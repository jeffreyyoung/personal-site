/*
 * ************************************************************************
 *
 *  ADOBE CONFIDENTIAL
 *  ___________________
 *
 *   (c) Copyright 2017 Adobe Systems, Inc.
 *   All Rights Reserved.
 *
 *  NOTICE:  All information contained herein is, and remains
 *  the property of Adobe Systems Incorporated and its suppliers,
 *  if any.  The intellectual and technical concepts contained
 *  herein are proprietary to Adobe Systems Incorporated and its
 *  suppliers and may be covered by U.S. and Foreign Patents,
 *  patents in process, and are protected by trade secret or copyright law.
 *  Dissemination of this information or reproduction of this material
 *  is strictly forbidden unless prior written permission is obtained
 *  from Adobe Systems Incorporated.
 * ************************************************************************
 */

/*
 * CloudViz - v4.1.0 - 2017-09-12
 * Copyright (c) 2017 Adobe Systems, Inc. All Rights Reserved.
 */

!function(){function a(a){return a&&(a.ownerDocument||a.document||a).documentElement}function b(a){return a&&(a.ownerDocument&&a.ownerDocument.defaultView||a.document&&a||a.defaultView)}function c(a,b){return a<b?-1:a>b?1:a>=b?0:NaN}function d(a){return null===a?NaN:+a}function e(a){return!isNaN(a)}function f(a){return{left:function(b,c,d,e){for(arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);d<e;){var f=d+e>>>1;a(b[f],c)<0?d=f+1:e=f}return d},right:function(b,c,d,e){for(arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);d<e;){var f=d+e>>>1;a(b[f],c)>0?e=f:d=f+1}return d}}}function g(a){return a.length}function h(a){for(var b=1;a*b%1;)b*=10;return b}function i(a,b){for(var c in b)Object.defineProperty(a.prototype,c,{value:b[c],enumerable:!1})}function j(){this._=Object.create(null)}function k(a){return(a+="")===sg||a[0]===tg?tg+a:a}function l(a){return(a+="")[0]===tg?a.slice(1):a}function m(a){return k(a)in this._}function n(a){return(a=k(a))in this._&&delete this._[a]}function o(){var a=[];for(var b in this._)a.push(l(b));return a}function p(){var a=0;for(var b in this._)++a;return a}function q(){for(var a in this._)return!1;return!0}function r(){this._=Object.create(null)}function s(a){return a}function t(a,b,c){return function(){var d=c.apply(b,arguments);return d===b?a:d}}function u(a,b){if(b in a)return b;b=b.charAt(0).toUpperCase()+b.slice(1);for(var c=0,d=ug.length;c<d;++c){var e=ug[c]+b;if(e in a)return e}}function v(){}function w(){}function x(a){function b(){for(var b,d=c,e=-1,f=d.length;++e<f;)(b=d[e].on)&&b.apply(this,arguments);return a}var c=[],d=new j;return b.on=function(b,e){var f,g=d.get(b);return arguments.length<2?g&&g.on:(g&&(g.on=null,c=c.slice(0,f=c.indexOf(g)).concat(c.slice(f+1)),d.remove(b)),e&&c.push(d.set(b,{on:e})),a)},b}function y(){hg.event.preventDefault()}function z(){for(var a,b=hg.event;a=b.sourceEvent;)b=a;return b}function A(a){for(var b=new w,c=0,d=arguments.length;++c<d;)b[arguments[c]]=x(b);return b.of=function(c,d){return function(e){try{var f=e.sourceEvent=hg.event;e.target=a,hg.event=e,b[e.type].apply(c,d)}finally{hg.event=f}}},b}function B(a){return wg(a,Ag),a}function C(a){return"function"==typeof a?a:function(){return xg(a,this)}}function D(a){return"function"==typeof a?a:function(){return yg(a,this)}}function E(a,b){function c(){this.removeAttribute(a)}function d(){this.removeAttributeNS(a.space,a.local)}function e(){this.setAttribute(a,b)}function f(){this.setAttributeNS(a.space,a.local,b)}function g(){var c=b.apply(this,arguments);null==c?this.removeAttribute(a):this.setAttribute(a,c)}function h(){var c=b.apply(this,arguments);null==c?this.removeAttributeNS(a.space,a.local):this.setAttributeNS(a.space,a.local,c)}return a=hg.ns.qualify(a),null==b?a.local?d:c:"function"==typeof b?a.local?h:g:a.local?f:e}function F(a){return a.trim().replace(/\s+/g," ")}function G(a){return new RegExp("(?:^|\\s+)"+hg.requote(a)+"(?:\\s+|$)","g")}function H(a){return(a+"").trim().split(/^|\s+/)}function I(a,b){function c(){for(var c=-1;++c<e;)a[c](this,b)}function d(){for(var c=-1,d=b.apply(this,arguments);++c<e;)a[c](this,d)}a=H(a).map(J);var e=a.length;return"function"==typeof b?d:c}function J(a){var b=G(a);return function(c,d){if(e=c.classList)return d?e.add(a):e.remove(a);var e=c.getAttribute("class")||"";d?(b.lastIndex=0,b.test(e)||c.setAttribute("class",F(e+" "+a))):c.setAttribute("class",F(e.replace(b," ")))}}function K(a,b,c){function d(){this.style.removeProperty(a)}function e(){this.style.setProperty(a,b,c)}function f(){var d=b.apply(this,arguments);null==d?this.style.removeProperty(a):this.style.setProperty(a,d,c)}return null==b?d:"function"==typeof b?f:e}function L(a,b){function c(){delete this[a]}function d(){this[a]=b}function e(){var c=b.apply(this,arguments);null==c?delete this[a]:this[a]=c}return null==b?c:"function"==typeof b?e:d}function M(a){function b(){var b=this.ownerDocument,c=this.namespaceURI;return c===Bg&&b.documentElement.namespaceURI===Bg?b.createElement(a):b.createElementNS(c,a)}function c(){return this.ownerDocument.createElementNS(a.space,a.local)}return"function"==typeof a?a:(a=hg.ns.qualify(a)).local?c:b}function N(){var a=this.parentNode;a&&a.removeChild(this)}function O(a){return{__data__:a}}function P(a){return function(){return zg(this,a)}}function Q(a){return arguments.length||(a=c),function(b,c){return b&&c?a(b.__data__,c.__data__):!b-!c}}function R(a,b){for(var c=0,d=a.length;c<d;c++)for(var e,f=a[c],g=0,h=f.length;g<h;g++)(e=f[g])&&b(e,g,c);return a}function S(a){return wg(a,Dg),a}function T(a){var b,c;return function(d,e,f){var g,h=a[f].update,i=h.length;for(f!=c&&(c=f,b=0),e>=b&&(b=e+1);!(g=h[b])&&++b<i;);return g}}function U(a,b,c){function d(){var b=this[g];b&&(this.removeEventListener(a,b,b.$),delete this[g])}function e(){var e=i(b,jg(arguments));d.call(this),this.addEventListener(a,this[g]=e,e.$=c),e._=b}function f(){var b,c=new RegExp("^__on([^.]+)"+hg.requote(a)+"$");for(var d in this)if(b=d.match(c)){var e=this[d];this.removeEventListener(b[1],e,e.$),delete this[d]}}var g="__on"+a,h=a.indexOf("."),i=V;h>0&&(a=a.slice(0,h));var j=Eg.get(a);return j&&(a=j,i=W),h?b?e:d:b?v:f}function V(a,b){return function(c){var d=hg.event;hg.event=c,b[0]=this.__data__;try{a.apply(this,b)}finally{hg.event=d}}}function W(a,b){var c=V(a,b);return function(a){var b=this,d=a.relatedTarget;d&&(d===b||8&d.compareDocumentPosition(b))||c.call(b,a)}}function X(c){var d=".dragsuppress-"+ ++Gg,e="click"+d,f=hg.select(b(c)).on("touchmove"+d,y).on("dragstart"+d,y).on("selectstart"+d,y);if(null==Fg&&(Fg=!("onselectstart"in c)&&u(c.style,"userSelect")),Fg){var g=a(c).style,h=g[Fg];g[Fg]="none"}return function(a){if(f.on(d,null),Fg&&(g[Fg]=h),a){var b=function(){f.on(e,null)};f.on(e,function(){y(),b()},!0),setTimeout(b,0)}}}function Y(a,c){c.changedTouches&&(c=c.changedTouches[0]);var d=a.ownerSVGElement||a;if(d.createSVGPoint){var e=d.createSVGPoint();if(Hg<0){var f=b(a);if(f.scrollX||f.scrollY){d=hg.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var g=d[0][0].getScreenCTM();Hg=!(g.f||g.e),d.remove()}}return Hg?(e.x=c.pageX,e.y=c.pageY):(e.x=c.clientX,e.y=c.clientY),e=e.matrixTransform(a.getScreenCTM().inverse()),[e.x,e.y]}var h=a.getBoundingClientRect();return[c.clientX-h.left-a.clientLeft,c.clientY-h.top-a.clientTop]}function Z(){return hg.event.changedTouches[0].identifier}function $(a){return a>0?1:a<0?-1:0}function _(a,b,c){return(b[0]-a[0])*(c[1]-a[1])-(b[1]-a[1])*(c[0]-a[0])}function aa(a){return a>1?0:a<-1?Kg:Math.acos(a)}function ba(a){return a>1?Ng:a<-1?-Ng:Math.asin(a)}function ca(a){return((a=Math.exp(a))-1/a)/2}function da(a){return((a=Math.exp(a))+1/a)/2}function ea(a){return((a=Math.exp(2*a))-1)/(a+1)}function fa(a){return(a=Math.sin(a/2))*a}function ga(){}function ha(a,b,c){return this instanceof ha?(this.h=+a,this.s=+b,void(this.l=+c)):arguments.length<2?a instanceof ha?new ha(a.h,a.s,a.l):va(""+a,wa,ha):new ha(a,b,c)}function ia(a,b,c){function d(a){return a>360?a-=360:a<0&&(a+=360),a<60?f+(g-f)*a/60:a<180?g:a<240?f+(g-f)*(240-a)/60:f}function e(a){return Math.round(255*d(a))}var f,g;return a=isNaN(a)?0:(a%=360)<0?a+360:a,b=isNaN(b)?0:b<0?0:b>1?1:b,c=c<0?0:c>1?1:c,g=c<=.5?c*(1+b):c+b-c*b,f=2*c-g,new ra(e(a+120),e(a),e(a-120))}function ja(a,b,c){return this instanceof ja?(this.h=+a,this.c=+b,void(this.l=+c)):arguments.length<2?a instanceof ja?new ja(a.h,a.c,a.l):a instanceof la?na(a.l,a.a,a.b):na((a=xa((a=hg.rgb(a)).r,a.g,a.b)).l,a.a,a.b):new ja(a,b,c)}function ka(a,b,c){return isNaN(a)&&(a=0),isNaN(b)&&(b=0),new la(c,Math.cos(a*=Og)*b,Math.sin(a)*b)}function la(a,b,c){return this instanceof la?(this.l=+a,this.a=+b,void(this.b=+c)):arguments.length<2?a instanceof la?new la(a.l,a.a,a.b):a instanceof ja?ka(a.h,a.c,a.l):xa((a=ra(a)).r,a.g,a.b):new la(a,b,c)}function ma(a,b,c){var d=(a+16)/116,e=d+b/500,f=d-c/200;return e=oa(e)*Zg,d=oa(d)*$g,f=oa(f)*_g,new ra(qa(3.2404542*e-1.5371385*d-.4985314*f),qa(-.969266*e+1.8760108*d+.041556*f),qa(.0556434*e-.2040259*d+1.0572252*f))}function na(a,b,c){return a>0?new ja(Math.atan2(c,b)*Pg,Math.sqrt(b*b+c*c),a):new ja(NaN,NaN,a)}function oa(a){return a>.206893034?a*a*a:(a-4/29)/7.787037}function pa(a){return a>.008856?Math.pow(a,1/3):7.787037*a+4/29}function qa(a){return Math.round(255*(a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055))}function ra(a,b,c){return this instanceof ra?(this.r=~~a,this.g=~~b,void(this.b=~~c)):arguments.length<2?a instanceof ra?new ra(a.r,a.g,a.b):va(""+a,ra,ia):new ra(a,b,c)}function sa(a){return new ra(a>>16,a>>8&255,255&a)}function ta(a){return sa(a)+""}function ua(a){return a<16?"0"+Math.max(0,a).toString(16):Math.min(255,a).toString(16)}function va(a,b,c){var d,e,f,g=0,h=0,i=0;if(d=/([a-z]+)\((.*)\)/.exec(a=a.toLowerCase()))switch(e=d[2].split(","),d[1]){case"hsl":return c(parseFloat(e[0]),parseFloat(e[1])/100,parseFloat(e[2])/100);case"rgb":return b(za(e[0]),za(e[1]),za(e[2]))}return(f=ch.get(a))?b(f.r,f.g,f.b):(null==a||"#"!==a.charAt(0)||isNaN(f=parseInt(a.slice(1),16))||(4===a.length?(g=(3840&f)>>4,g|=g>>4,h=240&f,h|=h>>4,i=15&f,i|=i<<4):7===a.length&&(g=(16711680&f)>>16,h=(65280&f)>>8,i=255&f)),b(g,h,i))}function wa(a,b,c){var d,e,f=Math.min(a/=255,b/=255,c/=255),g=Math.max(a,b,c),h=g-f,i=(g+f)/2;return h?(e=i<.5?h/(g+f):h/(2-g-f),d=a==g?(b-c)/h+(b<c?6:0):b==g?(c-a)/h+2:(a-b)/h+4,d*=60):(d=NaN,e=i>0&&i<1?0:d),new ha(d,e,i)}function xa(a,b,c){a=ya(a),b=ya(b),c=ya(c);var d=pa((.4124564*a+.3575761*b+.1804375*c)/Zg),e=pa((.2126729*a+.7151522*b+.072175*c)/$g);return la(116*e-16,500*(d-e),200*(e-pa((.0193339*a+.119192*b+.9503041*c)/_g)))}function ya(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function za(a){var b=parseFloat(a);return"%"===a.charAt(a.length-1)?Math.round(2.55*b):b}function Aa(a){return"function"==typeof a?a:function(){return a}}function Ba(a){return function(b,c,d){return 2===arguments.length&&"function"==typeof c&&(d=c,c=null),Ca(b,c,a,d)}}function Ca(a,b,c,d){function e(){var a,b=i.status;if(!b&&Ea(i)||b>=200&&b<300||304===b){try{a=c.call(f,i)}catch(d){return void g.error.call(f,d)}g.load.call(f,a)}else g.error.call(f,i)}var f={},g=hg.dispatch("beforesend","progress","load","error"),h={},i=new XMLHttpRequest,j=null;return!this.XDomainRequest||"withCredentials"in i||!/^(http(s)?:)?\/\//.test(a)||(i=new XDomainRequest),"onload"in i?i.onload=i.onerror=e:i.onreadystatechange=function(){i.readyState>3&&e()},i.onprogress=function(a){var b=hg.event;hg.event=a;try{g.progress.call(f,i)}finally{hg.event=b}},f.header=function(a,b){return a=(a+"").toLowerCase(),arguments.length<2?h[a]:(null==b?delete h[a]:h[a]=b+"",f)},f.mimeType=function(a){return arguments.length?(b=null==a?null:a+"",f):b},f.responseType=function(a){return arguments.length?(j=a,f):j},f.response=function(a){return c=a,f},["get","post"].forEach(function(a){f[a]=function(){return f.send.apply(f,[a].concat(jg(arguments)))}}),f.send=function(c,d,e){if(2===arguments.length&&"function"==typeof d&&(e=d,d=null),i.open(c,a,!0),null==b||"accept"in h||(h.accept=b+",*/*"),i.setRequestHeader)for(var k in h)i.setRequestHeader(k,h[k]);return null!=b&&i.overrideMimeType&&i.overrideMimeType(b),null!=j&&(i.responseType=j),null!=e&&f.on("error",e).on("load",function(a){e(null,a)}),g.beforesend.call(f,i),i.send(null==d?null:d),f},f.abort=function(){return i.abort(),f},hg.rebind(f,g,"on"),null==d?f:f.get(Da(d))}function Da(a){return 1===a.length?function(b,c){a(null==b?c:null)}:a}function Ea(a){var b=a.responseType;return b&&"text"!==b?a.response:a.responseText}function Fa(a,b,c){var d=arguments.length;d<2&&(b=0),d<3&&(c=Date.now());var e=c+b,f={c:a,t:e,n:null};return eh?eh.n=f:dh=f,eh=f,fh||(gh=clearTimeout(gh),fh=1,hh(Ga)),f}function Ga(){var a=Ha(),b=Ia()-a;b>24?(isFinite(b)&&(clearTimeout(gh),gh=setTimeout(Ga,b)),fh=0):(fh=1,hh(Ga))}function Ha(){for(var a=Date.now(),b=dh;b;)a>=b.t&&b.c(a-b.t)&&(b.c=null),b=b.n;return a}function Ia(){for(var a,b=dh,c=1/0;b;)b.c?(b.t<c&&(c=b.t),b=(a=b).n):b=a?a.n=b.n:dh=b.n;return eh=a,c}function Ja(a,b){return b-(a?Math.ceil(Math.log(a)/Math.LN10):1)}function Ka(a,b){var c=Math.pow(10,3*rg(8-b));return{scale:b>8?function(a){return a/c}:function(a){return a*c},symbol:a}}function La(a){var b=a.decimal,c=a.thousands,d=a.grouping,e=a.currency,f=d&&c?function(a,b){for(var e=a.length,f=[],g=0,h=d[0],i=0;e>0&&h>0&&(i+h+1>b&&(h=Math.max(1,b-i)),f.push(a.substring(e-=h,e+h)),!((i+=h+1)>b));)h=d[g=(g+1)%d.length];return f.reverse().join(c)}:s;return function(a){var c=jh.exec(a),d=c[1]||" ",g=c[2]||">",h=c[3]||"-",i=c[4]||"",j=c[5],k=+c[6],l=c[7],m=c[8],n=c[9],o=1,p="",q="",r=!1,s=!0;switch(m&&(m=+m.substring(1)),(j||"0"===d&&"="===g)&&(j=d="0",g="="),n){case"n":l=!0,n="g";break;case"%":o=100,q="%",n="f";break;case"p":o=100,q="%",n="r";break;case"b":case"o":case"x":case"X":"#"===i&&(p="0"+n.toLowerCase());case"c":s=!1;case"d":r=!0,m=0;break;case"s":o=-1,n="r"}"$"===i&&(p=e[0],q=e[1]),"r"!=n||m||(n="g"),null!=m&&("g"==n?m=Math.max(1,Math.min(21,m)):"e"!=n&&"f"!=n||(m=Math.max(0,Math.min(20,m)))),n=kh.get(n)||Ma;var t=j&&l;return function(a){var c=q;if(r&&a%1)return"";var e=a<0||0===a&&1/a<0?(a=-a,"-"):"-"===h?"":h;if(o<0){var i=hg.formatPrefix(a,m);a=i.scale(a),c=i.symbol+q}else a*=o;a=n(a,m);var u,v,w=a.lastIndexOf(".");if(w<0){var x=s?a.lastIndexOf("e"):-1;x<0?(u=a,v=""):(u=a.substring(0,x),v=a.substring(x))}else u=a.substring(0,w),v=b+a.substring(w+1);!j&&l&&(u=f(u,1/0));var y=p.length+u.length+v.length+(t?0:e.length),z=y<k?new Array(y=k-y+1).join(d):"";return t&&(u=f(z+u,z.length?k-v.length:1/0)),e+=p,a=u+v,("<"===g?e+a+z:">"===g?z+e+a:"^"===g?z.substring(0,y>>=1)+e+a+z.substring(y):e+(t?a:z+a))+c}}}function Ma(a){return a+""}function Na(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Oa(a,b,c){function d(b){var c=a(b),d=f(c,1);return b-c<d-b?c:d}function e(c){return b(c=a(new mh(c-1)),1),c}function f(a,c){return b(a=new mh(+a),c),a}function g(a,d,f){var g=e(a),h=[];if(f>1)for(;g<d;)c(g)%f||h.push(new Date(+g)),b(g,1);else for(;g<d;)h.push(new Date(+g)),b(g,1);return h}function h(a,b,c){try{mh=Na;var d=new Na;return d._=a,g(d,b,c)}finally{mh=Date}}a.floor=a,a.round=d,a.ceil=e,a.offset=f,a.range=g;var i=a.utc=Pa(a);return i.floor=i,i.round=Pa(d),i.ceil=Pa(e),i.offset=Pa(f),i.range=h,a}function Pa(a){return function(b,c){try{mh=Na;var d=new Na;return d._=b,a(d,c)._}finally{mh=Date}}}function Qa(a){function b(a){function b(b){for(var c,e,f,g=[],h=-1,i=0;++h<d;)37===a.charCodeAt(h)&&(g.push(a.slice(i,h)),null!=(e=oh[c=a.charAt(++h)])&&(c=a.charAt(++h)),(f=C[c])&&(c=f(b,null==e?"e"===c?" ":"0":e)),g.push(c),i=h+1);return g.push(a.slice(i,h)),g.join("")}var d=a.length;return b.parse=function(b){var d={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(c(d,a,b,0)!=b.length)return null;"p"in d&&(d.H=d.H%12+12*d.p);var e=null!=d.Z&&mh!==Na,f=new(e?Na:mh);return"j"in d?f.setFullYear(d.y,0,d.j):"W"in d||"U"in d?("w"in d||(d.w="W"in d?1:0),f.setFullYear(d.y,0,1),f.setFullYear(d.y,0,"W"in d?(d.w+6)%7+7*d.W-(f.getDay()+5)%7:d.w+7*d.U-(f.getDay()+6)%7)):f.setFullYear(d.y,d.m,d.d),f.setHours(d.H+(d.Z/100|0),d.M+d.Z%100,d.S,d.L),e?f._:f},b.toString=function(){return a},b}function c(a,b,c,d){for(var e,f,g,h=0,i=b.length,j=c.length;h<i;){if(d>=j)return-1;if(37===(e=b.charCodeAt(h++))){if(g=b.charAt(h++),!(f=D[g in oh?b.charAt(h++):g])||(d=f(a,c,d))<0)return-1}else if(e!=c.charCodeAt(d++))return-1}return d}function d(a,b,c){w.lastIndex=0;var d=w.exec(b.slice(c));return d?(a.w=x.get(d[0].toLowerCase()),c+d[0].length):-1}function e(a,b,c){u.lastIndex=0;var d=u.exec(b.slice(c));return d?(a.w=v.get(d[0].toLowerCase()),c+d[0].length):-1}function f(a,b,c){A.lastIndex=0;var d=A.exec(b.slice(c));return d?(a.m=B.get(d[0].toLowerCase()),c+d[0].length):-1}function g(a,b,c){y.lastIndex=0;var d=y.exec(b.slice(c));return d?(a.m=z.get(d[0].toLowerCase()),c+d[0].length):-1}function h(a,b,d){return c(a,C.c.toString(),b,d)}function i(a,b,d){return c(a,C.x.toString(),b,d)}function j(a,b,d){return c(a,C.X.toString(),b,d)}function k(a,b,c){var d=t.get(b.slice(c,c+=2).toLowerCase());return null==d?-1:(a.p=d,c)}var l=a.dateTime,m=a.date,n=a.time,o=a.periods,p=a.days,q=a.shortDays,r=a.months,s=a.shortMonths;b.utc=function(a){function c(a){try{mh=Na;var b=new mh;return b._=a,d(b)}finally{mh=Date}}var d=b(a);return c.parse=function(a){try{mh=Na;var b=d.parse(a);return b&&b._}finally{mh=Date}},c.toString=d.toString,c},b.multi=b.utc.multi=ib;var t=hg.map(),u=Sa(p),v=Ta(p),w=Sa(q),x=Ta(q),y=Sa(r),z=Ta(r),A=Sa(s),B=Ta(s);o.forEach(function(a,b){t.set(a.toLowerCase(),b)});var C={a:function(a){return q[a.getDay()]},A:function(a){return p[a.getDay()]},b:function(a){return s[a.getMonth()]},B:function(a){return r[a.getMonth()]},c:b(l),d:function(a,b){return Ra(a.getDate(),b,2)},e:function(a,b){return Ra(a.getDate(),b,2)},H:function(a,b){return Ra(a.getHours(),b,2)},I:function(a,b){return Ra(a.getHours()%12||12,b,2)},j:function(a,b){return Ra(1+lh.dayOfYear(a),b,3)},L:function(a,b){return Ra(a.getMilliseconds(),b,3)},m:function(a,b){return Ra(a.getMonth()+1,b,2)},M:function(a,b){return Ra(a.getMinutes(),b,2)},p:function(a){return o[+(a.getHours()>=12)]},S:function(a,b){return Ra(a.getSeconds(),b,2)},U:function(a,b){return Ra(lh.sundayOfYear(a),b,2)},w:function(a){return a.getDay()},W:function(a,b){return Ra(lh.mondayOfYear(a),b,2)},x:b(m),X:b(n),y:function(a,b){return Ra(a.getFullYear()%100,b,2)},Y:function(a,b){return Ra(a.getFullYear()%1e4,b,4)},Z:gb,"%":function(){return"%"}},D={a:d,A:e,b:f,B:g,c:h,d:ab,e:ab,H:cb,I:cb,j:bb,L:fb,m:_a,M:db,p:k,S:eb,U:Va,w:Ua,W:Wa,x:i,X:j,y:Ya,Y:Xa,Z:Za,"%":hb};return b}function Ra(a,b,c){var d=a<0?"-":"",e=(d?-a:a)+"",f=e.length;return d+(f<c?new Array(c-f+1).join(b)+e:e)}function Sa(a){return new RegExp("^(?:"+a.map(hg.requote).join("|")+")","i")}function Ta(a){for(var b=new j,c=-1,d=a.length;++c<d;)b.set(a[c].toLowerCase(),c);return b}function Ua(a,b,c){ph.lastIndex=0;var d=ph.exec(b.slice(c,c+1));return d?(a.w=+d[0],c+d[0].length):-1}function Va(a,b,c){ph.lastIndex=0;var d=ph.exec(b.slice(c));return d?(a.U=+d[0],c+d[0].length):-1}function Wa(a,b,c){ph.lastIndex=0;var d=ph.exec(b.slice(c));return d?(a.W=+d[0],c+d[0].length):-1}function Xa(a,b,c){ph.lastIndex=0;var d=ph.exec(b.slice(c,c+4));return d?(a.y=+d[0],c+d[0].length):-1}function Ya(a,b,c){ph.lastIndex=0;var d=ph.exec(b.slice(c,c+2));return d?(a.y=$a(+d[0]),c+d[0].length):-1}function Za(a,b,c){return/^[+-]\d{4}$/.test(b=b.slice(c,c+5))?(a.Z=-b,c+5):-1}function $a(a){return a+(a>68?1900:2e3)}function _a(a,b,c){ph.lastIndex=0;var d=ph.exec(b.slice(c,c+2));return d?(a.m=d[0]-1,c+d[0].length):-1}function ab(a,b,c){ph.lastIndex=0;var d=ph.exec(b.slice(c,c+2));return d?(a.d=+d[0],c+d[0].length):-1}function bb(a,b,c){ph.lastIndex=0;var d=ph.exec(b.slice(c,c+3));return d?(a.j=+d[0],c+d[0].length):-1}function cb(a,b,c){ph.lastIndex=0;var d=ph.exec(b.slice(c,c+2));return d?(a.H=+d[0],c+d[0].length):-1}function db(a,b,c){ph.lastIndex=0;var d=ph.exec(b.slice(c,c+2));return d?(a.M=+d[0],c+d[0].length):-1}function eb(a,b,c){ph.lastIndex=0;var d=ph.exec(b.slice(c,c+2));return d?(a.S=+d[0],c+d[0].length):-1}function fb(a,b,c){ph.lastIndex=0;var d=ph.exec(b.slice(c,c+3));return d?(a.L=+d[0],c+d[0].length):-1}function gb(a){var b=a.getTimezoneOffset(),c=b>0?"-":"+",d=rg(b)/60|0,e=rg(b)%60;return c+Ra(d,"0",2)+Ra(e,"0",2)}function hb(a,b,c){qh.lastIndex=0;var d=qh.exec(b.slice(c,c+1));return d?c+d[0].length:-1}function ib(a){for(var b=a.length,c=-1;++c<b;)a[c][0]=this(a[c][0]);return function(b){for(var c=0,d=a[c];!d[1](b);)d=a[++c];return d[0](b)}}function jb(){}function kb(a,b,c){var d=c.s=a+b,e=d-a,f=d-e;c.t=a-f+(b-e)}function lb(a,b){a&&uh.hasOwnProperty(a.type)&&uh[a.type](a,b)}function mb(a,b,c){var d,e=-1,f=a.length-c;for(b.lineStart();++e<f;)d=a[e],b.point(d[0],d[1],d[2]);b.lineEnd()}function nb(a,b){var c=-1,d=a.length;for(b.polygonStart();++c<d;)mb(a[c],b,1);b.polygonEnd()}function ob(){function a(a,b){a*=Og,b=b*Og/2+Kg/4;var c=a-d,g=c>=0?1:-1,h=g*c,i=Math.cos(b),j=Math.sin(b),k=f*j,l=e*i+k*Math.cos(h),m=k*g*Math.sin(h);wh.add(Math.atan2(m,l)),d=a,e=i,f=j}var b,c,d,e,f;xh.point=function(g,h){xh.point=a,d=(b=g)*Og,e=Math.cos(h=(c=h)*Og/2+Kg/4),f=Math.sin(h)},xh.lineEnd=function(){a(b,c)}}function pb(a){var b=a[0],c=a[1],d=Math.cos(c);return[d*Math.cos(b),d*Math.sin(b),Math.sin(c)]}function qb(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function rb(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}function sb(a,b){a[0]+=b[0],a[1]+=b[1],a[2]+=b[2]}function tb(a,b){return[a[0]*b,a[1]*b,a[2]*b]}function ub(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);a[0]/=b,a[1]/=b,a[2]/=b}function vb(a){return[Math.atan2(a[1],a[0]),ba(a[2])]}function wb(a,b){return rg(a[0]-b[0])<Ig&&rg(a[1]-b[1])<Ig}function xb(a,b){a*=Og;var c=Math.cos(b*=Og);yb(c*Math.cos(a),c*Math.sin(a),Math.sin(b))}function yb(a,b,c){++yh,Ah+=(a-Ah)/yh,Bh+=(b-Bh)/yh,Ch+=(c-Ch)/yh}function zb(){function a(a,e){a*=Og;var f=Math.cos(e*=Og),g=f*Math.cos(a),h=f*Math.sin(a),i=Math.sin(e),j=Math.atan2(Math.sqrt((j=c*i-d*h)*j+(j=d*g-b*i)*j+(j=b*h-c*g)*j),b*g+c*h+d*i);zh+=j,Dh+=j*(b+(b=g)),Eh+=j*(c+(c=h)),Fh+=j*(d+(d=i)),yb(b,c,d)}var b,c,d;Jh.point=function(e,f){e*=Og;var g=Math.cos(f*=Og);b=g*Math.cos(e),c=g*Math.sin(e),d=Math.sin(f),Jh.point=a,yb(b,c,d)}}function Ab(){Jh.point=xb}function Bb(){function a(a,b){a*=Og;var c=Math.cos(b*=Og),g=c*Math.cos(a),h=c*Math.sin(a),i=Math.sin(b),j=e*i-f*h,k=f*g-d*i,l=d*h-e*g,m=Math.sqrt(j*j+k*k+l*l),n=d*g+e*h+f*i,o=m&&-aa(n)/m,p=Math.atan2(m,n);Gh+=o*j,Hh+=o*k,Ih+=o*l,zh+=p,Dh+=p*(d+(d=g)),Eh+=p*(e+(e=h)),Fh+=p*(f+(f=i)),yb(d,e,f)}var b,c,d,e,f;Jh.point=function(g,h){b=g,c=h,Jh.point=a,g*=Og;var i=Math.cos(h*=Og);d=i*Math.cos(g),e=i*Math.sin(g),f=Math.sin(h),yb(d,e,f)},Jh.lineEnd=function(){a(b,c),Jh.lineEnd=Ab,Jh.point=xb}}function Cb(a,b){function c(c,d){return c=a(c,d),b(c[0],c[1])}return a.invert&&b.invert&&(c.invert=function(c,d){return(c=b.invert(c,d))&&a.invert(c[0],c[1])}),c}function Db(){return!0}function Eb(a,b,c,d,e){var f=[],g=[];if(a.forEach(function(a){if(!((b=a.length-1)<=0)){var b,c=a[0],d=a[b];if(wb(c,d)){e.lineStart();for(var h=0;h<b;++h)e.point((c=a[h])[0],c[1]);return void e.lineEnd()}var i=new Gb(c,a,null,!0),j=new Gb(c,null,i,!1);i.o=j,f.push(i),g.push(j),i=new Gb(d,a,null,!1),j=new Gb(d,null,i,!0),i.o=j,f.push(i),g.push(j)}}),g.sort(b),Fb(f),Fb(g),f.length){for(var h=0,i=c,j=g.length;h<j;++h)g[h].e=i=!i;for(var k,l,m=f[0];;){for(var n=m,o=!0;n.v;)if((n=n.n)===m)return;k=n.z,e.lineStart();do{if(n.v=n.o.v=!0,n.e){if(o)for(var h=0,j=k.length;h<j;++h)e.point((l=k[h])[0],l[1]);else d(n.x,n.n.x,1,e);n=n.n}else{if(o){k=n.p.z;for(var h=k.length-1;h>=0;--h)e.point((l=k[h])[0],l[1])}else d(n.x,n.p.x,-1,e);n=n.p}n=n.o,k=n.z,o=!o}while(!n.v);e.lineEnd()}}}function Fb(a){if(b=a.length){for(var b,c,d=0,e=a[0];++d<b;)e.n=c=a[d],c.p=e,e=c;e.n=c=a[0],c.p=e}}function Gb(a,b,c,d){this.x=a,this.z=b,this.o=c,this.e=d,this.v=!1,this.n=this.p=null}function Hb(a,b,c,d){return function(e,f){function g(b,c){var d=e(b,c);a(b=d[0],c=d[1])&&f.point(b,c)}function h(a,b){var c=e(a,b);q.point(c[0],c[1])}function i(){s.point=h,q.lineStart()}function j(){s.point=g,q.lineEnd()}function k(a,b){p.push([a,b]);var c=e(a,b);u.point(c[0],c[1])}function l(){u.lineStart(),p=[]}function m(){k(p[0][0],p[0][1]),u.lineEnd();var a,b=u.clean(),c=t.buffer(),d=c.length;if(p.pop(),o.push(p),p=null,d)if(1&b){a=c[0];var e,d=a.length-1,g=-1;if(d>0){for(v||(f.polygonStart(),v=!0),f.lineStart();++g<d;)f.point((e=a[g])[0],e[1]);f.lineEnd()}}else d>1&&2&b&&c.push(c.pop().concat(c.shift())),n.push(c.filter(Ib))}var n,o,p,q=b(f),r=e.invert(d[0],d[1]),s={point:g,lineStart:i,lineEnd:j,polygonStart:function(){s.point=k,s.lineStart=l,s.lineEnd=m,n=[],o=[]},polygonEnd:function(){s.point=g,s.lineStart=i,s.lineEnd=j,n=hg.merge(n);var a=Ob(r,o);n.length?(v||(f.polygonStart(),v=!0),Eb(n,Kb,a,c,f)):a&&(v||(f.polygonStart(),v=!0),f.lineStart(),c(null,null,1,f),f.lineEnd()),v&&(f.polygonEnd(),v=!1),n=o=null},sphere:function(){f.polygonStart(),f.lineStart(),c(null,null,1,f),f.lineEnd(),f.polygonEnd()}},t=Jb(),u=b(t),v=!1;return s}}function Ib(a){return a.length>1}function Jb(){var a,b=[];return{lineStart:function(){b.push(a=[])},point:function(b,c){a.push([b,c])},lineEnd:v,buffer:function(){var c=b;return b=[],a=null,c},rejoin:function(){b.length>1&&b.push(b.pop().concat(b.shift()))}}}function Kb(a,b){return((a=a.x)[0]<0?a[1]-Ng-Ig:Ng-a[1])-((b=b.x)[0]<0?b[1]-Ng-Ig:Ng-b[1])}function Lb(a){var b,c=NaN,d=NaN,e=NaN;return{lineStart:function(){a.lineStart(),b=1},point:function(f,g){var h=f>0?Kg:-Kg,i=rg(f-c);rg(i-Kg)<Ig?(a.point(c,d=(d+g)/2>0?Ng:-Ng),a.point(e,d),a.lineEnd(),a.lineStart(),a.point(h,d),a.point(f,d),b=0):e!==h&&i>=Kg&&(rg(c-e)<Ig&&(c-=e*Ig),rg(f-h)<Ig&&(f-=h*Ig),d=Mb(c,d,f,g),a.point(e,d),a.lineEnd(),a.lineStart(),a.point(h,d),b=0),a.point(c=f,d=g),e=h},lineEnd:function(){a.lineEnd(),c=d=NaN},clean:function(){return 2-b}}}function Mb(a,b,c,d){var e,f,g=Math.sin(a-c);return rg(g)>Ig?Math.atan((Math.sin(b)*(f=Math.cos(d))*Math.sin(c)-Math.sin(d)*(e=Math.cos(b))*Math.sin(a))/(e*f*g)):(b+d)/2}function Nb(a,b,c,d){var e;if(null==a)e=c*Ng,d.point(-Kg,e),d.point(0,e),d.point(Kg,e),d.point(Kg,0),d.point(Kg,-e),d.point(0,-e),d.point(-Kg,-e),d.point(-Kg,0),d.point(-Kg,e);else if(rg(a[0]-b[0])>Ig){var f=a[0]<b[0]?Kg:-Kg;e=c*f/2,d.point(-f,e),d.point(0,e),d.point(f,e)}else d.point(b[0],b[1])}function Ob(a,b){var c=a[0],d=a[1],e=[Math.sin(c),-Math.cos(c),0],f=0,g=0;wh.reset();for(var h=0,i=b.length;h<i;++h){var j=b[h],k=j.length;if(k)for(var l=j[0],m=l[0],n=l[1]/2+Kg/4,o=Math.sin(n),p=Math.cos(n),q=1;;){q===k&&(q=0),a=j[q];var r=a[0],s=a[1]/2+Kg/4,t=Math.sin(s),u=Math.cos(s),v=r-m,w=v>=0?1:-1,x=w*v,y=x>Kg,z=o*t;if(wh.add(Math.atan2(z*w*Math.sin(x),p*u+z*Math.cos(x))),f+=y?v+w*Lg:v,y^m>=c^r>=c){var A=rb(pb(l),pb(a));ub(A);var B=rb(e,A);ub(B);var C=(y^v>=0?-1:1)*ba(B[2]);(d>C||d===C&&(A[0]||A[1]))&&(g+=y^v>=0?1:-1)}if(!q++)break;m=r,o=t,p=u,l=a}}return(f<-Ig||f<Ig&&wh<0)^1&g}function Pb(a){function b(a,b){return Math.cos(a)*Math.cos(b)>f}function c(a){var c,f,i,j,k;return{lineStart:function(){j=i=!1,k=1},point:function(l,m){var n,o=[l,m],p=b(l,m),q=g?p?0:e(l,m):p?e(l+(l<0?Kg:-Kg),m):0;if(!c&&(j=i=p)&&a.lineStart(),p!==i&&(n=d(c,o),(wb(c,n)||wb(o,n))&&(o[0]+=Ig,o[1]+=Ig,p=b(o[0],o[1]))),p!==i)k=0,p?(a.lineStart(),n=d(o,c),a.point(n[0],n[1])):(n=d(c,o),a.point(n[0],n[1]),a.lineEnd()),c=n;else if(h&&c&&g^p){var r;q&f||!(r=d(o,c,!0))||(k=0,g?(a.lineStart(),a.point(r[0][0],r[0][1]),a.point(r[1][0],r[1][1]),a.lineEnd()):(a.point(r[1][0],r[1][1]),a.lineEnd(),a.lineStart(),a.point(r[0][0],r[0][1])))}!p||c&&wb(c,o)||a.point(o[0],o[1]),c=o,i=p,f=q},lineEnd:function(){i&&a.lineEnd(),c=null},clean:function(){return k|(j&&i)<<1}}}function d(a,b,c){var d=pb(a),e=pb(b),g=[1,0,0],h=rb(d,e),i=qb(h,h),j=h[0],k=i-j*j;if(!k)return!c&&a;var l=f*i/k,m=-f*j/k,n=rb(g,h),o=tb(g,l);sb(o,tb(h,m));var p=n,q=qb(o,p),r=qb(p,p),s=q*q-r*(qb(o,o)-1);if(!(s<0)){var t=Math.sqrt(s),u=tb(p,(-q-t)/r);if(sb(u,o),u=vb(u),!c)return u;var v,w=a[0],x=b[0],y=a[1],z=b[1];x<w&&(v=w,w=x,x=v);var A=x-w,B=rg(A-Kg)<Ig,C=B||A<Ig;if(!B&&z<y&&(v=y,y=z,z=v),C?B?y+z>0^u[1]<(rg(u[0]-w)<Ig?y:z):y<=u[1]&&u[1]<=z:A>Kg^(w<=u[0]&&u[0]<=x)){var D=tb(p,(-q+t)/r);return sb(D,o),[u,vb(D)]}}}function e(b,c){var d=g?a:Kg-a,e=0;return b<-d?e|=1:b>d&&(e|=2),c<-d?e|=4:c>d&&(e|=8),e}var f=Math.cos(a),g=f>0,h=rg(f)>Ig;return Hb(b,c,oc(a,6*Og),g?[0,-a]:[-Kg,a-Kg])}function Qb(a,b,c,d){return function(e){var f,g=e.a,h=e.b,i=g.x,j=g.y,k=h.x,l=h.y,m=0,n=1,o=k-i,p=l-j;if(f=a-i,o||!(f>0)){if(f/=o,o<0){if(f<m)return;f<n&&(n=f)}else if(o>0){if(f>n)return;f>m&&(m=f)}if(f=c-i,o||!(f<0)){if(f/=o,o<0){if(f>n)return;f>m&&(m=f)}else if(o>0){if(f<m)return;f<n&&(n=f)}if(f=b-j,p||!(f>0)){if(f/=p,p<0){if(f<m)return;f<n&&(n=f)}else if(p>0){if(f>n)return;f>m&&(m=f)}if(f=d-j,p||!(f<0)){if(f/=p,p<0){if(f>n)return;f>m&&(m=f)}else if(p>0){if(f<m)return;f<n&&(n=f)}return m>0&&(e.a={x:i+m*o,y:j+m*p}),n<1&&(e.b={x:i+n*o,y:j+n*p}),e}}}}}}function Rb(a,b,c,d){function e(d,e){return rg(d[0]-a)<Ig?e>0?0:3:rg(d[0]-c)<Ig?e>0?2:1:rg(d[1]-b)<Ig?e>0?1:0:e>0?3:2}function f(a,b){return g(a.x,b.x)}function g(a,b){var c=e(a,1),d=e(b,1);return c!==d?c-d:0===c?b[1]-a[1]:1===c?a[0]-b[0]:2===c?a[1]-b[1]:b[0]-a[0]}return function(h){function i(a){for(var b=0,c=q.length,d=a[1],e=0;e<c;++e)for(var f,g=1,h=q[e],i=h.length,j=h[0];g<i;++g)f=h[g],j[1]<=d?f[1]>d&&_(j,f,a)>0&&++b:f[1]<=d&&_(j,f,a)<0&&--b,j=f;return 0!==b}function j(f,h,i,j){var k=0,l=0;if(null==f||(k=e(f,i))!==(l=e(h,i))||g(f,h)<0^i>0)do{j.point(0===k||3===k?a:c,k>1?d:b)}while((k=(k+i+4)%4)!==l);else j.point(h[0],h[1])}function k(e,f){return a<=e&&e<=c&&b<=f&&f<=d}function l(a,b){k(a,b)&&h.point(a,b)}function m(){D.point=o,q&&q.push(r=[]),y=!0,x=!1,v=w=NaN}function n(){p&&(o(s,t),u&&x&&B.rejoin(),p.push(B.buffer())),D.point=l,x&&h.lineEnd()}function o(a,b){a=Math.max(-Lh,Math.min(Lh,a)),b=Math.max(-Lh,Math.min(Lh,b));var c=k(a,b);if(q&&r.push([a,b]),y)s=a,t=b,u=c,y=!1,c&&(h.lineStart(),h.point(a,b));else if(c&&x)h.point(a,b);else{var d={a:{x:v,y:w},b:{x:a,y:b}};C(d)?(x||(h.lineStart(),h.point(d.a.x,d.a.y)),h.point(d.b.x,d.b.y),c||h.lineEnd(),z=!1):c&&(h.lineStart(),h.point(a,b),z=!1)}v=a,w=b,x=c}var p,q,r,s,t,u,v,w,x,y,z,A=h,B=Jb(),C=Qb(a,b,c,d),D={point:l,lineStart:m,lineEnd:n,polygonStart:function(){h=B,p=[],q=[],z=!0},polygonEnd:function(){h=A,p=hg.merge(p);var b=i([a,d]),c=z&&b,e=p.length;(c||e)&&(h.polygonStart(),c&&(h.lineStart(),j(null,null,1,h),h.lineEnd()),e&&Eb(p,f,b,j,h),h.polygonEnd()),p=q=r=null}};return D}}function Sb(a){var b=0,c=Kg/3,d=gc(a),e=d(b,c);return e.parallels=function(a){return arguments.length?d(b=a[0]*Kg/180,c=a[1]*Kg/180):[b/Kg*180,c/Kg*180]},e}function Tb(a,b){function c(a,b){var c=Math.sqrt(f-2*e*Math.sin(b))/e;return[c*Math.sin(a*=e),g-c*Math.cos(a)]}var d=Math.sin(a),e=(d+Math.sin(b))/2,f=1+d*(2*e-d),g=Math.sqrt(f)/e;return c.invert=function(a,b){var c=g-b;return[Math.atan2(a,c)/e,ba((f-(a*a+c*c)*e*e)/(2*e))]},c}function Ub(){function a(a,b){Nh+=e*a-d*b,d=a,e=b}var b,c,d,e;Sh.point=function(f,g){Sh.point=a,b=d=f,c=e=g},Sh.lineEnd=function(){a(b,c)}}function Vb(a,b){a<Oh&&(Oh=a),a>Qh&&(Qh=a),b<Ph&&(Ph=b),b>Rh&&(Rh=b)}function Wb(){function a(a,b){g.push("M",a,",",b,f)}function b(a,b){g.push("M",a,",",b),h.point=c}function c(a,b){g.push("L",a,",",b)}function d(){h.point=a}function e(){g.push("Z")}var f=Xb(4.5),g=[],h={point:a,lineStart:function(){h.point=b},lineEnd:d,polygonStart:function(){h.lineEnd=e},polygonEnd:function(){h.lineEnd=d,h.point=a},pointRadius:function(a){return f=Xb(a),h},result:function(){if(g.length){var a=g.join("");return g=[],a}}};return h}function Xb(a){return"m0,"+a+"a"+a+","+a+" 0 1,1 0,"+-2*a+"a"+a+","+a+" 0 1,1 0,"+2*a+"z"}function Yb(a,b){Ah+=a,Bh+=b,++Ch}function Zb(){function a(a,d){var e=a-b,f=d-c,g=Math.sqrt(e*e+f*f);Dh+=g*(b+a)/2,Eh+=g*(c+d)/2,Fh+=g,Yb(b=a,c=d)}var b,c;Uh.point=function(d,e){Uh.point=a,Yb(b=d,c=e)}}function $b(){Uh.point=Yb}function _b(){function a(a,b){var c=a-d,f=b-e,g=Math.sqrt(c*c+f*f);Dh+=g*(d+a)/2,Eh+=g*(e+b)/2,Fh+=g,g=e*a-d*b,Gh+=g*(d+a),Hh+=g*(e+b),Ih+=3*g,Yb(d=a,e=b)}var b,c,d,e;Uh.point=function(f,g){Uh.point=a,Yb(b=d=f,c=e=g)},Uh.lineEnd=function(){a(b,c)}}function ac(a){function b(b,c){a.moveTo(b+g,c),a.arc(b,c,g,0,Lg)}function c(b,c){a.moveTo(b,c),h.point=d}function d(b,c){a.lineTo(b,c)}function e(){h.point=b}function f(){a.closePath()}var g=4.5,h={point:b,lineStart:function(){h.point=c},lineEnd:e,polygonStart:function(){h.lineEnd=f},polygonEnd:function(){h.lineEnd=e,h.point=b},pointRadius:function(a){return g=a,h},result:v};return h}function bc(a){function b(a){return(h?d:c)(a)}function c(b){return ec(b,function(c,d){c=a(c,d),b.point(c[0],c[1])})}function d(b){function c(c,d){c=a(c,d),b.point(c[0],c[1])}function d(){t=NaN,y.point=f,b.lineStart()}function f(c,d){var f=pb([c,d]),g=a(c,d);e(t,u,s,v,w,x,t=g[0],u=g[1],s=c,v=f[0],w=f[1],x=f[2],h,b),b.point(t,u)}function g(){y.point=c,b.lineEnd()}function i(){d(),
y.point=j,y.lineEnd=k}function j(a,b){f(l=a,m=b),n=t,o=u,p=v,q=w,r=x,y.point=f}function k(){e(t,u,s,v,w,x,n,o,l,p,q,r,h,b),y.lineEnd=g,g()}var l,m,n,o,p,q,r,s,t,u,v,w,x,y={point:c,lineStart:d,lineEnd:g,polygonStart:function(){b.polygonStart(),y.lineStart=i},polygonEnd:function(){b.polygonEnd(),y.lineStart=d}};return y}function e(b,c,d,h,i,j,k,l,m,n,o,p,q,r){var s=k-b,t=l-c,u=s*s+t*t;if(u>4*f&&q--){var v=h+n,w=i+o,x=j+p,y=Math.sqrt(v*v+w*w+x*x),z=Math.asin(x/=y),A=rg(rg(x)-1)<Ig||rg(d-m)<Ig?(d+m)/2:Math.atan2(w,v),B=a(A,z),C=B[0],D=B[1],E=C-b,F=D-c,G=t*E-s*F;(G*G/u>f||rg((s*E+t*F)/u-.5)>.3||h*n+i*o+j*p<g)&&(e(b,c,d,h,i,j,C,D,A,v/=y,w/=y,x,q,r),r.point(C,D),e(C,D,A,v,w,x,k,l,m,n,o,p,q,r))}}var f=.5,g=Math.cos(30*Og),h=16;return b.precision=function(a){return arguments.length?(h=(f=a*a)>0&&16,b):Math.sqrt(f)},b}function cc(a){var b=bc(function(b,c){return a([b*Pg,c*Pg])});return function(a){return hc(b(a))}}function dc(a){this.stream=a}function ec(a,b){return{point:b,sphere:function(){a.sphere()},lineStart:function(){a.lineStart()},lineEnd:function(){a.lineEnd()},polygonStart:function(){a.polygonStart()},polygonEnd:function(){a.polygonEnd()}}}function fc(a){return gc(function(){return a})()}function gc(a){function b(a){return a=h(a[0]*Og,a[1]*Og),[a[0]*m+i,j-a[1]*m]}function c(a){return(a=h.invert((a[0]-i)/m,(j-a[1])/m))&&[a[0]*Pg,a[1]*Pg]}function d(){h=Cb(g=kc(r,t,u),f);var a=f(p,q);return i=n-a[0]*m,j=o+a[1]*m,e()}function e(){return k&&(k.valid=!1,k=null),b}var f,g,h,i,j,k,l=bc(function(a,b){return a=f(a,b),[a[0]*m+i,j-a[1]*m]}),m=150,n=480,o=250,p=0,q=0,r=0,t=0,u=0,v=Kh,w=s,x=null,y=null;return b.stream=function(a){return k&&(k.valid=!1),k=hc(v(g,l(w(a)))),k.valid=!0,k},b.clipAngle=function(a){return arguments.length?(v=null==a?(x=a,Kh):Pb((x=+a)*Og),e()):x},b.clipExtent=function(a){return arguments.length?(y=a,w=a?Rb(a[0][0],a[0][1],a[1][0],a[1][1]):s,e()):y},b.scale=function(a){return arguments.length?(m=+a,d()):m},b.translate=function(a){return arguments.length?(n=+a[0],o=+a[1],d()):[n,o]},b.center=function(a){return arguments.length?(p=a[0]%360*Og,q=a[1]%360*Og,d()):[p*Pg,q*Pg]},b.rotate=function(a){return arguments.length?(r=a[0]%360*Og,t=a[1]%360*Og,u=a.length>2?a[2]%360*Og:0,d()):[r*Pg,t*Pg,u*Pg]},hg.rebind(b,l,"precision"),function(){return f=a.apply(this,arguments),b.invert=f.invert&&c,d()}}function hc(a){return ec(a,function(b,c){a.point(b*Og,c*Og)})}function ic(a,b){return[a,b]}function jc(a,b){return[a>Kg?a-Lg:a<-Kg?a+Lg:a,b]}function kc(a,b,c){return a?b||c?Cb(mc(a),nc(b,c)):mc(a):b||c?nc(b,c):jc}function lc(a){return function(b,c){return b+=a,[b>Kg?b-Lg:b<-Kg?b+Lg:b,c]}}function mc(a){var b=lc(a);return b.invert=lc(-a),b}function nc(a,b){function c(a,b){var c=Math.cos(b),h=Math.cos(a)*c,i=Math.sin(a)*c,j=Math.sin(b),k=j*d+h*e;return[Math.atan2(i*f-k*g,h*d-j*e),ba(k*f+i*g)]}var d=Math.cos(a),e=Math.sin(a),f=Math.cos(b),g=Math.sin(b);return c.invert=function(a,b){var c=Math.cos(b),h=Math.cos(a)*c,i=Math.sin(a)*c,j=Math.sin(b),k=j*f-i*g;return[Math.atan2(i*f+j*g,h*d+k*e),ba(k*d-h*e)]},c}function oc(a,b){var c=Math.cos(a),d=Math.sin(a);return function(e,f,g,h){var i=g*b;null!=e?(e=pc(c,e),f=pc(c,f),(g>0?e<f:e>f)&&(e+=g*Lg)):(e=a+g*Lg,f=a-.5*i);for(var j,k=e;g>0?k>f:k<f;k-=i)h.point((j=vb([c,-d*Math.cos(k),-d*Math.sin(k)]))[0],j[1])}}function pc(a,b){var c=pb(b);c[0]-=a,ub(c);var d=aa(-c[1]);return((-c[2]<0?-d:d)+2*Math.PI-Ig)%(2*Math.PI)}function qc(a,b,c){var d=hg.range(a,b-Ig,c).concat(b);return function(a){return d.map(function(b){return[a,b]})}}function rc(a,b,c){var d=hg.range(a,b-Ig,c).concat(b);return function(a){return d.map(function(b){return[b,a]})}}function sc(a){return a.source}function tc(a){return a.target}function uc(a,b,c,d){var e=Math.cos(b),f=Math.sin(b),g=Math.cos(d),h=Math.sin(d),i=e*Math.cos(a),j=e*Math.sin(a),k=g*Math.cos(c),l=g*Math.sin(c),m=2*Math.asin(Math.sqrt(fa(d-b)+e*g*fa(c-a))),n=1/Math.sin(m),o=m?function(a){var b=Math.sin(a*=m)*n,c=Math.sin(m-a)*n,d=c*i+b*k,e=c*j+b*l,g=c*f+b*h;return[Math.atan2(e,d)*Pg,Math.atan2(g,Math.sqrt(d*d+e*e))*Pg]}:function(){return[a*Pg,b*Pg]};return o.distance=m,o}function vc(){function a(a,e){var f=Math.sin(e*=Og),g=Math.cos(e),h=rg((a*=Og)-b),i=Math.cos(h);Vh+=Math.atan2(Math.sqrt((h=g*Math.sin(h))*h+(h=d*f-c*g*i)*h),c*f+d*g*i),b=a,c=f,d=g}var b,c,d;Wh.point=function(e,f){b=e*Og,c=Math.sin(f*=Og),d=Math.cos(f),Wh.point=a},Wh.lineEnd=function(){Wh.point=Wh.lineEnd=v}}function wc(a,b){function c(b,c){var d=Math.cos(b),e=Math.cos(c),f=a(d*e);return[f*e*Math.sin(b),f*Math.sin(c)]}return c.invert=function(a,c){var d=Math.sqrt(a*a+c*c),e=b(d),f=Math.sin(e),g=Math.cos(e);return[Math.atan2(a*f,d*g),Math.asin(d&&c*f/d)]},c}function xc(a,b){function c(a,b){g>0?b<-Ng+Ig&&(b=-Ng+Ig):b>Ng-Ig&&(b=Ng-Ig);var c=g/Math.pow(e(b),f);return[c*Math.sin(f*a),g-c*Math.cos(f*a)]}var d=Math.cos(a),e=function(a){return Math.tan(Kg/4+a/2)},f=a===b?Math.sin(a):Math.log(d/Math.cos(b))/Math.log(e(b)/e(a)),g=d*Math.pow(e(a),f)/f;return f?(c.invert=function(a,b){var c=g-b,d=$(f)*Math.sqrt(a*a+c*c);return[Math.atan2(a,c)/f,2*Math.atan(Math.pow(g/d,1/f))-Ng]},c):zc}function yc(a,b){function c(a,b){var c=f-b;return[c*Math.sin(e*a),f-c*Math.cos(e*a)]}var d=Math.cos(a),e=a===b?Math.sin(a):(d-Math.cos(b))/(b-a),f=d/e+a;return rg(e)<Ig?ic:(c.invert=function(a,b){var c=f-b;return[Math.atan2(a,c)/e,f-$(e)*Math.sqrt(a*a+c*c)]},c)}function zc(a,b){return[a,Math.log(Math.tan(Kg/4+b/2))]}function Ac(a){var b,c=fc(a),d=c.scale,e=c.translate,f=c.clipExtent;return c.scale=function(){var a=d.apply(c,arguments);return a===c?b?c.clipExtent(null):c:a},c.translate=function(){var a=e.apply(c,arguments);return a===c?b?c.clipExtent(null):c:a},c.clipExtent=function(a){var g=f.apply(c,arguments);if(g===c){if(b=null==a){var h=Kg*d(),i=e();f([[i[0]-h,i[1]-h],[i[0]+h,i[1]+h]])}}else b&&(g=null);return g},c.clipExtent(null)}function Bc(a,b){return[Math.log(Math.tan(Kg/4+b/2)),-a]}function Cc(a){return a[0]}function Dc(a){return a[1]}function Ec(a){for(var b=a.length,c=[0,1],d=2,e=2;e<b;e++){for(;d>1&&_(a[c[d-2]],a[c[d-1]],a[e])<=0;)--d;c[d++]=e}return c.slice(0,d)}function Fc(a,b){return a[0]-b[0]||a[1]-b[1]}function Gc(a,b,c){return(c[0]-b[0])*(a[1]-b[1])<(c[1]-b[1])*(a[0]-b[0])}function Hc(a,b,c,d){var e=a[0],f=c[0],g=b[0]-e,h=d[0]-f,i=a[1],j=c[1],k=b[1]-i,l=d[1]-j,m=(h*(i-j)-l*(e-f))/(l*g-h*k);return[e+m*g,i+m*k]}function Ic(a){var b=a[0],c=a[a.length-1];return!(b[0]-c[0]||b[1]-c[1])}function Jc(){cd(this),this.edge=this.site=this.circle=null}function Kc(a){var b=gi.pop()||new Jc;return b.site=a,b}function Lc(a){Vc(a),di.remove(a),gi.push(a),cd(a)}function Mc(a){var b=a.circle,c=b.x,d=b.cy,e={x:c,y:d},f=a.P,g=a.N,h=[a];Lc(a);for(var i=f;i.circle&&rg(c-i.circle.x)<Ig&&rg(d-i.circle.cy)<Ig;)f=i.P,h.unshift(i),Lc(i),i=f;h.unshift(i),Vc(i);for(var j=g;j.circle&&rg(c-j.circle.x)<Ig&&rg(d-j.circle.cy)<Ig;)g=j.N,h.push(j),Lc(j),j=g;h.push(j),Vc(j);var k,l=h.length;for(k=1;k<l;++k)j=h[k],i=h[k-1],_c(j.edge,i.site,j.site,e);i=h[0],j=h[l-1],j.edge=Zc(i.site,j.site,null,e),Uc(i),Uc(j)}function Nc(a){for(var b,c,d,e,f=a.x,g=a.y,h=di._;h;)if((d=Oc(h,g)-f)>Ig)h=h.L;else{if(!((e=f-Pc(h,g))>Ig)){d>-Ig?(b=h.P,c=h):e>-Ig?(b=h,c=h.N):b=c=h;break}if(!h.R){b=h;break}h=h.R}var i=Kc(a);if(di.insert(b,i),b||c){if(b===c)return Vc(b),c=Kc(b.site),di.insert(i,c),i.edge=c.edge=Zc(b.site,i.site),Uc(b),void Uc(c);if(!c)return void(i.edge=Zc(b.site,i.site));Vc(b),Vc(c);var j=b.site,k=j.x,l=j.y,m=a.x-k,n=a.y-l,o=c.site,p=o.x-k,q=o.y-l,r=2*(m*q-n*p),s=m*m+n*n,t=p*p+q*q,u={x:(q*s-n*t)/r+k,y:(m*t-p*s)/r+l};_c(c.edge,j,o,u),i.edge=Zc(j,a,null,u),c.edge=Zc(a,o,null,u),Uc(b),Uc(c)}}function Oc(a,b){var c=a.site,d=c.x,e=c.y,f=e-b;if(!f)return d;var g=a.P;if(!g)return-(1/0);c=g.site;var h=c.x,i=c.y,j=i-b;if(!j)return h;var k=h-d,l=1/f-1/j,m=k/j;return l?(-m+Math.sqrt(m*m-2*l*(k*k/(-2*j)-i+j/2+e-f/2)))/l+d:(d+h)/2}function Pc(a,b){var c=a.N;if(c)return Oc(c,b);var d=a.site;return d.y===b?d.x:1/0}function Qc(a){this.site=a,this.edges=[]}function Rc(a){for(var b,c,d,e,f,g,h,i,j,k,l=a[0][0],m=a[1][0],n=a[0][1],o=a[1][1],p=ci,q=p.length;q--;)if((f=p[q])&&f.prepare())for(h=f.edges,i=h.length,g=0;g<i;)k=h[g].end(),d=k.x,e=k.y,j=h[++g%i].start(),b=j.x,c=j.y,(rg(d-b)>Ig||rg(e-c)>Ig)&&(h.splice(g,0,new ad($c(f.site,k,rg(d-l)<Ig&&o-e>Ig?{x:l,y:rg(b-l)<Ig?c:o}:rg(e-o)<Ig&&m-d>Ig?{x:rg(c-o)<Ig?b:m,y:o}:rg(d-m)<Ig&&e-n>Ig?{x:m,y:rg(b-m)<Ig?c:n}:rg(e-n)<Ig&&d-l>Ig?{x:rg(c-n)<Ig?b:l,y:n}:null),f.site,null)),++i)}function Sc(a,b){return b.angle-a.angle}function Tc(){cd(this),this.x=this.y=this.arc=this.site=this.cy=null}function Uc(a){var b=a.P,c=a.N;if(b&&c){var d=b.site,e=a.site,f=c.site;if(d!==f){var g=e.x,h=e.y,i=d.x-g,j=d.y-h,k=f.x-g,l=f.y-h,m=2*(i*l-j*k);if(!(m>=-Jg)){var n=i*i+j*j,o=k*k+l*l,p=(l*n-j*o)/m,q=(i*o-k*n)/m,l=q+h,r=hi.pop()||new Tc;r.arc=a,r.site=e,r.x=p+g,r.y=l+Math.sqrt(p*p+q*q),r.cy=l,a.circle=r;for(var s=null,t=fi._;t;)if(r.y<t.y||r.y===t.y&&r.x<=t.x){if(!t.L){s=t.P;break}t=t.L}else{if(!t.R){s=t;break}t=t.R}fi.insert(s,r),s||(ei=r)}}}}function Vc(a){var b=a.circle;b&&(b.P||(ei=b.N),fi.remove(b),hi.push(b),cd(b),a.circle=null)}function Wc(a){for(var b,c=bi,d=Qb(a[0][0],a[0][1],a[1][0],a[1][1]),e=c.length;e--;)b=c[e],(!Xc(b,a)||!d(b)||rg(b.a.x-b.b.x)<Ig&&rg(b.a.y-b.b.y)<Ig)&&(b.a=b.b=null,c.splice(e,1))}function Xc(a,b){var c=a.b;if(c)return!0;var d,e,f=a.a,g=b[0][0],h=b[1][0],i=b[0][1],j=b[1][1],k=a.l,l=a.r,m=k.x,n=k.y,o=l.x,p=l.y,q=(m+o)/2,r=(n+p)/2;if(p===n){if(q<g||q>=h)return;if(m>o){if(f){if(f.y>=j)return}else f={x:q,y:i};c={x:q,y:j}}else{if(f){if(f.y<i)return}else f={x:q,y:j};c={x:q,y:i}}}else if(d=(m-o)/(p-n),e=r-d*q,d<-1||d>1)if(m>o){if(f){if(f.y>=j)return}else f={x:(i-e)/d,y:i};c={x:(j-e)/d,y:j}}else{if(f){if(f.y<i)return}else f={x:(j-e)/d,y:j};c={x:(i-e)/d,y:i}}else if(n<p){if(f){if(f.x>=h)return}else f={x:g,y:d*g+e};c={x:h,y:d*h+e}}else{if(f){if(f.x<g)return}else f={x:h,y:d*h+e};c={x:g,y:d*g+e}}return a.a=f,a.b=c,!0}function Yc(a,b){this.l=a,this.r=b,this.a=this.b=null}function Zc(a,b,c,d){var e=new Yc(a,b);return bi.push(e),c&&_c(e,a,b,c),d&&_c(e,b,a,d),ci[a.i].edges.push(new ad(e,a,b)),ci[b.i].edges.push(new ad(e,b,a)),e}function $c(a,b,c){var d=new Yc(a,null);return d.a=b,d.b=c,bi.push(d),d}function _c(a,b,c,d){a.a||a.b?a.l===c?a.b=d:a.a=d:(a.a=d,a.l=b,a.r=c)}function ad(a,b,c){var d=a.a,e=a.b;this.edge=a,this.site=b,this.angle=c?Math.atan2(c.y-b.y,c.x-b.x):a.l===b?Math.atan2(e.x-d.x,d.y-e.y):Math.atan2(d.x-e.x,e.y-d.y)}function bd(){this._=null}function cd(a){a.U=a.C=a.L=a.R=a.P=a.N=null}function dd(a,b){var c=b,d=b.R,e=c.U;e?e.L===c?e.L=d:e.R=d:a._=d,d.U=e,c.U=d,c.R=d.L,c.R&&(c.R.U=c),d.L=c}function ed(a,b){var c=b,d=b.L,e=c.U;e?e.L===c?e.L=d:e.R=d:a._=d,d.U=e,c.U=d,c.L=d.R,c.L&&(c.L.U=c),d.R=c}function fd(a){for(;a.L;)a=a.L;return a}function gd(a,b){var c,d,e,f=a.sort(hd).pop();for(bi=[],ci=new Array(a.length),di=new bd,fi=new bd;;)if(e=ei,f&&(!e||f.y<e.y||f.y===e.y&&f.x<e.x))f.x===c&&f.y===d||(ci[f.i]=new Qc(f),Nc(f),c=f.x,d=f.y),f=a.pop();else{if(!e)break;Mc(e.arc)}b&&(Wc(b),Rc(b));var g={cells:ci,edges:bi};return di=fi=bi=ci=null,g}function hd(a,b){return b.y-a.y||b.x-a.x}function id(a,b,c){return(a.x-c.x)*(b.y-a.y)-(a.x-b.x)*(c.y-a.y)}function jd(a){return a.x}function kd(a){return a.y}function ld(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function md(a,b,c,d,e,f){if(!a(b,c,d,e,f)){var g=.5*(c+e),h=.5*(d+f),i=b.nodes;i[0]&&md(a,i[0],c,d,g,h),i[1]&&md(a,i[1],g,d,e,h),i[2]&&md(a,i[2],c,h,g,f),i[3]&&md(a,i[3],g,h,e,f)}}function nd(a,b,c,d,e,f,g){var h,i=1/0;return function a(j,k,l,m,n){if(!(k>f||l>g||m<d||n<e)){if(o=j.point){var o,p=b-j.x,q=c-j.y,r=p*p+q*q;if(r<i){var s=Math.sqrt(i=r);d=b-s,e=c-s,f=b+s,g=c+s,h=o}}for(var t=j.nodes,u=.5*(k+m),v=.5*(l+n),w=b>=u,x=c>=v,y=x<<1|w,z=y+4;y<z;++y)if(j=t[3&y])switch(3&y){case 0:a(j,k,l,u,v);break;case 1:a(j,u,l,m,v);break;case 2:a(j,k,v,u,n);break;case 3:a(j,u,v,m,n)}}}(a,d,e,f,g),h}function od(a,b){a=hg.rgb(a),b=hg.rgb(b);var c=a.r,d=a.g,e=a.b,f=b.r-c,g=b.g-d,h=b.b-e;return function(a){return"#"+ua(Math.round(c+f*a))+ua(Math.round(d+g*a))+ua(Math.round(e+h*a))}}function pd(a,b){var c,d={},e={};for(c in a)c in b?d[c]=sd(a[c],b[c]):e[c]=a[c];for(c in b)c in a||(e[c]=b[c]);return function(a){for(c in d)e[c]=d[c](a);return e}}function qd(a,b){return a=+a,b=+b,function(c){return a*(1-c)+b*c}}function rd(a,b){var c,d,e,f=ji.lastIndex=ki.lastIndex=0,g=-1,h=[],i=[];for(a+="",b+="";(c=ji.exec(a))&&(d=ki.exec(b));)(e=d.index)>f&&(e=b.slice(f,e),h[g]?h[g]+=e:h[++g]=e),(c=c[0])===(d=d[0])?h[g]?h[g]+=d:h[++g]=d:(h[++g]=null,i.push({i:g,x:qd(c,d)})),f=ki.lastIndex;return f<b.length&&(e=b.slice(f),h[g]?h[g]+=e:h[++g]=e),h.length<2?i[0]?(b=i[0].x,function(a){return b(a)+""}):function(){return b}:(b=i.length,function(a){for(var c,d=0;d<b;++d)h[(c=i[d]).i]=c.x(a);return h.join("")})}function sd(a,b){for(var c,d=hg.interpolators.length;--d>=0&&!(c=hg.interpolators[d](a,b)););return c}function td(a,b){var c,d=[],e=[],f=a.length,g=b.length,h=Math.min(a.length,b.length);for(c=0;c<h;++c)d.push(sd(a[c],b[c]));for(;c<f;++c)e[c]=a[c];for(;c<g;++c)e[c]=b[c];return function(a){for(c=0;c<h;++c)e[c]=d[c](a);return e}}function ud(a){return function(b){return b<=0?0:b>=1?1:a(b)}}function vd(a){return function(b){return 1-a(1-b)}}function wd(a){return function(b){return.5*(b<.5?a(2*b):2-a(2-2*b))}}function xd(a){return a*a}function yd(a){return a*a*a}function zd(a){if(a<=0)return 0;if(a>=1)return 1;var b=a*a,c=b*a;return 4*(a<.5?c:3*(a-b)+c-.75)}function Ad(a){return function(b){return Math.pow(b,a)}}function Bd(a){return 1-Math.cos(a*Ng)}function Cd(a){return Math.pow(2,10*(a-1))}function Dd(a){return 1-Math.sqrt(1-a*a)}function Ed(a,b){var c;return arguments.length<2&&(b=.45),arguments.length?c=b/Lg*Math.asin(1/a):(a=1,c=b/4),function(d){return 1+a*Math.pow(2,-10*d)*Math.sin((d-c)*Lg/b)}}function Fd(a){return a||(a=1.70158),function(b){return b*b*((a+1)*b-a)}}function Gd(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}function Hd(a,b){a=hg.hcl(a),b=hg.hcl(b);var c=a.h,d=a.c,e=a.l,f=b.h-c,g=b.c-d,h=b.l-e;return isNaN(g)&&(g=0,d=isNaN(d)?b.c:d),isNaN(f)?(f=0,c=isNaN(c)?b.h:c):f>180?f-=360:f<-180&&(f+=360),function(a){return ka(c+f*a,d+g*a,e+h*a)+""}}function Id(a,b){a=hg.hsl(a),b=hg.hsl(b);var c=a.h,d=a.s,e=a.l,f=b.h-c,g=b.s-d,h=b.l-e;return isNaN(g)&&(g=0,d=isNaN(d)?b.s:d),isNaN(f)?(f=0,c=isNaN(c)?b.h:c):f>180?f-=360:f<-180&&(f+=360),function(a){return ia(c+f*a,d+g*a,e+h*a)+""}}function Jd(a,b){a=hg.lab(a),b=hg.lab(b);var c=a.l,d=a.a,e=a.b,f=b.l-c,g=b.a-d,h=b.b-e;return function(a){return ma(c+f*a,d+g*a,e+h*a)+""}}function Kd(a,b){return b-=a,function(c){return Math.round(a+b*c)}}function Ld(a){var b=[a.a,a.b],c=[a.c,a.d],d=Nd(b),e=Md(b,c),f=Nd(Od(c,b,-e))||0;b[0]*c[1]<c[0]*b[1]&&(b[0]*=-1,b[1]*=-1,d*=-1,e*=-1),this.rotate=(d?Math.atan2(b[1],b[0]):Math.atan2(-c[0],c[1]))*Pg,this.translate=[a.e,a.f],this.scale=[d,f],this.skew=f?Math.atan2(e,f)*Pg:0}function Md(a,b){return a[0]*b[0]+a[1]*b[1]}function Nd(a){var b=Math.sqrt(Md(a,a));return b&&(a[0]/=b,a[1]/=b),b}function Od(a,b,c){return a[0]+=c*b[0],a[1]+=c*b[1],a}function Pd(a){return a.length?a.pop()+",":""}function Qd(a,b,c,d){if(a[0]!==b[0]||a[1]!==b[1]){var e=c.push("translate(",null,",",null,")");d.push({i:e-4,x:qd(a[0],b[0])},{i:e-2,x:qd(a[1],b[1])})}else(b[0]||b[1])&&c.push("translate("+b+")")}function Rd(a,b,c,d){a!==b?(a-b>180?b+=360:b-a>180&&(a+=360),d.push({i:c.push(Pd(c)+"rotate(",null,")")-2,x:qd(a,b)})):b&&c.push(Pd(c)+"rotate("+b+")")}function Sd(a,b,c,d){a!==b?d.push({i:c.push(Pd(c)+"skewX(",null,")")-2,x:qd(a,b)}):b&&c.push(Pd(c)+"skewX("+b+")")}function Td(a,b,c,d){if(a[0]!==b[0]||a[1]!==b[1]){var e=c.push(Pd(c)+"scale(",null,",",null,")");d.push({i:e-4,x:qd(a[0],b[0])},{i:e-2,x:qd(a[1],b[1])})}else 1===b[0]&&1===b[1]||c.push(Pd(c)+"scale("+b+")")}function Ud(a,b){var c=[],d=[];return a=hg.transform(a),b=hg.transform(b),Qd(a.translate,b.translate,c,d),Rd(a.rotate,b.rotate,c,d),Sd(a.skew,b.skew,c,d),Td(a.scale,b.scale,c,d),a=b=null,function(a){for(var b,e=-1,f=d.length;++e<f;)c[(b=d[e]).i]=b.x(a);return c.join("")}}function Vd(a,b){return b=(b-=a=+a)||1/b,function(c){return(c-a)/b}}function Wd(a,b){return b=(b-=a=+a)||1/b,function(c){return Math.max(0,Math.min(1,(c-a)/b))}}function Xd(a){for(var b=a.source,c=a.target,d=Zd(b,c),e=[b];b!==d;)b=b.parent,e.push(b);for(var f=e.length;c!==d;)e.splice(f,0,c),c=c.parent;return e}function Yd(a){for(var b=[],c=a.parent;null!=c;)b.push(a),a=c,c=c.parent;return b.push(a),b}function Zd(a,b){if(a===b)return a;for(var c=Yd(a),d=Yd(b),e=c.pop(),f=d.pop(),g=null;e===f;)g=e,e=c.pop(),f=d.pop();return g}function $d(a){a.fixed|=2}function _d(a){a.fixed&=-7}function ae(a){a.fixed|=4,a.px=a.x,a.py=a.y}function be(a){a.fixed&=-5}function ce(a,b,c){var d=0,e=0;if(a.charge=0,!a.leaf)for(var f,g=a.nodes,h=g.length,i=-1;++i<h;)null!=(f=g[i])&&(ce(f,b,c),a.charge+=f.charge,d+=f.charge*f.cx,e+=f.charge*f.cy);if(a.point){a.leaf||(a.point.x+=Math.random()-.5,a.point.y+=Math.random()-.5);var j=b*c[a.point.index];a.charge+=a.pointCharge=j,d+=j*a.point.x,e+=j*a.point.y}a.cx=d/a.charge,a.cy=e/a.charge}function de(a,b){return hg.rebind(a,b,"sort","children","value"),a.nodes=a,a.links=je,a}function ee(a,b){for(var c=[a];null!=(a=c.pop());)if(b(a),(e=a.children)&&(d=e.length))for(var d,e;--d>=0;)c.push(e[d])}function fe(a,b){for(var c=[a],d=[];null!=(a=c.pop());)if(d.push(a),(f=a.children)&&(e=f.length))for(var e,f,g=-1;++g<e;)c.push(f[g]);for(;null!=(a=d.pop());)b(a)}function ge(a){return a.children}function he(a){return a.value}function ie(a,b){return b.value-a.value}function je(a){return hg.merge(a.map(function(a){return(a.children||[]).map(function(b){return{source:a,target:b}})}))}function ke(a){return a.x}function le(a){return a.y}function me(a,b,c){a.y0=b,a.y=c}function ne(a){return hg.range(a.length)}function oe(a){for(var b=-1,c=a[0].length,d=[];++b<c;)d[b]=0;return d}function pe(a){for(var b,c=1,d=0,e=a[0][1],f=a.length;c<f;++c)(b=a[c][1])>e&&(d=c,e=b);return d}function qe(a){return a.reduce(re,0)}function re(a,b){return a+b[1]}function se(a,b){return te(a,Math.ceil(Math.log(b.length)/Math.LN2+1))}function te(a,b){for(var c=-1,d=+a[0],e=(a[1]-d)/b,f=[];++c<=b;)f[c]=e*c+d;return f}function ue(a){return[hg.min(a),hg.max(a)]}function ve(a,b){return a.value-b.value}function we(a,b){var c=a._pack_next;a._pack_next=b,b._pack_prev=a,b._pack_next=c,c._pack_prev=b}function xe(a,b){a._pack_next=b,b._pack_prev=a}function ye(a,b){var c=b.x-a.x,d=b.y-a.y,e=a.r+b.r;return.999*e*e>c*c+d*d}function ze(a){function b(a){k=Math.min(a.x-a.r,k),l=Math.max(a.x+a.r,l),m=Math.min(a.y-a.r,m),n=Math.max(a.y+a.r,n)}if((c=a.children)&&(j=c.length)){var c,d,e,f,g,h,i,j,k=1/0,l=-(1/0),m=1/0,n=-(1/0);if(c.forEach(Ae),d=c[0],d.x=-d.r,d.y=0,b(d),j>1&&(e=c[1],e.x=e.r,e.y=0,b(e),j>2))for(f=c[2],De(d,e,f),b(f),we(d,f),d._pack_prev=f,we(f,e),e=d._pack_next,g=3;g<j;g++){De(d,e,f=c[g]);var o=0,p=1,q=1;for(h=e._pack_next;h!==e;h=h._pack_next,p++)if(ye(h,f)){o=1;break}if(1==o)for(i=d._pack_prev;i!==h._pack_prev&&!ye(i,f);i=i._pack_prev,q++);o?(p<q||p==q&&e.r<d.r?xe(d,e=h):xe(d=i,e),g--):(we(d,f),e=f,b(f))}var r=(k+l)/2,s=(m+n)/2,t=0;for(g=0;g<j;g++)f=c[g],f.x-=r,f.y-=s,t=Math.max(t,f.r+Math.sqrt(f.x*f.x+f.y*f.y));a.r=t,c.forEach(Be)}}function Ae(a){a._pack_next=a._pack_prev=a}function Be(a){delete a._pack_next,delete a._pack_prev}function Ce(a,b,c,d){var e=a.children;if(a.x=b+=d*a.x,a.y=c+=d*a.y,a.r*=d,e)for(var f=-1,g=e.length;++f<g;)Ce(e[f],b,c,d)}function De(a,b,c){var d=a.r+c.r,e=b.x-a.x,f=b.y-a.y;if(d&&(e||f)){var g=b.r+c.r,h=e*e+f*f;g*=g,d*=d;var i=.5+(d-g)/(2*h),j=Math.sqrt(Math.max(0,2*g*(d+h)-(d-=h)*d-g*g))/(2*h);c.x=a.x+i*e+j*f,c.y=a.y+i*f-j*e}else c.x=a.x+d,c.y=a.y}function Ee(a,b){return a.parent==b.parent?1:2}function Fe(a){var b=a.children;return b.length?b[0]:a.t}function Ge(a){var b,c=a.children;return(b=c.length)?c[b-1]:a.t}function He(a,b,c){var d=c/(b.i-a.i);b.c-=d,b.s+=c,a.c+=d,b.z+=c,b.m+=c}function Ie(a){for(var b,c=0,d=0,e=a.children,f=e.length;--f>=0;)b=e[f],b.z+=c,b.m+=c,c+=b.s+(d+=b.c)}function Je(a,b,c){return a.a.parent===b.parent?a.a:c}function Ke(a){return 1+hg.max(a,function(a){return a.y})}function Le(a){return a.reduce(function(a,b){return a+b.x},0)/a.length}function Me(a){var b=a.children;return b&&b.length?Me(b[0]):a}function Ne(a){var b,c=a.children;return c&&(b=c.length)?Ne(c[b-1]):a}function Oe(a){return{x:a.x,y:a.y,dx:a.dx,dy:a.dy}}function Pe(a,b){var c=a.x+b[3],d=a.y+b[0],e=a.dx-b[1]-b[3],f=a.dy-b[0]-b[2];return e<0&&(c+=e/2,e=0),f<0&&(d+=f/2,f=0),{x:c,y:d,dx:e,dy:f}}function Qe(a){var b=a[0],c=a[a.length-1];return b<c?[b,c]:[c,b]}function Re(a){return a.rangeExtent?a.rangeExtent():Qe(a.range())}function Se(a,b,c,d){var e=c(a[0],a[1]),f=d(b[0],b[1]);return function(a){return f(e(a))}}function Te(a,b){var c,d=0,e=a.length-1,f=a[d],g=a[e];return g<f&&(c=d,d=e,e=c,c=f,f=g,g=c),a[d]=b.floor(f),a[e]=b.ceil(g),a}function Ue(a){return a?{floor:function(b){return Math.floor(b/a)*a},ceil:function(b){return Math.ceil(b/a)*a}}:vi}function Ve(a,b,c,d){var e=[],f=[],g=0,h=Math.min(a.length,b.length)-1;for(a[h]<a[0]&&(a=a.slice().reverse(),b=b.slice().reverse());++g<=h;)e.push(c(a[g-1],a[g])),f.push(d(b[g-1],b[g]));return function(b){var c=hg.bisect(a,b,1,h)-1;return f[c](e[c](b))}}function We(a,b,c,d){function e(){var e=Math.min(a.length,b.length)>2?Ve:Se,i=d?Wd:Vd;return g=e(a,b,i,c),h=e(b,a,i,sd),f}function f(a){return g(a)}var g,h;return f.invert=function(a){return h(a)},f.domain=function(b){return arguments.length?(a=b.map(Number),e()):a},f.range=function(a){return arguments.length?(b=a,e()):b},f.rangeRound=function(a){return f.range(a).interpolate(Kd)},f.clamp=function(a){return arguments.length?(d=a,e()):d},f.interpolate=function(a){return arguments.length?(c=a,e()):c},f.ticks=function(b){return $e(a,b)},f.tickFormat=function(b,c){return _e(a,b,c)},f.nice=function(b){return Ye(a,b),e()},f.copy=function(){return We(a,b,c,d)},e()}function Xe(a,b){return hg.rebind(a,b,"range","rangeRound","interpolate","clamp")}function Ye(a,b){return Te(a,Ue(Ze(a,b)[2])),Te(a,Ue(Ze(a,b)[2])),a}function Ze(a,b){null==b&&(b=10);var c=Qe(a),d=c[1]-c[0],e=Math.pow(10,Math.floor(Math.log(d/b)/Math.LN10)),f=b/d*e;return f<=.15?e*=10:f<=.35?e*=5:f<=.75&&(e*=2),c[0]=Math.ceil(c[0]/e)*e,c[1]=Math.floor(c[1]/e)*e+.5*e,c[2]=e,c}function $e(a,b){return hg.range.apply(hg,Ze(a,b))}function _e(a,b,c){var d=Ze(a,b);if(c){var e=jh.exec(c);if(e.shift(),"s"===e[8]){var f=hg.formatPrefix(Math.max(rg(d[0]),rg(d[1])));return e[7]||(e[7]="."+af(f.scale(d[2]))),e[8]="f",c=hg.format(e.join("")),function(a){return c(f.scale(a))+f.symbol}}e[7]||(e[7]="."+bf(e[8],d)),c=e.join("")}else c=",."+af(d[2])+"f";return hg.format(c)}function af(a){return-Math.floor(Math.log(a)/Math.LN10+.01)}function bf(a,b){var c=af(b[2]);return a in wi?Math.abs(c-af(Math.max(rg(b[0]),rg(b[1]))))+ +("e"!==a):c-2*("%"===a)}function cf(a,b,c,d){function e(a){return(c?Math.log(a<0?0:a):-Math.log(a>0?0:-a))/Math.log(b)}function f(a){return c?Math.pow(b,a):-Math.pow(b,-a)}function g(b){return a(e(b))}return g.invert=function(b){return f(a.invert(b))},g.domain=function(b){return arguments.length?(c=b[0]>=0,a.domain((d=b.map(Number)).map(e)),g):d},g.base=function(c){return arguments.length?(b=+c,a.domain(d.map(e)),g):b},g.nice=function(){var b=Te(d.map(e),c?Math:yi);return a.domain(b),d=b.map(f),g},g.ticks=function(){var a=Qe(d),g=[],h=a[0],i=a[1],j=Math.floor(e(h)),k=Math.ceil(e(i)),l=b%1?2:b;if(isFinite(k-j)){if(c){for(;j<k;j++)for(var m=1;m<l;m++)g.push(f(j)*m);g.push(f(j))}else for(g.push(f(j));j++<k;)for(var m=l-1;m>0;m--)g.push(f(j)*m);for(j=0;g[j]<h;j++);for(k=g.length;g[k-1]>i;k--);g=g.slice(j,k)}return g},g.tickFormat=function(a,c){if(!arguments.length)return xi;arguments.length<2?c=xi:"function"!=typeof c&&(c=hg.format(c));var d=Math.max(1,b*a/g.ticks().length);return function(a){var g=a/f(Math.round(e(a)));return g*b<b-.5&&(g*=b),g<=d?c(a):""}},g.copy=function(){return cf(a.copy(),b,c,d)},Xe(g,a)}function df(a,b,c){function d(b){return a(e(b))}var e=ef(b),f=ef(1/b);return d.invert=function(b){return f(a.invert(b))},d.domain=function(b){return arguments.length?(a.domain((c=b.map(Number)).map(e)),d):c},d.ticks=function(a){return $e(c,a)},d.tickFormat=function(a,b){return _e(c,a,b)},d.nice=function(a){return d.domain(Ye(c,a))},d.exponent=function(g){return arguments.length?(e=ef(b=g),f=ef(1/b),a.domain(c.map(e)),d):b},d.copy=function(){return df(a.copy(),b,c)},Xe(d,a)}function ef(a){return function(b){return b<0?-Math.pow(-b,a):Math.pow(b,a)}}function ff(a,b){function c(c){return f[((e.get(c)||("range"===b.t?e.set(c,a.push(c)):NaN))-1)%f.length]}function d(b,c){return hg.range(a.length).map(function(a){return b+c*a})}var e,f,g;return c.domain=function(d){if(!arguments.length)return a;a=[],e=new j;for(var f,g=-1,h=d.length;++g<h;)e.has(f=d[g])||e.set(f,a.push(f));return c[b.t].apply(c,b.a)},c.range=function(a){return arguments.length?(f=a,g=0,b={t:"range",a:arguments},c):f},c.rangePoints=function(e,h){arguments.length<2&&(h=0);var i=e[0],j=e[1],k=a.length<2?(i=(i+j)/2,0):(j-i)/(a.length-1+h);return f=d(i+k*h/2,k),g=0,b={t:"rangePoints",a:arguments},c},c.rangeRoundPoints=function(e,h){arguments.length<2&&(h=0);var i=e[0],j=e[1],k=a.length<2?(i=j=Math.round((i+j)/2),0):(j-i)/(a.length-1+h)|0;return f=d(i+Math.round(k*h/2+(j-i-(a.length-1+h)*k)/2),k),g=0,b={t:"rangeRoundPoints",a:arguments},c},c.rangeBands=function(e,h,i){arguments.length<2&&(h=0),arguments.length<3&&(i=h);var j=e[1]<e[0],k=e[j-0],l=e[1-j],m=(l-k)/(a.length-h+2*i);return f=d(k+m*i,m),j&&f.reverse(),g=m*(1-h),b={t:"rangeBands",a:arguments},c},c.rangeRoundBands=function(e,h,i){arguments.length<2&&(h=0),arguments.length<3&&(i=h);var j=e[1]<e[0],k=e[j-0],l=e[1-j],m=Math.floor((l-k)/(a.length-h+2*i));return f=d(k+Math.round((l-k-(a.length-h)*m)/2),m),j&&f.reverse(),g=Math.round(m*(1-h)),b={t:"rangeRoundBands",a:arguments},c},c.rangeBand=function(){return g},c.rangeExtent=function(){return Qe(b.a[0])},c.copy=function(){return ff(a,b)},c.domain(a)}function gf(a,b){function f(){var c=0,d=b.length;for(h=[];++c<d;)h[c-1]=hg.quantile(a,c/d);return g}function g(a){if(!isNaN(a=+a))return b[hg.bisect(h,a)]}var h;return g.domain=function(b){return arguments.length?(a=b.map(d).filter(e).sort(c),f()):a},g.range=function(a){return arguments.length?(b=a,f()):b},g.quantiles=function(){return h},g.invertExtent=function(c){return c=b.indexOf(c),c<0?[NaN,NaN]:[c>0?h[c-1]:a[0],c<h.length?h[c]:a[a.length-1]]},g.copy=function(){return gf(a,b)},f()}function hf(a,b,c){function d(b){return c[Math.max(0,Math.min(g,Math.floor(f*(b-a))))]}function e(){return f=c.length/(b-a),g=c.length-1,d}var f,g;return d.domain=function(c){return arguments.length?(a=+c[0],b=+c[c.length-1],e()):[a,b]},d.range=function(a){return arguments.length?(c=a,e()):c},d.invertExtent=function(b){return b=c.indexOf(b),b=b<0?NaN:b/f+a,[b,b+1/f]},d.copy=function(){return hf(a,b,c)},e()}function jf(a,b){function c(c){if(c<=c)return b[hg.bisect(a,c)]}return c.domain=function(b){return arguments.length?(a=b,c):a},c.range=function(a){return arguments.length?(b=a,c):b},c.invertExtent=function(c){return c=b.indexOf(c),[a[c-1],a[c]]},c.copy=function(){return jf(a,b)},c}function kf(a){function b(a){return+a}return b.invert=b,b.domain=b.range=function(c){return arguments.length?(a=c.map(b),b):a},b.ticks=function(b){return $e(a,b)},b.tickFormat=function(b,c){return _e(a,b,c)},b.copy=function(){return kf(a)},b}function lf(){return 0}function mf(a){return a.innerRadius}function nf(a){return a.outerRadius}function of(a){return a.startAngle}function pf(a){return a.endAngle}function qf(a){return a&&a.padAngle}function rf(a,b,c,d){return(a-c)*b-(b-d)*a>0?0:1}function sf(a,b,c,d,e){var f=a[0]-b[0],g=a[1]-b[1],h=(e?d:-d)/Math.sqrt(f*f+g*g),i=h*g,j=-h*f,k=a[0]+i,l=a[1]+j,m=b[0]+i,n=b[1]+j,o=(k+m)/2,p=(l+n)/2,q=m-k,r=n-l,s=q*q+r*r,t=c-d,u=k*n-m*l,v=(r<0?-1:1)*Math.sqrt(Math.max(0,t*t*s-u*u)),w=(u*r-q*v)/s,x=(-u*q-r*v)/s,y=(u*r+q*v)/s,z=(-u*q+r*v)/s,A=w-o,B=x-p,C=y-o,D=z-p;return A*A+B*B>C*C+D*D&&(w=y,x=z),[[w-i,x-j],[w*c/t,x*c/t]]}function tf(a){function b(b){function g(){j.push("M",f(a(k),h))}for(var i,j=[],k=[],l=-1,m=b.length,n=Aa(c),o=Aa(d);++l<m;)e.call(this,i=b[l],l)?k.push([+n.call(this,i,l),+o.call(this,i,l)]):k.length&&(g(),k=[]);return k.length&&g(),j.length?j.join(""):null}var c=Cc,d=Dc,e=Db,f=uf,g=f.key,h=.7;return b.x=function(a){return arguments.length?(c=a,b):c},b.y=function(a){return arguments.length?(d=a,b):d},b.defined=function(a){return arguments.length?(e=a,b):e},b.interpolate=function(a){return arguments.length?(g="function"==typeof a?f=a:(f=Ei.get(a)||uf).key,b):g},b.tension=function(a){return arguments.length?(h=a,b):h},b}function uf(a){return a.length>1?a.join("L"):a+"Z"}function vf(a){return a.join("L")+"Z"}function wf(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("H",(d[0]+(d=a[b])[0])/2,"V",d[1]);return c>1&&e.push("H",d[0]),e.join("")}function xf(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("V",(d=a[b])[1],"H",d[0]);return e.join("")}function yf(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("H",(d=a[b])[0],"V",d[1]);return e.join("")}function zf(a,b){return a.length<4?uf(a):a[1]+Cf(a.slice(1,-1),Df(a,b))}function Af(a,b){return a.length<3?vf(a):a[0]+Cf((a.push(a[0]),a),Df([a[a.length-2]].concat(a,[a[1]]),b))}function Bf(a,b){return a.length<3?uf(a):a[0]+Cf(a,Df(a,b))}function Cf(a,b){if(b.length<1||a.length!=b.length&&a.length!=b.length+2)return uf(a);var c=a.length!=b.length,d="",e=a[0],f=a[1],g=b[0],h=g,i=1;if(c&&(d+="Q"+(f[0]-2*g[0]/3)+","+(f[1]-2*g[1]/3)+","+f[0]+","+f[1],e=a[1],i=2),b.length>1){h=b[1],f=a[i],i++,d+="C"+(e[0]+g[0])+","+(e[1]+g[1])+","+(f[0]-h[0])+","+(f[1]-h[1])+","+f[0]+","+f[1];for(var j=2;j<b.length;j++,i++)f=a[i],h=b[j],d+="S"+(f[0]-h[0])+","+(f[1]-h[1])+","+f[0]+","+f[1]}if(c){var k=a[i];d+="Q"+(f[0]+2*h[0]/3)+","+(f[1]+2*h[1]/3)+","+k[0]+","+k[1]}return d}function Df(a,b){for(var c,d=[],e=(1-b)/2,f=a[0],g=a[1],h=1,i=a.length;++h<i;)c=f,f=g,g=a[h],d.push([e*(g[0]-c[0]),e*(g[1]-c[1])]);return d}function Ef(a){if(a.length<3)return uf(a);var b=1,c=a.length,d=a[0],e=d[0],f=d[1],g=[e,e,e,(d=a[1])[0]],h=[f,f,f,d[1]],i=[e,",",f,"L",If(Hi,g),",",If(Hi,h)];for(a.push(a[c-1]);++b<=c;)d=a[b],g.shift(),g.push(d[0]),h.shift(),h.push(d[1]),Jf(i,g,h);return a.pop(),i.push("L",d),i.join("")}function Ff(a){if(a.length<4)return uf(a);for(var b,c=[],d=-1,e=a.length,f=[0],g=[0];++d<3;)b=a[d],f.push(b[0]),g.push(b[1]);for(c.push(If(Hi,f)+","+If(Hi,g)),--d;++d<e;)b=a[d],f.shift(),f.push(b[0]),g.shift(),g.push(b[1]),Jf(c,f,g);return c.join("")}function Gf(a){for(var b,c,d=-1,e=a.length,f=e+4,g=[],h=[];++d<4;)c=a[d%e],g.push(c[0]),h.push(c[1]);for(b=[If(Hi,g),",",If(Hi,h)],--d;++d<f;)c=a[d%e],g.shift(),g.push(c[0]),h.shift(),h.push(c[1]),Jf(b,g,h);return b.join("")}function Hf(a,b){var c=a.length-1;if(c)for(var d,e,f=a[0][0],g=a[0][1],h=a[c][0]-f,i=a[c][1]-g,j=-1;++j<=c;)d=a[j],e=j/c,d[0]=b*d[0]+(1-b)*(f+e*h),d[1]=b*d[1]+(1-b)*(g+e*i);return Ef(a)}function If(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}function Jf(a,b,c){a.push("C",If(Fi,b),",",If(Fi,c),",",If(Gi,b),",",If(Gi,c),",",If(Hi,b),",",If(Hi,c))}function Kf(a,b){return(b[1]-a[1])/(b[0]-a[0])}function Lf(a){for(var b=0,c=a.length-1,d=[],e=a[0],f=a[1],g=d[0]=Kf(e,f);++b<c;)d[b]=(g+(g=Kf(e=f,f=a[b+1])))/2;return d[b]=g,d}function Mf(a){for(var b,c,d,e,f=[],g=Lf(a),h=-1,i=a.length-1;++h<i;)b=Kf(a[h],a[h+1]),rg(b)<Ig?g[h]=g[h+1]=0:(c=g[h]/b,d=g[h+1]/b,(e=c*c+d*d)>9&&(e=3*b/Math.sqrt(e),g[h]=e*c,g[h+1]=e*d));for(h=-1;++h<=i;)e=(a[Math.min(i,h+1)][0]-a[Math.max(0,h-1)][0])/(6*(1+g[h]*g[h])),f.push([e||0,g[h]*e||0]);return f}function Nf(a){return a.length<3?uf(a):a[0]+Cf(a,Mf(a))}function Of(a){for(var b,c,d,e=-1,f=a.length;++e<f;)b=a[e],c=b[0],d=b[1]-Ng,b[0]=c*Math.cos(d),b[1]=c*Math.sin(d);return a}function Pf(a){function b(b){function i(){p.push("M",h(a(r),l),k,j(a(q.reverse()),l),"Z")}
for(var m,n,o,p=[],q=[],r=[],s=-1,t=b.length,u=Aa(c),v=Aa(e),w=c===d?function(){return n}:Aa(d),x=e===f?function(){return o}:Aa(f);++s<t;)g.call(this,m=b[s],s)?(q.push([n=+u.call(this,m,s),o=+v.call(this,m,s)]),r.push([+w.call(this,m,s),+x.call(this,m,s)])):q.length&&(i(),q=[],r=[]);return q.length&&i(),p.length?p.join(""):null}var c=Cc,d=Cc,e=0,f=Dc,g=Db,h=uf,i=h.key,j=h,k="L",l=.7;return b.x=function(a){return arguments.length?(c=d=a,b):d},b.x0=function(a){return arguments.length?(c=a,b):c},b.x1=function(a){return arguments.length?(d=a,b):d},b.y=function(a){return arguments.length?(e=f=a,b):f},b.y0=function(a){return arguments.length?(e=a,b):e},b.y1=function(a){return arguments.length?(f=a,b):f},b.defined=function(a){return arguments.length?(g=a,b):g},b.interpolate=function(a){return arguments.length?(i="function"==typeof a?h=a:(h=Ei.get(a)||uf).key,j=h.reverse||h,k=h.closed?"M":"L",b):i},b.tension=function(a){return arguments.length?(l=a,b):l},b}function Qf(a){return a.radius}function Rf(a){return[a.x,a.y]}function Sf(a){return function(){var b=a.apply(this,arguments),c=b[0],d=b[1]-Ng;return[c*Math.cos(d),c*Math.sin(d)]}}function Tf(){return 64}function Uf(){return"circle"}function Vf(a){var b=Math.sqrt(a/Kg);return"M0,"+b+"A"+b+","+b+" 0 1,1 0,"+-b+"A"+b+","+b+" 0 1,1 0,"+b+"Z"}function Wf(a){return function(){var b,c,d;(b=this[a])&&(d=b[c=b.active])&&(d.timer.c=null,d.timer.t=NaN,--b.count?delete b[c]:delete this[a],b.active+=.5,d.event&&d.event.interrupt.call(this,this.__data__,d.index))}}function Xf(a,b,c){return wg(a,Oi),a.namespace=b,a.id=c,a}function Yf(a,b,c,d){var e=a.id,f=a.namespace;return R(a,"function"==typeof c?function(a,g,h){a[f][e].tween.set(b,d(c.call(a,a.__data__,g,h)))}:(c=d(c),function(a){a[f][e].tween.set(b,c)}))}function Zf(a){return null==a&&(a=""),function(){this.textContent=a}}function $f(a){return null==a?"__transition__":"__transition_"+a+"__"}function _f(a,b,c,d,e){function f(a){var b=p.delay;if(k.t=b+i,b<=a)return g(a-b);k.c=g}function g(c){var e=o.active,f=o[e];f&&(f.timer.c=null,f.timer.t=NaN,--o.count,delete o[e],f.event&&f.event.interrupt.call(a,a.__data__,f.index));for(var g in o)if(+g<d){var j=o[g];j.timer.c=null,j.timer.t=NaN,--o.count,delete o[g]}k.c=h,Fa(function(){return k.c&&h(c||1)&&(k.c=null,k.t=NaN),1},0,i),o.active=d,p.event&&p.event.start.call(a,a.__data__,b),n=[],p.tween.forEach(function(c,d){(d=d.call(a,a.__data__,b))&&n.push(d)}),m=p.ease,l=p.duration}function h(e){for(var f=e/l,g=m(f),h=n.length;h>0;)n[--h].call(a,g);if(f>=1)return p.event&&p.event.end.call(a,a.__data__,b),--o.count?delete o[d]:delete a[c],1}var i,k,l,m,n,o=a[c]||(a[c]={active:0,count:0}),p=o[d];p||(i=e.time,k=Fa(f,0,i),p=o[d]={tween:new j,time:i,timer:k,delay:e.delay,duration:e.duration,ease:e.ease,index:b},e=null,++o.count)}function ag(a,b,c){a.attr("transform",function(a){var d=b(a);return"translate("+(isFinite(d)?d:c(a))+",0)"})}function bg(a,b,c){a.attr("transform",function(a){var d=b(a);return"translate(0,"+(isFinite(d)?d:c(a))+")"})}function cg(a){return a.toISOString()}function dg(a,b,c){function d(b){return a(b)}function e(a,c){var d=a[1]-a[0],e=d/c,f=hg.bisect(Xi,e);return f==Xi.length?[b.year,Ze(a.map(function(a){return a/31536e6}),c)[2]]:f?b[e/Xi[f-1]<Xi[f]/e?f-1:f]:[$i,Ze(a,c)[2]]}return d.invert=function(b){return eg(a.invert(b))},d.domain=function(b){return arguments.length?(a.domain(b),d):a.domain().map(eg)},d.nice=function(a,b){function c(c){return!isNaN(c)&&!a.range(c,eg(+c+1),b).length}var f=d.domain(),g=Qe(f),h=null==a?e(g,10):"number"==typeof a&&e(g,a);return h&&(a=h[0],b=h[1]),d.domain(Te(f,b>1?{floor:function(b){for(;c(b=a.floor(b));)b=eg(b-1);return b},ceil:function(b){for(;c(b=a.ceil(b));)b=eg(+b+1);return b}}:a))},d.ticks=function(a,b){var c=Qe(d.domain()),f=null==a?e(c,10):"number"==typeof a?e(c,a):!a.range&&[{range:a},b];return f&&(a=f[0],b=f[1]),a.range(c[0],eg(+c[1]+1),b<1?1:b)},d.tickFormat=function(){return c},d.copy=function(){return dg(a.copy(),b,c)},Xe(d,a)}function eg(a){return new Date(a)}function fg(a){return JSON.parse(a.responseText)}function gg(a){var b=kg.createRange();return b.selectNode(kg.body),b.createContextualFragment(a.responseText)}var hg={version:"3.5.16"},ig=[].slice,jg=function(a){return ig.call(a)},kg=this.document;if(kg)try{jg(kg.documentElement.childNodes)[0].nodeType}catch(bj){jg=function(a){for(var b=a.length,c=new Array(b);b--;)c[b]=a[b];return c}}if(Date.now||(Date.now=function(){return+new Date}),kg)try{kg.createElement("DIV").style.setProperty("opacity",0,"")}catch(cj){var lg=this.Element.prototype,mg=lg.setAttribute,ng=lg.setAttributeNS,og=this.CSSStyleDeclaration.prototype,pg=og.setProperty;lg.setAttribute=function(a,b){mg.call(this,a,b+"")},lg.setAttributeNS=function(a,b,c){ng.call(this,a,b,c+"")},og.setProperty=function(a,b,c){pg.call(this,a,b+"",c)}}hg.ascending=c,hg.descending=function(a,b){return b<a?-1:b>a?1:b>=a?0:NaN},hg.min=function(a,b){var c,d,e=-1,f=a.length;if(1===arguments.length){for(;++e<f;)if(null!=(d=a[e])&&d>=d){c=d;break}for(;++e<f;)null!=(d=a[e])&&c>d&&(c=d)}else{for(;++e<f;)if(null!=(d=b.call(a,a[e],e))&&d>=d){c=d;break}for(;++e<f;)null!=(d=b.call(a,a[e],e))&&c>d&&(c=d)}return c},hg.max=function(a,b){var c,d,e=-1,f=a.length;if(1===arguments.length){for(;++e<f;)if(null!=(d=a[e])&&d>=d){c=d;break}for(;++e<f;)null!=(d=a[e])&&d>c&&(c=d)}else{for(;++e<f;)if(null!=(d=b.call(a,a[e],e))&&d>=d){c=d;break}for(;++e<f;)null!=(d=b.call(a,a[e],e))&&d>c&&(c=d)}return c},hg.extent=function(a,b){var c,d,e,f=-1,g=a.length;if(1===arguments.length){for(;++f<g;)if(null!=(d=a[f])&&d>=d){c=e=d;break}for(;++f<g;)null!=(d=a[f])&&(c>d&&(c=d),e<d&&(e=d))}else{for(;++f<g;)if(null!=(d=b.call(a,a[f],f))&&d>=d){c=e=d;break}for(;++f<g;)null!=(d=b.call(a,a[f],f))&&(c>d&&(c=d),e<d&&(e=d))}return[c,e]},hg.sum=function(a,b){var c,d=0,f=a.length,g=-1;if(1===arguments.length)for(;++g<f;)e(c=+a[g])&&(d+=c);else for(;++g<f;)e(c=+b.call(a,a[g],g))&&(d+=c);return d},hg.mean=function(a,b){var c,f=0,g=a.length,h=-1,i=g;if(1===arguments.length)for(;++h<g;)e(c=d(a[h]))?f+=c:--i;else for(;++h<g;)e(c=d(b.call(a,a[h],h)))?f+=c:--i;if(i)return f/i},hg.quantile=function(a,b){var c=(a.length-1)*b+1,d=Math.floor(c),e=+a[d-1],f=c-d;return f?e+f*(a[d]-e):e},hg.median=function(a,b){var f,g=[],h=a.length,i=-1;if(1===arguments.length)for(;++i<h;)e(f=d(a[i]))&&g.push(f);else for(;++i<h;)e(f=d(b.call(a,a[i],i)))&&g.push(f);if(g.length)return hg.quantile(g.sort(c),.5)},hg.variance=function(a,b){var c,f,g=a.length,h=0,i=0,j=-1,k=0;if(1===arguments.length)for(;++j<g;)e(c=d(a[j]))&&(f=c-h,h+=f/++k,i+=f*(c-h));else for(;++j<g;)e(c=d(b.call(a,a[j],j)))&&(f=c-h,h+=f/++k,i+=f*(c-h));if(k>1)return i/(k-1)},hg.deviation=function(){var a=hg.variance.apply(this,arguments);return a?Math.sqrt(a):a};var qg=f(c);hg.bisectLeft=qg.left,hg.bisect=hg.bisectRight=qg.right,hg.bisector=function(a){return f(1===a.length?function(b,d){return c(a(b),d)}:a)},hg.shuffle=function(a,b,c){(f=arguments.length)<3&&(c=a.length,f<2&&(b=0));for(var d,e,f=c-b;f;)e=Math.random()*f--|0,d=a[f+b],a[f+b]=a[e+b],a[e+b]=d;return a},hg.permute=function(a,b){for(var c=b.length,d=new Array(c);c--;)d[c]=a[b[c]];return d},hg.pairs=function(a){for(var b=0,c=a.length-1,d=a[0],e=new Array(c<0?0:c);b<c;)e[b]=[d,d=a[++b]];return e},hg.transpose=function(a){if(!(e=a.length))return[];for(var b=-1,c=hg.min(a,g),d=new Array(c);++b<c;)for(var e,f=-1,h=d[b]=new Array(e);++f<e;)h[f]=a[f][b];return d},hg.zip=function(){return hg.transpose(arguments)},hg.keys=function(a){var b=[];for(var c in a)b.push(c);return b},hg.values=function(a){var b=[];for(var c in a)b.push(a[c]);return b},hg.entries=function(a){var b=[];for(var c in a)b.push({key:c,value:a[c]});return b},hg.merge=function(a){for(var b,c,d,e=a.length,f=-1,g=0;++f<e;)g+=a[f].length;for(c=new Array(g);--e>=0;)for(d=a[e],b=d.length;--b>=0;)c[--g]=d[b];return c};var rg=Math.abs;hg.range=function(a,b,c){if(arguments.length<3&&(c=1,arguments.length<2&&(b=a,a=0)),(b-a)/c==1/0)throw new Error("infinite range");var d,e=[],f=h(rg(c)),g=-1;if(a*=f,b*=f,c*=f,c<0)for(;(d=a+c*++g)>b;)e.push(d/f);else for(;(d=a+c*++g)<b;)e.push(d/f);return e},hg.map=function(a,b){var c=new j;if(a instanceof j)a.forEach(function(a,b){c.set(a,b)});else if(Array.isArray(a)){var d,e=-1,f=a.length;if(1===arguments.length)for(;++e<f;)c.set(e,a[e]);else for(;++e<f;)c.set(b.call(a,d=a[e],e),d)}else for(var g in a)c.set(g,a[g]);return c};var sg="__proto__",tg="\0";i(j,{has:m,get:function(a){return this._[k(a)]},set:function(a,b){return this._[k(a)]=b},remove:n,keys:o,values:function(){var a=[];for(var b in this._)a.push(this._[b]);return a},entries:function(){var a=[];for(var b in this._)a.push({key:l(b),value:this._[b]});return a},size:p,empty:q,forEach:function(a){for(var b in this._)a.call(this,l(b),this._[b])}}),hg.nest=function(){function a(b,g,h){if(h>=f.length)return d?d.call(e,g):c?g.sort(c):g;for(var i,k,l,m,n=-1,o=g.length,p=f[h++],q=new j;++n<o;)(m=q.get(i=p(k=g[n])))?m.push(k):q.set(i,[k]);return b?(k=b(),l=function(c,d){k.set(c,a(b,d,h))}):(k={},l=function(c,d){k[c]=a(b,d,h)}),q.forEach(l),k}function b(a,c){if(c>=f.length)return a;var d=[],e=g[c++];return a.forEach(function(a,e){d.push({key:a,values:b(e,c)})}),e?d.sort(function(a,b){return e(a.key,b.key)}):d}var c,d,e={},f=[],g=[];return e.map=function(b,c){return a(c,b,0)},e.entries=function(c){return b(a(hg.map,c,0),0)},e.key=function(a){return f.push(a),e},e.sortKeys=function(a){return g[f.length-1]=a,e},e.sortValues=function(a){return c=a,e},e.rollup=function(a){return d=a,e},e},hg.set=function(a){var b=new r;if(a)for(var c=0,d=a.length;c<d;++c)b.add(a[c]);return b},i(r,{has:m,add:function(a){return this._[k(a+="")]=!0,a},remove:n,values:o,size:p,empty:q,forEach:function(a){for(var b in this._)a.call(this,l(b))}}),hg.behavior={},hg.rebind=function(a,b){for(var c,d=1,e=arguments.length;++d<e;)a[c=arguments[d]]=t(a,b,b[c]);return a};var ug=["webkit","ms","moz","Moz","o","O"];hg.dispatch=function(){for(var a=new w,b=-1,c=arguments.length;++b<c;)a[arguments[b]]=x(a);return a},w.prototype.on=function(a,b){var c=a.indexOf("."),d="";if(c>=0&&(d=a.slice(c+1),a=a.slice(0,c)),a)return arguments.length<2?this[a].on(d):this[a].on(d,b);if(2===arguments.length){if(null==b)for(a in this)this.hasOwnProperty(a)&&this[a].on(d,null);return this}},hg.event=null,hg.requote=function(a){return a.replace(vg,"\\$&")};var vg=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,wg={}.__proto__?function(a,b){a.__proto__=b}:function(a,b){for(var c in b)a[c]=b[c]},xg=function(a,b){return b.querySelector(a)},yg=function(a,b){return b.querySelectorAll(a)},zg=function(a,b){var c=a.matches||a[u(a,"matchesSelector")];return(zg=function(a,b){return c.call(a,b)})(a,b)};"function"==typeof Sizzle&&(xg=function(a,b){return Sizzle(a,b)[0]||null},yg=Sizzle,zg=Sizzle.matchesSelector),hg.selection=function(){return hg.select(kg.documentElement)};var Ag=hg.selection.prototype=[];Ag.select=function(a){var b,c,d,e,f=[];a=C(a);for(var g=-1,h=this.length;++g<h;){f.push(b=[]),b.parentNode=(d=this[g]).parentNode;for(var i=-1,j=d.length;++i<j;)(e=d[i])?(b.push(c=a.call(e,e.__data__,i,g)),c&&"__data__"in e&&(c.__data__=e.__data__)):b.push(null)}return B(f)},Ag.selectAll=function(a){var b,c,d=[];a=D(a);for(var e=-1,f=this.length;++e<f;)for(var g=this[e],h=-1,i=g.length;++h<i;)(c=g[h])&&(d.push(b=jg(a.call(c,c.__data__,h,e))),b.parentNode=c);return B(d)};var Bg="http://www.w3.org/1999/xhtml",Cg={svg:"http://www.w3.org/2000/svg",xhtml:Bg,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};hg.ns={prefix:Cg,qualify:function(a){var b=a.indexOf(":"),c=a;return b>=0&&"xmlns"!==(c=a.slice(0,b))&&(a=a.slice(b+1)),Cg.hasOwnProperty(c)?{space:Cg[c],local:a}:a}},Ag.attr=function(a,b){if(arguments.length<2){if("string"==typeof a){var c=this.node();return a=hg.ns.qualify(a),a.local?c.getAttributeNS(a.space,a.local):c.getAttribute(a)}for(b in a)this.each(E(b,a[b]));return this}return this.each(E(a,b))},Ag.classed=function(a,b){if(arguments.length<2){if("string"==typeof a){var c=this.node(),d=(a=H(a)).length,e=-1;if(b=c.classList){for(;++e<d;)if(!b.contains(a[e]))return!1}else for(b=c.getAttribute("class");++e<d;)if(!G(a[e]).test(b))return!1;return!0}for(b in a)this.each(I(b,a[b]));return this}return this.each(I(a,b))},Ag.style=function(a,c,d){var e=arguments.length;if(e<3){if("string"!=typeof a){e<2&&(c="");for(d in a)this.each(K(d,a[d],c));return this}if(e<2){var f=this.node();return b(f).getComputedStyle(f,null).getPropertyValue(a)}d=""}return this.each(K(a,c,d))},Ag.property=function(a,b){if(arguments.length<2){if("string"==typeof a)return this.node()[a];for(b in a)this.each(L(b,a[b]));return this}return this.each(L(a,b))},Ag.text=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.textContent=null==b?"":b}:null==a?function(){this.textContent=""}:function(){this.textContent=a}):this.node().textContent},Ag.html=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.innerHTML=null==b?"":b}:null==a?function(){this.innerHTML=""}:function(){this.innerHTML=a}):this.node().innerHTML},Ag.append=function(a){return a=M(a),this.select(function(){return this.appendChild(a.apply(this,arguments))})},Ag.insert=function(a,b){return a=M(a),b=C(b),this.select(function(){return this.insertBefore(a.apply(this,arguments),b.apply(this,arguments)||null)})},Ag.remove=function(){return this.each(N)},Ag.data=function(a,b){function c(a,c){var d,e,f,g=a.length,l=c.length,m=Math.min(g,l),n=new Array(l),o=new Array(l),p=new Array(g);if(b){var q,r=new j,s=new Array(g);for(d=-1;++d<g;)(e=a[d])&&(r.has(q=b.call(e,e.__data__,d))?p[d]=e:r.set(q,e),s[d]=q);for(d=-1;++d<l;)(e=r.get(q=b.call(c,f=c[d],d)))?e!==!0&&(n[d]=e,e.__data__=f):o[d]=O(f),r.set(q,!0);for(d=-1;++d<g;)d in s&&r.get(s[d])!==!0&&(p[d]=a[d])}else{for(d=-1;++d<m;)e=a[d],f=c[d],e?(e.__data__=f,n[d]=e):o[d]=O(f);for(;d<l;++d)o[d]=O(c[d]);for(;d<g;++d)p[d]=a[d]}o.update=n,o.parentNode=n.parentNode=p.parentNode=a.parentNode,h.push(o),i.push(n),k.push(p)}var d,e,f=-1,g=this.length;if(!arguments.length){for(a=new Array(g=(d=this[0]).length);++f<g;)(e=d[f])&&(a[f]=e.__data__);return a}var h=S([]),i=B([]),k=B([]);if("function"==typeof a)for(;++f<g;)c(d=this[f],a.call(d,d.parentNode.__data__,f));else for(;++f<g;)c(d=this[f],a);return i.enter=function(){return h},i.exit=function(){return k},i},Ag.datum=function(a){return arguments.length?this.property("__data__",a):this.property("__data__")},Ag.filter=function(a){var b,c,d,e=[];"function"!=typeof a&&(a=P(a));for(var f=0,g=this.length;f<g;f++){e.push(b=[]),b.parentNode=(c=this[f]).parentNode;for(var h=0,i=c.length;h<i;h++)(d=c[h])&&a.call(d,d.__data__,h,f)&&b.push(d)}return B(e)},Ag.order=function(){for(var a=-1,b=this.length;++a<b;)for(var c,d=this[a],e=d.length-1,f=d[e];--e>=0;)(c=d[e])&&(f&&f!==c.nextSibling&&f.parentNode.insertBefore(c,f),f=c);return this},Ag.sort=function(a){a=Q.apply(this,arguments);for(var b=-1,c=this.length;++b<c;)this[b].sort(a);return this.order()},Ag.each=function(a){return R(this,function(b,c,d){a.call(b,b.__data__,c,d)})},Ag.call=function(a){var b=jg(arguments);return a.apply(b[0]=this,b),this},Ag.empty=function(){return!this.node()},Ag.node=function(){for(var a=0,b=this.length;a<b;a++)for(var c=this[a],d=0,e=c.length;d<e;d++){var f=c[d];if(f)return f}return null},Ag.size=function(){var a=0;return R(this,function(){++a}),a};var Dg=[];hg.selection.enter=S,hg.selection.enter.prototype=Dg,Dg.append=Ag.append,Dg.empty=Ag.empty,Dg.node=Ag.node,Dg.call=Ag.call,Dg.size=Ag.size,Dg.select=function(a){for(var b,c,d,e,f,g=[],h=-1,i=this.length;++h<i;){d=(e=this[h]).update,g.push(b=[]),b.parentNode=e.parentNode;for(var j=-1,k=e.length;++j<k;)(f=e[j])?(b.push(d[j]=c=a.call(e.parentNode,f.__data__,j,h)),c.__data__=f.__data__):b.push(null)}return B(g)},Dg.insert=function(a,b){return arguments.length<2&&(b=T(this)),Ag.insert.call(this,a,b)},hg.select=function(b){var c;return"string"==typeof b?(c=[xg(b,kg)],c.parentNode=kg.documentElement):(c=[b],c.parentNode=a(b)),B([c])},hg.selectAll=function(a){var b;return"string"==typeof a?(b=jg(yg(a,kg)),b.parentNode=kg.documentElement):(b=jg(a),b.parentNode=null),B([b])},Ag.on=function(a,b,c){var d=arguments.length;if(d<3){if("string"!=typeof a){d<2&&(b=!1);for(c in a)this.each(U(c,a[c],b));return this}if(d<2)return(d=this.node()["__on"+a])&&d._;c=!1}return this.each(U(a,b,c))};var Eg=hg.map({mouseenter:"mouseover",mouseleave:"mouseout"});kg&&Eg.forEach(function(a){"on"+a in kg&&Eg.remove(a)});var Fg,Gg=0;hg.mouse=function(a){return Y(a,z())};var Hg=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;hg.touch=function(a,b,c){if(arguments.length<3&&(c=b,b=z().changedTouches),b)for(var d,e=0,f=b.length;e<f;++e)if((d=b[e]).identifier===c)return Y(a,d)},hg.behavior.drag=function(){function a(){this.on("mousedown.drag",f).on("touchstart.drag",g)}function c(a,b,c,f,g){return function(){function h(){var a,c,d=b(m,p);d&&(a=d[0]-t[0],c=d[1]-t[1],o|=a|c,t=d,n({type:"drag",x:d[0]+j[0],y:d[1]+j[1],dx:a,dy:c}))}function i(){b(m,p)&&(r.on(f+q,null).on(g+q,null),s(o),n({type:"dragend"}))}var j,k=this,l=hg.event.target.correspondingElement||hg.event.target,m=k.parentNode,n=d.of(k,arguments),o=0,p=a(),q=".drag"+(null==p?"":"-"+p),r=hg.select(c(l)).on(f+q,h).on(g+q,i),s=X(l),t=b(m,p);e?(j=e.apply(k,arguments),j=[j.x-t[0],j.y-t[1]]):j=[0,0],n({type:"dragstart"})}}var d=A(a,"drag","dragstart","dragend"),e=null,f=c(v,hg.mouse,b,"mousemove","mouseup"),g=c(Z,hg.touch,s,"touchmove","touchend");return a.origin=function(b){return arguments.length?(e=b,a):e},hg.rebind(a,d,"on")},hg.touches=function(a,b){return arguments.length<2&&(b=z().touches),b?jg(b).map(function(b){var c=Y(a,b);return c.identifier=b.identifier,c}):[]};var Ig=1e-6,Jg=Ig*Ig,Kg=Math.PI,Lg=2*Kg,Mg=Lg-Ig,Ng=Kg/2,Og=Kg/180,Pg=180/Kg,Qg=Math.SQRT2,Rg=2,Sg=4;hg.interpolateZoom=function(a,b){var c,d,e=a[0],f=a[1],g=a[2],h=b[0],i=b[1],j=b[2],k=h-e,l=i-f,m=k*k+l*l;if(m<Jg)d=Math.log(j/g)/Qg,c=function(a){return[e+a*k,f+a*l,g*Math.exp(Qg*a*d)]};else{var n=Math.sqrt(m),o=(j*j-g*g+Sg*m)/(2*g*Rg*n),p=(j*j-g*g-Sg*m)/(2*j*Rg*n),q=Math.log(Math.sqrt(o*o+1)-o),r=Math.log(Math.sqrt(p*p+1)-p);d=(r-q)/Qg,c=function(a){var b=a*d,c=da(q),h=g/(Rg*n)*(c*ea(Qg*b+q)-ca(q));return[e+h*k,f+h*l,g*c/da(Qg*b+q)]}}return c.duration=1e3*d,c},hg.behavior.zoom=function(){function a(a){a.on(F,l).on(Ug+".zoom",n).on("dblclick.zoom",o).on(I,m)}function c(a){return[(a[0]-z.x)/z.k,(a[1]-z.y)/z.k]}function d(a){return[a[0]*z.k+z.x,a[1]*z.k+z.y]}function e(a){z.k=Math.max(C[0],Math.min(C[1],a))}function f(a,b){b=d(b),z.x+=a[0]-b[0],z.y+=a[1]-b[1]}function g(b,c,d,g){b.__chart__={x:z.x,y:z.y,k:z.k},e(Math.pow(2,g)),f(q=c,d),b=hg.select(b),D>0&&(b=b.transition().duration(D)),b.call(a.event)}function h(){v&&v.domain(u.range().map(function(a){return(a-z.x)/z.k}).map(u.invert)),x&&x.domain(w.range().map(function(a){return(a-z.y)/z.k}).map(w.invert))}function i(a){E++||a({type:"zoomstart"})}function j(a){h(),a({type:"zoom",scale:z.k,translate:[z.x,z.y]})}function k(a){--E||(a({type:"zoomend"}),q=null)}function l(){function a(){h=1,f(hg.mouse(e),m),j(g)}function d(){l.on(G,null).on(H,null),n(h),k(g)}var e=this,g=J.of(e,arguments),h=0,l=hg.select(b(e)).on(G,a).on(H,d),m=c(hg.mouse(e)),n=X(e);Ni.call(e),i(g)}function m(){function a(){var a=hg.touches(o);return n=z.k,a.forEach(function(a){a.identifier in q&&(q[a.identifier]=c(a))}),a}function b(){var b=hg.event.target;hg.select(b).on(u,d).on(v,h),w.push(b);for(var c=hg.event.changedTouches,e=0,f=c.length;e<f;++e)q[c[e].identifier]=null;var i=a(),j=Date.now();if(1===i.length){if(j-t<500){var k=i[0];g(o,k,q[k.identifier],Math.floor(Math.log(z.k)/Math.LN2)+1),y()}t=j}else if(i.length>1){var k=i[0],l=i[1],m=k[0]-l[0],n=k[1]-l[1];r=m*m+n*n}}function d(){var a,b,c,d,g=hg.touches(o);Ni.call(o);for(var h=0,i=g.length;h<i;++h,d=null)if(c=g[h],d=q[c.identifier]){if(b)break;a=c,b=d}if(d){var k=(k=c[0]-a[0])*k+(k=c[1]-a[1])*k,l=r&&Math.sqrt(k/r);a=[(a[0]+c[0])/2,(a[1]+c[1])/2],b=[(b[0]+d[0])/2,(b[1]+d[1])/2],e(l*n)}t=null,f(a,b),j(p)}function h(){if(hg.event.touches.length){for(var b=hg.event.changedTouches,c=0,d=b.length;c<d;++c)delete q[b[c].identifier];for(var e in q)return void a()}hg.selectAll(w).on(s,null),x.on(F,l).on(I,m),A(),k(p)}var n,o=this,p=J.of(o,arguments),q={},r=0,s=".zoom-"+hg.event.changedTouches[0].identifier,u="touchmove"+s,v="touchend"+s,w=[],x=hg.select(o),A=X(o);b(),i(p),x.on(F,null).on(I,b)}function n(){var a=J.of(this,arguments);s?clearTimeout(s):(Ni.call(this),p=c(q=r||hg.mouse(this)),i(a)),s=setTimeout(function(){s=null,k(a)},50),y(),e(Math.pow(2,.002*Tg())*z.k),f(q,p),j(a)}function o(){var a=hg.mouse(this),b=Math.log(z.k)/Math.LN2;g(this,a,c(a),hg.event.shiftKey?Math.ceil(b)-1:Math.floor(b)+1)}var p,q,r,s,t,u,v,w,x,z={x:0,y:0,k:1},B=[960,500],C=Vg,D=250,E=0,F="mousedown.zoom",G="mousemove.zoom",H="mouseup.zoom",I="touchstart.zoom",J=A(a,"zoomstart","zoom","zoomend");return Ug||(Ug="onwheel"in kg?(Tg=function(){return-hg.event.deltaY*(hg.event.deltaMode?120:1)},"wheel"):"onmousewheel"in kg?(Tg=function(){return hg.event.wheelDelta},"mousewheel"):(Tg=function(){return-hg.event.detail},"MozMousePixelScroll")),a.event=function(a){a.each(function(){var a=J.of(this,arguments),b=z;Li?hg.select(this).transition().each("start.zoom",function(){z=this.__chart__||{x:0,y:0,k:1},i(a)}).tween("zoom:zoom",function(){var c=B[0],d=B[1],e=q?q[0]:c/2,f=q?q[1]:d/2,g=hg.interpolateZoom([(e-z.x)/z.k,(f-z.y)/z.k,c/z.k],[(e-b.x)/b.k,(f-b.y)/b.k,c/b.k]);return function(b){var d=g(b),h=c/d[2];this.__chart__=z={x:e-d[0]*h,y:f-d[1]*h,k:h},j(a)}}).each("interrupt.zoom",function(){k(a)}).each("end.zoom",function(){k(a)}):(this.__chart__=z,i(a),j(a),k(a))})},a.translate=function(b){return arguments.length?(z={x:+b[0],y:+b[1],k:z.k},h(),a):[z.x,z.y]},a.scale=function(b){return arguments.length?(z={x:z.x,y:z.y,k:null},e(+b),h(),a):z.k},a.scaleExtent=function(b){return arguments.length?(C=null==b?Vg:[+b[0],+b[1]],a):C},a.center=function(b){return arguments.length?(r=b&&[+b[0],+b[1]],a):r},a.size=function(b){return arguments.length?(B=b&&[+b[0],+b[1]],a):B},a.duration=function(b){return arguments.length?(D=+b,a):D},a.x=function(b){return arguments.length?(v=b,u=b.copy(),z={x:0,y:0,k:1},a):v},a.y=function(b){return arguments.length?(x=b,w=b.copy(),z={x:0,y:0,k:1},a):x},hg.rebind(a,J,"on")};var Tg,Ug,Vg=[0,1/0];hg.color=ga,ga.prototype.toString=function(){return this.rgb()+""},hg.hsl=ha;var Wg=ha.prototype=new ga;Wg.brighter=function(a){return a=Math.pow(.7,arguments.length?a:1),new ha(this.h,this.s,this.l/a)},Wg.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),new ha(this.h,this.s,a*this.l)},Wg.rgb=function(){return ia(this.h,this.s,this.l)},hg.hcl=ja;var Xg=ja.prototype=new ga;Xg.brighter=function(a){return new ja(this.h,this.c,Math.min(100,this.l+Yg*(arguments.length?a:1)))},Xg.darker=function(a){return new ja(this.h,this.c,Math.max(0,this.l-Yg*(arguments.length?a:1)))},Xg.rgb=function(){return ka(this.h,this.c,this.l).rgb()},hg.lab=la;var Yg=18,Zg=.95047,$g=1,_g=1.08883,ah=la.prototype=new ga;ah.brighter=function(a){return new la(Math.min(100,this.l+Yg*(arguments.length?a:1)),this.a,this.b)},ah.darker=function(a){return new la(Math.max(0,this.l-Yg*(arguments.length?a:1)),this.a,this.b)},ah.rgb=function(){return ma(this.l,this.a,this.b)},hg.rgb=ra;var bh=ra.prototype=new ga;bh.brighter=function(a){a=Math.pow(.7,arguments.length?a:1);var b=this.r,c=this.g,d=this.b,e=30;return b||c||d?(b&&b<e&&(b=e),c&&c<e&&(c=e),d&&d<e&&(d=e),new ra(Math.min(255,b/a),Math.min(255,c/a),Math.min(255,d/a))):new ra(e,e,e)},bh.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),new ra(a*this.r,a*this.g,a*this.b)},bh.hsl=function(){return wa(this.r,this.g,this.b)},bh.toString=function(){return"#"+ua(this.r)+ua(this.g)+ua(this.b)};var ch=hg.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});ch.forEach(function(a,b){ch.set(a,sa(b))}),hg.functor=Aa,hg.xhr=Ba(s),hg.dsv=function(a,b){function c(a,c,f){arguments.length<3&&(f=c,c=null);var g=Ca(a,b,null==c?d:e(c),f);return g.row=function(a){return arguments.length?g.response(null==(c=a)?d:e(a)):c},g}function d(a){return c.parse(a.responseText)}function e(a){return function(b){return c.parse(b.responseText,a)}}function f(b){return b.map(g).join(a)}function g(a){return h.test(a)?'"'+a.replace(/\"/g,'""')+'"':a}var h=new RegExp('["'+a+"\n]"),i=a.charCodeAt(0);return c.parse=function(a,b){var d;return c.parseRows(a,function(a,c){if(d)return d(a,c-1);var e=new Function("d","return {"+a.map(function(a,b){return JSON.stringify(a)+": d["+b+"]"}).join(",")+"}");d=b?function(a,c){return b(e(a),c)}:e})},c.parseRows=function(a,b){function c(){if(k>=j)return g;if(e)return e=!1,f;var b=k;if(34===a.charCodeAt(b)){for(var c=b;c++<j;)if(34===a.charCodeAt(c)){if(34!==a.charCodeAt(c+1))break;++c}k=c+2;var d=a.charCodeAt(c+1);return 13===d?(e=!0,10===a.charCodeAt(c+2)&&++k):10===d&&(e=!0),a.slice(b+1,c).replace(/""/g,'"')}for(;k<j;){var d=a.charCodeAt(k++),h=1;if(10===d)e=!0;else if(13===d)e=!0,10===a.charCodeAt(k)&&(++k,++h);else if(d!==i)continue;return a.slice(b,k-h)}return a.slice(b)}for(var d,e,f={},g={},h=[],j=a.length,k=0,l=0;(d=c())!==g;){for(var m=[];d!==f&&d!==g;)m.push(d),d=c();b&&null==(m=b(m,l++))||h.push(m)}return h},c.format=function(b){if(Array.isArray(b[0]))return c.formatRows(b);var d=new r,e=[];return b.forEach(function(a){for(var b in a)d.has(b)||e.push(d.add(b))}),[e.map(g).join(a)].concat(b.map(function(b){return e.map(function(a){return g(b[a])}).join(a)})).join("\n")},c.formatRows=function(a){return a.map(f).join("\n")},c},hg.csv=hg.dsv(",","text/csv"),hg.tsv=hg.dsv("\t","text/tab-separated-values");var dh,eh,fh,gh,hh=this[u(this,"requestAnimationFrame")]||function(a){setTimeout(a,17)};hg.timer=function(){Fa.apply(this,arguments)},hg.timer.flush=function(){Ha(),Ia()},hg.round=function(a,b){return b?Math.round(a*(b=Math.pow(10,b)))/b:Math.round(a)};var ih=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"].map(Ka);hg.formatPrefix=function(a,b){var c=0;return(a=+a)&&(a<0&&(a*=-1),b&&(a=hg.round(a,Ja(a,b))),c=1+Math.floor(1e-12+Math.log(a)/Math.LN10),c=Math.max(-24,Math.min(24,3*Math.floor((c-1)/3)))),ih[8+c/3]};var jh=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,kh=hg.map({b:function(a){return a.toString(2)},c:function(a){return String.fromCharCode(a)},o:function(a){return a.toString(8)},x:function(a){return a.toString(16)},X:function(a){return a.toString(16).toUpperCase()},g:function(a,b){return a.toPrecision(b)},e:function(a,b){return a.toExponential(b)},f:function(a,b){return a.toFixed(b)},r:function(a,b){return(a=hg.round(a,Ja(a,b))).toFixed(Math.max(0,Math.min(20,Ja(a*(1+1e-15),b))))}}),lh=hg.time={},mh=Date;Na.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){nh.setUTCDate.apply(this._,arguments)},setDay:function(){nh.setUTCDay.apply(this._,arguments)},setFullYear:function(){nh.setUTCFullYear.apply(this._,arguments)},setHours:function(){nh.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){nh.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){nh.setUTCMinutes.apply(this._,arguments)},setMonth:function(){nh.setUTCMonth.apply(this._,arguments)},setSeconds:function(){nh.setUTCSeconds.apply(this._,arguments)},setTime:function(){nh.setTime.apply(this._,arguments)}};var nh=Date.prototype;lh.year=Oa(function(a){return a=lh.day(a),a.setMonth(0,1),a},function(a,b){a.setFullYear(a.getFullYear()+b)},function(a){return a.getFullYear()}),lh.years=lh.year.range,lh.years.utc=lh.year.utc.range,lh.day=Oa(function(a){var b=new mh(2e3,0);return b.setFullYear(a.getFullYear(),a.getMonth(),a.getDate()),b},function(a,b){a.setDate(a.getDate()+b)},function(a){return a.getDate()-1}),lh.days=lh.day.range,lh.days.utc=lh.day.utc.range,lh.dayOfYear=function(a){var b=lh.year(a);return Math.floor((a-b-6e4*(a.getTimezoneOffset()-b.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(a,b){b=7-b;var c=lh[a]=Oa(function(a){return(a=lh.day(a)).setDate(a.getDate()-(a.getDay()+b)%7),a},function(a,b){a.setDate(a.getDate()+7*Math.floor(b))},function(a){var c=lh.year(a).getDay();return Math.floor((lh.dayOfYear(a)+(c+b)%7)/7)-(c!==b)});lh[a+"s"]=c.range,lh[a+"s"].utc=c.utc.range,lh[a+"OfYear"]=function(a){var c=lh.year(a).getDay();return Math.floor((lh.dayOfYear(a)+(c+b)%7)/7)}}),lh.week=lh.sunday,lh.weeks=lh.sunday.range,lh.weeks.utc=lh.sunday.utc.range,lh.weekOfYear=lh.sundayOfYear;var oh={"-":"",_:" ",0:"0"},ph=/^\s*\d+/,qh=/^%/;hg.locale=function(a){return{numberFormat:La(a),timeFormat:Qa(a)}};var rh=hg.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",
date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});hg.format=rh.numberFormat,hg.geo={},jb.prototype={s:0,t:0,add:function(a){kb(a,this.t,sh),kb(sh.s,this.s,this),this.s?this.t+=sh.t:this.s=sh.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var sh=new jb;hg.geo.stream=function(a,b){a&&th.hasOwnProperty(a.type)?th[a.type](a,b):lb(a,b)};var th={Feature:function(a,b){lb(a.geometry,b)},FeatureCollection:function(a,b){for(var c=a.features,d=-1,e=c.length;++d<e;)lb(c[d].geometry,b)}},uh={Sphere:function(a,b){b.sphere()},Point:function(a,b){a=a.coordinates,b.point(a[0],a[1],a[2])},MultiPoint:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)a=c[d],b.point(a[0],a[1],a[2])},LineString:function(a,b){mb(a.coordinates,b,0)},MultiLineString:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)mb(c[d],b,0)},Polygon:function(a,b){nb(a.coordinates,b)},MultiPolygon:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)nb(c[d],b)},GeometryCollection:function(a,b){for(var c=a.geometries,d=-1,e=c.length;++d<e;)lb(c[d],b)}};hg.geo.area=function(a){return vh=0,hg.geo.stream(a,xh),vh};var vh,wh=new jb,xh={sphere:function(){vh+=4*Kg},point:v,lineStart:v,lineEnd:v,polygonStart:function(){wh.reset(),xh.lineStart=ob},polygonEnd:function(){var a=2*wh;vh+=a<0?4*Kg+a:a,xh.lineStart=xh.lineEnd=xh.point=v}};hg.geo.bounds=function(){function a(a,b){t.push(u=[k=a,m=a]),b<l&&(l=b),b>n&&(n=b)}function b(b,c){var d=pb([b*Og,c*Og]);if(r){var e=rb(r,d),f=[e[1],-e[0],0],g=rb(f,e);ub(g),g=vb(g);var i=b-o,j=i>0?1:-1,p=g[0]*Pg*j,q=rg(i)>180;if(q^(j*o<p&&p<j*b)){var s=g[1]*Pg;s>n&&(n=s)}else if(p=(p+360)%360-180,q^(j*o<p&&p<j*b)){var s=-g[1]*Pg;s<l&&(l=s)}else c<l&&(l=c),c>n&&(n=c);q?b<o?h(k,b)>h(k,m)&&(m=b):h(b,m)>h(k,m)&&(k=b):m>=k?(b<k&&(k=b),b>m&&(m=b)):b>o?h(k,b)>h(k,m)&&(m=b):h(b,m)>h(k,m)&&(k=b)}else a(b,c);r=d,o=b}function c(){v.point=b}function d(){u[0]=k,u[1]=m,v.point=a,r=null}function e(a,c){if(r){var d=a-o;s+=rg(d)>180?d+(d>0?360:-360):d}else p=a,q=c;xh.point(a,c),b(a,c)}function f(){xh.lineStart()}function g(){e(p,q),xh.lineEnd(),rg(s)>Ig&&(k=-(m=180)),u[0]=k,u[1]=m,r=null}function h(a,b){return(b-=a)<0?b+360:b}function i(a,b){return a[0]-b[0]}function j(a,b){return b[0]<=b[1]?b[0]<=a&&a<=b[1]:a<b[0]||b[1]<a}var k,l,m,n,o,p,q,r,s,t,u,v={point:a,lineStart:c,lineEnd:d,polygonStart:function(){v.point=e,v.lineStart=f,v.lineEnd=g,s=0,xh.polygonStart()},polygonEnd:function(){xh.polygonEnd(),v.point=a,v.lineStart=c,v.lineEnd=d,wh<0?(k=-(m=180),l=-(n=90)):s>Ig?n=90:s<-Ig&&(l=-90),u[0]=k,u[1]=m}};return function(a){n=m=-(k=l=1/0),t=[],hg.geo.stream(a,v);var b=t.length;if(b){t.sort(i);for(var c,d=1,e=t[0],f=[e];d<b;++d)c=t[d],j(c[0],e)||j(c[1],e)?(h(e[0],c[1])>h(e[0],e[1])&&(e[1]=c[1]),h(c[0],e[1])>h(e[0],e[1])&&(e[0]=c[0])):f.push(e=c);for(var g,c,o=-(1/0),b=f.length-1,d=0,e=f[b];d<=b;e=c,++d)c=f[d],(g=h(e[1],c[0]))>o&&(o=g,k=c[0],m=e[1])}return t=u=null,k===1/0||l===1/0?[[NaN,NaN],[NaN,NaN]]:[[k,l],[m,n]]}}(),hg.geo.centroid=function(a){yh=zh=Ah=Bh=Ch=Dh=Eh=Fh=Gh=Hh=Ih=0,hg.geo.stream(a,Jh);var b=Gh,c=Hh,d=Ih,e=b*b+c*c+d*d;return e<Jg&&(b=Dh,c=Eh,d=Fh,zh<Ig&&(b=Ah,c=Bh,d=Ch),(e=b*b+c*c+d*d)<Jg)?[NaN,NaN]:[Math.atan2(c,b)*Pg,ba(d/Math.sqrt(e))*Pg]};var yh,zh,Ah,Bh,Ch,Dh,Eh,Fh,Gh,Hh,Ih,Jh={sphere:v,point:xb,lineStart:zb,lineEnd:Ab,polygonStart:function(){Jh.lineStart=Bb},polygonEnd:function(){Jh.lineStart=zb}},Kh=Hb(Db,Lb,Nb,[-Kg,-Kg/2]),Lh=1e9;hg.geo.clipExtent=function(){var a,b,c,d,e,f,g={stream:function(a){return e&&(e.valid=!1),e=f(a),e.valid=!0,e},extent:function(h){return arguments.length?(f=Rb(a=+h[0][0],b=+h[0][1],c=+h[1][0],d=+h[1][1]),e&&(e.valid=!1,e=null),g):[[a,b],[c,d]]}};return g.extent([[0,0],[960,500]])},(hg.geo.conicEqualArea=function(){return Sb(Tb)}).raw=Tb,hg.geo.albers=function(){return hg.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},hg.geo.albersUsa=function(){function a(a){var f=a[0],g=a[1];return b=null,c(f,g),b||(d(f,g),b)||e(f,g),b}var b,c,d,e,f=hg.geo.albers(),g=hg.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),h=hg.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),i={point:function(a,c){b=[a,c]}};return a.invert=function(a){var b=f.scale(),c=f.translate(),d=(a[0]-c[0])/b,e=(a[1]-c[1])/b;return(e>=.12&&e<.234&&d>=-.425&&d<-.214?g:e>=.166&&e<.234&&d>=-.214&&d<-.115?h:f).invert(a)},a.stream=function(a){var b=f.stream(a),c=g.stream(a),d=h.stream(a);return{point:function(a,e){b.point(a,e),c.point(a,e),d.point(a,e)},sphere:function(){b.sphere(),c.sphere(),d.sphere()},lineStart:function(){b.lineStart(),c.lineStart(),d.lineStart()},lineEnd:function(){b.lineEnd(),c.lineEnd(),d.lineEnd()},polygonStart:function(){b.polygonStart(),c.polygonStart(),d.polygonStart()},polygonEnd:function(){b.polygonEnd(),c.polygonEnd(),d.polygonEnd()}}},a.precision=function(b){return arguments.length?(f.precision(b),g.precision(b),h.precision(b),a):f.precision()},a.scale=function(b){return arguments.length?(f.scale(b),g.scale(.35*b),h.scale(b),a.translate(f.translate())):f.scale()},a.translate=function(b){if(!arguments.length)return f.translate();var j=f.scale(),k=+b[0],l=+b[1];return c=f.translate(b).clipExtent([[k-.455*j,l-.238*j],[k+.455*j,l+.238*j]]).stream(i).point,d=g.translate([k-.307*j,l+.201*j]).clipExtent([[k-.425*j+Ig,l+.12*j+Ig],[k-.214*j-Ig,l+.234*j-Ig]]).stream(i).point,e=h.translate([k-.205*j,l+.212*j]).clipExtent([[k-.214*j+Ig,l+.166*j+Ig],[k-.115*j-Ig,l+.234*j-Ig]]).stream(i).point,a},a.scale(1070)};var Mh,Nh,Oh,Ph,Qh,Rh,Sh={point:v,lineStart:v,lineEnd:v,polygonStart:function(){Nh=0,Sh.lineStart=Ub},polygonEnd:function(){Sh.lineStart=Sh.lineEnd=Sh.point=v,Mh+=rg(Nh/2)}},Th={point:Vb,lineStart:v,lineEnd:v,polygonStart:v,polygonEnd:v},Uh={point:Yb,lineStart:Zb,lineEnd:$b,polygonStart:function(){Uh.lineStart=_b},polygonEnd:function(){Uh.point=Yb,Uh.lineStart=Zb,Uh.lineEnd=$b}};hg.geo.path=function(){function a(a){return a&&("function"==typeof h&&f.pointRadius(+h.apply(this,arguments)),g&&g.valid||(g=e(f)),hg.geo.stream(a,g)),f.result()}function b(){return g=null,a}var c,d,e,f,g,h=4.5;return a.area=function(a){return Mh=0,hg.geo.stream(a,e(Sh)),Mh},a.centroid=function(a){return Ah=Bh=Ch=Dh=Eh=Fh=Gh=Hh=Ih=0,hg.geo.stream(a,e(Uh)),Ih?[Gh/Ih,Hh/Ih]:Fh?[Dh/Fh,Eh/Fh]:Ch?[Ah/Ch,Bh/Ch]:[NaN,NaN]},a.bounds=function(a){return Qh=Rh=-(Oh=Ph=1/0),hg.geo.stream(a,e(Th)),[[Oh,Ph],[Qh,Rh]]},a.projection=function(a){return arguments.length?(e=(c=a)?a.stream||cc(a):s,b()):c},a.context=function(a){return arguments.length?(f=null==(d=a)?new Wb:new ac(a),"function"!=typeof h&&f.pointRadius(h),b()):d},a.pointRadius=function(b){return arguments.length?(h="function"==typeof b?b:(f.pointRadius(+b),+b),a):h},a.projection(hg.geo.albersUsa()).context(null)},hg.geo.transform=function(a){return{stream:function(b){var c=new dc(b);for(var d in a)c[d]=a[d];return c}}},dc.prototype={point:function(a,b){this.stream.point(a,b)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},hg.geo.projection=fc,hg.geo.projectionMutator=gc,(hg.geo.equirectangular=function(){return fc(ic)}).raw=ic.invert=ic,hg.geo.rotation=function(a){function b(b){return b=a(b[0]*Og,b[1]*Og),b[0]*=Pg,b[1]*=Pg,b}return a=kc(a[0]%360*Og,a[1]*Og,a.length>2?a[2]*Og:0),b.invert=function(b){return b=a.invert(b[0]*Og,b[1]*Og),b[0]*=Pg,b[1]*=Pg,b},b},jc.invert=ic,hg.geo.circle=function(){function a(){var a="function"==typeof d?d.apply(this,arguments):d,b=kc(-a[0]*Og,-a[1]*Og,0).invert,e=[];return c(null,null,1,{point:function(a,c){e.push(a=b(a,c)),a[0]*=Pg,a[1]*=Pg}}),{type:"Polygon",coordinates:[e]}}var b,c,d=[0,0],e=6;return a.origin=function(b){return arguments.length?(d=b,a):d},a.angle=function(d){return arguments.length?(c=oc((b=+d)*Og,e*Og),a):b},a.precision=function(d){return arguments.length?(c=oc(b*Og,(e=+d)*Og),a):e},a.angle(90)},hg.geo.distance=function(a,b){var c,d=(b[0]-a[0])*Og,e=a[1]*Og,f=b[1]*Og,g=Math.sin(d),h=Math.cos(d),i=Math.sin(e),j=Math.cos(e),k=Math.sin(f),l=Math.cos(f);return Math.atan2(Math.sqrt((c=l*g)*c+(c=j*k-i*l*h)*c),i*k+j*l*h)},hg.geo.graticule=function(){function a(){return{type:"MultiLineString",coordinates:b()}}function b(){return hg.range(Math.ceil(f/q)*q,e,q).map(m).concat(hg.range(Math.ceil(j/r)*r,i,r).map(n)).concat(hg.range(Math.ceil(d/o)*o,c,o).filter(function(a){return rg(a%q)>Ig}).map(k)).concat(hg.range(Math.ceil(h/p)*p,g,p).filter(function(a){return rg(a%r)>Ig}).map(l))}var c,d,e,f,g,h,i,j,k,l,m,n,o=10,p=o,q=90,r=360,s=2.5;return a.lines=function(){return b().map(function(a){return{type:"LineString",coordinates:a}})},a.outline=function(){return{type:"Polygon",coordinates:[m(f).concat(n(i).slice(1),m(e).reverse().slice(1),n(j).reverse().slice(1))]}},a.extent=function(b){return arguments.length?a.majorExtent(b).minorExtent(b):a.minorExtent()},a.majorExtent=function(b){return arguments.length?(f=+b[0][0],e=+b[1][0],j=+b[0][1],i=+b[1][1],f>e&&(b=f,f=e,e=b),j>i&&(b=j,j=i,i=b),a.precision(s)):[[f,j],[e,i]]},a.minorExtent=function(b){return arguments.length?(d=+b[0][0],c=+b[1][0],h=+b[0][1],g=+b[1][1],d>c&&(b=d,d=c,c=b),h>g&&(b=h,h=g,g=b),a.precision(s)):[[d,h],[c,g]]},a.step=function(b){return arguments.length?a.majorStep(b).minorStep(b):a.minorStep()},a.majorStep=function(b){return arguments.length?(q=+b[0],r=+b[1],a):[q,r]},a.minorStep=function(b){return arguments.length?(o=+b[0],p=+b[1],a):[o,p]},a.precision=function(b){return arguments.length?(s=+b,k=qc(h,g,90),l=rc(d,c,s),m=qc(j,i,90),n=rc(f,e,s),a):s},a.majorExtent([[-180,-90+Ig],[180,90-Ig]]).minorExtent([[-180,-80-Ig],[180,80+Ig]])},hg.geo.greatArc=function(){function a(){return{type:"LineString",coordinates:[b||d.apply(this,arguments),c||e.apply(this,arguments)]}}var b,c,d=sc,e=tc;return a.distance=function(){return hg.geo.distance(b||d.apply(this,arguments),c||e.apply(this,arguments))},a.source=function(c){return arguments.length?(d=c,b="function"==typeof c?null:c,a):d},a.target=function(b){return arguments.length?(e=b,c="function"==typeof b?null:b,a):e},a.precision=function(){return arguments.length?a:0},a},hg.geo.interpolate=function(a,b){return uc(a[0]*Og,a[1]*Og,b[0]*Og,b[1]*Og)},hg.geo.length=function(a){return Vh=0,hg.geo.stream(a,Wh),Vh};var Vh,Wh={sphere:v,point:v,lineStart:vc,lineEnd:v,polygonStart:v,polygonEnd:v},Xh=wc(function(a){return Math.sqrt(2/(1+a))},function(a){return 2*Math.asin(a/2)});(hg.geo.azimuthalEqualArea=function(){return fc(Xh)}).raw=Xh;var Yh=wc(function(a){var b=Math.acos(a);return b&&b/Math.sin(b)},s);(hg.geo.azimuthalEquidistant=function(){return fc(Yh)}).raw=Yh,(hg.geo.conicConformal=function(){return Sb(xc)}).raw=xc,(hg.geo.conicEquidistant=function(){return Sb(yc)}).raw=yc;var Zh=wc(function(a){return 1/a},Math.atan);(hg.geo.gnomonic=function(){return fc(Zh)}).raw=Zh,zc.invert=function(a,b){return[a,2*Math.atan(Math.exp(b))-Ng]},(hg.geo.mercator=function(){return Ac(zc)}).raw=zc;var $h=wc(function(){return 1},Math.asin);(hg.geo.orthographic=function(){return fc($h)}).raw=$h;var _h=wc(function(a){return 1/(1+a)},function(a){return 2*Math.atan(a)});(hg.geo.stereographic=function(){return fc(_h)}).raw=_h,Bc.invert=function(a,b){return[-b,2*Math.atan(Math.exp(a))-Ng]},(hg.geo.transverseMercator=function(){var a=Ac(Bc),b=a.center,c=a.rotate;return a.center=function(a){return a?b([-a[1],a[0]]):(a=b(),[a[1],-a[0]])},a.rotate=function(a){return a?c([a[0],a[1],a.length>2?a[2]+90:90]):(a=c(),[a[0],a[1],a[2]-90])},c([0,0,90])}).raw=Bc,hg.geom={},hg.geom.hull=function(a){function b(a){if(a.length<3)return[];var b,e=Aa(c),f=Aa(d),g=a.length,h=[],i=[];for(b=0;b<g;b++)h.push([+e.call(this,a[b],b),+f.call(this,a[b],b),b]);for(h.sort(Fc),b=0;b<g;b++)i.push([h[b][0],-h[b][1]]);var j=Ec(h),k=Ec(i),l=k[0]===j[0],m=k[k.length-1]===j[j.length-1],n=[];for(b=j.length-1;b>=0;--b)n.push(a[h[j[b]][2]]);for(b=+l;b<k.length-m;++b)n.push(a[h[k[b]][2]]);return n}var c=Cc,d=Dc;return arguments.length?b(a):(b.x=function(a){return arguments.length?(c=a,b):c},b.y=function(a){return arguments.length?(d=a,b):d},b)},hg.geom.polygon=function(a){return wg(a,ai),a};var ai=hg.geom.polygon.prototype=[];ai.area=function(){for(var a,b=-1,c=this.length,d=this[c-1],e=0;++b<c;)a=d,d=this[b],e+=a[1]*d[0]-a[0]*d[1];return.5*e},ai.centroid=function(a){var b,c,d=-1,e=this.length,f=0,g=0,h=this[e-1];for(arguments.length||(a=-1/(6*this.area()));++d<e;)b=h,h=this[d],c=b[0]*h[1]-h[0]*b[1],f+=(b[0]+h[0])*c,g+=(b[1]+h[1])*c;return[f*a,g*a]},ai.clip=function(a){for(var b,c,d,e,f,g,h=Ic(a),i=-1,j=this.length-Ic(this),k=this[j-1];++i<j;){for(b=a.slice(),a.length=0,e=this[i],f=b[(d=b.length-h)-1],c=-1;++c<d;)g=b[c],Gc(g,k,e)?(Gc(f,k,e)||a.push(Hc(f,g,k,e)),a.push(g)):Gc(f,k,e)&&a.push(Hc(f,g,k,e)),f=g;h&&a.push(a[0]),k=e}return a};var bi,ci,di,ei,fi,gi=[],hi=[];Qc.prototype.prepare=function(){for(var a,b=this.edges,c=b.length;c--;)a=b[c].edge,a.b&&a.a||b.splice(c,1);return b.sort(Sc),b.length},ad.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},bd.prototype={insert:function(a,b){var c,d,e;if(a){if(b.P=a,b.N=a.N,a.N&&(a.N.P=b),a.N=b,a.R){for(a=a.R;a.L;)a=a.L;a.L=b}else a.R=b;c=a}else this._?(a=fd(this._),b.P=null,b.N=a,a.P=a.L=b,c=a):(b.P=b.N=null,this._=b,c=null);for(b.L=b.R=null,b.U=c,b.C=!0,a=b;c&&c.C;)d=c.U,c===d.L?(e=d.R,e&&e.C?(c.C=e.C=!1,d.C=!0,a=d):(a===c.R&&(dd(this,c),a=c,c=a.U),c.C=!1,d.C=!0,ed(this,d))):(e=d.L,e&&e.C?(c.C=e.C=!1,d.C=!0,a=d):(a===c.L&&(ed(this,c),a=c,c=a.U),c.C=!1,d.C=!0,dd(this,d))),c=a.U;this._.C=!1},remove:function(a){a.N&&(a.N.P=a.P),a.P&&(a.P.N=a.N),a.N=a.P=null;var b,c,d,e=a.U,f=a.L,g=a.R;if(c=f?g?fd(g):f:g,e?e.L===a?e.L=c:e.R=c:this._=c,f&&g?(d=c.C,c.C=a.C,c.L=f,f.U=c,c!==g?(e=c.U,c.U=a.U,a=c.R,e.L=a,c.R=g,g.U=c):(c.U=e,e=c,a=c.R)):(d=a.C,a=c),a&&(a.U=e),!d){if(a&&a.C)return void(a.C=!1);do{if(a===this._)break;if(a===e.L){if(b=e.R,b.C&&(b.C=!1,e.C=!0,dd(this,e),b=e.R),b.L&&b.L.C||b.R&&b.R.C){b.R&&b.R.C||(b.L.C=!1,b.C=!0,ed(this,b),b=e.R),b.C=e.C,e.C=b.R.C=!1,dd(this,e),a=this._;break}}else if(b=e.L,b.C&&(b.C=!1,e.C=!0,ed(this,e),b=e.L),b.L&&b.L.C||b.R&&b.R.C){b.L&&b.L.C||(b.R.C=!1,b.C=!0,dd(this,b),b=e.L),b.C=e.C,e.C=b.L.C=!1,ed(this,e),a=this._;break}b.C=!0,a=e,e=e.U}while(!a.C);a&&(a.C=!1)}}},hg.geom.voronoi=function(a){function b(a){var b=new Array(a.length),d=h[0][0],e=h[0][1],f=h[1][0],g=h[1][1];return gd(c(a),h).cells.forEach(function(c,h){var i=c.edges,j=c.site;(b[h]=i.length?i.map(function(a){var b=a.start();return[b.x,b.y]}):j.x>=d&&j.x<=f&&j.y>=e&&j.y<=g?[[d,g],[f,g],[f,e],[d,e]]:[]).point=a[h]}),b}function c(a){return a.map(function(a,b){return{x:Math.round(f(a,b)/Ig)*Ig,y:Math.round(g(a,b)/Ig)*Ig,i:b}})}var d=Cc,e=Dc,f=d,g=e,h=ii;return a?b(a):(b.links=function(a){return gd(c(a)).edges.filter(function(a){return a.l&&a.r}).map(function(b){return{source:a[b.l.i],target:a[b.r.i]}})},b.triangles=function(a){var b=[];return gd(c(a)).cells.forEach(function(c,d){for(var e,f=c.site,g=c.edges.sort(Sc),h=-1,i=g.length,j=g[i-1].edge,k=j.l===f?j.r:j.l;++h<i;)j,e=k,j=g[h].edge,k=j.l===f?j.r:j.l,d<e.i&&d<k.i&&id(f,e,k)<0&&b.push([a[d],a[e.i],a[k.i]])}),b},b.x=function(a){return arguments.length?(f=Aa(d=a),b):d},b.y=function(a){return arguments.length?(g=Aa(e=a),b):e},b.clipExtent=function(a){return arguments.length?(h=null==a?ii:a,b):h===ii?null:h},b.size=function(a){return arguments.length?b.clipExtent(a&&[[0,0],a]):h===ii?null:h&&h[1]},b)};var ii=[[-1e6,-1e6],[1e6,1e6]];hg.geom.delaunay=function(a){return hg.geom.voronoi().triangles(a)},hg.geom.quadtree=function(a,b,c,d,e){function f(a){function f(a,b,c,d,e,f,g,h){if(!isNaN(c)&&!isNaN(d))if(a.leaf){var i=a.x,k=a.y;if(null!=i)if(rg(i-c)+rg(k-d)<.01)j(a,b,c,d,e,f,g,h);else{var l=a.point;a.x=a.y=a.point=null,j(a,l,i,k,e,f,g,h),j(a,b,c,d,e,f,g,h)}else a.x=c,a.y=d,a.point=b}else j(a,b,c,d,e,f,g,h)}function j(a,b,c,d,e,g,h,i){var j=.5*(e+h),k=.5*(g+i),l=c>=j,m=d>=k,n=m<<1|l;a.leaf=!1,a=a.nodes[n]||(a.nodes[n]=ld()),l?e=j:h=j,m?g=k:i=k,f(a,b,c,d,e,g,h,i)}var k,l,m,n,o,p,q,r,s,t=Aa(h),u=Aa(i);if(null!=b)p=b,q=c,r=d,s=e;else if(r=s=-(p=q=1/0),l=[],m=[],o=a.length,g)for(n=0;n<o;++n)k=a[n],k.x<p&&(p=k.x),k.y<q&&(q=k.y),k.x>r&&(r=k.x),k.y>s&&(s=k.y),l.push(k.x),m.push(k.y);else for(n=0;n<o;++n){var v=+t(k=a[n],n),w=+u(k,n);v<p&&(p=v),w<q&&(q=w),v>r&&(r=v),w>s&&(s=w),l.push(v),m.push(w)}var x=r-p,y=s-q;x>y?s=q+x:r=p+y;var z=ld();if(z.add=function(a){f(z,a,+t(a,++n),+u(a,n),p,q,r,s)},z.visit=function(a){md(a,z,p,q,r,s)},z.find=function(a){return nd(z,a[0],a[1],p,q,r,s)},n=-1,null==b){for(;++n<o;)f(z,a[n],l[n],m[n],p,q,r,s);--n}else a.forEach(z.add);return l=m=a=k=null,z}var g,h=Cc,i=Dc;return(g=arguments.length)?(h=jd,i=kd,3===g&&(e=c,d=b,c=b=0),f(a)):(f.x=function(a){return arguments.length?(h=a,f):h},f.y=function(a){return arguments.length?(i=a,f):i},f.extent=function(a){return arguments.length?(null==a?b=c=d=e=null:(b=+a[0][0],c=+a[0][1],d=+a[1][0],e=+a[1][1]),f):null==b?null:[[b,c],[d,e]]},f.size=function(a){return arguments.length?(null==a?b=c=d=e=null:(b=c=0,d=+a[0],e=+a[1]),f):null==b?null:[d-b,e-c]},f)},hg.interpolateRgb=od,hg.interpolateObject=pd,hg.interpolateNumber=qd,hg.interpolateString=rd;var ji=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ki=new RegExp(ji.source,"g");hg.interpolate=sd,hg.interpolators=[function(a,b){var c=typeof b;return("string"===c?ch.has(b.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(b)?od:rd:b instanceof ga?od:Array.isArray(b)?td:"object"===c&&isNaN(b)?pd:qd)(a,b)}],hg.interpolateArray=td;var li=function(){return s},mi=hg.map({linear:li,poly:Ad,quad:function(){return xd},cubic:function(){return yd},sin:function(){return Bd},exp:function(){return Cd},circle:function(){return Dd},elastic:Ed,back:Fd,bounce:function(){return Gd}}),ni=hg.map({in:s,out:vd,"in-out":wd,"out-in":function(a){return wd(vd(a))}});hg.ease=function(a){var b=a.indexOf("-"),c=b>=0?a.slice(0,b):a,d=b>=0?a.slice(b+1):"in";return c=mi.get(c)||li,d=ni.get(d)||s,ud(d(c.apply(null,ig.call(arguments,1))))},hg.interpolateHcl=Hd,hg.interpolateHsl=Id,hg.interpolateLab=Jd,hg.interpolateRound=Kd,hg.transform=function(a){var b=kg.createElementNS(hg.ns.prefix.svg,"g");return(hg.transform=function(a){if(null!=a){b.setAttribute("transform",a);var c=b.transform.baseVal.consolidate()}return new Ld(c?c.matrix:oi)})(a)},Ld.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var oi={a:1,b:0,c:0,d:1,e:0,f:0};hg.interpolateTransform=Ud,hg.layout={},hg.layout.bundle=function(){return function(a){for(var b=[],c=-1,d=a.length;++c<d;)b.push(Xd(a[c]));return b}},hg.layout.chord=function(){function a(){var a,j,l,m,n,o={},p=[],q=hg.range(f),r=[];for(c=[],d=[],a=0,m=-1;++m<f;){for(j=0,n=-1;++n<f;)j+=e[m][n];p.push(j),r.push(hg.range(f)),a+=j}for(g&&q.sort(function(a,b){return g(p[a],p[b])}),h&&r.forEach(function(a,b){a.sort(function(a,c){return h(e[b][a],e[b][c])})}),a=(Lg-k*f)/a,j=0,m=-1;++m<f;){for(l=j,n=-1;++n<f;){var s=q[m],t=r[s][n],u=e[s][t],v=j,w=j+=u*a;o[s+"-"+t]={index:s,subindex:t,startAngle:v,endAngle:w,value:u}}d[s]={index:s,startAngle:l,endAngle:j,value:p[s]},j+=k}for(m=-1;++m<f;)for(n=m-1;++n<f;){var x=o[m+"-"+n],y=o[n+"-"+m];(x.value||y.value)&&c.push(x.value<y.value?{source:y,target:x}:{source:x,target:y})}i&&b()}function b(){c.sort(function(a,b){return i((a.source.value+a.target.value)/2,(b.source.value+b.target.value)/2)})}var c,d,e,f,g,h,i,j={},k=0;return j.matrix=function(a){return arguments.length?(f=(e=a)&&e.length,c=d=null,j):e},j.padding=function(a){return arguments.length?(k=a,c=d=null,j):k},j.sortGroups=function(a){return arguments.length?(g=a,c=d=null,j):g},j.sortSubgroups=function(a){return arguments.length?(h=a,c=null,j):h},j.sortChords=function(a){return arguments.length?(i=a,c&&b(),j):i},j.chords=function(){return c||a(),c},j.groups=function(){return d||a(),d},j},hg.layout.force=function(){function a(a){return function(b,c,d,e){if(b.point!==a){var f=b.cx-a.x,g=b.cy-a.y,h=e-c,i=f*f+g*g;if(h*h/r<i){if(i<p){var j=b.charge/i;a.px-=f*j,a.py-=g*j}return!0}if(b.point&&i&&i<p){var j=b.pointCharge/i;a.px-=f*j,a.py-=g*j}}return!b.charge}}function b(a){a.px=hg.event.x,a.py=hg.event.y,i.resume()}var c,d,e,f,g,h,i={},j=hg.dispatch("start","tick","end"),k=[1,1],l=.9,m=pi,n=qi,o=-30,p=ri,q=.1,r=.64,t=[],u=[];return i.tick=function(){if((e*=.99)<.005)return c=null,j.end({type:"end",alpha:e=0}),!0;var b,d,i,m,n,p,r,s,v,w=t.length,x=u.length;for(d=0;d<x;++d)i=u[d],m=i.source,n=i.target,s=n.x-m.x,v=n.y-m.y,(p=s*s+v*v)&&(p=e*g[d]*((p=Math.sqrt(p))-f[d])/p,s*=p,v*=p,n.x-=s*(r=m.weight+n.weight?m.weight/(m.weight+n.weight):.5),n.y-=v*r,m.x+=s*(r=1-r),m.y+=v*r);if((r=e*q)&&(s=k[0]/2,v=k[1]/2,d=-1,r))for(;++d<w;)i=t[d],i.x+=(s-i.x)*r,i.y+=(v-i.y)*r;if(o)for(ce(b=hg.geom.quadtree(t),e,h),d=-1;++d<w;)(i=t[d]).fixed||b.visit(a(i));for(d=-1;++d<w;)i=t[d],i.fixed?(i.x=i.px,i.y=i.py):(i.x-=(i.px-(i.px=i.x))*l,i.y-=(i.py-(i.py=i.y))*l);j.tick({type:"tick",alpha:e})},i.nodes=function(a){return arguments.length?(t=a,i):t},i.links=function(a){return arguments.length?(u=a,i):u},i.size=function(a){return arguments.length?(k=a,i):k},i.linkDistance=function(a){return arguments.length?(m="function"==typeof a?a:+a,i):m},i.distance=i.linkDistance,i.linkStrength=function(a){return arguments.length?(n="function"==typeof a?a:+a,i):n},i.friction=function(a){return arguments.length?(l=+a,i):l},i.charge=function(a){return arguments.length?(o="function"==typeof a?a:+a,i):o},i.chargeDistance=function(a){return arguments.length?(p=a*a,i):Math.sqrt(p)},i.gravity=function(a){return arguments.length?(q=+a,i):q},i.theta=function(a){return arguments.length?(r=a*a,i):Math.sqrt(r)},i.alpha=function(a){return arguments.length?(a=+a,e?a>0?e=a:(c.c=null,c.t=NaN,c=null,j.end({type:"end",alpha:e=0})):a>0&&(j.start({type:"start",alpha:e=a}),c=Fa(i.tick)),i):e},i.start=function(){function a(a,d){if(!c){for(c=new Array(e),i=0;i<e;++i)c[i]=[];for(i=0;i<j;++i){var f=u[i];c[f.source.index].push(f.target),c[f.target.index].push(f.source)}}for(var g,h=c[b],i=-1,k=h.length;++i<k;)if(!isNaN(g=h[i][a]))return g;return Math.random()*d}var b,c,d,e=t.length,j=u.length,l=k[0],p=k[1];for(b=0;b<e;++b)(d=t[b]).index=b,d.weight=0;for(b=0;b<j;++b)d=u[b],"number"==typeof d.source&&(d.source=t[d.source]),"number"==typeof d.target&&(d.target=t[d.target]),++d.source.weight,++d.target.weight;for(b=0;b<e;++b)d=t[b],isNaN(d.x)&&(d.x=a("x",l)),isNaN(d.y)&&(d.y=a("y",p)),isNaN(d.px)&&(d.px=d.x),isNaN(d.py)&&(d.py=d.y);if(f=[],"function"==typeof m)for(b=0;b<j;++b)f[b]=+m.call(this,u[b],b);else for(b=0;b<j;++b)f[b]=m;if(g=[],"function"==typeof n)for(b=0;b<j;++b)g[b]=+n.call(this,u[b],b);else for(b=0;b<j;++b)g[b]=n;if(h=[],"function"==typeof o)for(b=0;b<e;++b)h[b]=+o.call(this,t[b],b);else for(b=0;b<e;++b)h[b]=o;return i.resume()},i.resume=function(){return i.alpha(.1)},i.stop=function(){return i.alpha(0)},i.drag=function(){if(d||(d=hg.behavior.drag().origin(s).on("dragstart.force",$d).on("drag.force",b).on("dragend.force",_d)),!arguments.length)return d;this.on("mouseover.force",ae).on("mouseout.force",be).call(d)},hg.rebind(i,j,"on")};var pi=20,qi=1,ri=1/0;hg.layout.hierarchy=function(){function a(e){var f,g=[e],h=[];for(e.depth=0;null!=(f=g.pop());)if(h.push(f),(j=c.call(a,f,f.depth))&&(i=j.length)){for(var i,j,k;--i>=0;)g.push(k=j[i]),k.parent=f,k.depth=f.depth+1;d&&(f.value=0),f.children=j}else d&&(f.value=+d.call(a,f,f.depth)||0),delete f.children;return fe(e,function(a){var c,e;b&&(c=a.children)&&c.sort(b),d&&(e=a.parent)&&(e.value+=a.value)}),h}var b=ie,c=ge,d=he;return a.sort=function(c){return arguments.length?(b=c,a):b},a.children=function(b){return arguments.length?(c=b,a):c},a.value=function(b){return arguments.length?(d=b,a):d},a.revalue=function(b){return d&&(ee(b,function(a){a.children&&(a.value=0)}),fe(b,function(b){var c;b.children||(b.value=+d.call(a,b,b.depth)||0),(c=b.parent)&&(c.value+=b.value)})),b},a},hg.layout.partition=function(){function a(b,c,d,e){var f=b.children;if(b.x=c,b.y=b.depth*e,b.dx=d,b.dy=e,f&&(g=f.length)){var g,h,i,j=-1;for(d=b.value?d/b.value:0;++j<g;)a(h=f[j],c,i=h.value*d,e),c+=i}}function b(a){var c=a.children,d=0;if(c&&(e=c.length))for(var e,f=-1;++f<e;)d=Math.max(d,b(c[f]));return 1+d}function c(c,f){var g=d.call(this,c,f);return a(g[0],0,e[0],e[1]/b(g[0])),g}var d=hg.layout.hierarchy(),e=[1,1];return c.size=function(a){return arguments.length?(e=a,c):e},de(c,d)},hg.layout.pie=function(){function a(g){var h,i=g.length,j=g.map(function(c,d){return+b.call(a,c,d)}),k=+("function"==typeof d?d.apply(this,arguments):d),l=("function"==typeof e?e.apply(this,arguments):e)-k,m=Math.min(Math.abs(l)/i,+("function"==typeof f?f.apply(this,arguments):f)),n=m*(l<0?-1:1),o=hg.sum(j),p=o?(l-i*n)/o:0,q=hg.range(i),r=[];return null!=c&&q.sort(c===si?function(a,b){return j[b]-j[a]}:function(a,b){return c(g[a],g[b])}),q.forEach(function(a){r[a]={data:g[a],value:h=j[a],startAngle:k,endAngle:k+=h*p+n,padAngle:m}}),r}var b=Number,c=si,d=0,e=Lg,f=0;return a.value=function(c){return arguments.length?(b=c,a):b},a.sort=function(b){return arguments.length?(c=b,a):c},a.startAngle=function(b){return arguments.length?(d=b,a):d},a.endAngle=function(b){return arguments.length?(e=b,a):e},a.padAngle=function(b){return arguments.length?(f=b,a):f},a};var si={};hg.layout.stack=function(){function a(h,i){if(!(m=h.length))return h;var j=h.map(function(c,d){return b.call(a,c,d)}),k=j.map(function(b){return b.map(function(b,c){return[f.call(a,b,c),g.call(a,b,c)]})}),l=c.call(a,k,i);j=hg.permute(j,l),k=hg.permute(k,l);var m,n,o,p,q=d.call(a,k,i),r=j[0].length;for(o=0;o<r;++o)for(e.call(a,j[0][o],p=q[o],k[0][o][1]),n=1;n<m;++n)e.call(a,j[n][o],p+=k[n-1][o][1],k[n][o][1]);return h}var b=s,c=ne,d=oe,e=me,f=ke,g=le;return a.values=function(c){return arguments.length?(b=c,a):b},a.order=function(b){return arguments.length?(c="function"==typeof b?b:ti.get(b)||ne,a):c},a.offset=function(b){return arguments.length?(d="function"==typeof b?b:ui.get(b)||oe,a):d},a.x=function(b){return arguments.length?(f=b,a):f},a.y=function(b){return arguments.length?(g=b,a):g},a.out=function(b){return arguments.length?(e=b,a):e},a};var ti=hg.map({"inside-out":function(a){var b,c,d=a.length,e=a.map(pe),f=a.map(qe),g=hg.range(d).sort(function(a,b){return e[a]-e[b]}),h=0,i=0,j=[],k=[];for(b=0;b<d;++b)c=g[b],h<i?(h+=f[c],j.push(c)):(i+=f[c],k.push(c));return k.reverse().concat(j)},reverse:function(a){return hg.range(a.length).reverse()},default:ne}),ui=hg.map({silhouette:function(a){var b,c,d,e=a.length,f=a[0].length,g=[],h=0,i=[];for(c=0;c<f;++c){for(b=0,d=0;b<e;b++)d+=a[b][c][1];d>h&&(h=d),g.push(d)}for(c=0;c<f;++c)i[c]=(h-g[c])/2;return i},wiggle:function(a){var b,c,d,e,f,g,h,i,j,k=a.length,l=a[0],m=l.length,n=[];for(n[0]=i=j=0,c=1;c<m;++c){for(b=0,e=0;b<k;++b)e+=a[b][c][1];for(b=0,f=0,h=l[c][0]-l[c-1][0];b<k;++b){for(d=0,g=(a[b][c][1]-a[b][c-1][1])/(2*h);d<b;++d)g+=(a[d][c][1]-a[d][c-1][1])/h;f+=g*a[b][c][1]}n[c]=i-=e?f/e*h:0,i<j&&(j=i)}for(c=0;c<m;++c)n[c]-=j;return n},expand:function(a){var b,c,d,e=a.length,f=a[0].length,g=1/e,h=[];for(c=0;c<f;++c){for(b=0,d=0;b<e;b++)d+=a[b][c][1];if(d)for(b=0;b<e;b++)a[b][c][1]/=d;else for(b=0;b<e;b++)a[b][c][1]=g}for(c=0;c<f;++c)h[c]=0;return h},zero:oe});hg.layout.histogram=function(){function a(a,f){for(var g,h,i=[],j=a.map(c,this),k=d.call(this,j,f),l=e.call(this,k,j,f),f=-1,m=j.length,n=l.length-1,o=b?1:1/m;++f<n;)g=i[f]=[],g.dx=l[f+1]-(g.x=l[f]),g.y=0;if(n>0)for(f=-1;++f<m;)(h=j[f])>=k[0]&&h<=k[1]&&(g=i[hg.bisect(l,h,1,n)-1],g.y+=o,g.push(a[f]));return i}var b=!0,c=Number,d=ue,e=se;return a.value=function(b){return arguments.length?(c=b,a):c},a.range=function(b){return arguments.length?(d=Aa(b),a):d},a.bins=function(b){return arguments.length?(e="number"==typeof b?function(a){return te(a,b)}:Aa(b),a):e},a.frequency=function(c){return arguments.length?(b=!!c,a):b},a},hg.layout.pack=function(){function a(a,f){var g=c.call(this,a,f),h=g[0],i=e[0],j=e[1],k=null==b?Math.sqrt:"function"==typeof b?b:function(){return b};if(h.x=h.y=0,fe(h,function(a){a.r=+k(a.value)}),fe(h,ze),d){var l=d*(b?1:Math.max(2*h.r/i,2*h.r/j))/2;fe(h,function(a){a.r+=l}),fe(h,ze),fe(h,function(a){a.r-=l})}return Ce(h,i/2,j/2,b?1:1/Math.max(2*h.r/i,2*h.r/j)),g}var b,c=hg.layout.hierarchy().sort(ve),d=0,e=[1,1];return a.size=function(b){return arguments.length?(e=b,a):e},a.radius=function(c){return arguments.length?(b=null==c||"function"==typeof c?c:+c,a):b},a.padding=function(b){return arguments.length?(d=+b,a):d},de(a,c)},hg.layout.tree=function(){function a(a,e){var k=g.call(this,a,e),l=k[0],m=b(l);if(fe(m,c),m.parent.m=-m.z,ee(m,d),j)ee(l,f);else{var n=l,o=l,p=l;ee(l,function(a){a.x<n.x&&(n=a),a.x>o.x&&(o=a),a.depth>p.depth&&(p=a)});var q=h(n,o)/2-n.x,r=i[0]/(o.x+h(o,n)/2+q),s=i[1]/(p.depth||1);ee(l,function(a){a.x=(a.x+q)*r,a.y=a.depth*s})}return k}function b(a){for(var b,c={A:null,children:[a]},d=[c];null!=(b=d.pop());)for(var e,f=b.children,g=0,h=f.length;g<h;++g)d.push((f[g]=e={_:f[g],parent:b,children:(e=f[g].children)&&e.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:g}).a=e);return c.children[0]}function c(a){var b=a.children,c=a.parent.children,d=a.i?c[a.i-1]:null;if(b.length){Ie(a);var f=(b[0].z+b[b.length-1].z)/2;d?(a.z=d.z+h(a._,d._),a.m=a.z-f):a.z=f}else d&&(a.z=d.z+h(a._,d._));a.parent.A=e(a,d,a.parent.A||c[0])}function d(a){a._.x=a.z+a.parent.m,a.m+=a.parent.m}function e(a,b,c){if(b){for(var d,e=a,f=a,g=b,i=e.parent.children[0],j=e.m,k=f.m,l=g.m,m=i.m;g=Ge(g),e=Fe(e),g&&e;)i=Fe(i),f=Ge(f),f.a=a,d=g.z+l-e.z-j+h(g._,e._),d>0&&(He(Je(g,a,c),a,d),j+=d,k+=d),l+=g.m,j+=e.m,m+=i.m,k+=f.m;g&&!Ge(f)&&(f.t=g,f.m+=l-k),e&&!Fe(i)&&(i.t=e,i.m+=j-m,c=a)}return c}function f(a){a.x*=i[0],a.y=a.depth*i[1]}var g=hg.layout.hierarchy().sort(null).value(null),h=Ee,i=[1,1],j=null;return a.separation=function(b){return arguments.length?(h=b,a):h},a.size=function(b){return arguments.length?(j=null==(i=b)?f:null,a):j?null:i},a.nodeSize=function(b){return arguments.length?(j=null==(i=b)?null:f,a):j?i:null},de(a,g)},hg.layout.cluster=function(){function a(a,f){var g,h=b.call(this,a,f),i=h[0],j=0;fe(i,function(a){var b=a.children;b&&b.length?(a.x=Le(b),a.y=Ke(b)):(a.x=g?j+=c(a,g):0,a.y=0,g=a)});var k=Me(i),l=Ne(i),m=k.x-c(k,l)/2,n=l.x+c(l,k)/2;return fe(i,e?function(a){a.x=(a.x-i.x)*d[0],a.y=(i.y-a.y)*d[1]}:function(a){a.x=(a.x-m)/(n-m)*d[0],a.y=(1-(i.y?a.y/i.y:1))*d[1]}),h}var b=hg.layout.hierarchy().sort(null).value(null),c=Ee,d=[1,1],e=!1;return a.separation=function(b){return arguments.length?(c=b,a):c},a.size=function(b){return arguments.length?(e=null==(d=b),a):e?null:d},a.nodeSize=function(b){return arguments.length?(e=null!=(d=b),a):e?d:null},de(a,b)},hg.layout.treemap=function(){function a(a,b){for(var c,d,e=-1,f=a.length;++e<f;)d=(c=a[e]).value*(b<0?0:b),c.area=isNaN(d)||d<=0?0:d}function b(c){var f=c.children;if(f&&f.length){var g,h,i,j=l(c),k=[],m=f.slice(),o=1/0,p="slice"===n?j.dx:"dice"===n?j.dy:"slice-dice"===n?1&c.depth?j.dy:j.dx:Math.min(j.dx,j.dy);for(a(m,j.dx*j.dy/c.value),k.area=0;(i=m.length)>0;)k.push(g=m[i-1]),k.area+=g.area,"squarify"!==n||(h=d(k,p))<=o?(m.pop(),o=h):(k.area-=k.pop().area,e(k,p,j,!1),p=Math.min(j.dx,j.dy),k.length=k.area=0,o=1/0);k.length&&(e(k,p,j,!0),k.length=k.area=0),f.forEach(b)}}function c(b){var d=b.children;if(d&&d.length){var f,g=l(b),h=d.slice(),i=[];for(a(h,g.dx*g.dy/b.value),i.area=0;f=h.pop();)i.push(f),i.area+=f.area,null!=f.z&&(e(i,f.z?g.dx:g.dy,g,!h.length),i.length=i.area=0);d.forEach(c)}}function d(a,b){
for(var c,d=a.area,e=0,f=1/0,g=-1,h=a.length;++g<h;)(c=a[g].area)&&(c<f&&(f=c),c>e&&(e=c));return d*=d,b*=b,d?Math.max(b*e*o/d,d/(b*f*o)):1/0}function e(a,b,c,d){var e,f=-1,g=a.length,h=c.x,j=c.y,k=b?i(a.area/b):0;if(b==c.dx){for((d||k>c.dy)&&(k=c.dy);++f<g;)e=a[f],e.x=h,e.y=j,e.dy=k,h+=e.dx=Math.min(c.x+c.dx-h,k?i(e.area/k):0);e.z=!0,e.dx+=c.x+c.dx-h,c.y+=k,c.dy-=k}else{for((d||k>c.dx)&&(k=c.dx);++f<g;)e=a[f],e.x=h,e.y=j,e.dx=k,j+=e.dy=Math.min(c.y+c.dy-j,k?i(e.area/k):0);e.z=!1,e.dy+=c.y+c.dy-j,c.x+=k,c.dx-=k}}function f(d){var e=g||h(d),f=e[0];return f.x=f.y=0,f.value?(f.dx=j[0],f.dy=j[1]):f.dx=f.dy=0,g&&h.revalue(f),a([f],f.dx*f.dy/f.value),(g?c:b)(f),m&&(g=e),e}var g,h=hg.layout.hierarchy(),i=Math.round,j=[1,1],k=null,l=Oe,m=!1,n="squarify",o=.5*(1+Math.sqrt(5));return f.size=function(a){return arguments.length?(j=a,f):j},f.padding=function(a){function b(b){var c=a.call(f,b,b.depth);return null==c?Oe(b):Pe(b,"number"==typeof c?[c,c,c,c]:c)}function c(b){return Pe(b,a)}if(!arguments.length)return k;var d;return l=null==(k=a)?Oe:"function"==(d=typeof a)?b:"number"===d?(a=[a,a,a,a],c):c,f},f.round=function(a){return arguments.length?(i=a?Math.round:Number,f):i!=Number},f.sticky=function(a){return arguments.length?(m=a,g=null,f):m},f.ratio=function(a){return arguments.length?(o=a,f):o},f.mode=function(a){return arguments.length?(n=a+"",f):n},de(f,h)},hg.random={normal:function(a,b){var c=arguments.length;return c<2&&(b=1),c<1&&(a=0),function(){var c,d,e;do{c=2*Math.random()-1,d=2*Math.random()-1,e=c*c+d*d}while(!e||e>1);return a+b*c*Math.sqrt(-2*Math.log(e)/e)}},logNormal:function(){var a=hg.random.normal.apply(hg,arguments);return function(){return Math.exp(a())}},bates:function(a){var b=hg.random.irwinHall(a);return function(){return b()/a}},irwinHall:function(a){return function(){for(var b=0,c=0;c<a;c++)b+=Math.random();return b}}},hg.scale={};var vi={floor:s,ceil:s};hg.scale.linear=function(){return We([0,1],[0,1],sd,!1)};var wi={s:1,g:1,p:1,r:1,e:1};hg.scale.log=function(){return cf(hg.scale.linear().domain([0,1]),10,!0,[1,10])};var xi=hg.format(".0e"),yi={floor:function(a){return-Math.ceil(-a)},ceil:function(a){return-Math.floor(-a)}};hg.scale.pow=function(){return df(hg.scale.linear(),1,[0,1])},hg.scale.sqrt=function(){return hg.scale.pow().exponent(.5)},hg.scale.ordinal=function(){return ff([],{t:"range",a:[[]]})},hg.scale.category10=function(){return hg.scale.ordinal().range(zi)},hg.scale.category20=function(){return hg.scale.ordinal().range(Ai)},hg.scale.category20b=function(){return hg.scale.ordinal().range(Bi)},hg.scale.category20c=function(){return hg.scale.ordinal().range(Ci)};var zi=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(ta),Ai=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(ta),Bi=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(ta),Ci=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(ta);hg.scale.quantile=function(){return gf([],[])},hg.scale.quantize=function(){return hf(0,1,[0,1])},hg.scale.threshold=function(){return jf([.5],[0,1])},hg.scale.identity=function(){return kf([0,1])},hg.svg={},hg.svg.arc=function(){function a(){var a=Math.max(0,+c.apply(this,arguments)),j=Math.max(0,+d.apply(this,arguments)),k=g.apply(this,arguments)-Ng,l=h.apply(this,arguments)-Ng,m=Math.abs(l-k),n=k>l?0:1;if(j<a&&(o=j,j=a,a=o),m>=Mg)return b(j,n)+(a?b(a,1-n):"")+"Z";var o,p,q,r,s,t,u,v,w,x,y,z,A=0,B=0,C=[];if((r=(+i.apply(this,arguments)||0)/2)&&(q=f===Di?Math.sqrt(a*a+j*j):+f.apply(this,arguments),n||(B*=-1),j&&(B=ba(q/j*Math.sin(r))),a&&(A=ba(q/a*Math.sin(r)))),j){s=j*Math.cos(k+B),t=j*Math.sin(k+B),u=j*Math.cos(l-B),v=j*Math.sin(l-B);var D=Math.abs(l-k-2*B)<=Kg?0:1;if(B&&rf(s,t,u,v)===n^D){var E=(k+l)/2;s=j*Math.cos(E),t=j*Math.sin(E),u=v=null}}else s=t=0;if(a){w=a*Math.cos(l-A),x=a*Math.sin(l-A),y=a*Math.cos(k+A),z=a*Math.sin(k+A);var F=Math.abs(k-l+2*A)<=Kg?0:1;if(A&&rf(w,x,y,z)===1-n^F){var G=(k+l)/2;w=a*Math.cos(G),x=a*Math.sin(G),y=z=null}}else w=x=0;if(m>Ig&&(o=Math.min(Math.abs(j-a)/2,+e.apply(this,arguments)))>.001){p=a<j^n?0:1;var H=o,I=o;if(m<Kg){var J=null==y?[w,x]:null==u?[s,t]:Hc([s,t],[y,z],[u,v],[w,x]),K=s-J[0],L=t-J[1],M=u-J[0],N=v-J[1],O=1/Math.sin(Math.acos((K*M+L*N)/(Math.sqrt(K*K+L*L)*Math.sqrt(M*M+N*N)))/2),P=Math.sqrt(J[0]*J[0]+J[1]*J[1]);I=Math.min(o,(a-P)/(O-1)),H=Math.min(o,(j-P)/(O+1))}if(null!=u){var Q=sf(null==y?[w,x]:[y,z],[s,t],j,H,n),R=sf([u,v],[w,x],j,H,n);o===H?C.push("M",Q[0],"A",H,",",H," 0 0,",p," ",Q[1],"A",j,",",j," 0 ",1-n^rf(Q[1][0],Q[1][1],R[1][0],R[1][1]),",",n," ",R[1],"A",H,",",H," 0 0,",p," ",R[0]):C.push("M",Q[0],"A",H,",",H," 0 1,",p," ",R[0])}else C.push("M",s,",",t);if(null!=y){var S=sf([s,t],[y,z],a,-I,n),T=sf([w,x],null==u?[s,t]:[u,v],a,-I,n);o===I?C.push("L",T[0],"A",I,",",I," 0 0,",p," ",T[1],"A",a,",",a," 0 ",n^rf(T[1][0],T[1][1],S[1][0],S[1][1]),",",1-n," ",S[1],"A",I,",",I," 0 0,",p," ",S[0]):C.push("L",T[0],"A",I,",",I," 0 0,",p," ",S[0])}else C.push("L",w,",",x)}else C.push("M",s,",",t),null!=u&&C.push("A",j,",",j," 0 ",D,",",n," ",u,",",v),C.push("L",w,",",x),null!=y&&C.push("A",a,",",a," 0 ",F,",",1-n," ",y,",",z);return C.push("Z"),C.join("")}function b(a,b){return"M0,"+a+"A"+a+","+a+" 0 1,"+b+" 0,"+-a+"A"+a+","+a+" 0 1,"+b+" 0,"+a}var c=mf,d=nf,e=lf,f=Di,g=of,h=pf,i=qf;return a.innerRadius=function(b){return arguments.length?(c=Aa(b),a):c},a.outerRadius=function(b){return arguments.length?(d=Aa(b),a):d},a.cornerRadius=function(b){return arguments.length?(e=Aa(b),a):e},a.padRadius=function(b){return arguments.length?(f=b==Di?Di:Aa(b),a):f},a.startAngle=function(b){return arguments.length?(g=Aa(b),a):g},a.endAngle=function(b){return arguments.length?(h=Aa(b),a):h},a.padAngle=function(b){return arguments.length?(i=Aa(b),a):i},a.centroid=function(){var a=(+c.apply(this,arguments)+ +d.apply(this,arguments))/2,b=(+g.apply(this,arguments)+ +h.apply(this,arguments))/2-Ng;return[Math.cos(b)*a,Math.sin(b)*a]},a};var Di="auto";hg.svg.line=function(){return tf(s)};var Ei=hg.map({linear:uf,"linear-closed":vf,step:wf,"step-before":xf,"step-after":yf,basis:Ef,"basis-open":Ff,"basis-closed":Gf,bundle:Hf,cardinal:Bf,"cardinal-open":zf,"cardinal-closed":Af,monotone:Nf});Ei.forEach(function(a,b){b.key=a,b.closed=/-closed$/.test(a)});var Fi=[0,2/3,1/3,0],Gi=[0,1/3,2/3,0],Hi=[0,1/6,2/3,1/6];hg.svg.line.radial=function(){var a=tf(Of);return a.radius=a.x,delete a.x,a.angle=a.y,delete a.y,a},xf.reverse=yf,yf.reverse=xf,hg.svg.area=function(){return Pf(s)},hg.svg.area.radial=function(){var a=Pf(Of);return a.radius=a.x,delete a.x,a.innerRadius=a.x0,delete a.x0,a.outerRadius=a.x1,delete a.x1,a.angle=a.y,delete a.y,a.startAngle=a.y0,delete a.y0,a.endAngle=a.y1,delete a.y1,a},hg.svg.chord=function(){function a(a,h){var i=b(this,f,a,h),j=b(this,g,a,h);return"M"+i.p0+d(i.r,i.p1,i.a1-i.a0)+(c(i,j)?e(i.r,i.p1,i.r,i.p0):e(i.r,i.p1,j.r,j.p0)+d(j.r,j.p1,j.a1-j.a0)+e(j.r,j.p1,i.r,i.p0))+"Z"}function b(a,b,c,d){var e=b.call(a,c,d),f=h.call(a,e,d),g=i.call(a,e,d)-Ng,k=j.call(a,e,d)-Ng;return{r:f,a0:g,a1:k,p0:[f*Math.cos(g),f*Math.sin(g)],p1:[f*Math.cos(k),f*Math.sin(k)]}}function c(a,b){return a.a0==b.a0&&a.a1==b.a1}function d(a,b,c){return"A"+a+","+a+" 0 "+ +(c>Kg)+",1 "+b}function e(a,b,c,d){return"Q 0,0 "+d}var f=sc,g=tc,h=Qf,i=of,j=pf;return a.radius=function(b){return arguments.length?(h=Aa(b),a):h},a.source=function(b){return arguments.length?(f=Aa(b),a):f},a.target=function(b){return arguments.length?(g=Aa(b),a):g},a.startAngle=function(b){return arguments.length?(i=Aa(b),a):i},a.endAngle=function(b){return arguments.length?(j=Aa(b),a):j},a},hg.svg.diagonal=function(){function a(a,e){var f=b.call(this,a,e),g=c.call(this,a,e),h=(f.y+g.y)/2,i=[f,{x:f.x,y:h},{x:g.x,y:h},g];return i=i.map(d),"M"+i[0]+"C"+i[1]+" "+i[2]+" "+i[3]}var b=sc,c=tc,d=Rf;return a.source=function(c){return arguments.length?(b=Aa(c),a):b},a.target=function(b){return arguments.length?(c=Aa(b),a):c},a.projection=function(b){return arguments.length?(d=b,a):d},a},hg.svg.diagonal.radial=function(){var a=hg.svg.diagonal(),b=Rf,c=a.projection;return a.projection=function(a){return arguments.length?c(Sf(b=a)):b},a},hg.svg.symbol=function(){function a(a,d){return(Ii.get(b.call(this,a,d))||Vf)(c.call(this,a,d))}var b=Uf,c=Tf;return a.type=function(c){return arguments.length?(b=Aa(c),a):b},a.size=function(b){return arguments.length?(c=Aa(b),a):c},a};var Ii=hg.map({circle:Vf,cross:function(a){var b=Math.sqrt(a/5)/2;return"M"+-3*b+","+-b+"H"+-b+"V"+-3*b+"H"+b+"V"+-b+"H"+3*b+"V"+b+"H"+b+"V"+3*b+"H"+-b+"V"+b+"H"+-3*b+"Z"},diamond:function(a){var b=Math.sqrt(a/(2*Ki)),c=b*Ki;return"M0,"+-b+"L"+c+",0 0,"+b+" "+-c+",0Z"},square:function(a){var b=Math.sqrt(a)/2;return"M"+-b+","+-b+"L"+b+","+-b+" "+b+","+b+" "+-b+","+b+"Z"},"triangle-down":function(a){var b=Math.sqrt(a/Ji),c=b*Ji/2;return"M0,"+c+"L"+b+","+-c+" "+-b+","+-c+"Z"},"triangle-up":function(a){var b=Math.sqrt(a/Ji),c=b*Ji/2;return"M0,"+-c+"L"+b+","+c+" "+-b+","+c+"Z"}});hg.svg.symbolTypes=Ii.keys();var Ji=Math.sqrt(3),Ki=Math.tan(30*Og);Ag.transition=function(a){for(var b,c,d=Li||++Pi,e=$f(a),f=[],g=Mi||{time:Date.now(),ease:zd,delay:0,duration:250},h=-1,i=this.length;++h<i;){f.push(b=[]);for(var j=this[h],k=-1,l=j.length;++k<l;)(c=j[k])&&_f(c,k,e,d,g),b.push(c)}return Xf(f,e,d)},Ag.interrupt=function(a){return this.each(null==a?Ni:Wf($f(a)))};var Li,Mi,Ni=Wf($f()),Oi=[],Pi=0;Oi.call=Ag.call,Oi.empty=Ag.empty,Oi.node=Ag.node,Oi.size=Ag.size,hg.transition=function(a,b){return a&&a.transition?Li?a.transition(b):a:hg.selection().transition(a)},hg.transition.prototype=Oi,Oi.select=function(a){var b,c,d,e=this.id,f=this.namespace,g=[];a=C(a);for(var h=-1,i=this.length;++h<i;){g.push(b=[]);for(var j=this[h],k=-1,l=j.length;++k<l;)(d=j[k])&&(c=a.call(d,d.__data__,k,h))?("__data__"in d&&(c.__data__=d.__data__),_f(c,k,f,e,d[f][e]),b.push(c)):b.push(null)}return Xf(g,f,e)},Oi.selectAll=function(a){var b,c,d,e,f,g=this.id,h=this.namespace,i=[];a=D(a);for(var j=-1,k=this.length;++j<k;)for(var l=this[j],m=-1,n=l.length;++m<n;)if(d=l[m]){f=d[h][g],c=a.call(d,d.__data__,m,j),i.push(b=[]);for(var o=-1,p=c.length;++o<p;)(e=c[o])&&_f(e,o,h,g,f),b.push(e)}return Xf(i,h,g)},Oi.filter=function(a){var b,c,d,e=[];"function"!=typeof a&&(a=P(a));for(var f=0,g=this.length;f<g;f++){e.push(b=[]);for(var c=this[f],h=0,i=c.length;h<i;h++)(d=c[h])&&a.call(d,d.__data__,h,f)&&b.push(d)}return Xf(e,this.namespace,this.id)},Oi.tween=function(a,b){var c=this.id,d=this.namespace;return arguments.length<2?this.node()[d][c].tween.get(a):R(this,null==b?function(b){b[d][c].tween.remove(a)}:function(e){e[d][c].tween.set(a,b)})},Oi.attr=function(a,b){function c(){this.removeAttribute(h)}function d(){this.removeAttributeNS(h.space,h.local)}function e(a){return null==a?c:(a+="",function(){var b,c=this.getAttribute(h);return c!==a&&(b=g(c,a),function(a){this.setAttribute(h,b(a))})})}function f(a){return null==a?d:(a+="",function(){var b,c=this.getAttributeNS(h.space,h.local);return c!==a&&(b=g(c,a),function(a){this.setAttributeNS(h.space,h.local,b(a))})})}if(arguments.length<2){for(b in a)this.attr(b,a[b]);return this}var g="transform"==a?Ud:sd,h=hg.ns.qualify(a);return Yf(this,"attr."+a,b,h.local?f:e)},Oi.attrTween=function(a,b){function c(a,c){var d=b.call(this,a,c,this.getAttribute(e));return d&&function(a){this.setAttribute(e,d(a))}}function d(a,c){var d=b.call(this,a,c,this.getAttributeNS(e.space,e.local));return d&&function(a){this.setAttributeNS(e.space,e.local,d(a))}}var e=hg.ns.qualify(a);return this.tween("attr."+a,e.local?d:c)},Oi.style=function(a,c,d){function e(){this.style.removeProperty(a)}function f(c){return null==c?e:(c+="",function(){var e,f=b(this).getComputedStyle(this,null).getPropertyValue(a);return f!==c&&(e=sd(f,c),function(b){this.style.setProperty(a,e(b),d)})})}var g=arguments.length;if(g<3){if("string"!=typeof a){g<2&&(c="");for(d in a)this.style(d,a[d],c);return this}d=""}return Yf(this,"style."+a,c,f)},Oi.styleTween=function(a,c,d){function e(e,f){var g=c.call(this,e,f,b(this).getComputedStyle(this,null).getPropertyValue(a));return g&&function(b){this.style.setProperty(a,g(b),d)}}return arguments.length<3&&(d=""),this.tween("style."+a,e)},Oi.text=function(a){return Yf(this,"text",a,Zf)},Oi.remove=function(){var a=this.namespace;return this.each("end.transition",function(){var b;this[a].count<2&&(b=this.parentNode)&&b.removeChild(this)})},Oi.ease=function(a){var b=this.id,c=this.namespace;return arguments.length<1?this.node()[c][b].ease:("function"!=typeof a&&(a=hg.ease.apply(hg,arguments)),R(this,function(d){d[c][b].ease=a}))},Oi.delay=function(a){var b=this.id,c=this.namespace;return arguments.length<1?this.node()[c][b].delay:R(this,"function"==typeof a?function(d,e,f){d[c][b].delay=+a.call(d,d.__data__,e,f)}:(a=+a,function(d){d[c][b].delay=a}))},Oi.duration=function(a){var b=this.id,c=this.namespace;return arguments.length<1?this.node()[c][b].duration:R(this,"function"==typeof a?function(d,e,f){d[c][b].duration=Math.max(1,a.call(d,d.__data__,e,f))}:(a=Math.max(1,a),function(d){d[c][b].duration=a}))},Oi.each=function(a,b){var c=this.id,d=this.namespace;if(arguments.length<2){var e=Mi,f=Li;try{Li=c,R(this,function(b,e,f){Mi=b[d][c],a.call(b,b.__data__,e,f)})}finally{Mi=e,Li=f}}else R(this,function(e){var f=e[d][c];(f.event||(f.event=hg.dispatch("start","end","interrupt"))).on(a,b)});return this},Oi.transition=function(){for(var a,b,c,d,e=this.id,f=++Pi,g=this.namespace,h=[],i=0,j=this.length;i<j;i++){h.push(a=[]);for(var b=this[i],k=0,l=b.length;k<l;k++)(c=b[k])&&(d=c[g][e],_f(c,k,g,f,{time:d.time,ease:d.ease,delay:d.delay+d.duration,duration:d.duration})),a.push(c)}return Xf(h,g,f)},hg.svg.axis=function(){function a(a){a.each(function(){var a,j=hg.select(this),k=this.__chart__||c,l=this.__chart__=c.copy(),m=null==i?l.ticks?l.ticks.apply(l,h):l.domain():i,n=null==b?l.tickFormat?l.tickFormat.apply(l,h):s:b,o=j.selectAll(".tick").data(m,l),p=o.enter().insert("g",".domain").attr("class","tick").style("opacity",Ig),q=hg.transition(o.exit()).style("opacity",Ig).remove(),r=hg.transition(o.order()).style("opacity",1),t=Math.max(e,0)+g,u=Re(l),v=j.selectAll(".domain").data([0]),w=(v.enter().append("path").attr("class","domain"),hg.transition(v));p.append("line"),p.append("text");var x,y,z,A,B=p.select("line"),C=r.select("line"),D=o.select("text").text(n),E=p.select("text"),F=r.select("text"),G="top"===d||"left"===d?-1:1;if("bottom"===d||"top"===d?(a=ag,x="x",z="y",y="x2",A="y2",D.attr("dy",G<0?"0em":".71em").style("text-anchor","middle"),w.attr("d","M"+u[0]+","+G*f+"V0H"+u[1]+"V"+G*f)):(a=bg,x="y",z="x",y="y2",A="x2",D.attr("dy",".32em").style("text-anchor",G<0?"end":"start"),w.attr("d","M"+G*f+","+u[0]+"H0V"+u[1]+"H"+G*f)),B.attr(A,G*e),E.attr(z,G*t),C.attr(y,0).attr(A,G*e),F.attr(x,0).attr(z,G*t),l.rangeBand){var H=l,I=H.rangeBand()/2;k=l=function(a){return H(a)+I}}else k.rangeBand?k=l:q.call(a,l,k);p.call(a,k,l),r.call(a,l,l)})}var b,c=hg.scale.linear(),d=Qi,e=6,f=6,g=3,h=[10],i=null;return a.scale=function(b){return arguments.length?(c=b,a):c},a.orient=function(b){return arguments.length?(d=b in Ri?b+"":Qi,a):d},a.ticks=function(){return arguments.length?(h=jg(arguments),a):h},a.tickValues=function(b){return arguments.length?(i=b,a):i},a.tickFormat=function(c){return arguments.length?(b=c,a):b},a.tickSize=function(b){var c=arguments.length;return c?(e=+b,f=+arguments[c-1],a):e},a.innerTickSize=function(b){return arguments.length?(e=+b,a):e},a.outerTickSize=function(b){return arguments.length?(f=+b,a):f},a.tickPadding=function(b){return arguments.length?(g=+b,a):g},a.tickSubdivide=function(){return arguments.length&&a},a};var Qi="bottom",Ri={top:1,right:1,bottom:1,left:1};hg.svg.brush=function(){function a(b){b.each(function(){var b=hg.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",f).on("touchstart.brush",f),g=b.selectAll(".background").data([0]);g.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),b.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var h=b.selectAll(".resize").data(p,s);h.exit().remove(),h.enter().append("g").attr("class",function(a){return"resize "+a}).style("cursor",function(a){return Si[a]}).append("rect").attr("x",function(a){return/[ew]$/.test(a)?-3:null}).attr("y",function(a){return/^[ns]/.test(a)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),h.style("display",a.empty()?"none":null);var i,l=hg.transition(b),m=hg.transition(g);j&&(i=Re(j),m.attr("x",i[0]).attr("width",i[1]-i[0]),d(l)),k&&(i=Re(k),m.attr("y",i[0]).attr("height",i[1]-i[0]),e(l)),c(l)})}function c(a){a.selectAll(".resize").attr("transform",function(a){return"translate("+l[+/e$/.test(a)]+","+m[+/^s/.test(a)]+")"})}function d(a){a.select(".extent").attr("x",l[0]),a.selectAll(".extent,.n>rect,.s>rect").attr("width",l[1]-l[0])}function e(a){a.select(".extent").attr("y",m[0]),a.selectAll(".extent,.e>rect,.w>rect").attr("height",m[1]-m[0])}function f(){function f(){32==hg.event.keyCode&&(D||(t=null,F[0]-=l[1],F[1]-=m[1],D=2),y())}function p(){32==hg.event.keyCode&&2==D&&(F[0]+=l[1],F[1]+=m[1],D=0,y())}function q(){var a=hg.mouse(v),b=!1;u&&(a[0]+=u[0],a[1]+=u[1]),D||(hg.event.altKey?(t||(t=[(l[0]+l[1])/2,(m[0]+m[1])/2]),F[0]=l[+(a[0]<t[0])],F[1]=m[+(a[1]<t[1])]):t=null),B&&r(a,j,0)&&(d(z),b=!0),C&&r(a,k,1)&&(e(z),b=!0),b&&(c(z),x({type:"brush",mode:D?"move":"resize"}))}function r(a,b,c){var d,e,f=Re(b),i=f[0],j=f[1],k=F[c],p=c?m:l,q=p[1]-p[0];if(D&&(i-=k,j-=q+k),d=(c?o:n)?Math.max(i,Math.min(j,a[c])):a[c],D?e=(d+=k)+q:(t&&(k=Math.max(i,Math.min(j,2*t[c]-d))),k<d?(e=d,d=k):e=k),p[0]!=d||p[1]!=e)return c?h=null:g=null,p[0]=d,p[1]=e,!0}function s(){q(),z.style("pointer-events","all").selectAll(".resize").style("display",a.empty()?"none":null),hg.select("body").style("cursor",null),G.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),E(),x({type:"brushend"})}var t,u,v=this,w=hg.select(hg.event.target),x=i.of(v,arguments),z=hg.select(v),A=w.datum(),B=!/^(n|s)$/.test(A)&&j,C=!/^(e|w)$/.test(A)&&k,D=w.classed("extent"),E=X(v),F=hg.mouse(v),G=hg.select(b(v)).on("keydown.brush",f).on("keyup.brush",p);if(hg.event.changedTouches?G.on("touchmove.brush",q).on("touchend.brush",s):G.on("mousemove.brush",q).on("mouseup.brush",s),z.interrupt().selectAll("*").interrupt(),D)F[0]=l[0]-F[0],F[1]=m[0]-F[1];else if(A){var H=+/w$/.test(A),I=+/^n/.test(A);u=[l[1-H]-F[0],m[1-I]-F[1]],F[0]=l[H],F[1]=m[I]}else hg.event.altKey&&(t=F.slice());z.style("pointer-events","none").selectAll(".resize").style("display",null),hg.select("body").style("cursor",w.style("cursor")),x({type:"brushstart"}),q()}var g,h,i=A(a,"brushstart","brush","brushend"),j=null,k=null,l=[0,0],m=[0,0],n=!0,o=!0,p=Ti[0];return a.event=function(a){a.each(function(){var a=i.of(this,arguments),b={x:l,y:m,i:g,j:h},c=this.__chart__||b;this.__chart__=b,Li?hg.select(this).transition().each("start.brush",function(){g=c.i,h=c.j,l=c.x,m=c.y,a({type:"brushstart"})}).tween("brush:brush",function(){var c=td(l,b.x),d=td(m,b.y);return g=h=null,function(e){l=b.x=c(e),m=b.y=d(e),a({type:"brush",mode:"resize"})}}).each("end.brush",function(){g=b.i,h=b.j,a({type:"brush",mode:"resize"}),a({type:"brushend"})}):(a({type:"brushstart"}),a({type:"brush",mode:"resize"}),a({type:"brushend"}))})},a.x=function(b){return arguments.length?(j=b,p=Ti[!j<<1|!k],a):j},a.y=function(b){return arguments.length?(k=b,p=Ti[!j<<1|!k],a):k},a.clamp=function(b){return arguments.length?(j&&k?(n=!!b[0],o=!!b[1]):j?n=!!b:k&&(o=!!b),a):j&&k?[n,o]:j?n:k?o:null},a.extent=function(b){var c,d,e,f,i;return arguments.length?(j&&(c=b[0],d=b[1],k&&(c=c[0],d=d[0]),g=[c,d],j.invert&&(c=j(c),d=j(d)),d<c&&(i=c,c=d,d=i),c==l[0]&&d==l[1]||(l=[c,d])),k&&(e=b[0],f=b[1],j&&(e=e[1],f=f[1]),h=[e,f],k.invert&&(e=k(e),f=k(f)),f<e&&(i=e,e=f,f=i),e==m[0]&&f==m[1]||(m=[e,f])),a):(j&&(g?(c=g[0],d=g[1]):(c=l[0],d=l[1],j.invert&&(c=j.invert(c),d=j.invert(d)),d<c&&(i=c,c=d,d=i))),k&&(h?(e=h[0],f=h[1]):(e=m[0],f=m[1],k.invert&&(e=k.invert(e),f=k.invert(f)),f<e&&(i=e,e=f,f=i))),j&&k?[[c,e],[d,f]]:j?[c,d]:k&&[e,f])},a.clear=function(){return a.empty()||(l=[0,0],m=[0,0],g=h=null),a},a.empty=function(){return!!j&&l[0]==l[1]||!!k&&m[0]==m[1]},hg.rebind(a,i,"on")};var Si={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Ti=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Ui=lh.format=rh.timeFormat,Vi=Ui.utc,Wi=Vi("%Y-%m-%dT%H:%M:%S.%LZ");Ui.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?cg:Wi,cg.parse=function(a){var b=new Date(a);return isNaN(b)?null:b},cg.toString=Wi.toString,lh.second=Oa(function(a){return new mh(1e3*Math.floor(a/1e3))},function(a,b){a.setTime(a.getTime()+1e3*Math.floor(b))},function(a){return a.getSeconds()}),lh.seconds=lh.second.range,lh.seconds.utc=lh.second.utc.range,lh.minute=Oa(function(a){return new mh(6e4*Math.floor(a/6e4))},function(a,b){a.setTime(a.getTime()+6e4*Math.floor(b))},function(a){return a.getMinutes()}),lh.minutes=lh.minute.range,lh.minutes.utc=lh.minute.utc.range,lh.hour=Oa(function(a){var b=a.getTimezoneOffset()/60;return new mh(36e5*(Math.floor(a/36e5-b)+b))},function(a,b){a.setTime(a.getTime()+36e5*Math.floor(b))},function(a){return a.getHours()}),lh.hours=lh.hour.range,lh.hours.utc=lh.hour.utc.range,lh.month=Oa(function(a){return a=lh.day(a),a.setDate(1),a},function(a,b){a.setMonth(a.getMonth()+b)},function(a){return a.getMonth()}),lh.months=lh.month.range,lh.months.utc=lh.month.utc.range;var Xi=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Yi=[[lh.second,1],[lh.second,5],[lh.second,15],[lh.second,30],[lh.minute,1],[lh.minute,5],[lh.minute,15],[lh.minute,30],[lh.hour,1],[lh.hour,3],[lh.hour,6],[lh.hour,12],[lh.day,1],[lh.day,2],[lh.week,1],[lh.month,1],[lh.month,3],[lh.year,1]],Zi=Ui.multi([[".%L",function(a){return a.getMilliseconds()}],[":%S",function(a){return a.getSeconds()}],["%I:%M",function(a){return a.getMinutes()}],["%I %p",function(a){return a.getHours()}],["%a %d",function(a){return a.getDay()&&1!=a.getDate()}],["%b %d",function(a){return 1!=a.getDate()}],["%B",function(a){return a.getMonth()}],["%Y",Db]]),$i={range:function(a,b,c){return hg.range(Math.ceil(a/c)*c,+b,c).map(eg)},floor:s,ceil:s};Yi.year=lh.year,lh.scale=function(){return dg(hg.scale.linear(),Yi,Zi)};var _i=Yi.map(function(a){return[a[0].utc,a[1]]}),aj=Vi.multi([[".%L",function(a){return a.getUTCMilliseconds()}],[":%S",function(a){return a.getUTCSeconds()}],["%I:%M",function(a){return a.getUTCMinutes()}],["%I %p",function(a){return a.getUTCHours()}],["%a %d",function(a){return a.getUTCDay()&&1!=a.getUTCDate()}],["%b %d",function(a){return 1!=a.getUTCDate()}],["%B",function(a){return a.getUTCMonth()}],["%Y",Db]]);_i.year=lh.year.utc,lh.scale.utc=function(){return dg(hg.scale.linear(),_i,aj)},hg.text=Ba(function(a){return a.responseText}),hg.json=function(a,b){return Ca(a,"application/json",fg,b)},hg.html=function(a,b){return Ca(a,"text/html",gg,b)},hg.xml=Ba(function(a){return a.responseXML}),"function"==typeof define&&define.amd?(this.d3=hg,define(hg)):"object"==typeof module&&module.exports?module.exports=hg:this.d3=hg}(),function(){function a(a){return function(){if("touchstart"===d3.event.type){M=b(d3.event),Q=O=M.pageX,R=P=M.pageY,N=!0;var c=d3.event;setTimeout(function(){Q!==O||N||R!==P||(d3.event=c,a.apply(this,arguments))},200)}"touchend"===d3.event.type&&N&&(N=!1),"touchmove"===d3.event.type&&N&&(M=b(d3.event),O=M.pageX,P=M.pageY)}}function b(a){return a.touches?a.touches[0]:a}function c(a){return a[0]}function d(a){return a[1]}function e(a){return a[2]}function f(){return!0}function g(){return 0}function h(a){return a[0]}function i(a){return a[1]}function j(a){return a[2]}function k(a){return a[3]}function l(){return!0}function m(a,b,c,d){return"M"+a+","+c+"L"+b+","+c+"L"+b+","+d+"L"+a+","+d+"Z"}function n(){return 64}function o(){return"circle"}function p(a){return a[0]}function q(a){return a[1]}function r(a){return!0}function s(a){return a[0]}function t(a){return a[1]}function u(a){return a[2]}function v(a){return a[3]}function w(){return!1}function z(){return!0}function A(a,b,c,d,e){var f;return e?(f=c+(d-c)/2,"M"+a+","+c+"L"+a+","+d+"M"+a+","+f+"L"+b+","+f+"M"+b+","+c+"L"+b+","+d):(f=a+(b-a)/2,"M"+a+","+c+"L"+b+","+c+"M"+f+","+c+"L"+f+","+d+"M"+a+","+d+"L"+b+","+d)}function B(a){return!0}function C(a){return a[0]}function D(a){return a[1]}function E(a,b){for(var c=d3.max([a.length,b.length]),d="M",e=0;e<c;e++)e>0&&(d+="L"),d+=e<a.length?a[e]:"0",d+=",",d+=e<b.length?b[e]:"0";return d+="Z"}function F(){}function G(a){function b(){for(var b,d=c,e=-1,f=d.length;++e<f;)(b=d[e].on)&&b.apply(this,arguments);return a}var c=[],d=new d3.map;return b.on=function(b,e){var f,g=d.get(b);return arguments.length<2?g&&g.on:(g&&(g.on=null,c=c.slice(0,f=c.indexOf(g)).concat(c.slice(f+1)),d.remove(b)),e&&c.push(d.set(b,{on:e})),a)},b}function H(a){for(var b=new F,c=0,d=arguments.length;++c<d;)b[arguments[c]]=G(b);return b.of=function(c,d){return function(e){var f;try{f=e.sourceEvent=d3.event,e.target=a,d3.event=e,b[e.type].apply(c,d)}finally{d3.event=f}}},b}function I(){d3.event.stopPropagation(),d3.event.preventDefault()}var J=d3.selection.prototype,K=J.on,L={tap:[["touchstart","touchend","touchmove"],a]},M=null,N=!1,O=0,P=0,Q=0,R=0;J.on=function(a,b,c){var d=a.split("."),e=d.shift(),f=L[e];if(f){var g=f[0],h=this;return b=f[1].call(null,b),g.forEach(function(a,e){var f=[a,d].join(".");K.call(h,f,b,c)}),K}return K.apply(this,arguments)},dv=function(){},dv.version="3.2.0",dv.ANIMATION=!0,dv.setVisibilityForeground=function(a){return a.classed({visibilityForeground:!0,visibilityWaning:!1,visibilityHidden:!1})},dv.setVisibilityWaning=function(a){return a.classed({visibilityForeground:!1,visibilityWaning:!0,visibilityHidden:!1})},dv.setVisibilityHidden=function(a){return a.classed({visibilityForeground:!1,visibilityWaning:!1,visibilityHidden:!0})};var S=!1,T=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;dv.extend=function(a){function b(){if(!S){S=!0;var a=new arguments.callee;return S=!1,a.init.apply(a,arguments),a}}var c=this.prototype;S=!0;var d=new this;a=a(),a.init=a,S=!1;for(var e in a)d[e]="function"==typeof a[e]&&"function"==typeof c[e]&&T.test(a[e])?function(a,b){return function(){var d=this._super;this._super=c[a];var e=b.apply(this,arguments);return this._super=d,e}}(e,a[e]):a[e];return b.prototype=d,b.mixin=function(a,b){dv.util.isObject(a)?dv.util.each(a,function(a,c){d[c]=b}):d[a]=b},b.extend=arguments.callee,b},dv.DEFAULT_COLORS=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],dv.DEFAULT_CATEGORICAL_AES=["color","fill","stroke","shape","size","linetype"],dv.absoluteCoordinates=function(a,b,c){if(a.coord()instanceof dv.coord.polar){var d=a.coord().flip()?c.yOuterScale():c.xOuterScale(),e=a.coord().flip()?c.xOuterScale():c.yOuterScale(),f=dv.util.scaleRangeNoReverse(d),g=dv.util.scaleRangeNoReverse(e);b[0]+=(f[0]+f[1])/2,b[1]+=(g[0]+g[1])/2}return b},dv.showTooltip=function(a,b,c,d,e,f){var g=f.selectAll(".dv-tooltip").data([a]);a.cx=a.cx||a.x+a.width/2,a.cy=a.cy||a.y+a.height/2,a.dx=a.dx||a.x+a.width,a.dy=a.dy||a.y+a.height,b.dx=b.dx||b.x+b.width,b.dy=b.dy||b.y+b.height;var h=g.enter().append("div").classed("dv-tooltip",!0).style("top",0).style("left",0);h.append("div").classed("content",!0),h.append("b").classed("notch",!0),g.select(".content").html(c);var i=g.select(".notch"),j=g.node(),k=Math.min(j.offsetWidth,b.width),l=Math.min(j.offsetHeight,b.height),m=0,n=0,o=function(a,b,c){return Math.min(Math.max(b,a),c)};switch(d){case"left":n=a.x-k-e,m=a.cy-l/2,n<b.x&&(n=a.dx+e,d="right"),m<b.y&&(m=b.y),m+l>b.dy&&(m=b.dy-l),i.style("top",o(a.cy-m-5,3,l-13)+"px"),i.style("left",null);break;case"right":n=a.x+a.width+e,m=a.cy-l/2,n+k>b.dx&&(n=a.x-k-e,d="left"),m<b.y&&(m=b.y),m+l>b.dy&&(m=b.dy-l),i.style("top",o(a.cy-m-5,3,l-13)+"px"),i.style("left",null);break;case"top":n=a.cx-k/2,m=a.y-l-e,m<b.y&&(m=a.dy+e,d="bottom"),n<b.x&&(n=b.x),n+k>b.dx&&(n=b.dx-k),i.style("left",o(a.cx-n-5,3,k-13)+"px"),i.style("top",null);break;case"bottom":n=a.cx-k/2,m=a.dy+e,m+l>b.dy&&(m=a.y-l-e,d="top"),n<b.x&&(n=b.x),n+k>b.dx&&(n=b.dx-k),i.style("left",o(a.cx-n-5,3,k-13)+"px"),i.style("top",null);break;default:d=null}m=Math.round(m),n=Math.round(n),g.classed("top right left bottom hide",!1).classed(d,!0),h.style("top",m+"px").style("left",n+"px"),g.style("top",m+"px").style("left",n+"px")},dv.removeTooltip=function(a){a.selectAll(".dv-tooltip").classed("hide",!0)},dv.cancelEvent=function(a){a.stopPropagation(),a.preventDefault()},dv.windowDimensions=function(){var a={width:640,height:480};return document.body&&document.body.offsetWidth&&(a.width=document.body.offsetWidth,a.height=document.body.offsetHeight),"CSS1Compat"==document.compatMode&&document.documentElement&&document.documentElement.offsetWidth&&(a.width=document.documentElement.offsetWidth,a.height=document.documentElement.offsetHeight),window.innerWidth&&window.innerHeight&&(a.width=window.innerWidth,a.height=window.innerHeight),a},dv.addWindowResizeHandler=function(a){window.addEventListener("resize",a)},dv.removeWindowResizeHandler=function(a){window.removeEventListener("resize",a)},dv.passiveListenerOption=function(){try{var a={passive:!0};return document.addEventListener("null",null,a),a}catch(b){return!1}}(),dv.scale=dv.extend(function(){function a(a){this._d3Scale=a,this._reverse=!1,this._parse=dv.util.identity,this._includeInDomain=function(){return!0}}return a._mapToD3Scale=function(a){return this._d3Scale(a)},a.trainingProperties=function(a){return arguments.length?(dv.util.isValidValue(a,["isUndefined","isArray"])||dv.log.error({msg:"The supplied properties is not an array",data:{range:a}}),this._trainingProperties=a,this):this._trainingProperties?this._trainingProperties:this._property?[this._property]:void 0},a.trainDomain=function(a,b){var c=this.calculateDomain(a,b);return this.domain(c),c},a.parse=function(a){return arguments.length?(this._parse=a,this):this._parse},a.applyRangePadding=function(){},a.validateDomain=function(){},a.mapToProp=function(a){var b=a[this.property()],c=this;return dv.util.isArray(b)?dv.util.map(b,function(a){return c._mapToD3Scale.call(c,a)}):this._mapToD3Scale.call(this,b)},a.mapPropToPercent=function(a){return this.mapValueToPercent(this.mapToProp(a))},a.mapValueToPercent=function(a){var b=dv.util.scaleRange(this),c=b[1]-b[0];return dv.util.isArray(a)?dv.util.map(a,function(a){return c?(a-b[0])/c:0}):c?(a-b[0])/c:0},a.mapValue=function(a){if(dv.util.isArray(a)){var b=this;return dv.util.map(a,function(a){return b._mapToD3Scale.call(b,a)})}return this._mapToD3Scale.call(this,a)},a.invertValue=function(a){return this._d3Scale.invert(a)},a.rangeBand=function(a){return 0},a.reverse=function(a){return arguments.length?(this._reverse=a,this):this._reverse},a.property=function(a){return arguments.length?(this._property=a,this):this._property},a.mapping=function(a){return arguments.length?(this._mapping=a,this):this._mapping},a.domain=function(a){return arguments.length?this._d3Scale?(this._d3Scale.domain(a),this):this:this._d3Scale.domain()},a.hasSameDomain=function(a){var b=!0,c=this.domain();if(c.length!=a.length)b=!1;else for(var d=0;d<a.length;d++)if(a[d]!=c[d]){b=!1;break}return b},a.range=function(a){
return arguments.length?this._d3Scale?(dv.util.isValidValue(a,["isArray"])||dv.log.error({msg:"The supplied range is not an array",data:{range:a}}),this._d3Scale.range(a),this):this:this._d3Scale.range()},a.expand=function(a){return arguments.length?(this._expand=a,this):this._expand},a.limits=function(a){return arguments.length?(this._limits=a,this):this._limits},a.breaks=function(a){return arguments.length?(this._breaks=a,this):this._breaks},a.orientation=function(a){return arguments.length?(this._orientation=a,this):this._orientation},a.includeInDomain=function(a){return arguments.length?(this._includeInDomain=a,this):this._includeInDomain},a.scaleIndex=function(a){return arguments.length?(this._scaleIndex=a,this):this._scaleIndex},a._copy=function(){dv.log.error({msg:"A copy function was not specified for the scale subclass."})},a.copy=a._copy,a.isDefault=function(a){return arguments.length?(this._isDefault=a,this):this._isDefault},a}),dv.scale.constant=dv.scale.extend(function(){function a(){this._super(null)}return a.trainDomain=function(a){},a.map=function(a){return this._value},a.mapToProp=function(a){return this._value},a.value=function(a){return arguments.length?(this._value=a,this):this._value},a._copy=function(a){var b=this.trainingProperties();return dv.util.isUndefined(b)||(b=b.slice(0)),dv.scale.constant().isDefault(this.isDefault()).value(this.value()).property(this.property()).trainingProperties(b).scaleIndex(this._scaleIndex)},a.copy=a._copy,a}),dv.scale.continuous=dv.scale.extend(function(){function a(a){this._super(a?a:d3.scale.linear()),this.to=this.range,this._parse=function(a){if(null!=a)return parseFloat(a)}}return a.calculateDomain=function(a,b){var c,d,e=[],f=this;this.trainingProperties()||this.trainingProperties([this.property()]);var g=this.trainingProperties();b||(b={}),a||(a=[]);for(var h=0;h<g.length;h++)for(var i=g[h],j=0;j<a.length;j++)if(!b.filter||!b.filter.call(this,a[j].key))for(var k=a[j].values,l=0;l<k.length;l++){var m=k[l];if(this._includeInDomain(m,l)){0!==this.scaleIndex()&&(m[this.property()+"-index"]=this.scaleIndex());var n=b.stack?m.y0:m[i];dv.util.isArray(n)||(n=this._parse.call(this,n));var o=dv.util.isArray(n)?d3.min(n):n;if(c=dv.util.isUndefined(c)||isNaN(c)||o<c?o:c,b.stack){var p=m[i];n+=dv.util.isArray(p)?d3.max(p):f._parse.call(this,p)}var q=dv.util.isArray(n)?d3.max(n):n;d=dv.util.isUndefined(d)||isNaN(d)||q>d?q:d}}return isNaN(c)&&isNaN(d)?(e=[],this._naturalDomain=[]):(e=[c,d],this._naturalDomain=[c,d]),b.fill&&(e=[0,100]),dv.util.isUndefined(this._upperLimit)||dv.util.isFunction(this._upperLimit)||dv.util.isUndefined(this._lowerLimit)||dv.util.isFunction(this._lowerLimit)?this._reconcileLimits(e):e=this.limits(),e},a.unionDomain=function(a,b){a&&a instanceof dv.scale.continuous||dv.log.error({msg:"The supplied scale is not continuous.",data:{scale:a,isReversed:b}});var c=a.domain(),d=a.naturalDomain(),e=this.domain()?d3.extent(this.domain().concat(c)):d3.extent(c),f=this._naturalDomain?d3.extent(this._naturalDomain.concat(d)):d3.extent(d);return isNaN(e[0])&&isNaN(e[1])&&(e=[]),isNaN(f[0]&&isNaN(f[1]))&&(f=[]),this.reverse(b||this._reverse),this.domain(e),this._naturalDomain=f,this},a.validateDomain=function(){var a=this.domain();a&&a.length||this.domain([0,1])},a.unionRange=function(a){return dv.util.isValidValue(a,["isArray"])||dv.log.error({msg:"The supplied range is not an array",data:{range:a}}),this.range(this.range()?d3.extent(this.range().concat(a)):a),this},a.applyRangePadding=function(){var a=this.domain(),b=this.range();if(this._lowerRangePadding){var c=b[0]-b[1],d=Math.min(Math.abs(c)-1,this._lowerRangePadding);a[0]=this.invertValue(c/(Math.abs(c)-d)*d+b[0])}if(this._upperRangePadding){var e=b[1]-b[0],f=Math.min(Math.abs(e)-1,this._upperRangePadding);a[1]=this.invertValue(e/(Math.abs(e)-f)*f+b[1])}return this.domain(a),this},a.upperLimit=function(a){return arguments.length?(dv.util.isValidValue(a,["isUndefined","isFinite","isDate","isFunction"])?this._upperLimit=a:dv.log.error({msg:"Invalid value, cannot set upperLimit with: "+a}),this):this._upperLimit},a.lowerLimit=function(a){return arguments.length?(dv.util.isValidValue(a,["isUndefined","isFinite","isDate","isFunction"])?this._lowerLimit=a:dv.log.error({msg:"Invalid value, cannot set lowerLimit with: "+a}),this):this._lowerLimit},a.limits=function(a){return arguments.length?(a&&2==a.length||dv.log.error({msg:"Incorrect number of arguments, the limits function must supply an array containing both a lower and upper limit"}),this.lowerLimit(a[0]),this.upperLimit(a[1]),this):[this._lowerLimit,this._upperLimit]},a.naturalDomain=function(){return this._naturalDomain},a.upperRangePadding=function(a){return arguments.length?(dv.util.isValidValue(a,["isUndefined","isFinite","isDate","isFunction"])?this._upperRangePadding=a:dv.log.error({msg:"Invalid value, cannot set upperRangePadding with: "+a}),this):this._upperRangePadding},a.lowerRangePadding=function(a){return arguments.length?(dv.util.isValidValue(a,["isUndefined","isFinite","isDate","isFunction"])?this._lowerRangePadding=a:dv.log.error({msg:"Invalid value, cannot set lowerRangePadding with: "+a}),this):this._lowerRangePadding},a.rangePadding=function(a){return arguments.length?(a&&2==a.length||dv.log.error({msg:"Incorrect number of arguments, the limits function must supply an array containing both a lower and upper limit"}),this.lowerRangePadding(a[0]),this.upperRangePadding(a[1]),this):[this._lowerRangePadding,this._upperRangePadding]},a.softLowerLimit=function(a){return arguments.length?(this._softLowerLimit=a,this):this._softLowerLimit},a._reconcileLimits=function(a){a.length&&(dv.util.isUndefined(this._softLowerLimit)||(a[0]=Math.min(a[0],this._softLowerLimit),a[1]=Math.max(a[1],this._softLowerLimit)),dv.util.isUndefined(this._lowerLimit)||(a[0]=dv.util.isFunction(this._lowerLimit)?this._lowerLimit(a[0],a[1]):this._lowerLimit),dv.util.isUndefined(this._upperLimit)||(a[1]=dv.util.isFunction(this._upperLimit)?this._upperLimit(a[0],a[1]):this._upperLimit))},a.labels=function(a){return arguments.length?(this._labels=a,this):this._labels},a._copy=function(){var a=this.domain().slice(0),b=this.trainingProperties();dv.util.isUndefined(b)||(b=b.slice(0));var c=dv.scale.continuous().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).reverse(this.reverse()).domain(a).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).trainingProperties(b).scaleIndex(this._scaleIndex);return c._naturalDomain=this._naturalDomain,c},a.invert=function(a){return this._d3Scale.invert(a[this.mapping()])},a.invertFromProp=function(a){return this._d3Scale.invert(a[this.property()])},a.copy=a._copy,a}),dv.scale.linear=dv.scale.continuous.extend(function(){function a(){this._super(d3.scale.linear())}return a._copy=function(){var a=this.domain().slice(0),b=this.trainingProperties();dv.util.isUndefined(b)||(b=b.slice(0));var c=dv.scale.linear().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(a).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(b).scaleIndex(this._scaleIndex);return c._naturalDomain=this._naturalDomain,c},a.copy=a._copy,a}),dv.scale.gradient=dv.scale.continuous.extend(function(){function a(){this._super(d3.scale.linear()),this._innerScale=d3.scale.linear().range([0,1]),this.colors=this.range,this._controlPoints=["0%","50%","100%"],this.colors(["#FA5A50","#E1E1E1","#5FAF69"])}return a._adjustOuterDomain=function(){var a=this;this._d3Scale.domain(dv.util.map(this._controlPoints,function(b,c){return dv.util.isPercentString(b)?a._innerScale.invert(parseInt(b,10)/100):b}))},a.controlPoints=function(a){return arguments.length?(this._controlPoints=a,this._adjustOuterDomain(),this):this._controlPoints},a.domain=function(a){return arguments.length?this._innerScale?(this._innerScale.domain(a),this._adjustOuterDomain(),this):this:this._innerScale.domain()},a._copy=function(){var a=this.domain().slice(0),b=this.trainingProperties();dv.util.isUndefined(b)||(b=b.slice(0));var c=dv.scale.gradient().property(this.property()).mapping(this.mapping()).domain(a).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).includeInDomain(this.includeInDomain()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).controlPoints(this.controlPoints()).reverse(this.reverse()).trainingProperties(b).scaleIndex(this._scaleIndex);return c._naturalDomain=this._naturalDomain,c},a.copy=a._copy,a}),dv.scale.time=dv.scale.continuous.extend(function(){function a(){this._super(d3.time.scale()),this._parse=function(a){return a instanceof Date?a:new Date(Date.parse(a))}}return a._copy=function(){var a=this.domain().slice(0),b=this.trainingProperties();dv.util.isUndefined(b)||(b=b.slice(0));var c=dv.scale.time().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(a).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(b).scaleIndex(this._scaleIndex);return c._naturalDomain=this._naturalDomain,c},a.copy=a._copy,a._reconcileLimits=function(a,b,c){dv.util.isUndefined(this._softLowerLimit)||(a[0]=Math.min(a[0],this._softLowerLimit),a[1]=Math.max(a[1],this._softLowerLimit)),dv.util.isUndefined(this._lowerLimit)||(a[0]=dv.util.isFunction(this._lowerLimit)?this._parse(this._lowerLimit(new Date(b),new Date(c))):this._lowerLimit),dv.util.isUndefined(this._upperLimit)||(a[1]=dv.util.isFunction(this._upperLimit)?this._parse(this._upperLimit(new Date(b),new Date(c))):this._upperLimit)},a}),dv.scale.time.utc=dv.scale.continuous.extend(function(){function a(){this._super(d3.time.scale.utc()),this._parse=function(a){return a instanceof Date?a:new Date(Date.parse(a))}}return a._copy=function(){var a=this.domain().slice(0),b=this.trainingProperties();dv.util.isUndefined(b)||(b=b.slice(0));var c=dv.scale.time.utc().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(a).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(b).scaleIndex(this._scaleIndex);return c._naturalDomain=this._naturalDomain,c},a.copy=a._copy,a._reconcileLimits=function(a,b,c){dv.util.isUndefined(this._softLowerLimit)||(a[0]=Math.min(a[0],this._softLowerLimit),a[1]=Math.max(a[1],this._softLowerLimit)),dv.util.isUndefined(this._lowerLimit)||(a[0]=dv.util.isFunction(this._lowerLimit)?this._parse(this._lowerLimit(new Date(b),new Date(c))):this._lowerLimit),dv.util.isUndefined(this._upperLimit)||(a[1]=dv.util.isFunction(this._upperLimit)?this._parse(this._upperLimit(new Date(b),new Date(c))):this._upperLimit)},a}),dv.scale.ordinal=dv.scale.extend(function(){function a(){this._super(d3.scale.ordinal()),this._defaultPadding=.1,this._defaultOuterPadding=0,this._rangeExtent=[],this._rangeBandsSet=!1}return a._mapToD3Scale=function(a){for(var b=this.domain(),c=-1,d=b.length,e=-1;++c<d;){var f=b[c];if(f===a||dv.util.isDate(f)&&dv.util.isDate(a)&&f.getTime()===a.getTime()){e=c;break}}return e<0?void 0:this._d3Scale(a)},a.calculateDomain=function(a,b){var c={},d=[],e=this.trainingProperties();b=b||{};for(var f=0;f<e.length;f++)for(var g=e[f],h=0;h<a.length;h++){var i=a[h].values;if(!b.filter||!b.filter.call(this,a[h].key))for(var j=0;j<i.length;j++){var k=i[j];if(this._includeInDomain(k,j)){0!==this.scaleIndex()&&(k[this.property()+"-index"]=this.scaleIndex());var l=this._parse.call(this,k[g]);dv.util.isUndefined(l)||c.hasOwnProperty(l)||(c[l]=l,d.push(l))}}}return d.length?d:[]},a.unionDomain=function(a,b){a&&a instanceof dv.scale.ordinal||dv.log.error({msg:"The supplied scale is not ordinal.",data:{scale:a,isReversed:b}});var c=a.domain();if(c&&!dv.util.isArray(c))throw new Error("The supplied domain is not an array");return c&&(this.reverse(b||this._reverse),this.domain(this.domain()?dv.util.union(this.domain(),c):c)),this},a.unionRange=function(a){if(a&&!dv.util.isArray(a))throw new Error("The supplied range is not an array");return a&&this.range(this.range()?dv.util.union(this.range(),a):a),this},a.invertValue=function(a){var b=this.range().indexOf(a),c=this.domain();if(b<0)throw new Error("The supplied value does not exist in the specified range.");return c[b%c.length]},a.padding=function(a){return arguments.length?(this._padding=a,this._rangeBandsSet&&this._d3Scale.rangeBands(this.rangeExtent(),this._padding,this.outerPadding()),this):dv.util.isUndefined(this._padding)?this._defaultPadding:this._padding},a.outerPadding=function(a){return arguments.length?(this._outerPadding=a,this._rangeBandsSet&&this._d3Scale.rangeBands(this.rangeExtent(),this.padding(),this._outerPadding),this):dv.util.isUndefined(this._outerPadding)?dv.util.isUndefined(this._padding)?this._defaultOuterPadding:this.padding():this._outerPadding},a.rangeBands=function(a){return arguments.length?(this._rangeBandsSet=!0,this._d3Scale.rangeBands(a,this.padding(),this.outerPadding()),this.rangeExtent(a),this):this._d3Scale.range()},a.rangeBand=function(){return this._d3Scale.rangeBand()},a.range=function(a){return arguments.length?this._d3Scale?(dv.util.isValidValue(a,["isArray"])||dv.log.error({msg:"The supplied range is not an array",data:{range:a}}),this._d3Scale.range(a),this.rangeExtent([a[0],a[a.length-1]]),this):this:this._d3Scale.range()},a.rangeExtent=function(a){return arguments.length?(dv.util.isValidValue(a,["isArray"])||dv.log.error({msg:"The supplied range extent is not an array",data:{range:a}}),this._rangeExtent=a,this):this._rangeExtent},a.values=function(a){return arguments.length?(dv.util.isValidValue(a,["isArray"])||dv.log.error({msg:"The supplied values is not an array",data:{range:a}}),this.range(a)):this._d3Scale.range()},a.drop=function(a){return arguments.length?(this._drop=a,this):this._drop},a._copy=function(){var a=this.domain().slice(0),b=this.trainingProperties();dv.util.isUndefined(b)||(b=b.slice(0));var c=dv.scale.ordinal().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(a).includeInDomain(this.includeInDomain()).range(this.range().slice(0)).rangeExtent(this.rangeExtent().slice(0)).reverse(this.reverse()).padding(this._padding).outerPadding(this._outerPadding).trainingProperties(b).scaleIndex(this._scaleIndex);return this._rangeBandsSet&&c.rangeBands(this.rangeExtent().slice(0)),c},a.copy=a._copy,a}),dv.scale.color=dv.scale.ordinal.extend(function(){function a(){this._super(),this.range(b)}var b=["#8CC350","#5A6EAA","#D755A5","#1EBED7","#F0A01E","#9B8CE6","#3CB5A0","#3287D2","#F0557D","#C3D250","#EB782D","#78B4F5","#5FAF69","#AA5FA5","#FA5A50","#F5C841"];return a._copy=function(){var a=this.domain().slice(0),b=this.trainingProperties();dv.util.isUndefined(b)||(b=b.slice(0));var c=dv.scale.ordinal().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(a).range(this.range()).rangeExtent(this.rangeExtent()).includeInDomain(this.includeInDomain()).reverse(this.reverse()).padding(this._padding).outerPadding(this._outerPadding).trainingProperties(b).scaleIndex(this._scaleIndex);return this._rangeBandsSet&&c.rangeBands(this.rangeExtent().slice(0)).padding(this._padding).outerPadding(this._outerPadding),c},a.copy=a._copy,a}),dv.scale.shape=dv.scale.ordinal.extend(function(){function a(){this._super(),this.range(b)}var b=["circle","cross","diamond","square","triangle-down","triangle-up"];return a._copy=function(){var a=this.domain().slice(0),b=this.trainingProperties();dv.util.isUndefined(b)||(b=b.slice(0));var c=dv.scale.ordinal().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(a).includeInDomain(this.includeInDomain()).range(this.range().slice(0)).rangeExtent(this.rangeExtent().slice(0)).reverse(this.reverse()).padding(this._padding).outerPadding(this._outerPadding).trainingProperties(b).scaleIndex(this._scaleIndex);return this._rangeBandsSet&&c.rangeBands(this.rangeExtent().slice(0)).padding(this._padding).outerPadding(this._outerPadding),c},a.copy=a._copy,a}),dv.scale.linetype=dv.scale.ordinal.extend(function(){function a(){this._super(),this.range(b)}var b=["solid","dashed","dotted","dotdash","longdash","twodash"];return a._copy=function(){var a=this.domain().slice(0),b=this.trainingProperties();dv.util.isUndefined(b)||(b=b.slice(0));var c=dv.scale.ordinal().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(a).includeInDomain(this.includeInDomain()).range(this.range().slice(0)).rangeExtent(this.rangeExtent().slice(0)).reverse(this.reverse()).padding(this._padding).outerPadding(this._outerPadding).trainingProperties(b).scaleIndex(this._scaleIndex);return this._rangeBandsSet&&c.rangeBands(this.rangeExtent().slice(0)).padding(this._padding).outerPadding(this._outerPadding),c},a.copy=a._copy,a}),dv.scale.size=dv.scale.continuous.extend(function(){function a(){this._super(),this.to([2,10])}return a._copy=function(){var a=this.domain().slice(0),b=this.trainingProperties();dv.util.isUndefined(b)||(b=b.slice(0));var c=dv.scale.size().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(a).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(b).scaleIndex(this._scaleIndex);return c._naturalDomain=this._naturalDomain,c},a.copy=a._copy,a}),dv.scale.identity=dv.scale.ordinal.extend(function(){function a(a){this._super(d3.scale.ordinal())}return a.mapToProp=function(a){return a[this.property()]},a.domain=function(a){return arguments.length?this._d3Scale?(this._d3Scale.domain(a),this._d3Scale.range(a),this):this:this._d3Scale.domain()},a.range=function(){return arguments.length?this:this._d3Scale.range()},a.labels=function(a){return arguments.length?(this._labels=a,this):this._labels},a._copy=function(){var a=this.domain().slice(0),b=this.trainingProperties();return dv.util.isUndefined(b)||(b=b.slice(0)),dv.scale.identity().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(a).includeInDomain(this.includeInDomain()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(b).scaleIndex(this._scaleIndex)},a.copy=a._copy,a}),dv.scale.log=dv.scale.continuous.extend(function(){function a(){this._super(d3.scale.log())}return a._copy=function(){var a=this.domain().slice(0),b=this.trainingProperties();dv.util.isUndefined(b)||(b=b.slice(0));var c=dv.scale.log().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(a).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(b).scaleIndex(this._scaleIndex);return c._naturalDomain=this._naturalDomain,c},a.domain=function(a){if(a){var b=d3.extent(a);if(b[0]<=0&&b[1]>=0)throw new Error('Data mapped to the logarithmic "'+this.property()+'" property must be entirely positive or entirely negative. The data values cannot cross zero.')}return this._super.apply(this,arguments)},a.copy=a._copy,a}),dv.svg=dv.svg||{},dv.svg.text=function(){function a(a){return a.select(function(a,b){return j.call(this,a,b)?this:null}).attr("x",function(a,c){return b.call(this,a,c)}).attr("y",function(a,b){return h.call(this,a,b)}).text(function(a,b){return i.call(this,a,b)})}var b=c,h=d,i=e,j=f,k=g;return a.x=function(c){return arguments.length?(b=c,a):b},a.y=function(b){return arguments.length?(h=b,a):h},a.label=function(b){return arguments.length?(i=b,a):i},a.defined=function(b){return arguments.length?(j=b,a):j},a.duration=function(b){return arguments.length?(k=b,a):k},a},dv.svg.text.radial=function(){function a(a){var c=function(a,c){return b.call(this,a,c)+X},d=function(a,b){return h.call(this,a,b)};return a.select(function(a,b){return j.call(this,a,b)?this:null}).attr("x",function(a,b){return d(a,b)*Math.cos(c(a,b))}).attr("y",function(a,b){return d(a,b)*Math.sin(c(a,b))}).text(function(a,b){return i.call(this,a,b)})}var b=c,h=d,i=e,j=f,k=g;return a.angle=function(c){return arguments.length?(b=c,a):b},a.radius=function(b){return arguments.length?(h=b,a):h},a.label=function(b){return arguments.length?(i=b,a):i},a.defined=function(b){return arguments.length?(j=b,a):j},a.duration=function(b){return arguments.length?(k=b,a):k},a},dv.svg.rect=function(){function a(a,g){return f.call(this,a,g)?m(b.call(this,a,g),c.call(this,a,g),d.call(this,a,g),e.call(this,a,g)):null}var b=h,c=i,d=j,e=k,f=l;return a.x0=function(c){return arguments.length?(b=c,a):b},a.x1=function(b){return arguments.length?(c=b,a):c},a.y0=function(b){return arguments.length?(d=b,a):d},a.y1=function(b){return arguments.length?(e=b,a):e},a.defined=function(b){return arguments.length?(f=b,a):f},a},dv.svg.symbol=function(){function a(a,g){return f.call(this,a,g)?(U[b.call(this,a,g)]||U.circle)(c.call(this,a,g),d.call(this,a,g),e.call(this,a,g)):null}var b=o,c=n,d=p,e=q,f=r;return a.x=function(b){return arguments.length?(d=b,a):d},a.y=function(b){return arguments.length?(e=b,a):e},a.type=function(c){return arguments.length?(b=d3.functor(c),a):b},a.size=function(b){return arguments.length?(c=d3.functor(b),a):c},a.defined=function(b){return arguments.length?(f=b,a):f},a},dv.svg.symbol.radial=function(){function a(a,g){if(f.call(this,a,g)){var h=d.call(this,a,g)+X,i=e.call(this,a,g),j=i*Math.cos(h),k=i*Math.sin(h);return(U[b.call(this,a,g)]||U.circle)(c.call(this,a,g),j,k)}return null}var b=o,c=n,d=p,e=q,f=r;return a.angle=function(b){return arguments.length?(d=b,a):d},a.radius=function(b){return arguments.length?(e=b,a):e},a.type=function(c){return arguments.length?(b=d3.functor(c),a):b},a.size=function(b){return arguments.length?(c=d3.functor(b),a):c},a.defined=function(b){return arguments.length?(f=b,a):f},a},d3.svg.symbolTypes=d3.keys(U);var U={circle:function(a,b,c){var d=Math.sqrt(a/Math.PI);return"M"+b+","+(c+d)+"A"+d+","+d+" 0 1,1 "+b+","+(c-d)+"A"+d+","+d+" 0 1,1 "+b+","+(c+d)+"Z"},cross:function(a,b,c){var d=Math.sqrt(a/5)/2;return"M"+(b+-3*d)+","+(c-d)+"H"+(b-d)+"V"+(c+-3*d)+"H"+(b+d)+"V"+(c-d)+"H"+(b+3*d)+"V"+(c+d)+"H"+(b+d)+"V"+(c+3*d)+"H"+(b-d)+"V"+(c+d)+"H"+(b-3*d)+"Z"},diamond:function(a,b,c){var d=Math.sqrt(a/(2*W)),e=d*W;return"M"+b+","+(c-d)+"L"+(b+e)+","+c+" "+b+","+(c+d)+" "+(b-e)+","+c+"Z"},square:function(a,b,c){var d=Math.sqrt(a)/2;return"M"+(b-d)+","+(c-d)+"L"+(b+d)+","+(c-d)+" "+(b+d)+","+(c+d)+" "+(b-d)+","+(c+d)+"Z"},"triangle-down":function(a,b,c){var d=Math.sqrt(a/V),e=d*V/2;return"M"+b+","+(c+e)+"L"+(b+d)+","+(c-e)+" "+(b-d)+","+(c-e)+"Z"},"triangle-up":function(a,b,c){var d=Math.sqrt(a/V),e=d*V/2;return"M"+b+","+(c-e)+"L"+(b+d)+","+(c+e)+" "+(b-d)+","+(c+e)+"Z"}};dv.svg.errorBar=function(){function a(a,h){return g.call(this,a,h)?A(b.call(this,a,h),c.call(this,a,h),d.call(this,a,h),e.call(this,a,h),f.call(this,a,h)):null}var b=s,c=t,d=u,e=v,f=w,g=z;return a.x0=function(c){return arguments.length?(b=c,a):b},a.x1=function(b){return arguments.length?(c=b,a):c},a.y0=function(b){return arguments.length?(d=b,a):d},a.y1=function(b){return arguments.length?(e=b,a):e},a.flip=function(b){return arguments.length?(f=b,a):f},a.defined=function(b){return arguments.length?(g=b,a):g},a};var V=Math.sqrt(3),W=Math.tan(30*Math.PI/180),X=-Math.PI/2;dv.svg.poly=function(){function a(a,e){return b.call(this,a,e)?E(c.call(this,a,e),d.call(this,a,e)):null}var b=B,c=C,d=D;return a.xs=function(b){return arguments.length?(c=b,a):c},a.ys=function(b){return arguments.length?(d=b,a):d},a.defined=function(a){return arguments.length?b=a:b},a},dv.svg.poly.radial=function(){function a(a,e){if(b.call(this,a,e)){for(var f=c.call(this,a,e),g=d.call(this,a,e),h=d3.max([f.length,g.length]),i="M",j=0;j<h;j++){j>0&&(i+="L");var k=f[j]+X,l=g[j],m=l*Math.cos(k),n=l*Math.sin(k);i+=j<f.length?m:"0",i+=",",i+=j<g.length?n:"0"}return i+="Z"}return null}var b=B,c=C,d=D;return a.angles=function(b){return arguments.length?(c=b,a):c},a.radii=function(b){return arguments.length?(d=b,a):d},a.defined=function(a){return arguments.length?b=a:b},a},dv.util={},dv.util.filterAndZip=function(a,b,c){var d=[],e=[];if(b)d=a[b];else for(var f in a){d=a[f];break}for(var g=-1,h=d.length;++g<h;){var i=d[g];if(!c||i==c){var j={};for(var k in a)if("data"===k){j[k]={};for(var l in a[k])j[k][l]=a[k][l][g]}else j[k]=a[k][g];e.push(j)}}return e},dv.util.binaryCompare=function(a,b,c,d,e){var f=d;for(arguments.length<4&&(f=0),arguments.length<5&&(e=a.length);f<e;){var g=f+e>>1;b<c(a[g])?e=g:f=g+1}return f==d||Math.abs(c(a[f])-b)<Math.abs(c(a[f-1])-b)?f:f-1},dv.util.uniqueValues=function(a,b){var c=[];return dv.util.each(a,function(d,e){for(var f=-1,g=c.length,h=!1;++f<g;){var i=c[f];if(b(d,i)){h=!0;break}}h||c.push(a[f])}),c},dv.util.scaleRange=function(a,b){return 1===arguments.length?a.rangeExtent?a.rangeExtent():a.range():(a.rangeExtent?a.rangeBands(b):a.range(b),a)},dv.util.minRangeDistance=function(a,b){var c,d,e=Number.MAX_VALUE;return dv.util.each(b,function(b){dv.util.each(b.values,function(b){c=b.panel.xScale(b).mapValue(b[a]),dv.util.isUndefined(d)||(e=Math.min(e,Math.abs(c-d))),d=c})}),e},dv.util.scaleRangeNoReverse=function(a){return a.rangeExtent?a.rangeExtent():dv.util.scaleExtent(a.range())},dv.util.scaleExtent=function(a){var b=a[0],c=a[a.length-1];return b<c?[b,c]:[c,b]},dv.util.merge=function(a,b){var c,d={};for(c in a)d[c]=a[c];for(c in b)d[c]=b[c];return d},dv.util.getPercentValue=function(a,b){return dv.util.isPercentString(a)?b*parseInt(a,10)/100:a},dv.util.isPercentString=function(a){return"string"==typeof a&&/^(-?[0-9]+)%$/.test(a)},dv.util.isValidValue=function(a,b){for(var c=0;c<b.length;c++)if(dv.util[b[c]](a))return!0;return!1},dv.util.identity=function(a){return a},dv.util.clamp=function(a,b,c){return Math.min(Math.max(a,b),c)},dv.util.clone=function(a){return dv.util.isObject(a)?dv.util.isArray(a)?a.slice():dv.util.extend({},a):a},dv.util.isArray=function(a){return Array.isArray?Array.isArray(a):"[object Array]"==Object.prototype.toString.call(a)},dv.util.isObject=function(a){return a===Object(a)},dv.util.isFunction=function(a){return"[object Function]"==Object.prototype.toString.call(a)},dv.util.isUndefined=function(a){return void 0===a},dv.util.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},dv.util.isDate=function(a){return a instanceof Date},dv.util.isEmpty=function(a){return 0===Object.keys(a).length},dv.util.extend=function(a){return dv.util.each(Array.prototype.slice.call(arguments,1),function(b){for(var c in b)a[c]=b[c]}),a},dv.util.each=function(a,b,c){if(null!=a)if(Array.prototype.forEach&&a.forEach===Array.prototype.forEach)a.forEach(b,c);else if(a.length===+a.length){for(var d=0,e=a.length;d<e;d++)if(b.call(c,a[d],d,a)==={})return}else for(var f in a)if(dv.util.has(a,f)&&b.call(c,a[f],f,a)==={})return},dv.util.has=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},dv.util.uniq=function(a,b,c,d){dv.util.isFunction(b)&&(d=c,c=b,b=!1);var e=c?dv.util.map(a,c,d):a,f=[],g=[];return dv.util.each(e,function(c,d){(b?d&&g[g.length-1]===c:dv.util.contains(g,c))||(g.push(c),f.push(a[d]))}),f},dv.util.union=function(){return dv.util.uniq(Array.prototype.concat.apply(Array.prototype,arguments))},dv.util.contains=function(a,b){return null!=a&&(Array.prototype.indexOf&&a.indexOf===Array.prototype.indexOf?a.indexOf(b)!=-1:dv.util.any(a,function(a){return a===b}))},dv.util.any=function(a,b,c){b||(b=dv.util.identity);var d=!1;return null==a?d:Array.prototype.some&&a.some===Array.prototype.some?a.some(b,c):void dv.util.each(a,function(a,e,f){if(d||(d=b.call(c,a,e,f)))return{}})},dv.util.sortBy=function(a,b,c){var d=function(a){return dv.util.isFunction(a)?a:function(b){return b[a]}},e=d(b);return dv.util.pluck(dv.util.map(a,function(a,b,d){return{value:a,index:b,criteria:e.call(c,a,b,d)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(c<d||void 0===d)return-1}return a.index<b.index?-1:1}),"value")},dv.util.pluck=function(a,b){return dv.util.map(a,function(a){return a[b]})},dv.util.map=function(a,b,c){var d=[];return null===a?d:Array.prototype.map&&a.map===Array.prototype.map?a.map(b,c):(dv.util.each(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),d)},dv.util.reduce=function(a,b,c,d){var e=arguments.length>2;if(null===a&&(a=[]),Array.prototype.reduce&&a.reduce===Array.prototype.reduce)return d&&(b=dv.util.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(dv.util.each(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError("Reduce of empty array with no initial value");return c},dv.util.bind=function(a,b){if(a.bind===Function.prototype.bind&&Function.prototype.bind)return Function.prototype.bind.apply(a,Array.prototype.slice.call(arguments,1));var c=Array.prototype.slice.call(arguments,2);return function(){return a.apply(b,c.concat(Array.prototype.slice.call(arguments)))}},dv.util.noop=function(){},dv.util.each(["Arguments","String","Number","RegExp"],function(a){dv.util["is"+a]=function(b){return toString.call(b)=="[object "+a+"]"}}),dv.util.validateParam=function(a,b,c,d){if("isString"===b)return dv.util.isString(a)&&dv.util.isArray(c)&&c.indexOf(a.toLowerCase())!==-1?a.toLowerCase():d;if("isNumber"===b)return dv.util.isNumber(a)&&dv.util.isArray(c)&&a<=c[1]&&a>=c[0]?a:d;if("isFunction"===b)return dv.util.isFunction(a)?a:d;if("isDimension"===b)return"x"===a||"X"===a?"x":"y"===a||"Y"===a?"y":a===["x","y"]||a===["X","y"]||a===["x","Y"]||a===["X","Y"]?["x","y"]:d;if("isRange"===b){var e=c[0],f=c[1];return dv.util.isArray(a)&&2===a.length?(dv.util.isNumber(a[0])&&dv.util.isNumber(a[1])&&(e=Math.max(Math.min(a[0],a[1]),c[0]),f=Math.min(Math.max(a[0],a[1]),c[1])),[e,f]):d}},dv.util.selectModifiers={toggle:1,set:2,range:4},dv.util.defaultSelectionKeymap=function(a){var b=0;return b|=a.metaKey?dv.util.selectModifiers.toggle:0,b|=a.ctrlKey?dv.util.selectModifiers.toggle:0,b|=a.shiftKey?dv.util.selectModifiers.range:0,b|=a.altKey?dv.util.selectModifiers.set:0},dv.util.determineKeyModifiers=function(a,b){for(var c=a;c.sourceEvent;)c=c.sourceEvent;return b?b(c):dv.util.defaultSelectionKeymap(c)},dv.util.arraysEqual=function(a,b){if(a.length!=b.length)return!1;for(var c=0,d=a.length;c<d;c++)if(b.indexOf(a[c])===-1)return!1;return!0},dv.util.selectJoin=function(a,b){a.classed("joinme",!0),b.classed("joinme",!0);var c=d3.selectAll(".joinme");return a.classed("joinme",!1),b.classed("joinme",!1),c},dv.util.selectXOR=function(a,b){var c=selectANotB(a,b),d=selectANotB(b,a);return join(c,d)},dv.util.selectIntersection=function(a,b){return a.filter(function(){var a=this,c=0;return b.each(function(){this===a&&(c=1)}),c})},dv.util.selectANotB=function(a,b){return a.filter(function(){var a=this,c=1;return b.each(function(){this===a&&(c=0)}),c})},dv.util.SelectionCache=function(){this._lastSelected=null,this._dispatch=d3.dispatch("selectionChanged"),
this._selectionScope=d3,this._keymap=dv.util.defaultSelectionKeymap},dv.util.SelectionCache.prototype.selectionKeymap=function(a){return a&&(this._keymap=a),this._keymap},dv.util.SelectionCache.prototype.selectionScope=function(a){if(!a)return this._selectionScope;if(!a.selectAll)throw new TypeError("sel argument does not appear to support d3 selection.");this._selectionScope=a},dv.util.SelectionCache.prototype.currentSelection=function(){return this._selectionScope.selectAll("."+this.selectedClass)},dv.util.SelectionCache.prototype.selectedClass="selected",dv.util.SelectionCache.prototype.selectableClass="selectable",dv.util.SelectionCache.prototype.markSelectable=function(a){a.classed(this.selectableClass,!0)},dv.util.SelectionCache.prototype.selectSelectableCandidates=function(){this._selectionScope.selectAll("."+this.selectableClass)},dv.util.SelectionCache.prototype._onSelectionChanged=function(a,b,c){c.classed(this.selectedClass,!1),b.classed(this.selectedClass,!0);var d=null;b.each(function(a){d=this}),this._lastSelected=d,this._dispatch.selectionChanged.call(this,d,this.currentSelection(),b,c)},dv.util.SelectionCache.prototype.on=function(a,b){return this._dispatch.on(a,b),this},dv.util.SelectionCache.prototype.selectionToggle=function(a){if(!a||a.empty())return this;if(this.currentSelection().empty())return this.selectionSet(a);var b=[],c=[];a.each(function(a){a.selected?(a.selected=!1,b.push(this)):(a.selected=!0,c.push(this))});var d=d3.selectAll(c),e=d3.selectAll(b);return this._onSelectionChanged(this,d,e),this},dv.util.SelectionCache.prototype.selectionSet=function(a){var b=this,c=this.currentSelection(),d=null;return d=c.empty()?d3.selectAll([]):c,d.each(function(a){a.selected=!1}),a.each(function(a){a.selected=!0}),b._onSelectionChanged(b,a,d),b},dv.util.SelectionCache.prototype.selectionAdd=function(a){var b=this;if(!a||a.empty())return b;var c=this.currentSelection();if(c.empty())return b.selectionSet(a);var d=[];return c.each(function(a){d.push(this)}),a.each(function(a){a.selected=!0,d.push(this)}),d3.selectAll(d),b._onSelectionChanged(b,a,d3.selectAll([])),b},dv.util.SelectionCache.prototype.selectionRemove=function(a){var b=this;return!a||a.empty()?b:(a.each(function(a){a.selected=!1}),b._onSelectionChanged(b,d3.selectAll([]),a),b)},dv.util.SelectionCache.prototype.savePreviousState=function(a){var b=function(a){a.previouslySelected=a.selected};if(a)a.each(b);else{this.selectSelectableCandidates().each(b)}return this},dv.util.SelectionCache.prototype.brush=function(a){function b(a){return a.selected=a.previouslySelected,a.selected}function c(a){return a.selected=!1,a.selected}function d(a){return a.selected=!0,!0}function e(a){return a.selected=!a.previouslySelected,a.selected}var f=this,g=[],h=[],i=dv.util.determineKeyModifiers(d3.event,f._keymap),j=this.currentSelection(),k=dv.util.selectANotB(j,a),l=this._selectionScope.select(".brushed"),m=dv.util.selectANotB(l,a),n=d,o=b;i&dv.util.selectModifiers.toggle&&(n=e),i&dv.util.selectModifiers.set&&(o=c),a.each(function(a){a.selected!=n(a)&&(a.selected?h.push(this):g.push(this))}),k.each(function(a){a.selected!=o(a)&&(a.selected?h.push(this):g.push(this))}),m.each(function(a){a.selected!=o(a)&&(a.selected?h.push(this):g.push(this))}),a.classed("brushed",!0),m.classed("brushed",!1);var p=d3.selectAll(g),q=d3.selectAll(h);return f._onSelectionChanged(f,q,p),f},dv.util.SelectionCache.prototype.setDeselector=function(a){var b=this;return a.on("click.selection",function(){dv.util.determineKeyModifiers(d3.event,b._keymap)&&b.selectionSet(d3.selectAll([]))}),this},dv.util=dv.util||{},dv.util.svg={},dv.util.svg.getDasharray=function(a){if(a.indexOf(",")!=-1||a.indexOf(" ")!=-1)return a;if(Y.hasOwnProperty(a))return Y[a];throw new Error("The dashed line format is invalid")};var Y={solid:"",dashed:"7,4",dotted:"2,3",dotdash:"2,3,7,4",longdash:"11,4",twodash:"5,2,11,2"};dv.container=dv.extend(function(){function a(){this._aes={}}var b={x:dv.scale.linear,y:dv.scale.linear,yMin:dv.scale.linear,yMax:dv.scale.linear,xMin:dv.scale.linear,xMax:dv.scale.linear,color:dv.scale.color,fill:dv.scale.color,stroke:dv.scale.color,alpha:dv.scale.linear,shape:dv.scale.shape,size:dv.scale.size,radius:dv.scale.linear,group:dv.scale.ordinal,linetype:dv.scale.linetype,label:dv.scale.identity};return a.render=function(){throw new Error("render() must be implemented in a subclass")},a._calculateStats=function(){throw new Error("_calculateStats() must be implemented in a subclass")},a._handlePositions=function(){throw new Error("_handlePositions() must be implemented in a subclass")},a.getTrainedScale=function(a){throw new Error("getTrainedScale() must be implemented in a subclass")},a.getExplicitScalesMap=function(){return this._aes},a._normalizeData=function(a){if(a.hasOwnProperty("data")&&!dv.util.isArray(a.data))return a;var b,c={},d=this.getExplicitScalesMap();return dv.util.each(d,function(d,e){for(var f in d)if(!((b=d[f])instanceof dv.scale.constant)){var g=a[b.mapping()];if(dv.util.isArray(g)){var h=g.map(function(a){return dv.util.isArray(a)?a.map(function(a){return b._parse(a)}):b._parse(a)});c[b.property()]=h}}}),c.data=a,c},a.map=function(a,c,d,e){if(d||(d=b[a]().copy().isDefault(!0)),!d)throw new Error("There is no default scale associated with this property. Either the property isn't valid or the scale default doesn't exist.");return arguments.length<4&&(e=0),this._aes[a]||(this._aes[a]={}),this._aes[a][e]=d.property(a).mapping(c).scaleIndex(e),this},a.set=function(a,b){this._aes[a]||(this._aes[a]={});var c=this._aes[a][0]=dv.scale.constant();return dv.util.isFunction(b)?c.map=c.mapToProp=b:c.value(b),this},a.on=function(a,b,c){return arguments.length<3&&(c=!1),b&&dv.util.isFunction(b)?(this.eventMap=this.eventMap||{},this.eventMap[a]={callback:b,capture:c}):(this.eventMap&&delete this.eventMap[a],this.unregisterEventMap=this.unregisterEventMap||{},this.unregisterEventMap[a]=c),this._removeRegisteredEvents(),this._addRegisteredEvents(),this},a.position=function(a){return arguments.length?(this._position=a,this):this._chart&&!this._position?this._chart.position():this._position},a.delay=function(a){return arguments.length?(this._delay=d3.functor(a),this):this._chart&&dv.util.isUndefined(this._delay)?this._chart.delay():this._delay},a.duration=function(a){return arguments.length?(this._duration=d3.functor(a),this):this._chart&&dv.util.isUndefined(this._duration)?this._chart.duration():this._duration},a.ease=function(a){return arguments.length?(this._ease=a,this):this._chart&&dv.util.isUndefined(this._ease)?this._chart.ease():this._ease},a}),dv.coord=dv.extend(function(){function a(){this._flip=!1}return a.flip=function(a){return arguments.length?(this._flip=a,this):this._flip},a.startX=function(a){return arguments.length?(dv.util.isValidValue(a,["isFinite","isPercentString"])||dv.log.error({msg:"Invalid value type, startX/startAngle must be a number or percent string",data:{val:a}}),this._startX=a,this):this._startX},a.endX=function(a){return arguments.length?(dv.util.isValidValue(a,["isFinite","isPercentString"])||dv.log.error({msg:"Invalid value type, endX/endAngle must be a number or percent string",data:{val:a}}),this._endX=a,this):this._endX},a.startY=function(a){return arguments.length?(dv.util.isValidValue(a,["isFinite","isPercentString"])||dv.log.error({msg:"Invalid value type, startY/innerRadius must be a number or percent string",data:{val:a}}),this._startY=a,this):this._startY},a.endY=function(a){return arguments.length?(dv.util.isValidValue(a,["isFinite","isPercentString"])||dv.log.error({msg:"Invalid value type, endY/outerRadius must be a number or percent string",data:{val:a}}),this._endY=a,this):this._endY},a}),dv.coord.cartesian=dv.coord.extend(function(){function a(){this._super(),this.startX(0),this.endX(0),this.startY(0),this.endY(0),this._type="cartesian"}return a._translatePercentToX=function(a,b){var c=dv.util.scaleRange(a),d=this._translatePercent(b,c,this.startX(),this.endX()),e=3*Math.abs(c[1]-c[0]);return dv.util.clamp(d,c[0]-e,c[1]+e)},a._translatePercentToY=function(a,b){var c=dv.util.scaleRange(a),d=this._translatePercent(b,c,this.startY(),this.endY()),e=3*Math.abs(c[1]-c[0]);return dv.util.clamp(d,c[1]-e,c[0]+e)},a._translatePercent=function(a,b,c,d){return(b[1]-b[0]-d-c)*a+c+b[0]},a._translatePercentArrToY=function(a,b){var c=this;return dv.util.map(b,function(b){return c._translatePercentToY(a,b)})},a._translatePercentArrToX=function(a,b){var c=this;return dv.util.map(b,function(b){return c._translatePercentToX(a,b)})},a._text=function(){function a(){var c=dv.svg.text();return b._flip?c.x(function(c,d){return b._translatePercentToY(c.panel.yOuterScale(),a.y()(c,d))}).y(function(c,d){return b._translatePercentToX(c.panel.xOuterScale(),a.x()(c,d))}):c.x(function(c,d){return b._translatePercentToX(c.panel.xOuterScale(),a.x()(c,d))}).y(function(c,d){return b._translatePercentToY(c.panel.yOuterScale(),a.y()(c,d))})}var b=this;return a.x=function(a){return arguments.length?(this._x=a,this):this._x},a.y=function(a){return arguments.length?(this._y=a,this):this._y},a},a._point=function(){var a=this,b={};return b.renderer=dv.svg.symbol().x(function(a,b){return a.bounds.x}).y(function(a,b){return a.bounds.y}),b.getBounds=function(c,d){return c.hasOwnProperty("y")||(c.y=0),c.hasOwnProperty("x")||(c.x=0),b._defined(c,d)?(a._flip?c.bounds={x:a._translatePercentToY(c.panel.yOuterScale(),b.y()(c,d)),y:a._translatePercentToX(c.panel.xOuterScale(),b.x()(c,d))}:c.bounds={x:a._translatePercentToX(c.panel.xOuterScale(),b.x()(c,d)),y:a._translatePercentToY(c.panel.yOuterScale(),b.y()(c,d))},c):null},b.getPath=function(a){return null===a||void 0===a.bounds?null:b.renderer(a)},b.x=function(a){return arguments.length?(this._x=a,b):this._x},b.y=function(a){return arguments.length?(this._y=a,b):this._y},b.defined=function(a){return arguments.length?(this._defined=a,this):this._defined},b},a._line=function(){var a=this,b={};return b.renderer=d3.svg.line().x(function(a,b){return a.bounds.x}).y(function(a,b){return a.bounds.y}),b.getBounds=function(c,d){var e=[];return dv.util.each(c,function(d,f){d.hasOwnProperty("y")||(d.y=0),d.hasOwnProperty("x")||(d.x=0),b._defined(d,f)&&(a._flip?d.bounds={x:a._translatePercentToY(d.panel.yOuterScale(),b.y()(d,f)),y:a._translatePercentToX(d.panel.xOuterScale(),b.x()(d,f))}:d.bounds={x:a._translatePercentToX(d.panel.xOuterScale(),b.x()(d,f)),y:a._translatePercentToY(d.panel.yOuterScale(),b.y()(d,f))},e.push(c[f]))}),e},b.getPath=function(a){return null===a?null:b.renderer(a)},b.x=function(a){return arguments.length?(dv.util.isValidValue(a,["isFunction"])||dv.log.error({msg:"Invalid value, line.x must be a function",data:{val:a}}),this._x=a,this):this._x},b.y=function(a){return arguments.length?(dv.util.isValidValue(a,["isFunction"])||dv.log.error({msg:"Invalid value, line.y must be a function",data:{val:a}}),this._y=a,this):this._y},b.defined=function(a){return arguments.length?(dv.util.isValidValue(a,["isFunction"])||dv.log.error({msg:"Invalid value, line.defined must be a function",data:{val:a}}),this._defined=a,this):this._defined},b},a._area=function(){var a=this,b={};return b.renderer=d3.svg.area(),b.getBounds=function(c,d){var e=[];return b.setupRenderer(),dv.util.each(c,function(c,d){if(c.hasOwnProperty("y")||(c.y=0),c.hasOwnProperty("x")||(c.x=0),b._defined(c,d)){var f=dv.util.clone(c);f.bounds={x:a._translatePercentToX(c.panel.xOuterScale(),b.x()(c,d)),y0:a._translatePercentToY(c.panel.yOuterScale(),b.y0()(c,d)),y1:a._translatePercentToY(c.panel.yOuterScale(),b.y1()(c,d))},e.push(f)}}),e},b.getPath=function(a){return b.setupRenderer(),null===a?null:b.renderer(a)},b.setupRenderer=function(){a._flip?b.renderer.x(null).y0(null).y1(null).y(function(a,b){return a.bounds.x}).x0(function(a,b){return a.bounds.y0}).x1(function(a,b){return a.bounds.y1}):b.renderer.y(null).x0(null).x1(null).x(function(a,b){return a.bounds.x}).y0(function(a,b){return a.bounds.y0}).y1(function(a,b){return a.bounds.y1})},b.x=function(a){return arguments.length?(dv.util.isValidValue(a,["isFunction"])||dv.log.error({msg:"Invalid value, area.x must be a function",data:{val:a}}),this._x=a,this):this._x},b.y0=function(a){return arguments.length?(dv.util.isValidValue(a,["isFunction"])||dv.log.error({msg:"Invalid value, area.y0 must be a function",data:{val:a}}),this._y0=a,this):this._y0},b.y1=function(a){return arguments.length?(dv.util.isValidValue(a,["isFunction"])||dv.log.error({msg:"Invalid value, area.y1 must be a function",data:{val:a}}),this._y1=a,this):this._y1},b.defined=function(a){return arguments.length?(dv.util.isValidValue(a,["isFunction"])||dv.log.error({msg:"Invalid value, area.defined must be a function",data:{val:a}}),this._defined=a,this):this._defined},b},a._rect=function(){var a=this,b={};return b.renderer=dv.svg.rect().x0(function(a,b){return a.bounds.x0}).x1(function(a,b){return a.bounds.x1}).y0(function(a,b){return a.bounds.y0}).y1(function(a,b){return a.bounds.y1}),b.getBounds=function(c,d){var e=dv.util.clone(c),f=e[c.panel.xScale(c).property()];dv.util.isArray(f)&&(e.x0=f[0],e.x1=f[1]);var g=e[c.panel.yScale(c).property()];return dv.util.isArray(g)&&(e.y0=g[0],e.y1=g[1]),b._defined(e,d)?(a._flip?e.bounds={x0:a._translatePercentToY(c.panel.yOuterScale(),b.y0()(e,d)),x1:a._translatePercentToY(c.panel.yOuterScale(),b.y1()(e,d)),y0:a._translatePercentToX(c.panel.xOuterScale(),b.x0()(e,d)),y1:a._translatePercentToX(c.panel.xOuterScale(),b.x1()(e,d))}:e.bounds={x0:a._translatePercentToX(c.panel.xOuterScale(),b.x0()(e,d)),x1:a._translatePercentToX(c.panel.xOuterScale(),b.x1()(e,d)),y0:a._translatePercentToY(c.panel.yOuterScale(),b.y0()(e,d)),y1:a._translatePercentToY(c.panel.yOuterScale(),b.y1()(e,d))},e):null},b.getPath=function(a){return null===a?null:b.renderer(a)},b.x0=function(a){return arguments.length?(dv.util.isValidValue(a,["isFunction"])||dv.log.error({msg:"Invalid value, line.x0 must be a function",data:{val:a}}),this._x0=a,this):this._x0},b.x1=function(a){return arguments.length?(dv.util.isValidValue(a,["isFunction"])||dv.log.error({msg:"Invalid value, line.x1 must be a function",data:{val:a}}),this._x1=a,this):this._x1},b.y0=function(a){return arguments.length?(dv.util.isValidValue(a,["isFunction"])||dv.log.error({msg:"Invalid value, line.y0 must be a function",data:{val:a}}),this._y0=a,this):this._y0},b.y1=function(a){return arguments.length?(dv.util.isValidValue(a,["isFunction"])||dv.log.error({msg:"Invalid value, line.y1 must be a function",data:{val:a}}),this._y1=a,this):this._y1},b.defined=function(a){return arguments.length?(dv.util.isValidValue(a,["isFunction"])||dv.log.error({msg:"Invalid value, line.defined must be a function",data:{val:a}}),this._defined=a,this):this._defined},b},a._errorBar=function(){var a=this,b={};return b.renderer=dv.svg.errorBar().x0(function(a,b){return a.bounds.x0}).x1(function(a,b){return a.bounds.x1}).y0(function(a,b){return a.bounds.y0}).y1(function(a,b){return a.bounds.y1}).flip(function(){return a._flip}),b.getBounds=function(c,d){var e=dv.util.clone(c);return b._defined(e,d)?(a._flip?e.bounds={x0:a._translatePercentToY(c.panel.yOuterScale(),b.y0()(e,d)),x1:a._translatePercentToY(c.panel.yOuterScale(),b.y1()(e,d)),y0:a._translatePercentToX(c.panel.xOuterScale(),b.x0()(e,d)),y1:a._translatePercentToX(c.panel.xOuterScale(),b.x1()(e,d))}:e.bounds={x0:a._translatePercentToX(c.panel.xOuterScale(),b.x0()(e,d)),x1:a._translatePercentToX(c.panel.xOuterScale(),b.x1()(e,d)),y0:a._translatePercentToY(c.panel.yOuterScale(),b.y0()(e,d)),y1:a._translatePercentToY(c.panel.yOuterScale(),b.y1()(e,d))},e):null},b.getPath=function(a){return null===a?null:b.renderer(a)},b.x0=function(a){return arguments.length?(this._x0=a,this):this._x0},b.x1=function(a){return arguments.length?(this._x1=a,this):this._x1},b.y0=function(a){return arguments.length?(this._y0=a,this):this._y0},b.y1=function(a){return arguments.length?(this._y1=a,this):this._y1},b.defined=function(a){return arguments.length?(this._defined=a,this):this._defined},b},a._poly=function(){var a=this,b={};return b.renderer=dv.svg.poly().xs(function(a,b){return a.bounds.x}).ys(function(a,b){return a.bounds.y}),b.getBounds=function(c,d){var e=dv.util.clone(c);return b._defined(c,d)&&(a._flip?e.bounds={x:a._translatePercentArrToY(c.panel.yOuterScale(),b.ys()(c,d)),y:a._translatePercentArrToX(c.panel.xOuterScale(),b.xs()(c,d))}:e.bounds={x:a._translatePercentArrToX(c.panel.xOuterScale(),b.xs()(c,d)),y:a._translatePercentArrToY(c.panel.yOuterScale(),b.ys()(c,d))}),e},b.getPath=function(a){return null===a?null:b.renderer(a)},b.xs=function(a){return arguments.length?(this._xs=a,this):this._xs},b.ys=function(a){return arguments.length?(this._ys=a,this):this._ys},b.defined=function(a){return arguments.length?(this._defined=a,this):this._defined},b},a}),dv.coord.polar=dv.coord.extend(function(){function a(){this._super(),this.innerRadius=this.startY,this.outerRadius=this.endY,this.startAngle=this.startX,this.endAngle=this.endX,this.innerRadius(0),this.outerRadius(0),this.startAngle(0),this.endAngle(360),this._type="polar"}return a._transformAngleRadiusToXY=function(a,b){return a+=-1.570796327,[b*Math.cos(a),b*Math.sin(a)]},a._translatePercentToRadius=function(a,b){var c=Math.abs(a[1]-a[0])/2,d=dv.util.getPercentValue(this.innerRadius(),c);return(c-dv.util.getPercentValue(this.outerRadius(),c)-d)*b+d},a._translatePercentToTheta=function(a,b){var c=360,d=dv.util.getPercentValue(this.startAngle(),c);return.017453293*((dv.util.getPercentValue(this.endAngle(),c)-d)*b+d)},a._translatePercentArrToRadius=function(a,b){var c=this;return dv.util.map(b,function(b){return c._translatePercentToRadius(a,b)})},a._translatePercentArrToTheta=function(a,b){var c=this;return dv.util.map(b,function(b){return c._translatePercentToTheta(a,b)})},a._getRadiusRange=function(a,b){var c=dv.util.scaleRange(a),d=dv.util.scaleRange(b);return[0,Math.min(Math.abs(c[1]-c[0]),Math.abs(d[1]-d[0]))]},a._text=function(){function a(){var c=dv.svg.text.radial();return b._flip?c.angle(function(c,d){return b._translatePercentToTheta(c.panel.yOuterScale(),a.y()(c,d))}).radius(function(c,d){return b._translatePercentToRadius(b._getRadiusRange(c.panel.xOuterScale(),c.panel.yOuterScale()),a.x()(c,d))}):c.angle(function(c,d){return b._translatePercentToTheta(c.panel.xOuterScale(),a.x()(c,d))}).radius(function(c,d){return b._translatePercentToRadius(b._getRadiusRange(c.panel.xOuterScale(),c.panel.yOuterScale()),a.y()(c,d))})}var b=this;return a.x=function(a){return arguments.length?(this._x=a,this):this._x},a.y=function(a){return arguments.length?(this._y=a,this):this._y},a},a._point=function(){var a=this,b={};return b.renderer=dv.svg.symbol.radial().angle(function(a,b){return a.bounds.x}).radius(function(a,b){return a.bounds.y}),b.getBounds=function(c,d){if(c.hasOwnProperty("y")||(c.y=0),c.hasOwnProperty("x")||(c.x=0),b._defined(c,d)){var e=a._getRadiusRange(c.panel.xOuterScale(),c.panel.yOuterScale());a._flip?c.bounds={x:a._translatePercentToTheta(c.panel.xOuterScale(),b.y()(c,d)),y:a._translatePercentToRadius(e,b.x()(c,d))}:c.bounds={x:a._translatePercentToTheta(c.panel.xOuterScale(),b.x()(c,d)),y:a._translatePercentToRadius(e,b.y()(c,d))}}return c},b.getPath=function(a){return null===a||dv.util.isUndefined(a.bounds)?null:b.renderer(a)},b.x=function(a){return arguments.length?(this._x=a,this):this._x},b.y=function(a){return arguments.length?(this._y=a,this):this._y},b.defined=function(a){return arguments.length?(this._defined=a,this):this._defined},b},a._line=function(){var a=this,b={};return b.renderer=d3.svg.line.radial().angle(function(a,b){return a.bounds.x}).radius(function(a,b){return a.bounds.y}),b.getBounds=function(c,d){var e=[];return dv.util.each(c,function(d,f){var g=a._getRadiusRange(d.panel.xOuterScale(),d.panel.yOuterScale());d.hasOwnProperty("y")||(d.y=0),d.hasOwnProperty("x")||(d.x=0),b._defined(d,f)&&(a._flip?d.bounds={x:a._translatePercentToTheta(d.panel.xOuterScale(),b.y()(d,f)),y:a._translatePercentToRadius(g,b.x()(d,f))}:d.bounds={x:a._translatePercentToTheta(d.panel.xOuterScale(),b.x()(d,f)),y:a._translatePercentToRadius(g,b.y()(d,f))},e.push(c[f]))}),e},b.getPath=function(a){return null===a?null:b.renderer(a)},b.x=function(a){return arguments.length?(this._x=a,this):this._x},b.y=function(a){return arguments.length?(this._y=a,this):this._y},b.defined=function(a){return arguments.length?(this._defined=a,this):this._defined},b},a._area=function(){var a=this,b={};return b.renderer=d3.svg.area.radial(),b.getBounds=function(c,d){var e=[];return b.setupRenderer(),dv.util.each(c,function(c,d){var f=a._getRadiusRange(c.panel.xOuterScale(),c.panel.yOuterScale());if(c.hasOwnProperty("y")||(c.y=0),c.hasOwnProperty("x")||(c.x=0),b._defined(c,d)){var g=dv.util.clone(c);a._flip?g.bounds={x:a._translatePercentToRadius(f,b.x()(c,d)),y0:a._translatePercentToTheta(c.panel.xOuterScale(),b.y0()(c,d)),y1:a._translatePercentToTheta(c.panel.xOuterScale(),b.y1()(c,d))}:g.bounds={x:a._translatePercentToTheta(c.panel.xOuterScale(),b.x()(c,d)),y0:a._translatePercentToRadius(f,b.y0()(c,d)),y1:a._translatePercentToRadius(f,b.y1()(c,d))},e.push(g)}}),e},b.getPath=function(a){return b.setupRenderer(),null===a?null:b.renderer(a)},b.setupRenderer=function(){a._flip?b.renderer.angle(null).innerRadius(null).outerRadius(null).radius(function(a,b){return a.bounds.x}).startAngle(function(a,b){return a.bounds.y0}).endAngle(function(a,b){return a.bounds.y1}):b.renderer.radius(null).startAngle(null).endAngle(null).angle(function(a,b){return a.bounds.x}).innerRadius(function(a,b){return a.bounds.y0}).outerRadius(function(a,b){return a.bounds.y1})},b.x=function(a){return arguments.length?(this._x=a,this):this._x},b.y0=function(a){return arguments.length?(this._y0=a,this):this._y0},b.y1=function(a){return arguments.length?(this._y1=a,this):this._y1},b.defined=function(a){return arguments.length?(this._defined=a,this):this._defined},b},a._rect=function(){var a=this,b={};return b.renderer=d3.svg.arc().startAngle(function(a,b){return a.bounds.x0}).endAngle(function(a,b){return a.bounds.x1}).innerRadius(function(a,b){return a.bounds.y0}).outerRadius(function(a,b){return a.bounds.y1}),b.getBounds=function(c,d){var e=dv.util.clone(c);if(!b._defined(e,d))return null;var f=a._getRadiusRange(c.panel.xOuterScale(),c.panel.yOuterScale());return a._flip?e.bounds={x0:a._translatePercentToTheta(c.panel.yOuterScale(),b.y0()(e,d)),x1:a._translatePercentToTheta(c.panel.yOuterScale(),b.y1()(e,d)),y0:a._translatePercentToRadius(f,b.x0()(e,d)),y1:a._translatePercentToRadius(f,b.x1()(e,d))}:e.bounds={x0:a._translatePercentToTheta(c.panel.xOuterScale(),b.x0()(e,d)),x1:a._translatePercentToTheta(c.panel.xOuterScale(),b.x1()(e,d)),y0:a._translatePercentToRadius(f,b.y0()(e,d)),y1:a._translatePercentToRadius(f,b.y1()(e,d))},e},b.getPath=function(a){return null===a?null:b.renderer(a)},b.x0=function(a){return arguments.length?(this._x0=a,this):this._x0},b.x1=function(a){return arguments.length?(this._x1=a,this):this._x1},b.y0=function(a){return arguments.length?(this._y0=a,this):this._y0},b.y1=function(a){return arguments.length?(this._y1=a,this):this._y1},b.defined=function(a){return arguments.length?(this._defined=a,this):this._defined},b},a._poly=function(){var a=this,b={};return b.renderer=dv.svg.poly.radial().angles(function(a,b){return a.bounds.x}).radii(function(a,b){return a.bounds.y}),b.getBounds=function(c,d){var e=dv.util.clone(c);if(b._defined(c,d)){var f=a._getRadiusRange(c.panel.xOuterScale(),c.panel.yOuterScale());a._flip?e.bounds={x:a._translatePercentArrToTheta(c.panel.xOuterScale(),b.ys()(c,d)),y:a._translatePercentArrToRadius(f,b.xs()(c,d))}:e.bounds={x:a._translatePercentArrToTheta(c.panel.xOuterScale(),b.xs()(c,d)),y:a._translatePercentArrToRadius(f,b.ys()(c,d))}}return e},b.getPath=function(a){return null===a?null:b.renderer(a)},b.xs=function(a){return arguments.length?(this._xs=a,this):this._xs},b.ys=function(a){return arguments.length?(this._ys=a,this):this._ys},b.defined=function(a){return arguments.length?(this._defined=a,this):this._defined},b},a}),dv.guide=dv.extend(function(){function a(){this._renderer=null}return a._render=function(){dv.log.warn({msg:"dv.guide._render should not be called directly, try using dv.guide.legend.render or dv.guide.axis.render"})},a._scale=function(a){return arguments.length?(this.__scale=a,this):this.__scale},a.orientation=function(a){return arguments.length?(this._orientation=a,this):this._orientation},a._parent=function(a){return arguments.length?(this.__parent=a,this):this.__parent},a.scaleIndex=function(a){return arguments.length?(this._scaleIndex=a,this):this._scaleIndex},a.title=function(a){return arguments.length?(this._title=a,this):this._title},a}),dv.guide.axes=dv.extend(function(){function a(){this._axes={},this._emptyTickFormat=function(){return""}}return a._initializeAxisRenderers=function(){this._eachAxis(function(a,b,c){if(c.hasOwnProperty("_orientation")||"x"!==a||(c._orientation="bottom"),c.hasOwnProperty("_orientation")||"y"!==a||(c._orientation="left"),this._chart._coord.flip())switch(c._orientation){case"top":c._orientation="right";break;case"right":c._orientation="top";break;case"bottom":c._orientation="left";break;case"left":c._orientation="bottom"}})},a._measure=function(a){var b=this._chart._g.select(".panels"),c=this._chart._axisLabelContainer;return this._eachAxis(function(d,e,f){var g=this._changeScaleRangeToLocal(a.getOuterScale(d));this._chart._coord instanceof dv.coord.polar||"none"===f||(f._chart(this._chart)._scale(g[e])._parent(b)._labelParent(c),a.margins(f._measure(a.margins(),a.bounds(),a)))}),this},a._getAllOrientations=function(){var a={};return this._eachAxis(function(b,c,d){a[d._orientation]=b}),a},a._render=function(a,b,c){return this._eachAxis(function(d,e,f){var g=this._changeScaleRangeToLocal(c.getOuterScale(d));this._chart._coord instanceof dv.coord.polar||"none"===f?(a.selectAll(".axis-"+d+".axis-index-"+e).transition().duration(this._chart._duration).style("opacity",0).remove(),this._chart._chartContainer.select(".axes-labels .axis-"+d+".axis-index-"+e).transition().duration(this._chart._duration).style("opacity",0).remove()):f._chart(this._chart)._parent(a)._scale(g[e])._labelParent(b)._render(a,c,c.bounds())}),this},a._measureTitles=function(a){var b=this._chart._axisLabelContainer;return this._eachAxis(function(c,d,e){if("none"!==e){var f=e._chart(this._chart)._measureAxisTitle(b,c,d,a);a.left+=f.left,a.top+=f.top,a.right-=f.right,a.bottom-=f.bottom}}),a},a._renderTitles=function(a,b){var c=this._chart._axisLabelContainer;this._eachAxis(function(d,e,f){"none"!==f&&f.title()?f._chart(this._chart)._renderAxisTitle(c,b,d,e,a):c.selectAll(".axis-title-"+d+".axis-title-index-"+e).transition().duration(this._chart._duration).style("opacity",0).remove()})},a._changeScaleRangeToLocal=function(a){var b=a.range(),c=a.innerScaleGroup();for(var d in c)dv.util.scaleRange(c[d],[b[0],b[1]]);return c},a._eachAxis=function(a){for(var b in this._axes){var c=this._axes[b];for(var d in c)a.call(this,b,+d,c[d])}},a._add=function(a,b,c){c=void 0===c?0:c;var d=this._axes[a];return d||(this._axes[a]=d={}),d[c]=b,this},a._axes=function(a){return arguments.length?(this._axes=a,this):this._axes},a._get=function(a){return this._axes[a]},a._empty=function(){for(var a in this._axes)delete this._axes[a];return this._axes={},this},a._chart=function(a){return arguments.length?(this._chart=a,this):this._chart},a}),dv.guide.axis=dv.guide.extend(function(){function a(){this._ticks=d3.functor(5),this._tickInterval=void 0,this._labelGroup=null,this._htmlLabels=!1,this._domain=null}function b(a,b){return a+"%"}function c(a,b){return"100%"}function d(a,b){return"inline"}function e(a,b){return""}function f(a,b){return""}return a._measure=function(a,b,c){var d,e=this._getAxisOffset(b),f=dv.util.scaleRange(this._scale()),g=this._ticks.call(this,Math.abs(f[1]-f[0])),h=this,i=this._parent().append("g").classed("temp-axis",!0);this._shouldDrawAxisLabels(c)&&(d=this._constructLabelGroup(this.__labelParent,e,!0));var j=this._constructD3Axis(d,b,g,c),k=this._measureAxis(i,e,j),l={left:k.x+e[0],top:k.y+e[1],right:k.x+k.width+e[0],bottom:k.y+k.height+e[1]};d&&d.selectAll("span").each(function(){var a=this,b=d3.select(this);if(h._htmlLabels?b.html():b.text()){var c="right"===h._orientation?a.offsetWidth/2:0,d="bottom"===h._orientation?a.offsetHeight/2:0,e=[a.parentNode.parentNode.offsetLeft+a.parentNode.offsetLeft+c,a.parentNode.parentNode.offsetTop+a.parentNode.offsetTop+d];l.left=Math.min(e[0],l.left),l.top=Math.min(e[1],l.top),l.right=Math.max(e[0]+c,l.right),l.bottom=Math.max(e[1]+d,l.bottom)}}),i.remove(),d&&d.remove();var m={};return m.left=Math.abs(Math.min(l.left-b.left,0)),m.top=Math.abs(Math.min(l.top-b.top,0)),m.right=Math.max(l.right-b.right,0),m.bottom=Math.max(l.bottom-b.bottom,0),this._unionAxisPadding(m,a)},a._render=function(a,b,c){if(!this._scale())throw new Error("The axis does not have a scale associated with it.");var d,e=dv.util.scaleRange(this._scale()),f=this._ticks.call(this,Math.abs(e[1]-e[0])),g=this._getAxisOffset(c);this._shouldDrawAxisLabels(b)?d=this._constructLabelGroup(this.__labelParent,g):this.__labelParent.selectAll(".axis-"+this._scale().property()+".axis-index-"+this._scale().scaleIndex()).remove();var h=this._constructD3Axis(d,c,f,b);return this._renderAxis(this._parent(),b.bounds(),g,h,d),this},a._shouldDrawAxisLabels=function(a){var b=a.facet(),c=this._scale().property(),d=this.orientation();return b._isFree(c)&&b._showAllPanelLabelsIfFree()||a.visibleAxisLabelOrientations()[d]},a._unionAxisPadding=function(a,b){return b.left=Math.max(b.left,a.left),b.top=Math.max(b.top,a.top),b.right=Math.max(b.right,a.right),b.bottom=Math.max(b.bottom,a.bottom),b},a._constructLabelGroup=function(a,b,c){var d=".axis-"+this._scale().property()+".axis-index-"+this._scale().scaleIndex()+(c?" .temp-axis":""),e=a.selectAll(d).data([0]);return e.enter().append("div").classed("axis-"+this._scale().property()+" axis-index-"+this._scale().scaleIndex(),!0).classed("temp-axis",c).style("left",b[0]+"px").style("top",b[1]+"px"),dv.ANIMATION?e.transition().delay(this._chart().delay()).duration(this._chart().duration()).ease(this._chart().ease()).style("left",b[0]+"px").style("top",b[1]+"px"):e.style("left",b[0]+"px").style("top",b[1]+"px"),e},a._getAxisOffset=function(a){switch(this._orientation){case"bottom":return[0,a.bottom];case"left":return[a.left,0];case"top":return[0,a.top];case"right":return[a.right,0]}},a._constructD3Axis=function(a,g,h,i){var j,k=this._getDefaultTickSize(g),l=dv.util.isUndefined(this._tickSize)?k:this._tickSize,m=dv.util.isUndefined(this._minorTickSize)?k:this._minorTickSize;if("left"===this._orientation&&(j="right"),"right"===this._orientation&&(j="left"),"top"===this._orientation&&(j="bottom"),"bottom"===this._orientation&&(j="top"),"x"===this._scale().property()){var n=dv.util.scaleRange(this._scale());n[0]+=this._chart().coord().startX(),n[1]-=this._chart().coord().endX(),this._scale()instanceof dv.scale.ordinal?this._scale().rangeBands(n):this._scale().range(n)}
return dv.svg.axis()._orient(j)._labelParent(a)._panel(i)._ticks(dv.util.isUndefined(h)?5:h,this._tickInterval)._tickSize(l,m,l)._defaultTickSize(k())._tickDx(dv.util.isUndefined(this._tickDx)?this._getDefaultTickDx():this._tickDx)._tickDy(dv.util.isUndefined(this._tickDy)?this._getDefaultTickDy():this._tickDy)._tickAnchor(dv.util.isUndefined(this._tickAnchor)?this._getDefaultTickAnchor():this._tickAnchor)._tickFormat(dv.util.isUndefined(this._tickFormat)&&"fill"===this._chart().position()&&"y"===this._scale().property()?b:this._tickFormat)._tickWidth(dv.util.isUndefined(this._tickWidth)?c:this._tickWidth)._tickDisplay(dv.util.isUndefined(this._tickDisplay)?d:this._tickDisplay)._tickOverflow(dv.util.isUndefined(this._tickOverflow)?e:this._tickOverflow)._tickTextOverflow(dv.util.isUndefined(this._tickTextOverflow)?f:this._tickTextOverflow)._tickValues(this._tickValues)._htmlLabels(this._htmlLabels)._domain(this._domain)._tickSubdivide(this._tickSubdivide)._scale(this._scale()._d3Scale)},a._renderAxis=function(a,b,c,d,e){var f=a.selectAll(".axis-"+this._scale().property()+".axis-index-"+this._scale().scaleIndex()).data([0]);d._labelParent(e),f.enter().append("g").classed("axis axis-"+this._scale().property()+" axis-index-"+this._scale().scaleIndex(),!0).attr("transform","translate("+c[0]+","+c[1]+")"),dv.ANIMATION&&(f=f.transition().delay(this._chart().delay()).duration(this._chart().duration()).ease(this._chart().ease())),f.attr("transform","translate("+c[0]+","+c[1]+")").call(d)},a._measureAxis=function(a,b,c){return a.attr("transform","translate("+b[0]+","+b[1]+")").call(c),a.node().getBBox()},a._measureAxisTitle=function(a,b,c,d){var e={left:0,top:0,right:0,bottom:0};if(this._title){var f=a.append("div").classed("temp-axis-title",!0),g=this._titleOrientation||this._orientation,h="top"===g||"bottom"===g?d.right-d.left:d.bottom-d.top,i=this._createAndSizeAxisTitle(f,g,b,c,h),j=i.node().getBoundingClientRect();e[g]+="top"===g||"bottom"===g?j.height:j.width,f.remove()}return e},a._renderAxisTitle=function(a,b,c,d,e){var f,g=this._titleOrientation||this._orientation;if(this._title){var h=a.selectAll(".axis-title-"+c+".axis-title-index-"+d).empty(),i="left"===g||"right"===g,j=i?b[g][1]-e.top:b[g][0]-e.left,k=2*j,l=this._createAndSizeAxisTitle(a,g,c,d,k);dv.ANIMATION&&(f=l.transition().duration(this._chart().duration()).delay(this._chart().delay()).ease(this._chart().ease())),this._positionAxisTitle(h||!dv.ANIMATION?l:f,b[g],g),f?f.style("opacity",1):l.style("opacity",1)}},a._createAndSizeAxisTitle=function(b,c,d,e,f){var g=b.selectAll(".axis-title-"+d+".axis-title-index-"+e).data([a]);return g.enter().append("div").classed("axis-title axis-title-"+d+" axis-title-index-"+e,!0).style("opacity",dv.ANIMATION?0:1),g.text(this._title).style("width",f-10+"px").classed({top:"top"===c,bottom:"bottom"===c,left:"left"===c,right:"right"===c})},a._positionAxisTitle=function(a,b,c){a.style("left",function(){return b[0]+0+"px"}).style("top",function(){var a=0;return"top"===c&&(a=-this.offsetHeight),b[1]+a+"px"})},a._getDefaultTickSize=function(a){return"bottom"===this._orientation?d3.functor(a.bottom-a.top):"left"===this._orientation?d3.functor(a.right-a.left):"top"===this._orientation?d3.functor(a.bottom-a.top):d3.functor(a.right-a.left)},a._getDefaultTickDx=function(){return"bottom"===this._orientation||"top"===this._orientation?d3.functor(0):d3.functor(-12)},a._getDefaultTickDy=function(){return"bottom"===this._orientation||"top"===this._orientation?d3.functor(-12):d3.functor(0)},a._getDefaultTickAnchor=function(){return"left"===this._orientation?d3.functor("end"):"right"===this._orientation?d3.functor("start"):d3.functor("middle")},a._labelParent=function(a){return arguments.length?(this.__labelParent=a,this):this.__labelParent},a.ticks=function(a,b){return arguments.length?(arguments.length>1?(this._ticks=function(){return a},this._tickInterval=b):(this._ticks=d3.functor(a),this._tickInterval=void 0),this):dv.util.isFinite(this._tickInterval)?[this._ticks,this._tickInterval]:this._ticks},a.tickSubdivide=function(a){return arguments.length?(this._tickSubdivide=a,this):this._tickSubdivide},a.tickSize=function(a){return arguments.length?(this._tickSize=d3.functor(a),this):this._tickSize},a.minorTickSize=function(a){return arguments.length?(this._minorTickSize=d3.functor(a),this):this._minorTickSize},a.tickDx=function(a){return arguments.length?(this._tickDx=d3.functor(a),this):this._tickDx},a.htmlLabels=function(a){return arguments.length?(this._htmlLabels=a,this):this._htmlLabels},a.tickDy=function(a){return arguments.length?(this._tickDy=d3.functor(a),this):this._tickDy},a.tickAnchor=function(a){return arguments.length?(this._tickAnchor=d3.functor(a),this):this._tickAnchor},a.tickFormat=function(a){if(!arguments.length){var b=this._scale()._d3Scale;return this._tickFormat?this._tickFormat:b.tickFormat?b.tickFormat(b):function(a){return a}}return this._tickFormat=a,this},a.tickWidth=function(a){if(!arguments.length){var b=this._scale()._d3Scale;return this._tickWidth?this._tickWidth:b.tickWidth?b.tickWidth(b):function(a){return a}}return this._tickWidth=a,this},a.tickDisplay=function(a){if(!arguments.length){var b=this._scale()._d3Scale;return this._tickDisplay?this._tickDisplay:b.tickDisplay?b.tickDisplay(b):function(a){return a}}return this._tickDisplay=a,this},a.tickOverflow=function(a){if(!arguments.length){var b=this._scale()._d3Scale;return this._tickOverflow?this._tickOverflow:b.tickOverflow?b.tickOverflow(b):function(a){return a}}return this._tickOverflow=a,this},a.tickTextOverflow=function(a){if(!arguments.length){var b=this._scale()._d3Scale;return this._tickTextOverflow?this._tickTextOverflow:b.tickTextOverflow?b.tickTextOverflow(b):function(a){return a}}return this._tickTextOverflow=a,this},a.tickValues=function(a){return arguments.length?(this._tickValues=a,this):this._tickValues},a.titleOrientation=function(a){return arguments.length?(this._titleOrientation=a,this):this._titleOrientation},a.domain=function(a){return arguments.length?(this._domain=a,this):this._domain},a._chart=function(a){return arguments.length?(this.__chart=a,this):this.__chart},a}),dv.svg.axis=function(){function a(a,b){a.attr("transform",function(a){var c=b(a);return dv.util.isFinite(c)?"translate("+c+",0)":null})}function b(a,b){a.attr("transform",function(a){var c=b(a);return dv.util.isFinite(c)?"translate(0,"+c+")":null})}function c(a,b,c){var d=d3.select(a).select("span").node().offsetWidth;return b+("end"===c?-d:"middle"===c?-d/2:0)}function d(a,b,c){var d=d3.select(a).select("span").node().offsetHeight;return b+("top"===c?0:"middle"===c?-d/2:-d)}function e(a,b,c){var d=[];if(c&&b.length>1){for(var e,f,g=dv.util.scaleExtent(a.domain()),h=-1,i=b.length,j=(b[1]-b[0])/++c;++h<i;)for(e=c;--e>0;)(f=+b[h]-e*j)>=g[0]&&d.push(f);for(--h,e=0;++e<c&&(f=+b[h]+e*j)<g[1];)d.push(f)}return d}function f(f){var w=function(a,b,e,f,g){var h={};switch(g){case"top":h.top=d(a,-p.call(a,b,e),"top"),h.left=f(b)+c(a,o.call(a,b,e),q.call(a,b,e));break;case"bottom":h.top=d(a,p.call(a,b,e),"bottom"),h.left=f(b)+c(a,o.call(a,b,e),q.call(a,b,e));break;case"right":h.top=f(b)+d(a,p.call(a,b,e),"middle"),h.left=c(a,o.call(a,b,e),q.call(a,b,e));break;case"left":h.top=f(b)+d(a,p.call(a,b,e),"middle"),h.left=c(a,-o.call(a,b,e),q.call(a,b,e))}h.top=(isNaN(h.top)?0:h.top)+"px",h.left=(isNaN(h.left)?0:h.left)+"px";var i=q.call(a,b,e);return d3.select(a).classed({start:"start"===i,middle:"middle"===i,end:"end"===i}),h},x=function(a,b){["top","left"].forEach(function(c){a.style(c,function(a,d){return b[d][c]})})},y=function(a,b,c){if(h){var d,e,f,k,l=a.reduce(function(a,b){var c=b.toString().split(".")[1],d=c?c.length:0;return Math.max(d,a)},0),m=null==g?i.tickFormat?i.tickFormat.apply(i,r):String:g,n=null==tickWidth_?i.tickWidth?i.tickWidth.apply(i,r):String:tickWidth_,o=null==tickDisplay_?i.tickDisplay?i.tickDisplay.apply(i,r):String:tickDisplay_,p=null==tickOverflow_?i.tickOverflow?i.tickOverflow.apply(i,r):String:tickOverflow_,q=null==tickTextOverflow_?i.tickTextOverflow?i.tickTextOverflow.apply(i,r):String:tickTextOverflow_;h.style("position","absolute"),d=h.selectAll(".axis-label").data(a,String),e=d.enter().append("div").classed({"axis-label":!0,visibilityTransition:!0,visibilityHidden:!0}).style({position:"absolute"}),f=dv.setVisibilityHidden(d.exit()).remove(),k=d,setTimeout(function(){dv.setVisibilityForeground(d)},100),e.append("span");var s=d.selectAll("span"),u=function(a,b,c){return m.call(this,a,c,panel,l)},v=function(a,b,c){return n.call(this,a,c,panel,s.length)},y=function(a,b,c){return o.call(this,a,c,panel)},z=function(a,b,c){return p.call(this,a,c,panel)},A=function(a,b,c){return q.call(this,a,c,panel)};t?s.html(u):s.text(u).style("width",v).style("display",y).style("overflow",z).style("text-overflow",A);var B,C=[],D=[],E=[],F=[];if(!i.ticks){var G=i.rangeBand()/2;B=function(a){return c(a)+G}}e.each(function(a,c){C[c]=w(this,a,c,B||b,j)}),k.each(function(a,d){D[d]=w(this,a,d,B||b,j),E[d]=w(this,a,d,B||c,j)}),i.ticks&&f.each(function(a,b){F[b]=w(this,a,b,c,j)}),x(e,C),x(d,D),x(k,E),i.ticks&&x(f,F)}};f.each(function(){var c=d3.select(this);if(u){var d=i.domain();(isNaN(u[0])||u[0]<d[0]&&u[1]>d[1])&&i.domain(u)}var f,g=null==s?i.ticks?i.ticks.apply(i,r):i.domain():s,h=e(i,g,v),o=c.selectAll(".minor").data(h,String),p=o.enter().insert("line","g").attr("class","tick minor").style("opacity",1e-6),q=d3.transition(o.exit()).style("opacity",1e-6).remove(),t=d3.transition(o).style("opacity",1),w=c.selectAll(".axis-tick").data(g,String),x=w.enter().insert("g","path").classed("axis-tick",!0).style("opacity",1e-6),z=d3.transition(w.exit()).style("opacity",1e-6).remove(),A=d3.transition(w).style("opacity",1),B=dv.util.scaleRangeNoReverse(i);path=c.selectAll(".domain").data([0]),pathEnter=path.enter().append("path").attr("class","domain"),pathUpdate=d3.transition(path);var C=i.copy(),D=this.__chart__||C;this.__chart__=C,x.append("line").attr("class","tick");var E=x.select("line"),F=A.select("line"),G=function(a,b,c,d){var e=a.call(this,b,c,d);return null==e||isNaN(e)?n:e};switch(j){case"bottom":f=a,p.attr("y2",function(a,b){return G.call(this,l,a,b,panel)}),t.attr("x2",0).attr("y2",function(a,b){return G.call(this,l,a,b,panel)}),E.attr("y2",function(a,b){return G.call(this,k,a,b,panel)}),F.attr("x2",0).attr("y2",function(a,b){return G.call(this,k,a,b,panel)}),pathUpdate.attr("d",function(a,b){return"M"+B[0]+","+G.call(this,m,a,b,panel)+"V0H"+B[1]+"V"+G.call(this,m,a,b,panel)});break;case"top":f=a,p.attr("y2",function(a,b){return-G.call(this,l,a,b,panel)}),t.attr("x2",0).attr("y2",function(a,b){return-G.call(this,l,a,b,panel)}),E.attr("y2",function(a,b){return-G.call(this,k,a,b,panel)}),F.attr("x2",0).attr("y2",function(a,b){return-G.call(this,k,a,b,panel)}),pathUpdate.attr("d",function(a,b){return"M"+B[0]+","+-G.call(this,m,a,b,panel)+"V0H"+B[1]+"V"+-G.call(this,m,a,b,panel)});break;case"left":f=b,p.attr("x2",function(a,b){return-G.call(this,l,a,b,panel)}),t.attr("x2",function(a,b){return-G.call(this,l,a,b,panel)}).attr("y2",0),E.attr("x2",function(a,b){return-G.call(this,k,a,b,panel)}),F.attr("x2",function(a,b){return-G.call(this,k,a,b,panel)}).attr("y2",0),pathUpdate.attr("d",function(a,b){return"M"+-G.call(this,m,a,b,panel)+","+B[0]+"H0V"+B[1]+"H"+-G.call(this,m,a,b,panel)});break;case"right":f=b,p.attr("x2",function(a,b){return G.call(this,l,a,b,panel)}),t.attr("x2",function(a,b){return G.call(this,l,a,b,panel)}).attr("y2",0),E.attr("x2",function(a,b){return G.call(this,k,a,b,panel)}),F.attr("x2",function(a,b){return G.call(this,k,a,b,panel)}).attr("y2",0),pathUpdate.attr("d",function(a,b){return"M"+G.call(this,m,a,b,panel)+","+B[0]+"H0V"+B[1]+"H"+G.call(this,m,a,b,panel)})}if(i.ticks)D.ticks&&(x.call(f,D),p.call(f,D)),A.call(f,C),z.call(f,C),t.call(f,C),q.call(f,C);else{var H=C.rangeBand()/2,I=function(a){return C(a)+H};x.call(f,I),A.call(f,I)}y(g,D,C)})}var g,h,i=d3.scale.linear(),j="bottom",k=d3.functor(6),l=d3.functor(6),m=d3.functor(6),n=0,o=d3.functor(0),p=d3.functor(0),q=d3.functor("start"),r=[10],s=null,t=!1,u=null,v=0;return f._scale=function(a){return arguments.length?(i=a,f):i},f._orient=function(a){return arguments.length?(j=a,f):j},f._ticks=function(){return arguments.length?(r=arguments,f):r},f._tickValues=function(a){return arguments.length?(s=a,f):s},f._tickFormat=function(a){return arguments.length?(g=a,f):g},f._tickWidth=function(a){return arguments.length?(tickWidth_=a,f):tickWidth_},f._tickDisplay=function(a){return arguments.length?(tickDisplay_=a,f):tickDisplay_},f._tickOverflow=function(a){return arguments.length?(tickOverflow_=a,f):tickOverflow_},f._tickTextOverflow=function(a){return arguments.length?(tickTextOverflow_=a,f):tickTextOverflow_},f._htmlLabels=function(a){return arguments.length?(t=a,f):t},f._tickSize=function(a,b,c){if(!arguments.length)return k;var d=arguments.length-1;return k=d3.functor(a),l=d>1?d3.functor(b):k,m=d>0?d3.functor(arguments[d]):k,f},f._defaultTickSize=function(a){return arguments.length?(n=a,f):n},f._tickDx=function(a){return arguments.length?(o=a,f):o},f._tickDy=function(a){return arguments.length?(p=a,f):p},f._tickAnchor=function(a){return arguments.length?(q=a,f):q},f._tickSubdivide=function(a){return arguments.length?(v=+a,f):v},f._panel=function(a){return arguments.length?(panel=a,f):panel},f._labelParent=function(a){return arguments.length?(h=a,f):h},f._domain=function(a){return arguments.length?(u=a,this):u},f},dv.guide.legends=dv.extend(function(){function a(){this._legArr=[],this.__hide=!1,this._ad={left:0,right:0,width:0,height:0}}return a._render=function(a){if(this._w=0,this._h=0,!this.__hide){var b=a.el.select(".legends"),c=this,d=b.selectAll(".legend").data(this._legArr);d.exit().transition().duration(a.duration).style("opacity",0).remove();var e=d.enter().append("g").classed("legend",!0);dv.ANIMATION&&e.style("opacity",0),d.each(function(b,d){for(var e={},f=(b.props[0],c._getScale(a,b.props[0])),g=f.domain(),h=0;h<b.props.length;h++){var i=b.props[h];if(!c._getScale(a,b.props[h]).hasSameDomain(g))throw new Error("Can't render single legend from multiple domains");e[i]=a.scales[i]}b.guide._render(d3.select(this),e,{dims:c._ad,renderOpts:a}),c._w+=b.guide._getUsedWidth(),c._h+=b.guide._getUsedHeight(),c._ad=b.guide._getAdjustedDimensions(c._ad)})}return this},a._getScale=function(a,b){var c=a.scales[b];if(void 0===b||void 0===c||void 0===c[0])throw new Error("A '"+b+"'' legend has been called for, but '"+b+" hasn't been mapped to data.");return c[0]},a._add=function(a){return this._legArr.push(a),this},a._remove=function(a){for(var b in a)for(var c=a[b],d=0;d<this._legArr.length;d++){for(var e=this._legArr[d].props,f=!0,g=0;g<e.length;g++)e[g]===c&&(e.splice(g,1),g--),0===e.length&&(f=!1);f||(this._legArr.splice(d,1),d--)}},a._legends=function(a){return arguments.length?(this._legArr=a,this):this._legArr},a._allowedDimensions=function(a){return arguments.length?(this._ad=a,this):this._ad},a._getWidth=function(){return this._w},a._getHeight=function(){return this._h},a._hide=function(a){return arguments.length?(this.__hide=a,this):this.__hide},a._empty=function(){for(var a=0;a<this._legArr.length;a++)delete this._legArr[a];return this._legArr=[],this},a}),dv.guide.legend=dv.guide.extend(function(){function a(){this._overlay=!1,this._orientation="top",this._vGap=5,this._hGap=15,this._defaultPadding=this._padding={top:10,left:10,right:10,bottom:10},this._swatchWidth=15,this._swatchHeight=10,this._innerPadding=5,this._spanPercent=.75,this._lineHeight=0,this._entriesWidth=[]}function b(a){var b=this;return a.each(function(a,c){b._entryWidths[c]=Math.min(b._entryWidths[c],b._width),b._lineHeight=Math.max(b._lineHeight,this.getBBox().height)}),b._entryWidths}function c(a){for(var b,e=0,f=0,g=0,h=!1,i=0,j=0,k=[],l=0;l<this._legendWidths.length;l++)if(e+=(0===f?0:this._hGap)+this._legendWidths[l],f<a.data.length&&e<=this._width){if(this._legendWidths[l]<=a.data[f]+g)j+=0===f?0:this._hGap,k.push({x:j,y:i}),j+=a.data[f]+g,g=0;else{if((b=this._legendWidths[l]-a.data[f])<=a.padding)return a.padding-=b,a.data[f]=this._legendWidths[l],c.call(this,a);if(!(f+1<a.data.length&&this._legendWidths[l]>=a.data[f]+a.data[f+1]*this._spanPercent+g))return a=d.call(this,a.data.length-1),c.call(this,a);f+1<=a.data.length?(g+=(0===f?0:this._hGap)+a.data[f],e-=(0===f?0:this._hGap)+this._legendWidths[l],l--):(e=e-this._legendWidths[l]+g+a.data[f],g=0,j+=0===f?0:this._hGap,k.push({x:j,y:i}),j+=a.data[f]+g,f++)}f++}else{if(f+1===a.data.length&&a.data.length>1)return a=d.call(this,a.data.length-1),c.call(this,a);f===a.data.length&&(h=!0),i+=this._lineHeight+this._vGap,e=j=0,f=0,g=0,l--}return f===a.data.length&&(h=!0),h?{offsets:k,cols:a}:(a=d.call(this,a.data.length-1),c.call(this,a))}function d(a){var b={data:[],padding:this._width},c=0,e=0;for(this._isVAligned()&&(a=Math.ceil(this._legendWidths.length/Math.floor(this._height/(this._lineHeight+this._vGap)))),e=0;e<a;e++)c+=this._legendWidths[e]+this._hGap;return(c-=this._hGap)>this._width&&a>1?d.call(this,a-1):(b.data=this._legendWidths.slice(0,a),b.padding-=c,b.padding<0&&(b.padding=0),b)}function e(a,b,c,d){return"M"+a+","+b+"L"+(a+c)+","+b+"L"+(a+c)+","+(b+d)+"L"+a+","+(b+d)+"Z"}function f(a,b,c,d){var e=b+d>>1;return"M"+a+","+e+"L"+c+","+e}function g(a,b){return this._scales.hasOwnProperty("fill")?e.call(this,0,0,this._swatchWidth,this._swatchHeight):f.call(this,0,0,this._swatchWidth,this._swatchHeight)}return a._render=function(a,e,f){var g=a,h=f.dims,i=this;this._renderingOptions=f.renderOpts,this._scales=e,this._transformData=[],this._width=h.width-this._padding.left-this._padding.right,this._height=h.height-this._padding.top-this._padding.bottom;var j=this._drawEntries(a);this._legendWidths=b.call(this,j);var k=d.call(this,Math.min(this._legendWidths.length,Math.floor(this._width/this._swatchWidth))),l=c.call(this,k),m=l.offsets;k=l.cols,this._width=this._width-k.padding+this._hGap*(k.data.length-1),this._height=this._lineHeight+m[m.length-1].y,j.each(function(a,b){var c=d3.select(this);dv.ANIMATION&&(c=c.transition().duration(i._renderingOptions.duration).delay(i._renderingOptions.delay).ease(i._renderingOptions.ease)),c.attr("transform","translate("+m[b].x+", "+m[b].y+")")}),this._renderingOptions.firstRender||(g=a.transition().duration(this._renderingOptions.duration).style("opacity",1));var n="right"===this._orientation?h.left+h.width-this._width-this._padding.right:h.left+this._padding.left,o="bottom"===this._orientation?h.top+h.height-this._height-this._padding.bottom:h.top+this._padding.top;g.attr("transform","translate("+n+","+o+")"),this._renderingOptions.firstRender&&g.transition().duration(this._renderingOptions.duration).style("opacity",1)},a._drawEntries=function(a){var b=this,c=[];this._entryWidths=[];for(var d in this._scales){c=this._scales[d][0].domain();break}var e=a.selectAll(".legend-entry").data(c);e.exit().transition().duration(this._renderingOptions.duration).style("opacity",0).remove();var f=e.enter().append("g").classed("legend-entry",!0);return f.append("path"),f.append("text").classed("legend-entry-label",!0),f.append("text").classed("legend-entry-value",!0),e.select("path").attr("d",function(a,c){return g.call(b,a,c)}).call(function(a){a.attr("style",""),b._scales.hasOwnProperty("fill")&&a.style("fill",function(a,c){return b._scales.fill[0].mapValue(a)}),b._scales.hasOwnProperty("stroke")&&a.style("stroke",function(a,c){return b._scales.stroke[0].mapValue(a)}).style("stroke-width",2),b._scales.hasOwnProperty("linetype")&&(a.style("stroke-dasharray",function(a,c){return dv.util.svg.getDasharray(b._scales.linetype[0].mapValue(a))}),b._scales.hasOwnProperty("stroke")||a.style("stroke","#000"),a.style("stroke-width",2)),b._scales.hasOwnProperty("size")&&a.style("stroke-width",function(a,c){return b._scales.size[0].mapValue(a)})}).each(function(a,c){b._entryWidths[c]=this.getBBox().width}),e.select("text.legend-entry-label").attr("x",this._swatchWidth+this._innerPadding).attr("y",10).text(function(a,c){return dv.util.isUndefined(b._labels)?a:b._labels[c%b._labels.length]}).each(function(a,c){b._entryWidths[c]+=b._innerPadding+this.getBBox().width}),e.select("text.legend-entry-value").attr("y",10).attr("x",function(a,c){return b._entryWidths[c]+b._innerPadding}).text(function(a,c){return dv.util.isUndefined(b._values)?"":b._values[c]}).style("fill",function(a,c){return dv.util.isUndefined(b._scales.stroke)?dv.util.isUndefined(b._scales.fill)?void 0:b._scales.fill[0].mapValue(a):b._scales.stroke[0].mapValue(a)}).each(function(a,c){var d=this.getBBox().width;b._entryWidths[c]+=d+(d>0?b._innerPadding:0)}),e},a._getAdjustedDimensions=function(a){if(this._overlay)return a;var b=this._padding.left+this._width+this._padding.right,c=this._padding.top+this._height+this._padding.bottom;return"left"===this._orientation?(a.left+=b,a.width-=b):"top"===this._orientation?(a.top+=c,a.height-=c):"right"===this._orientation?a.width-=b:"bottom"===this._orientation&&(a.height-=c),a},a._getUsedWidth=function(){return this._overlay?0:this._isVAligned()?this._width+this._padding.left+this._padding.right:0},a._getUsedHeight=function(){return this._overlay?0:this._isVAligned()?0:this._height+this._padding.top+this._padding.bottom},a._isVAligned=function(){return"left"===this._orientation||"right"===this._orientation},a.vGap=function(a){return arguments.length?(this._vGap=a,this):this._vGap},a.hGap=function(a){return arguments.length?(this._hGap=a,this):this._hGap},a.padding=function(a){return arguments.length?(this._padding=dv.util.merge(this._defaultPadding,a),this):this._padding},a.align=function(a){return arguments.length?(this._align=a,this):this._align},a.labels=function(a){return arguments.length?(this._labels=a,this):this._labels},a.values=function(a){return arguments.length?(this._values=a,this):this._values},a.overlay=function(a){return arguments.length?(this._overlay=a,this):this._overlay},a}),dv.guide.custom=dv.guide.extend(function(){function a(a){this._render=function(){return dv.log.warn({msg:"empty render function on custom guide"}),this},this._getAdjustedDimensions=function(a){return a},this._getUsedWidth=function(){return 0},this._getUsedHeight=function(){return 0}}return a.setFunc=function(a,b){return this[a]=b,this},a}),dv.geom=dv.container.extend(function(){function a(){this._super(),this._defaultAes={},this._behaviorsLayer=null,this._dodgePadding=0,this._initializeDefaultAes()}return a._initializeDefaultAes=function(){this._defaultAes.x=1,this._defaultAes.y=1,this._defaultAes.shape="circle",this._defaultAes.linetype="solid"},a._prerender=function(a){this._trainedScales={},this._chart=a,this.normalizedData(this._normalizeData(this.data())),this._calculateStats(),this._inheritChartAesthetics(a)},a._inheritChartAesthetics=function(a){for(var b in a._aes){var c=a._aes[b];this._aes[b]||(this._aes[b]={});for(var d in c)this._aes[b][d]||(this._aes[b][d]=c[d])}},a._trainScales=function(){},a._createDefaultScales=function(){for(var a in this._defaultAes)this._aes.hasOwnProperty(a)||(this._aes[a]={},this._aes[a][0]=dv.scale.constant().value(this._defaultAes[a]).property(a)),delete this._defaultAes[a]},a._render=function(a){var b=this;this._geomGroup=d3.select(a);var c=this._geomGroup.selectAll(".series").data(this._nestData);c.exit().call(b.exitSeriesGroup,b),c.enter().append("g").classed("series",!0),c.call(b.updateGroups,b.enterPen,b.pen,b.enterPen,b).call(b.updateDataPoints,b.enterPen,b.pen,b.enterPen,b),b._renderBehaviors(b._geomGroup),b.unregisterEventMap=null},a._renderBehaviors=function(a){var b=this;this._behaviors&&this._behaviors.length&&(this._behaviorsLayer=a.select(".behavior-layer"),this._behaviorsLayer.empty()?this._behaviorsLayer=a.append("g").classed("behavior-layer",!0):this._behaviorsLayer.node().parentNode.appendChild(this._behaviorsLayer.node()),dv.util.each(this._behaviors,function(a){a._geom(b)._render(b._behaviorsLayer)}))},a.updateGroups=function(a,b,c,d,e){a.each(function(a,b){var c=0,d=0,f=d3.select(this),g=f.attr("transform");if(e._chart._coord instanceof dv.coord.polar){var h=a.values[0],i=dv.util.scaleRange(h.panel.xOuterScale()),j=dv.util.scaleRange(h.panel.yOuterScale()),k=(i[0]+i[1])/2,l=(j[0]+j[1])/2,m=e._chart._coord.flip();c=m?l:k,d=m?k:l}g&&dv.ANIMATION&&(f=f.transition().duration(function(a,b){return e.duration().call(this,a,b)})),f.attr("transform","translate("+c+","+d+")")})},a.updateDataPoints=function(a,b,c,d,e){var f=b.call(e),g=c.call(e),h=d.call(e),i=a.selectAll("."+e._dataPointStyleClass).data(function(a){return e.getValues(a)});i.exit().transition().delay(function(a,b,c){return e.delay().call(this,a,b,c)}).duration(function(a,b,c){return e.duration().call(this,a,b,c)}).ease(e.ease()).each(function(){this.__exiting__=!0}).attrTween("d",h.pathTween).remove(),i.enter().append("path").each(function(a,b,c){e.setPreviousState.call(this,f,h,a,b,c)}).attr("class",function(a,b,c){return"datum-"+b+" series-"+c}).call(e.attributes,e).attr("d",f.path);var j=i.call(e.attributes,e).call(e._removeRegisteredEvents,e).call(e._addRegisteredEvents,e).each(function(){this.__exiting__=!1});dv.ANIMATION?j=j.transition().delay(function(a,b,c){return e.delay().call(this,a,b,c)}).duration(function(a,b,c){return e.duration().call(this,a,b,c)}).ease(e.ease()).attrTween("d",g.pathTween):j.each(function(a,b,c){var d=g.bounds(a,b,c);d&&(a.bounds=d.bounds)}).attr("d",g.path),j.call(e.addEachFunction,e)},a.addEachFunction=function(a,b){b._each&&(dv.util.isUndefined(b._each.start)||(dv.ANIMATION?a.each("start",function(a,c,d){b._each.start.call(this,a,c,d)}):a.each(function(a,c,d){b._each.start.call(this,a,c,d)})),dv.util.isUndefined(b._each.end)||(dv.ANIMATION?a.each("end",function(a,c,d){b._each.end.call(this,a,c,d)}):a.each(function(a,c,d){b._each.end.call(this,a,c,d)})))},a.exitSeriesGroup=function(a,b){b.exitSeries(a,b.enterPen,b)},a.setPreviousState=function(a,b,c,d){var e=a.bounds(c,d);this.__previousBounds__=e,this.__exitTransition__=b},a.pathTween=function(a,b,c,d,e){var f,g=d3.select(b);return b.__exiting__?(f=b.__exitTransition__.path(c,d),b.__exiting__=!1):f=a.getPath(a.getBounds(c,d)),null===f?(g.remove(),null):d3.interpolate(g.attr("d"),f)},a._calculateStats=function(){},a._handlePositions=function(){if("stack"===this.position()||"fill"===this.position()||"dodge"===this.position()){var a=this.position(),b=this._addGroupLayerToNestedData(),c=(this._chart.coord().flip(),function(a){var b=d.getExplicitScales(a)[a],c=!1;return function(d,e){for(var f in b)if(c=b[f]._includeInDomain(d,e))break;return c?d[a]:0}}),d=this;dv.util.each(b,function(b){var d=c("x"),e=c("y");if("stack"===a)d3.layout.stack().x(d).y(e).values(function(a){return a.values})(b.values);else if("fill"===a)d3.layout.stack().x(d).y(e).offset(function(a){var b,c,d,e=a.length,f=a[0].length,g=[];for(c=0;c<f;++c){for(b=0,d=0;b<e;b++)d+=a[b][c][1];if(d)for(b=0;b<e;b++)a[b][c][1]/=d;else for(b=0;b<e;b++)a[b][c][1]=0}for(c=0;c<f;++c)g[c]=0;return g}).values(function(a){return a.values})(b.values);else if("dodge"===a){var f=b.values.length;dv.util.each(b.values,function(a,b){dv.util.each(a.values,function(a){a.dodge={groupIndex:b,numGroups:f}})})}})}},a._addGroupLayerToNestedData=function(){var a=[],b={},c={};return dv.util.each(this._nestData,function(d,e){var f,g,h=/(.*) ~ .*/g.exec(d.key)[1],i=/.* ~ (.*)/g.exec(d.key)[1];b.hasOwnProperty(h)||(a.push({key:h,values:[]}),b[h]=a.length-1),f=a[b[h]],c.hasOwnProperty(d.key)||(f.values.push({key:i,values:[]}),c[d.key]=f.values.length-1),g=f.values[c[d.key]],g.values=g.values.concat(d.values)}),a},a.exit=function(a){d3.select(a).selectAll(".series").call(this.exitSeriesGroup,this)},a.exitSeries=function(a,b,c){a.selectAll("."+c._dataPointStyleClass).transition().delay(function(a,b,d){return c.delay().call(this,a,b,d)}).duration(function(a,b,d){return c.duration().call(this,a,b,d)}).ease(c.ease()).each(function(){this.__exiting__=!0}).attrTween("d",b.call(c).pathTween).remove().each("end",function(a,b){var c=this.parentNode;if(c&&c.childNodes&&!c.childNodes.length){var d=c.parentNode;d&&d.childNodes&&d.childNodes.length<=1?d3.select(d).remove():d3.select(c).remove()}})},a.coord=function(){return this.chart().coord()},a._addRegisteredEvents=function(a,b){b||(b=this),b._geomGroup&&(a=a?a:b._geomGroup.selectAll(".series").selectAll("."+this._dataPointStyleClass),b=b||this,dv.util.each(b.eventMap,function(c,d){a.on(d,function(a,c,e){b.eventMap[d].callback.call(this,a,c,e,d3.event)},c.capture)}),dv.util.each(b._chart.eventMap,function(c,d){a.on(d+".dvchart",function(a,c){var e=d3.event,f=b._chart._interactionGroup.select(".interaction-canvas").node();b._shouldDispatchChartEvent(e,f)&&b._chart.eventMap[d].callback.call(f,e)},c.capture)}),dv.util.each(b._behaviors,function(a){a._addRegisteredEvents&&a._addRegisteredEvents()}))},a._removeRegisteredEvents=function(a,b){b||(b=this),b._geomGroup&&(a=a||b._geomGroup.selectAll("."+this._dataPointStyleClass),b=b||this,dv.util.each(b.unregisterEventMap,function(b,c){a.on(c,null,b)}),dv.util.each(b._chart.unregisterEventMap,function(b,c){a.on(c+".dvchart",null,b)}),dv.util.each(b._behaviors,function(a){a._removeRegisteredEvents&&a._removeRegisteredEvents()}))},a._shouldDispatchChartEvent=function(a,b){var c=!0;if("mouseout"===a.type||"mouseover"===a.type){var d=a.relatedTarget;d||(d="mouseout"===a.type?a.toElement:a.fromElement);var e=d3.select(d);if(e&&!e.empty()){var f=e.attr("class");c=!(e.node()===b||f&&f.indexOf("-geom")>=0)}}return c},a.getExplicitScalesMap=function(){var a=dv.util.clone(this._chart.getExplicitScalesMap());for(var b in this._aes){var c=this._aes[b],d=a[b]||{},e=dv.util.extend({},d,c);a[b]=e}return a},a.getExplicitScale=function(a,b){if("group"===a)return this._getGroup();var c=this._aes[a],d=this.chart()._aes[a];return void 0!==b&&c&&c[b]?c[b]:void 0!==b&&d&&d[b]?d[b]:c&&void 0!==c[0]?c[0]:d&&void 0!==d[0]?d[0]:null},a.getExplicitScales=function(a){dv.util.isArray(a)||(a=[a]);for(var b={},c=-1,d=a.length;++c<d;){var e=a[c],f=this._aes[e],g=this.chart()._aes[e]||{};b[e]=dv.util.extend({},g,f)}return b},a.getTrainedScale=function(a,b){return this.chart().getTrainedScale(a,b)},a.getScale=function(a,b){return this.getExplicitScale(a,b)},a.getScales=function(a){return this.getExplicitScales(a)},a.hasScale=function(a,b){return!!this.getExplicitScale(a,b)},a._dodgeAdjust=function(a){var b=a.dodge.groupIndex,c=a.dodge.numGroups,d=a.panel.xScale(a).rangeBand(),e=c>1?d/(c-1)*this._dodgePadding:0,f=(d-e*(c-1))/c;return(f+e)*b+f/2},a.applyAttributeValue=function(a,b,c,d){var e=b.getScale(d,0);a.style(c,function(a,b,c){return e?e.mapToProp(dv.util.isArray(a)?a[0]:a,b,c):null})},a._getGroup=function(){if(this._aes.hasOwnProperty("group"))return this._aes.group[0];var a=this.chart()._getGroup();if(a&&"group"===a.property())return a;for(var b=-1,c=dv.DEFAULT_CATEGORICAL_AES.length-1;b++<c;){var d=this._aes[dv.DEFAULT_CATEGORICAL_AES[b]];if(d&&d[0]&&d[0]instanceof dv.scale.ordinal&&!dv.util.isUndefined(d[0].mapping()))return d[0]}return a},a.each=function(a,b){var c,d;return arguments.length?(this._each=this._each||{},arguments.length<2?(d=a,c="end"):(d=b,c=a),this._each[c]=d,this):this._each},a.dodgePadding=function(a){return arguments?(this._dodgePadding=a,this):this._dodgePadding},a.behaviors=function(a){return arguments.length?(this._behaviors=a,this):this._behaviors},a.stat=function(a){return arguments.length?(this._stat=a,this):this._stat},a.chart=function(a){return arguments.length?(this._chart=a,this):this._chart},a.normalizedData=function(a){return arguments.length?(this._normalizedData=a,this):this._normalizedData},a.data=function(a){return arguments.length?(this._data=a,this):this._data?this._data:this.chart().data()},a}),dv.geom.point=dv.geom.extend(function(){function a(){this._super(),this._rendererClass=dv.geom.point}return a._dataPointStyleClass="point-geom",a._initializeDefaultAes=function(){this._super(),this._defaultAes.shape="circle",
this._defaultAes.size=7},a.getValues=function(a){return a.values},a.exitSeriesGroup=function(a,b){b.exitSeries(a,b.enterPen,b)},a.attributes=function(a,b){a.attr("style","").classed(b._dataPointStyleClass,!0).call(b.applyAttributeValue,b,"opacity","alpha").call(b.applyAttributeValue,b,"stroke","stroke").call(b.applyAttributeValue,b,"fill","fill")},a.getHighlightColor=function(a,b){var c=this.getScale("fill"),d=this.getScale("stroke");return!d||d instanceof dv.scale.constant?!c||c instanceof dv.scale.constant?d?d.mapToProp(a,b):"#8CC350":c.mapToProp(a,b):d.mapToProp(a,b)},a.enterPen=function(){var a,b=this,c=function(a,b){return a.panel.yScale(a).reverse()?1:0};return a="dodge"===this.position()?function(a,c){var d=a.panel.xScale(a);return d.mapValueToPercent(d.mapToProp(a,c)+b._dodgeAdjust(a),c)}:function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)},this._decoratePen(a,c)},a.pen=function(){var a,b=this,c=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)};switch(this.position()){case"identity":a=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)};break;case"stack":a=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(a.y0+a.y),b)};break;case"dodge":c=function(a,c){var d=a.panel.xScale(a);return d.mapValueToPercent(d.mapToProp(a,c)+b._dodgeAdjust(a),c)},a=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)};break;case"fill":a=function(a,b){return a.y+a.y0}}return this._decoratePen(c,a)},a._defined=function(a,b){return dv.util.isFinite(a.panel.xScale(a).mapToProp(a,b))&&dv.util.isFinite(a.panel.yScale(a).mapToProp(a,b))},a._decoratePen=function(a,b){var c=this.getScale("shape"),d=this.getScale("size"),e=this,f=this.coord()._point().x(a).y(b).defined(this._defined);return f.renderer.type(function(a,b){return c.mapToProp(a,b)}).size(function(a,b){return Math.pow(d.mapToProp(a,b),2)}),{bounds:function(a,b){return f.getBounds(a,b)},pathTween:function(a,b){return e.pathTween(f,this,a,b)},path:function(a,b){return f.getPath(f.getBounds(a,b))}}},a}),dv.geom.text=dv.geom.extend(function(){function a(){this._super(),this._rendererClass=dv.geom.text,this._dx=d3.functor(0),this._dy=d3.functor(0),this._textFormat=function(a){return a},this._textAnchor="start"}return a._dataPointStyleClass="text-geom",a.dx=function(a){return arguments.length?(this._dx=d3.functor(a),this):this._dx},a.dy=function(a){return arguments.length?(this._dy=d3.functor(a),this):this._dy},a.textAnchor=function(a){return arguments.length?(this._textAnchor=a,this):this._textAnchor},a.textFormat=function(a){return arguments.length?(this._textFormat=d3.functor(a),this):this._textFormat},a.getValues=function(a){return a.values},a.updateDataPoints=function(a,b,c,d,e){var f=(e.getScale("alpha"),b.call(e)),g=c.call(e),h=d.call(e),i=a.selectAll("."+e._dataPointStyleClass).data(function(a){return e.getValues(a)});i.exit().transition().delay(function(a,b,c){return e.delay().call(this,a,b,c)}).duration(function(a,b,c){return e.duration().call(this,a,b,c)}).ease(e.ease()).call(h).each("end.transition",function(a,b){var c=this.parentNode;c&&c.removeChild(this)}),i.enter().append("text").attr("class",function(a,b,c){return"datum-"+b+" series-"+c}).call(e.attributes,e).call(f);var j=i.call(e.attributes,e).call(e._removeRegisteredEvents,e).call(e._addRegisteredEvents,e);dv.ANIMATION&&(j=j.transition().delay(function(a,b,c){return e.delay().call(this,a,b,c)}).duration(function(a,b,c){return e.duration().call(this,a,b,c)}).ease(e.ease())),j.call(g).call(e.addEachFunction,e)},a.exitSeriesGroup=function(a,b){b.exitSeries(a,b.enterPen,b)},a.exitSeries=function(a,b,c){a.selectAll("."+c._dataPointStyleClass).transition().delay(function(a,b,d){return c.delay().call(this,a,b,d)}).duration(function(a,b,d){return c.duration().call(this,a,b,d)}).ease(c.ease()).call(b.call(c)).remove().each("end.transition",function(a,b){var c=this.parentNode;c.parentNode&&c.removeChild(this),c&&c.childNodes&&!c.childNodes.length&&d3.select(c).remove()})},a.attributes=function(a,b){a.attr("style","").classed(b._dataPointStyleClass,!0).call(b.applyAttributeValue,b,"stroke","stroke").call(b.applyAttributeValue,b,"fill","fill").call(b.applyAttributeValue,b,"opacity","alpha").call(b.applyAttributeValue,b,"font-size","size").attr("text-anchor",b._textAnchor)},a.enterPen=function(){var a,b=this,c=this._dx,d=function(a,b){return a.panel.yScale(a).reverse()?1:0};return a="dodge"===this.position()?function(a,d,e){var f=a.panel.xScale(a);return f.mapValueToPercent(f.mapToProp(a,d)+b._dodgeAdjust(a)+c(a,d,e),d)}:function(a,b,d){var e=a.panel.xScale(a);return e.mapValueToPercent(e.mapToProp(a,b)+e.rangeBand()/2+c(a,b,d),b)},this._decoratePen(a,d)},a.pen=function(){var a,b=this,c=this._dx,d=this._dy,e=function(a,b,d){var e=a.panel.xScale(a);return e.mapValueToPercent(e.mapToProp(a,b)+e.rangeBand()/2+c(a,b,d),b)};switch(this.position()){case"identity":a=function(a,b,c){var e=a.panel.yScale(a);return e.mapValueToPercent(e.mapToProp(a,b)+d(a,b,c)+e.rangeBand()/2,b)};break;case"stack":a=function(a,b,c){var e=a.panel.yScale(a);return e.mapValueToPercent(e.mapValue(a.y0+a.y,b)+d(a,b,c),b)};break;case"dodge":e=function(a,d,e){var f=a.panel.xScale(a);return f.mapValueToPercent(f.mapToProp(a,d)+b._dodgeAdjust(a)+c(a,d,e),d)},a=function(a,b,c){var e=a.panel.yScale(a);return e.mapValueToPercent(e.mapToProp(a,b)+d(a,b,c)+e.rangeBand()/2,b)};break;case"fill":a=function(a,b,c){var e=a.panel.yScale(a);return a.y+a.y0+e.mapValueToPercent(d(a,b,c)+dv.util.scaleRange(e)[0],b)}}return this._decoratePen(e,a)},a._defined=function(a,b){return dv.util.isFinite(a.panel.xScale(a).mapToProp(a,b))&&dv.util.isFinite(a.panel.yScale(a).mapToProp(a,b))},a._decoratePen=function(a,b){var c=this.getScale("label"),d=this;return this.coord()._text().x(a).y(b)().label(function(a,b,e){return d._textFormat.call(this,c.mapToProp(a,b),b,e)}).defined(this._defined)},a}),dv.geom.line=dv.geom.extend(function(){function a(){this._super(),this._tension=.7,this._interpolate="linear",this._rendererClass=dv.geom.line}return a._dataPointStyleClass="line-geom",a.tension=function(a){return arguments.length?(this._tension=a,this):this._tension},a.interpolate=function(a){return arguments.length?(this._interpolate=a,this):this._interpolate},a._render=function(a){this._super(a);var b=this.getScale("size");b&&b.to&&!b.to()&&b.to([2,8])},a.getValues=function(a){return[a.values]},a.exitSeriesGroup=function(a,b){b.exitSeries(a,b.enterPen,b)},a.attributes=function(a,b){var c=b.getScale("linetype",0);a.attr("style","").classed(b._dataPointStyleClass,!0).call(b.applyAttributeValue,b,"stroke","stroke").call(b.applyAttributeValue,b,"opacity","alpha").call(b.applyAttributeValue,b,"stroke-width","size").style("stroke-dasharray",function(a,b,d){return c?dv.util.svg.getDasharray(c.mapToProp(a[0],b,d)):null}).style("fill","none")},a.getHighlightColor=function(a,b){var c=this.getScale("stroke",0);return c?c.mapToProp(a,b):"#8CC350"},a.enterPen=function(){var a,b=this,c=function(a,b){return a.panel.yScale(a).reverse()?1:0};return a="dodge"===this.position()?function(a,c){var d=a.panel.xScale(a);return d.mapValueToPercent(d.mapToProp(a,c)+b._dodgeAdjust(a),c)}:function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)},this._decoratePen(a,c)},a.pen=function(){var a,b=this,c=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)};switch(this.position()){case"identity":a=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)};break;case"stack":a=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(a.y0+a.y),b)};break;case"dodge":c=function(a,c){var d=a.panel.xScale(a);return d.mapValueToPercent(d.mapToProp(a,c)+b._dodgeAdjust(a),c)},a=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)};break;case"fill":a=function(a,b){return a.y+a.y0}}return this._decoratePen(c,a)},a._defined=function(a,b){return dv.util.isFinite(a.panel.xScale(a).mapToProp(a,b))&&dv.util.isFinite(a.panel.yScale(a).mapToProp(a,b))},a._decoratePen=function(a,b){var c=this,d=this.coord()._line().x(a).y(b).defined(this._defined);return d.renderer.tension(this.tension()).interpolate(this.interpolate()),{bounds:function(a,b){return d.getBounds(a,b)},pathTween:function(a,b){return c.pathTween(d,this,a,b)},path:function(a,b){return d.getPath(d.getBounds(a,b))}}},a}),dv.geom.area=dv.geom.extend(function(){function a(){this._super(),this._tension=.7,this._interpolate="linear",this._rendererClass=dv.geom.area,this._baseline=0}return a._dataPointStyleClass="area-geom",a._initializeDefaultAes=function(){this._super()},a._trainScales=function(){if(void 0!==this._baseline){var a=this.getExplicitScales("y").y;for(var b in a){var c=a[b];c instanceof dv.scale.continuous&&c.softLowerLimit(this._baseline)}}this._super()},a.tension=function(a){return arguments.length?(this._tension=a,this):this._tension},a.interpolate=function(a){return arguments.length?(this._interpolate=a,this):this._interpolate},a.getValues=function(a){return[a.values]},a.pathTween=function(a,b,c,d,e){var f,g,h,i,j=b.__previousBounds__,k=[],l=this.enterPen.call(this,e),m=this.getScale("x").domain(),n=-1;for(f=a.getBounds(c,d),f.coord=this.coord(),(j&&j.coord&&f.coord._type!==j.coord._type||f.coord.flip()!=j.coord.flip())&&(j=this.enterPen.call(this,e).bounds(c,d)),g=Math.max(f.length,j.length);++n<g;)h=n<f.length?f[n]:null,i=n<j.length?j[n]:null,i?h||(h=l.bounds([i],d)[0]):(h.x=m[m.length-1],i=l.bounds([h],d)[0]),k.push(d3.interpolateObject(i.bounds,h.bounds));return b.__previousBounds__=f,function(b){1===b&&(k=k.splice(0,f.length));var c=[];return dv.util.each(k,function(a,d){var e={};e.bounds=a(b),c.push(e)}),a.getPath(c)}},a.exitSeriesGroup=function(a,b){b.exitSeries(a,b.enterPen,b)},a.attributes=function(a,b){a.attr("style","").classed(b._dataPointStyleClass,!0).call(b.applyAttributeValue,b,"opacity","alpha").call(b.applyAttributeValue,b,"fill","fill")},a.getHighlightColor=function(a,b){var c=this.getScale("fill");return c?c.mapToProp(a,b):"#8CC350"},a.getBaseline=function(a){var b=d3.min(a.domain());return void 0!==self._baseline?self._baseline:b<0?0:b},a.enterPen=function(){var a,b=this,c=function(a,c){var d=a.panel.yScale(a);return d.mapValueToPercent(d.mapValue(b.getBaseline(d)),c)};return a="dodge"===this.position()?function(a,c){var d=a.panel.xScale(a);return d.mapValueToPercent(d.mapToProp(a,c)+b._dodgeAdjust(a),c)}:function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)},this._decoratePen(a,c,c)},a.pen=function(){var a,b,c=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)},d=this;switch(this.position()){case"identity":a=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(d.getBaseline(c)),b)},b=function(a,b){return a.panel.yScale(a).mapPropToPercent(a,b)};break;case"stack":a=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(a.y0),b)},b=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(a.y0+a.y),b)};break;case"dodge":c=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+d._dodgeAdjust(a),b)},a=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(d.getBaseline(c)),b)},b=function(a,b){return a.panel.yScale(a).mapPropToPercent(a,b)};break;case"fill":a=function(a,b){return a.y0},b=function(a,b){return a.y+a.y0}}return this._decoratePen(c,a,b)},a._defined=function(a,b){return dv.util.isFinite(a.panel.xScale(a).mapToProp(a,b))&&dv.util.isFinite(a.panel.yScale(a).mapToProp(a))},a._decoratePen=function(a,b,c){var d=this,e=this.coord()._area().x(a).y0(b).y1(c).defined(this._defined);return e.renderer.tension(this.tension()).interpolate(this.interpolate()),{bounds:function(a,b){var c=e.getBounds(a,b);return c&&(c.coord=d.coord()),c},pathTween:function(a,b){return d.pathTween(e,this,a,b)},path:function(a,b){return e.getPath(e.getBounds(a,b))}}},a.baseline=function(a){return arguments.length?(this._baseline=a,this):this._baseline},a}),dv.geom.rect=dv.geom.extend(function(){function a(){this._super(),this._rendererClass=dv.geom.rect}return a._dataPointStyleClass="bar-geom",a._initializeDefaultAes=function(){this._super(),this._defaultAes.yMin=1,this._defaultAes.yMax=1,this._defaultAes.xMin=1,this._defaultAes.xMax=1,delete this._defaultAes.x,delete this._defaultAes.y},a._trainScales=function(){var a,b=this.getExplicitScales(["yMin","xMin"]),c=b.yMin,d=b.xMin;for(a in c){var e=this._aes.y;e||(this._aes.y=e={}),e[a]||(e[a]=c[a].copy().property("y").mapping("y")),e[a].trainingProperties(["yMin","yMax"])}for(a in d){var f=this._aes.x;f||(this._aes.x=f={}),f[a]||(f[a]=d[a].copy().property("x").mapping("x")),f[a].trainingProperties(["xMin","xMax"])}},a.getValues=function(a){return a.values},a._render=function(a){var b,c=this.getExplicitScales(["yMin","yMax","y","xMin","xMax","x"]);for(b in c.yMin){var d=c.yMin[b],e=c.yMax[b],f=c.y[b];f&&(e.range(f.range()).domain(f.domain()),d.range(f.range()).domain(f.domain()))}for(b in c.xMin){var g=c.xMin[b],h=c.xMax[b],i=c.x[b];i&&(h.range(i.range()).domain(i.domain()),g.range(i.range()).domain(i.domain()))}this._super(a)},a.pathTween=function(a,b,c,d,e){var f,g=c,h=b.__previousBounds__,i=this.coord()._type;if(f=b.__exiting__?b.__exitTransition__.bounds(c,d):a.getBounds(c,d),h&&h.coord&&i!==h.coord&&(h=b.__exitTransition__.bounds(c,d)),!f||!h)return null;f.coord=i;var j=d3.interpolateObject(h.bounds,f.bounds);return b.__previousBounds__=f,function(b){return g.bounds=j(b),a.getPath(g)}},a.attributes=function(a,b){a.attr("style","").classed(b._dataPointStyleClass,!0).call(b.applyAttributeValue,b,"fill","fill").call(b.applyAttributeValue,b,"stroke","stroke").call(b.applyAttributeValue,b,"opacity","alpha")},a.enterPen=function(){var a=function(a,b){return a.panel.yScale(a).reverse()?1:0},b=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapValue(dv.util.isArray(a.x)?a.x[0]:a.xMin,b))},c=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapValue(dv.util.isArray(a.x)?a.x[1]:a.xMax,b))};return this._decoratePen(b,c,a,a)},a.pen=function(){var a=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapValue(dv.util.isArray(a.x)?a.x[0]:a.xMin,b))},b=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapValue(dv.util.isArray(a.x)?a.x[1]:a.xMax,b))},c=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(dv.util.isArray(a.y)?a.y[0]:a.yMin,b))},d=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(dv.util.isArray(a.y)?a.y[1]:a.yMax,b))};return this._decoratePen(a,b,c,d)},a._defined=function(a,b){var c=a.panel.xScale(a),d=a.panel.yScale(a);return dv.util.isFinite(c.mapValue(dv.util.isArray(a.x)?a.x[0]:a.xMin,b))&&dv.util.isFinite(c.mapValue(dv.util.isArray(a.x)?a.x[1]:a.xMax,b))&&dv.util.isFinite(d.mapValue(dv.util.isArray(a.y)?a.y[0]:a.yMin,b))&&dv.util.isFinite(d.mapValue(dv.util.isArray(a.y)?a.y[1]:a.yMax,b))},a._decoratePen=function(a,b,c,d){var e=this,f=this.coord()._rect().x0(a).x1(b).y0(c).y1(d).defined(this._defined);return{bounds:function(a,b){var c=f.getBounds(a,b);return c&&(c.bounds.coord=e.coord()._type),c},pathTween:function(a,b,c){return e.pathTween(f,this,a,b,c)},path:function(a,b){return f.getPath(f.getBounds(a,b))}}},a}),dv.geom.tile=dv.geom.rect.extend(function(){function a(){this._super(),this._rendererClass=dv.geom.tile}return a._dataPointStyleClass="tile-geom",a._initializeDefaultAes=function(){this._super(),this._defaultAes.y=1,this._defaultAes.x=1},a.getValues=function(a){return a.values},a.enterPen=function(){var a=function(a,b){return a.panel.yScale(a).reverse()?1:0},b=function(a,b){return a.panel.xScale(a).mapPropToPercent(a,b)},c=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand(),b)};return this._decoratePen(b,c,a,a)},a.pen=function(){var a=function(a,b){return a.panel.xScale(a).mapPropToPercent(a,b)},b=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand(),b)},c=function(a,b){return a.panel.yScale(a).mapPropToPercent(a,b)},d=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand(),b)};return this._decoratePen(a,b,c,d)},a._defined=function(a,b){return dv.util.isFinite(a.panel.xScale(a).mapToProp(a,b))&&dv.util.isFinite(a.panel.yScale(a).mapToProp(a,b))},a._decoratePen=function(a,b,c,d){var e=this,f=this.coord()._rect().x0(a).x1(b).y0(c).y1(d).defined(this._defined);return{bounds:function(a,b){var c=f.getBounds(a,b);return c&&(c.bounds.coord=e.coord()._type),c},pathTween:function(a,b,c){return e.pathTween(f,this,a,b,c)},path:function(a,b){return f.getPath(f.getBounds(a,b))}}},a}),dv.geom.bar=dv.geom.rect.extend(function(){function a(){this._super(),this._rendererClass=dv.geom.bar,this._baseline=0,this._width=1}return a._dataPointStyleClass="bar-geom",a._initializeDefaultAes=function(){this._super(),this._defaultAes.y=1,this._defaultAes.x=1},a._trainScales=function(){if(void 0!==this._baseline){var a=this.getExplicitScales("y").y;for(var b in a){var c=a[b];c instanceof dv.scale.continuous&&c.softLowerLimit(this._baseline)}}},a.getValues=function(a){return a.values},a.getBaseline=function(a){var b=d3.min(a.domain());return void 0!==self._baseline?self._baseline:b<0?0:b},a.width=function(a){return arguments.length?(this._width=a,this):this.width},a._enforceMinSize=function(a,b,c){var d=this.getBaseline(a),e=b[a.property()]-d,f=a.mapValueToPercent(a.mapValue(d)),g=a.mapPropToPercent(b,c)-f,h=dv.util.scaleExtent(a.range()),i=h[1]-h[0],j=1/i;return 0===i?f:a.reverse()?f+(e<0?Math.max(j,g):Math.min(-j,g)):f+(e<0?Math.min(-j,g):Math.max(j,g))},a.enterPen=function(){var a,b,c=this,d=function(a,b){var d=a.panel.yScale(a);return d.mapValueToPercent(d.mapValue(c.getBaseline(d)),b)};return"dodge"===this.position()?(a=function(a,b){var d=a.panel.xScale(a);return d.mapValueToPercent(d.mapToProp(a,b)+c._dodgeAdjust(a),b)},b=function(a,b){var d=a.panel.xScale(a);return d.mapValueToPercent(d.mapToProp(a,b)+c._dodgeAdjust(a,!0),b)}):(a=function(a,b){var d=a.panel.xScale(a);return d.mapValueToPercent(d.mapToProp(a,b)+c._offsetX(a),b)},b=function(a,b){var d=a.panel.xScale(a);return d.mapValueToPercent(d.mapToProp(a,b)+c._offsetX(a,!0),b)}),this._decoratePen(a,b,d,d)},a.pen=function(){var a,b,c,d,e=this;switch(this.position()){case"identity":a=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+e._offsetX(a),b)},b=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+e._offsetX(a,!0),b)},c=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(e.getBaseline(c)),b)},d=function(a,b){return e._enforceMinSize(a.panel.yScale(a),a,b)};break;case"stack":a=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+e._offsetX(a),b)},b=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+e._offsetX(a,!0),b)},c=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(a.y0),b)},d=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(a.y0+a.y),b)};break;case"dodge":a=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+e._dodgeAdjust(a),b)},b=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+e._dodgeAdjust(a,!0),b)},c=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(e.getBaseline(c)),b)},d=function(a,b){return e._enforceMinSize(a.panel.yScale(a),a,b)};break;case"fill":a=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+e._offsetX(a),b)},b=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+e._offsetX(a,!0),b)},c=function(a,b){return a.y0},d=function(a,b){return a.y+a.y0}}return this._decoratePen(a,b,c,d)},a._offsetX=function(a,b){var c=a.panel.xScale(a),d=c.rangeBand();return d/2+d/2*(b?this._width:-this._width)},a._defined=function(a,b){return dv.util.isFinite(a.panel.xScale(a).mapToProp(a,b))&&dv.util.isFinite(a.panel.yScale(a).mapToProp(a,b))},a._decoratePen=function(a,b,c,d){var e=this,f=this.coord()._rect().x0(a).x1(b).y0(c).y1(d).defined(this._defined);return{bounds:function(a,b){var c=f.getBounds(a,b);return c&&(c.bounds.coord=e.coord()._type),c},pathTween:function(a,b,c){return e.pathTween(f,this,a,b,c)},path:function(a,b){return f.getPath(f.getBounds(a,b))}}},a._dodgeAdjust=function(a,b){var c=a.dodge.groupIndex,d=a.dodge.numGroups,e=a.panel.xScale(a).rangeBand(),f=d>1?e/(d-1)*this._dodgePadding:0,g=(e-f*(d-1))/d;return(g+f)*c+(b?g:0)},a.baseline=function(a){return arguments.length?(this._baseline=a,this):this._baseline},a}),dv.geom.barrange=dv.geom.bar.extend(function(){function a(){this._super(),this._rendererClass=dv.geom.barrange}return a._initializeDefaultAes=function(){this._super(),this._defaultAes.yMin=1,this._defaultAes.yMax=1,delete this._defaultAes.y},a._trainScales=function(){var a,b,c=this.getExplicitScales("yMin").yMin;for(var d in c)this._aes.y||(this._aes.y={}),a=this._aes.y,b=a[d],b||(a[d]=b=c[d].copy().property("y").mapping("y")),b.trainingProperties(["yMin","yMax"])},a._render=function(a){var b=this.getExplicitScales(["yMin","yMax","y"]),c=b.yMin;for(var d in c){var e=c[d],f=b.yMax[d],g=b.y[d];f.range(g.range()).domain(g.domain()),e.range(g.range()).domain(g.domain())}this._super(a)},a.enterPen=function(){var a=this,b=function(a,b){return a.panel.yScale(a).reverse()?1:0},c=function(b,c){var d=b.panel.xScale(b);return d.mapValueToPercent(d.mapToProp(b,c)+a._offsetX(b),c)},d=function(b,c){var d=b.panel.xScale(b);return d.mapValueToPercent(d.mapToProp(b,c)+a._offsetX(b,!0),c)};return this._decoratePen(c,d,b,b)},a.pen=function(){var a=this,b=function(b,c){var d=b.panel.xScale(b);return d.mapValueToPercent(d.mapToProp(b,c)+a._offsetX(b),c)},c=function(b,c){var d=b.panel.xScale(b);return d.mapValueToPercent(d.mapToProp(b,c)+a._offsetX(b,!0),c)},d=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(a.yMin,b),b)},e=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(a.yMax,b),b)};return this._decoratePen(b,c,d,e)},a._defined=function(a,b){var c=a.panel.xScale(a),d=a.panel.yScale(a);return dv.util.isFinite(c.mapToProp(a,b))&&dv.util.isFinite(d.mapValue(a.yMin,b))&&dv.util.isFinite(d.mapValue(a.yMax,b))},a._decoratePen=function(a,b,c,d){var e=this,f=this.coord()._rect().x0(a).x1(b).y0(c).y1(d).defined(this._defined);return{bounds:function(a,b){var c=f.getBounds(a,b);return c&&(c.bounds.coord=e.coord()._type),c},pathTween:function(a,b,c){return e.pathTween(f,this,a,b,c)},path:function(a,b){return f.getPath(f.getBounds(a,b))}}},a}),dv.geom.segment=dv.geom.line.extend(function(){function a(){this._super(),this._rendererClass=dv.geom.segment}return a.getValues=function(a){return a.values},a.enterPen=function(){var a=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)},b=function(a,b){return a.panel.yScale(a).reverse()?1:0};return this._decoratePen(a,b)},a.pen=function(){var a=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)},b=function(a,b){return a.panel.yScale(a).mapPropToPercent(a,b)};return this._decoratePen(a,b)},a}),dv.geom.vline=dv.geom.segment.extend(function(){function a(){this._super(),this._rendererClass=dv.geom.vline}return a._dataPointStyleClass="vline-geom",a._render=function(a){var b=this;dv.util.each(this._nestData,function(a,c){var d=[];dv.util.each(a.values,function(a,b){var c=a.panel.xScale(a),e=a.panel.yScale(a),f=(e.domain(),a[c.property()]);if(dv.util.isArray(a))a[0].x=f,a[1].x=f;else{var g=[];a.x=f,g.push(a),g.push(dv.util.clone(a)),d.push(g)}}),b._nestData[c].values=d}),this._super(a)},a.enterPen=function(){var a=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)},b=function(a,b){return 0};return this._decoratePen(a,b)},a.pen=function(){var a=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)},b=function(a,b){return 0===b?0:1};return this._decoratePen(a,b)},a._defined=function(a,b){return dv.util.isFinite(a.panel.xScale(a).mapToProp(a,b))},a}),dv.geom.hline=dv.geom.segment.extend(function(){function a(){this._super(),this._rendererClass=dv.geom.hline}return a._dataPointStyleClass="hline-geom",a._render=function(a){var b=this;dv.util.each(this._nestData,function(a,c){var d=[];dv.util.each(a.values,function(a,b){var c=a.panel.xScale(a),e=a.panel.yScale(a),f=(c.domain(),a[e.property()]);if(dv.util.isArray(a))a[0].y=f,a[1].y=f;else{var g=[];a.y=f,g.push(a),g.push(dv.util.clone(a)),d.push(g)}}),b._nestData[c].values=d}),this._super(a)},a.enterPen=function(){var a=function(a,b){return 0===b?a.data&&a.data.xStart?a.data.xStart:0:a.data&&a.data.xEnd?a.data.xEnd:1},b=function(a,b){return a.panel.yScale(a).reverse()?1:0};return this._decoratePen(a,b)},a.pen=function(){var a=function(a,b){return 0===b?a.data&&a.data.xStart?a.data.xStart:0:a.data&&a.data.xEnd?a.data.xEnd:1},b=function(a,b){return a.panel.yScale(a).mapPropToPercent(a,b)};return this._decoratePen(a,b)},a._defined=function(a,b){return dv.util.isFinite(a.panel.yScale(a).mapToProp(a,b))},a}),dv.geom.ribbon=dv.geom.area.extend(function(){function a(){this._super(),this._rendererClass=dv.geom.ribbon}return a._initializeDefaultAes=function(){this._super(),this._defaultAes.yMin=1,this._defaultAes.yMax=1,delete this._defaultAes.y},a._trainScales=function(){var a,b,c=this.getExplicitScales("yMin").yMin;for(var d in c)this._aes.y||(this._aes.y={}),a=this._aes.y,b=a[d],b||(a[d]=b=c[d].copy().property("y").mapping("y")),b.trainingProperties(["yMin","yMax"])},a._render=function(a){var b=this.getExplicitScales(["yMin","yMax","y"]),c=b.yMin;for(var d in c){var e=c[d],f=b.yMax[d],g=b.y[d];f.range(g.range()).domain(g.domain()),e.range(g.range()).domain(g.domain())}this._super(a)},a.enterPen=function(){var a=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)},b=function(a,b){return a.panel.yScale(a).reverse()?1:0};return this._decoratePen(a,b,b)},a.pen=function(){var a=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)},b=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(a.yMin,b))},c=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(a.yMax,b))};return this._decoratePen(a,b,c)},a._defined=function(a,b){var c=a.panel.xScale(a),d=a.panel.yScale(a);return dv.util.isFinite(c.mapToProp(a,b))&&dv.util.isFinite(d.mapValue(a.yMin,b))&&dv.util.isFinite(d.mapValue(a.yMax,b))},a._decoratePen=function(a,b,c){var d=this,e=this.coord()._area().x(a).y0(b).y1(c).defined(this._defined);return e.renderer.tension(this.tension()).interpolate(this.interpolate()),{bounds:function(a,b){var c=e.getBounds(a,b);return c&&(c.coord=d.coord()),c},pathTween:function(a,b){return d.pathTween(e,this,a,b)},path:function(a,b){return e.getPath(e.getBounds(a,b))}}},a}),dv.geom.errorbar=dv.geom.extend(function(){function a(){this._super(),this._rendererClass=dv.geom.errorbar,this._width=1}return a._dataPointStyleClass="errorbar-geom",a._initializeDefaultAes=function(){this._super(),this._defaultAes.yMin=1,this._defaultAes.yMax=1,delete this._defaultAes.y},a._trainScales=function(){var a,b=this.getExplicitScales("yMin").yMin;for(var c in b)this._aes.y||(this._aes.y={}),yScales=this._aes.y,a=yScales[c],a||(yScales[c]=a=b[c].copy().property("y").mapping("y")),a.trainingProperties(["yMin","yMax"])},a.getValues=function(a){return a.values},a.width=function(a){return arguments.length?(this._width=a,this):this._width},a.attributes=function(a,b){var c=b.getScale("linetype");a.attr("style","").classed(b._dataPointStyleClass,!0).call(b.applyAttributeValue,b,"stroke","stroke").call(b.applyAttributeValue,b,"opacity","alpha").call(b.applyAttributeValue,b,"stroke-width","size").style("stroke-dasharray",function(a,b,d){return c?dv.util.svg.getDasharray(c.mapToProp(a[0],b,d)):null}).style("fill","none")},a._render=function(a){if(!(this.getScale("x")instanceof dv.scale.ordinal)){var b,c,d=Number.MAX_VALUE;dv.util.each(this._nestData,function(a){dv.util.each(a.values,function(a){b=a.panel.xScale(a).mapValue(a.x),dv.util.isUndefined(c)||(d=Math.min(d,Math.abs(b-c))),c=b})}),this._maxWidthPixels=d}var e=this.getExplicitScales(["yMin","yMax","y"]),f=e.yMin;for(var g in f){var h=f[g],i=e.yMax[g];yScale=e.y[g],i.range(yScale.range()).domain(yScale.domain()),h.range(yScale.range()).domain(yScale.domain())}this._super(a)},a.enterPen=function(){var a=this,b=function(b,c){var d=b.panel.xScale(b);return d.mapValueToPercent(d.mapToProp(b,c)+a._offsetX(b),c)},c=function(b,c){var d=b.panel.xScale(b);return d.mapValueToPercent(d.mapToProp(b,c)+a._offsetX(b,!0),c)},d=function(a,b){return a.panel.yScale(a).reverse()?1:0};return this._decoratePen(b,c,d,d)},a.pen=function(){var a=this,b=function(b,c){var d=b.panel.xScale(b);return d.mapValueToPercent(d.mapToProp(b,c)+a._offsetX(b),c)},c=function(b,c){var d=b.panel.xScale(b);return d.mapValueToPercent(d.mapToProp(b,c)+a._offsetX(b,!0),c)},d=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(a.yMin,b))},e=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(a.yMax,b))};return this._decoratePen(b,c,d,e)},a._isOrdinal=function(a){return a.panel.xScale(a)instanceof dv.scale.ordinal},a._offsetX=function(a,b){var c=a.panel.xScale(a);return c instanceof dv.scale.ordinal?c.rangeBand()/2+c.rangeBand()/2*(b?this._width:-this._width):this._maxWidthPixels*(b?this._width/2:-this._width/2)},a._defined=function(a,b){var c=a.panel.xScale(a),d=a.panel.yScale(a);return dv.util.isFinite(c.mapToProp(a,b))&&dv.util.isFinite(d.mapValue(a.yMin,b))&&dv.util.isFinite(d.mapValue(a.yMax,b))},a._decoratePen=function(a,b,c,d){var e=this,f=this.coord()._errorBar().x0(a).x1(b).y0(c).y1(d).defined(this._defined);return{bounds:function(a,b){return f.getBounds(a,b)},pathTween:function(a,b){return e.pathTween(f,this,a,b)},path:function(a,b){return f.getPath(f.getBounds(a,b))}}},a}),dv.geom.poly=dv.geom.extend(function(){function a(){this._super(),this._rendererClass=dv.geom.poly}return a._dataPointStyleClass="poly-geom",a._initializeDefaultAes=function(){this._super(),this._defaultAes.size=1,delete this._defaultAes.shape,delete this._defaultAes.x,delete this._defaultAes.y},a._trainScales=function(){var a,b=this.getExplicitScales(["yMin","xMin"]);for(a in b.yMin){var c=this._aes.y;c||(this._aes.y=c={}),c[a]||(c[a]=yMinScale.copy().property("y").mapping("y")),c[a].trainingProperties(["yMin","yMax"])}for(a in b.xMin){var d=this._aes.x;d||(this._aes.x=d={}),d[a]||(d[a]=xMinScale.copy().property("x").mapping("x")),d[a].trainingProperties(["xMin","xMax"])}},a.getValues=function(a){return a.values},a.attributes=function(a,b){b.getScale("fill"),b.getScale("stroke"),b.getScale("alpha");a.attr("style","").classed(b._dataPointStyleClass,!0).call(b.applyAttributeValue,b,"stroke","stroke").call(b.applyAttributeValue,b,"fill","fill").call(b.applyAttributeValue,b,"opacity","alpha")},a.exitSeriesGroup=function(a,b){b.exitSeries(a,b.enterPen,b)},a.getHighlightColor=function(a,b){var c=this.getScale("fill"),d=this.getScale("stroke");return d instanceof dv.scale.constant?c instanceof dv.scale.constant?d.mapToProp(a,b):c.mapToProp(a,b):d.mapToProp(a,b)},a.enterPen=function(){var a=function(a,b){return a.panel.xScale(a).mapPropToPercent(a,b)},b=function(a,b){var c=a.panel.yScale(a)
;return dv.util.map(a[c.property()],function(){return c.reverse()?1:0})};return this._decoratePen(a,b)},a.pen=function(){var a=function(a,b){return a.panel.xScale(a).mapPropToPercent(a,b)},b=function(a,b){return a.panel.yScale(a).mapPropToPercent(a,b)};return this._decoratePen(a,b)},a._defined=function(a,b){for(var c=a.panel.xScale(a).mapToProp(a,b),d=a.panel.yScale(a).mapToProp(a,b),e=d3.max([c.length,d.length]),f=!0,g=0;g<e&&f;g++)f=dv.util.isFinite(c[g])&&dv.util.isFinite(d[g]);return f},a._decoratePen=function(a,b){var c=this,d=this.coord()._poly().xs(a).ys(b).defined(this._defined);return{bounds:function(a,b){return d.getBounds(a,b)},pathTween:function(a,b,e){return c.pathTween(d,this,a,b,e)},path:function(a,b){return d.getPath(d.getBounds(a,b))}}},a}),dv.behavior=dv.extend(function(){function a(){}var b;return a._testAndroidChromeBug141840=function(){if(void 0===b){var a=navigator.userAgent;b=null!==/Android .* Chrome\/18+/.exec(a)||null!==/Silk\/2./.exec(a)}return b},a}),dv.behavior.inspector=dv.behavior.extend(function(){function a(){this._size=void 0,this._lastX=NaN,this._visible=!1,this._inspector=null,this._thickness=3,this._orientation="bottom",this._currentValue=null,this._gutterPadding=-7,this._calloutPadding={left:8,top:7,right:8,bottom:7},this._label=this._defaultLabel(),this._underGeoms=!1,this._dragInspect=!0,this._pressTimer=null}function b(){var a=[],b=this._chart.getTrainedScale("x"),c=!1,d=function(a,d){return a=b._parse(a),d=b._parse(d),c&&a&&d?a.getTime()===d.getTime():a===d},e=function(a){return b.mapValue(a)},f=this._chart.data(),g=-1,h=this._chart._layers.length;for(f.length&&a.concat(f[b.property()]);++g<h;){var i=this._chart._layers[g],j=i.getTrainedScale("x"),k=i.data()[j.property()];k&&k!==f&&(a=a.concat(k)),c=c||j instanceof dv.scale.time||j instanceof dv.scale.time.utc}return a.length?dv.util.sortBy(dv.util.uniqueValues(a,d),e):a}function c(){this._chart.on("mousemove.inspector",dv.util.bind(g,this)),this._chart.on("mouseout.inspector",dv.util.bind(h,this)),this._chart.on("touchstart.inspector",dv.util.bind(e,this),dv.passiveListenerOption),this._chart.on("touchmove.inspector",dv.util.bind(g,this),dv.passiveListenerOption),this._chart.on("touchend.inspector",dv.util.bind(f,this),dv.passiveListenerOption)}function d(a,b,c){var d=0,e=0;if(this._lastX!==c){dv.setVisibilityForeground(this._inspector),this._inspector.select(".inspector-tip-label").text(b).each(function(){var a=this.getBBox();d=Math.max(a.width,d),e=Math.max(a.height,e)});var f,g=this._chart.facet().getPanel(0).bounds();d+=this._calloutPadding.left+this._calloutPadding.right,e+=this._calloutPadding.top+this._calloutPadding.bottom,f=c-d/2,f<g.left+this._gutterPadding&&(f=g.left+this._gutterPadding),f+d>g.right-this._gutterPadding&&(f=g.right-this._gutterPadding-d),this._inspector.select(".inspector-marker").attr("transform","translate("+f+",0)"),this._inspector.select(".inspector-tip-background").attr("width",d).attr("height",e);var h=c-f;this._inspector.select(".inspector-line-container").attr("transform","translate("+h+",0)")}}function e(a){if(a){var b=this;return this._dragInspect=!1,clearTimeout(this._pressTimer),this._pressTimer=setTimeout(function(){b._dragInspect=!0,g.call(b,a)},500),!1}}function f(a){clearTimeout(this._pressTimer),this._dragInspect&&(this._dragInspect=!1),h.call(this,a)}function g(a){if(a){if(!this._dragInspect)return void clearTimeout(this._pressTimer);var b=a.touches?a.touches[0]:a,c=this._chart.getTrainedScale("x"),e=this._testAndroidChromeBug141840()?b.screenX:b.clientX,f=e-b.target.getBoundingClientRect().left+b.target.getBBox().x,g=dv.util.binaryCompare(this._domain,f,function(a){return c.mapValue(a)}),h=Math.min(Math.max(g||0,0),this._domain.length-1),i=this._domain[h],j=this._label.call(this,i,h),k=c.mapValue(i);this._currentValue!=i&&(this._inspectorMove&&this._inspectorMove.call(this,j,h,k,i),d.call(this,i,j,k)),this._currentValue=i,dv.cancelEvent(a)}}function h(a){dv.setVisibilityHidden(this._inspector),this._inspectorOut&&this._inspectorOut.call(this),this._currentValue=null,dv.cancelEvent(a)}return a._render=function(a){this._domain=b.call(this);var c=this._chart.facet().getPanel(0)._bounds;void 0===this._size&&(this._size=c.bottom-c.top),this._xGuide=dv.util.clone(this._chart._axes._get("x")[0]),this._selection=a,this._inspector=a.selectAll(".inspector").data([0]),this._inspector.call(this._createInspector,this._orientation,c,this._calloutPadding,this._thickness),dv.setVisibilityHidden(this._inspector)},a._createInspector=function(a,b,c,d,e){var f=a,g=a.enter();g=g.append("g").classed({visibilityTransition:!0,inspector:!0}),f.style("pointer-events","none").attr("transform","translate(0,"+c.top+")");var h=g.append("g").classed("inspector-marker",!0),i=h.append("g").classed("inspector-line-container",!0);i.append("path").classed("inspector-callout",!0),f.select(".inspector-callout").attr("d",function(){var a=-3,d=a+5;return"bottom"===b&&(a=c.bottom-c.top+2,d=a-5),"M-5,"+a+"L5,"+a+"L0,"+d+"Z"}),i.append("line").classed("inspector-line",!0),f.select(".inspector-line").attr("y1","bottom"===b?0:4).attr("y2","bottom"===b?c.bottom-c.top-6:c.bottom-c.top).style("stroke-width",e);var j=h.append("g").classed("inspector-tip",!0);f.select(".inspector-tip").attr("transform","translate(0,"+("bottom"===b?c.bottom-c.top+2:-30)+")"),j.append("rect").classed("inspector-tip-background",!0),j.append("text").classed("inspector-tip-label",!0),f.select(".inspector-tip-label").attr("x",d.left).attr("y","1em").attr("dy",d.top)},a.moveToIndex=function(a){var b=this._chart.getTrainedScale("x"),c=this._domain[a],e=this._label.call(this,c,a),f=b.mapValue(c);d.call(this,c,e,f)},a.hide=function(){return dv.setVisibilityHidden(this._inspector),this._visible=!1,this},a.show=function(){return dv.setVisibilityForeground(this._inspector),this._visible=!0,this},a._removeEvents=function(){this._chart.on("mousemove.inspector",null),this._chart.on("mouseout.inspector",null),this._chart.on("touchstart.inspector",null),this._chart.on("touchmove.inspector",null),this._chart.on("touchend.inspector",null)},a.inspectorMove=function(a){return arguments.length?(this._inspectorMove=a,this):this._inspectorMove},a.inspectorOut=function(a){return arguments.length?(this._inspectorOut=a,this):this._inspectorOut},a.label=function(a){return arguments.length?(this._label=d3.functor(a),this):this._label},a.thickness=function(a){return arguments.length?(this._thickness=a,this):this._thickness},a.size=function(a){return arguments.length?(this._size=a,this):this._size},a.chart=function(a){return arguments.length?(this._chart&&this._removeEvents(),this._chart=a,this._chart&&c.call(this),this):this._chart},a.orientation=function(a){return arguments.length?(this._orientation=a,this):this._orientation},a._defaultLabel=function(){var a=this;return function(b){return(a._xGuide.tickFormat?a._xGuide.tickFormat():function(a){return a})(b)}},a.label=function(a){return arguments.length?(this._label=d3.functor(a),this):this._label},a.underGeoms=function(a){return arguments.length?(this._underGeoms=a,this):this._underGeoms},a.gutterPadding=function(a){return arguments.length?(this._gutterPadding=a,this):this._gutterPadding},a}),dv.behavior.brush=dv.behavior.extend(function(){function a(a){arguments.length&&!dv.util.isArray(a)&&(this._dimensions=[this._dimensions]),this._fluidDimensions=a||["x","y"],this._snap=!1,this._resizing=!1}return a.initializeBrush=function(a){var b=this;this._brush=dv.brush(a).on("brushstart.brush",function(){b._onBrushStart.call(b),b._brushStart&&b._brushStart.call(this,"start",b._brush.extent(),b)}).on("brush.brush",function(a){b._onBrushMove.call(b),b._brushMove&&b._brushMove.call(this,"move",b._brush.extent(),b)}).on("brushend.brush",function(){b._onBrushEnd.call(b),b._brushEnd&&b._brushEnd.call(this,"end",b._brush.extent(),b)})},a._removeEvents=function(){this._brush.on("brushstart.brush",null).on("brush.brush",null).on("brushend.brush",null)},a._onBrushStart=function(){!this.snap()||this._fluidDimensions.length>1||(this._startPos=d3.mouse(this._brushContainer.node()),this._moving=d3.select(d3.event.sourceEvent.target).classed("extent"))},a._onBrushMove=function(){if(this.snap()&&!(this._fluidDimensions.length>1)){var a=d3.mouse(this._brushContainer.node());this._startPos[0]===a[0]&&this._startPos[1]===a[1]||this._snapToDataPoints()}},a._onBrushEnd=function(){if(this.snap()&&!(this._fluidDimensions.length>1)){var a=d3.mouse(this._brushContainer.node());this._moving||this._startPos[0]!==a[0]||this._startPos[1]!==a[1]?this._brushContainer.selectAll(".resize").style("display",null):this.clear()}},a._snapToDataPoints=function(){var a=this._brush.extent(),b=[],c=this._chart.getTrainedScale(this._fluidDimensions[0]),d=[this._snapToNearestPoint(c,a[0],0),this._snapToNearestPoint(c,a[1],1)];this._brush.extent([d[0].value,d[1].value]);var e=this._chart.plotBounds();"x"===this._fluidDimensions?(b[0]=[d[0].rangeValue,0],b[1]=[d[1].rangeValue,e.bottom-e.top]):(b[0]=[0,d[0].rangeValue],b[1]=[e.right-e.left,d[1].rangeValue]),this._adjustBounds(this._brushContainer,b)},a._snapToNearestPoint=function(a,b,c){var d,e={};if(a instanceof dv.scale.ordinal||a instanceof dv.scale.identity){var f=dv.util.scaleRangeNoReverse(a),g=f[1]-f[0];domain=a.domain(),d=Math.round(a.invertValue(b)/g-1)}else domain=dv.util.uniq(this._chart.data()[a.mapping()]),index=dv.util.binaryCompare(domain,b,function(a){return a}),d=Math.min(Math.max(index||0,0),domain.length-1);var h=domain[d];if(e.value=h,0===c)if(0===d)e.rangeValue=a.mapValue(h);else{var i=domain[d-1],j=a.mapValue(i);valueRange=a.mapValue(h),e.rangeValue=valueRange-(valueRange-j)/2}else if(d===domain.length-1)e.rangeValue=a.mapValue(h);else{var k=domain[d+1],l=a.mapValue(k);valueRange=a.mapValue(h),e.rangeValue=valueRange+(l-valueRange)/2}return e},a._adjustBounds=function(a,b){"x"===this._fluidDimensions&&this._adjustBoundsX(a,b),"y"===this._fluidDimensions&&this._adjustBoundsY(a,b),a.selectAll(".resize").attr("transform",function(a){return"translate("+b[+/e$/.test(a)][0]+","+b[+/^s/.test(a)][1]+")"})},a._adjustBoundsX=function(a,b){a.select(".extent").attr("x",b[0][0]),a.selectAll(".extent,.n>rect,.s>rect").attr("width",b[1][0]-b[0][0])},a._adjustBoundsY=function(a,b){a.select(".extent").attr("y",b[0][1]),a.selectAll(".extent,.e>rect,.w>rect").attr("height",b[1][1]-b[0][1])},a._setScales=function(){if(this._fluidDimensions.indexOf("x")>=0){var a=this._chart.getTrainedScale("x");this._brush.x(a._d3Scale)}if(this._fluidDimensions.indexOf("y")>=0){var b=this._chart.getTrainedScale("y");this._brush.y(b._d3Scale)}},a._render=function(){this._brushContainer=this._chart._parent.select(".interaction-group"),this._brush.empty()&&this._brushContainer.classed("brush",!0).call(this._brush);var a=this._chart.plotBounds();if(!this._brush.y()){var b=a.bottom-a.top;this._brushContainer.selectAll(".extent").attr("height",b).attr("y",0),this._brushContainer.selectAll(".resize rect").attr("height",b).attr("y",0)}if(!this._brush.x()){var c=a.right-a.left;this._brushContainer.selectAll(".extent").attr("width",c).attr("x",0),this._brushContainer.selectAll(".resize rect").attr("width",c).attr("x",0)}},a.empty=function(){return this._brush.empty()},a.clear=function(){this._brushContainer.call(this._brush.clear())},a.extent=function(a){return arguments.length?(this._brushContainer.call(this._brush.extent(a)),this):this._brush?this._brush.extent():null},a.snap=function(a){return arguments.length?(this._snap=!(this._fluidDimensions.length>1)&&a,this):this._snap},a.brushStart=function(a){return arguments.length?(this._brushStart=a,this):this._brushStart},a.brushMove=function(a){return arguments.length?(this._brushMove=a,this):this._brushMove},a.brushEnd=function(a){return arguments.length?(this._brushEnd=a,this):this._brushEnd},a.chart=function(a){return arguments.length?(this._chart=a,this.initializeBrush(this._chart),this._chart&&this._setScales(),this):this._chart},a}),dv.brush=function(a){function b(g){g.each(function(){var g,h=d3.select(this),l=h.selectAll(".background").data([0]),m=h.selectAll(".extent").data([0]),n=h.selectAll(".resize").data(k,String);a.on("mousedown.brush",f).on("touchstart.brush",f)._g.style("cursor","crosshair"),h.style("pointer-events","all"),m.enter().append("rect").attr("class","extent").style("cursor","move"),n.enter().append("g").attr("class",function(a){return"resize "+a}).style("cursor",function(a){return Z[a]}).append("rect").attr("x",function(a){return/[e]$/.test(a)?-10:/[w]$/.test(a)?2:null}).attr("y",function(a){return/^[ns]/.test(a)?-3:null}).attr("width",10).attr("height",6).style("visibility","hidden"),n.style("display",b.empty()?"none":null),n.exit().remove(),i&&(g=dv.util.scaleRangeNoReverse(i),l.attr("x",g[0]).attr("width",g[1]-g[0]),d(h)),j&&(g=dv.util.scaleRangeNoReverse(j),l.attr("y",g[0]).attr("height",g[1]-g[0]),e(h)),c(h)})}function c(a){a.selectAll(".resize").attr("transform",function(a){return"translate("+l[+/e$/.test(a)][0]+","+l[+/^s/.test(a)][1]+")"})}function d(a){a.select(".extent").attr("x",l[0][0]),a.selectAll(".extent,.n>rect,.s>rect").attr("width",l[1][0]-l[0][0])}function e(a){a.select(".extent").attr("y",l[0][1]),a.selectAll(".extent,.e>rect,.w>rect").attr("height",l[1][1]-l[0][1])}function f(){function a(){var a=d3.event.changedTouches;return a?d3.touches(r,a)[0]:d3.mouse(r)}function f(){32==d3.event.keyCode&&(y||(p=null,z[0]-=l[1][0],z[1]-=l[1][1],y=2),I())}function k(){32==d3.event.keyCode&&2==y&&(z[0]+=l[1][0],z[1]+=l[1][1],y=0,I())}function m(){var b=a(),f=!1;q&&(b[0]+=q[0],b[1]+=q[1]),y||(d3.event.altKey?(p||(p=[(l[0][0]+l[1][0])/2,(l[0][1]+l[1][1])/2]),z[0]=l[+(b[0]<p[0])][0],z[1]=l[+(b[1]<p[1])][1]):p=null),w&&n(b,i,0)&&(d(u),f=!0),x&&n(b,j,1)&&(e(u),f=!0),f&&(c(u),t({type:"brush",mode:y?"move":"resize"}))}function n(a,b,c){var d,e,f=dv.util.scaleRangeNoReverse(b),h=f[0],i=f[1],j=z[c],k=l[1][c]-l[0][c];if(y&&(h-=j,i-=k+j),d=Math.max(h,Math.min(i,a[c])),y?e=(d+=j)+k:(p&&(j=Math.max(h,Math.min(i,2*p[c]-d))),j<d?(e=d,d=j):e=j),l[0][c]!==d||l[1][c]!==e)return g=null,l[0][c]=d,l[1][c]=e,!0}function o(){m(),u.style("pointer-events","all").selectAll(".resize").style("display",b.empty()?"none":null),d3.select("body").style("cursor",null),A.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),t({type:"brushend"}),I()}var p,q,r=this,s=d3.select(d3.event.target),t=h.of(r,arguments),u=d3.select(r),v=s.datum(),w=!/^(n|s)$/.test(v)&&i,x=!/^(e|w)$/.test(v)&&j,y=s.classed("extent"),z=a(),A=d3.select(window).on("mousemove.brush",m).on("mouseup.brush",o).on("touchmove.brush",m).on("touchend.brush",o).on("keydown.brush",f).on("keyup.brush",k);if(y)z[0]=l[0][0]-z[0],z[1]=l[0][1]-z[1];else if(!v||"e"!==v&&"w"!==v&&"s"!==v&&"n"!==v&&"nw"!==v&&"ne"!==v&&"sw"!==v&&"se"!==v)d3.event.altKey&&(p=z.slice());else{var B=+/w$/.test(v),C=+/^n/.test(v);q=[l[1-B][0]-z[0],l[1-C][1]-z[1]],z[0]=l[B][0],z[1]=l[C][1]}u.style("pointer-events","none").selectAll(".resize").style("display",null),d3.select("body").style("cursor",s.style("cursor")),t({type:"brushstart"}),m(),I()}var g,h=H(b,"brushstart","brush","brushend"),i=null,j=null,k=$[0],l=[[0,0],[0,0]];return b.x=function(a){return arguments.length?(i=a,k=$[!i<<1|!j],b):i},b.y=function(a){return arguments.length?(j=a,k=$[!i<<1|!j],b):j},b.extent=function(a){var c,d,e,f,h;return arguments.length?(g=[[0,0],[0,0]],i&&(c=a[0],d=a[1],j&&(c=c[0],d=d[0]),g[0][0]=c,g[1][0]=d,i.invert&&(c=i(c),d=i(d)),d<c&&(h=c,c=d,d=h),l[0][0]=0|c,l[1][0]=0|d),j&&(e=a[0],f=a[1],i&&(e=e[1],f=f[1]),g[0][1]=e,g[1][1]=f,j.invert&&(e=j(e),f=j(f)),f<e&&(h=e,e=f,f=h),l[0][1]=0|e,l[1][1]=0|f),b):(a=g||l,i&&(c=a[0][0],d=a[1][0],g||(c=l[0][0],d=l[1][0],i.invert&&(c=i.invert(c),d=i.invert(d)),d<c&&(h=c,c=d,d=h))),j&&(e=a[0][1],f=a[1][1],g||(e=l[0][1],f=l[1][1],j.invert&&(e=j.invert(e),f=j.invert(f)),f<e&&(h=e,e=f,f=h))),i&&j?[[c,e],[d,f]]:i?[c,d]:j&&[e,f])},b.clear=function(){return g=null,l[0][0]=l[0][1]=l[1][0]=l[1][1]=0,b},b.empty=function(){return i&&l[0][0]===l[1][0]||j&&l[0][1]===l[1][1]},d3.rebind(b,h,"on")};var Z={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},$=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];F.prototype.on=function(a,b){var c=a.indexOf("."),d="";return c>0&&(d=a.substring(c+1),a=a.substring(0,c)),arguments.length<2?this[a].on(d):this[a].on(d,b)},dv.behavior.zoom=dv.behavior.extend(function(){function a(a){arguments.length&&!dv.util.isArray(a)&&(this._dimensions=[this._dimensions]),this._fluidDimensions=a||["x","y"],this._zoom=d3.behavior.zoom(),this.scaleExtent([0,1/0]),this._underGeoms=!1}return a.initializeZoom=function(a){var b=this;this._cacheAxes(),this._zoom.on("zoomstart.zoom",function(){b._zoomStart&&b._zoomStart.call(this,"start",d3.event.scale,d3.event.translate,b)}).on("zoom.zoom",function(){b._zoomMove&&b._zoomMove.call(this,"move",d3.event.scale,d3.event.translate,b),b._refresh(d3.event.scale,d3.event.translate)}).on("zoomend.zoom",function(){b._zoomEnd&&b._zoomEnd.call(this,"end",d3.event.scale,d3.event.translate,b)})},a.underGeoms=function(a){return arguments.length?(this._underGeoms=a,this):this._underGeoms},a._cacheAxes=function(){this._axisCache={};for(var a in this._chart._axes._axes)this._axisCache[a]=this._chart._axes._axes[a]},a._removeEvents=function(){this._zoom.on("zoomstart.zoom",null).on("zoom.zoom",null).on("zoomend.zoom",null)},a._refresh=function(a,b){var c=this,d=[0,this._bounds.width-this._bounds.width*a],e=[0,this._bounds.height-this._bounds.height*a];a>=1?(b[0]=Math.min(d[0],Math.max(b[0],d[1])),b[1]=Math.min(e[0],Math.max(b[1],e[1]))):(b[0]=b[0]<d[0]?d[0]:b[0]>d[1]?d[1]:b[0],b[1]=b[1]<e[0]?e[0]:b[1]>e[1]?e[1]:b[1]),this._zoom.translate(b),setTimeout(function(){c._chart._axes._axes=c._axisCache,c._chart.duration(0),c._chart._finalizePlotBounds(),c._chart._facet._render()},0)},a._setScales=function(){if(this._fluidDimensions.indexOf("x")>=0){var a=this._chart.getTrainedScale("x");this._zoom.x(a._d3Scale)}if(this._fluidDimensions.indexOf("y")>=0){var b=this._chart.getTrainedScale("y");this._zoom.y(b._d3Scale)}},a._render=function(a){this._zoomContainer=a.selectAll(".zoom-container").data([0]),this._zoomContainer.enter().append("g").classed("zoom-container");var b=this._zoomContainer.selectAll(".zoom-pane").data([0]);b.enter().append("rect").classed("zoom-pane",!0);var c=this._chart.facet().getPanel(0),d=c.bounds();b.attr("x",d.left).attr("y",d.top).attr("width",d.width).attr("height",d.height).call(this._zoom),this._bounds=d},a.scale=function(a){return arguments.length?(this._zoom.scale(a),this._refresh(a,this._zoom.translate()),this):this._zoom.scale()},a.scaleExtent=function(a){return arguments.length?(this._zoom.scaleExtent(a),this):this._zoom.scaleExtent()},a.translate=function(a){return arguments.length?(this._zoom.translate(a),this._refresh(this._zoom.scale(),a),this):this._zoom.translate()},a.zoomStart=function(a){return arguments.length?(this._zoomStart=a,this):this._zoomStart},a.zoomMove=function(a){return arguments.length?(this._zoomMove=a,this):this._zoomMove},a.zoomEnd=function(a){return arguments.length?(this._zoomEnd=a,this):this._zoomEnd},a.chart=function(a){return arguments.length?(this._chart=a,this.initializeZoom(this._chart),this._chart&&(this._setScales(),this._chart.clipPlot(!0)),this):this._chart},a}),dv.behavior.rollover=dv.behavior.extend(function(){function a(){this._selection=null,this._showTooltip=this._defaultShowTooltip,this._hideTooltip=this._defaultHideTooltip,this._orientation="right",this._tooltipPadding=10,this._content=this._defaultContent,this._lastSelectedTarget=null,this._timer=null,this._pressTimer=null,this._dragInspect=!0,this._shouldShowTooltip=function(a,b,c){return!0}}return a._render=function(a){this._xGuides=this.__geom._chart._axes._get("x"),this._yGuides=this.__geom._chart._axes._get("y"),this._isPolar=this.__geom.coord()instanceof dv.coord.polar,this._selection=a,this._addEvents()},a._addEvents=function(){var a=this;this.__geom.on("mouseover.rollover",function(b,c,d){return a._onMouseOver.call(this,b,c,d,a)}).on("mouseout.rollover",function(b,c,d){return a._onMouseOut.call(this,b,c,d,a)}),this.__geom._chart.on("tap.rollover",function(){return a._onTap.call(a,d3.event)},dv.passiveListenerOption).on("touchstart.rollover",function(){return a._onTouchStart.call(a,d3.event)},dv.passiveListenerOption).on("touchmove.rollover",function(){return a._onTouchMove.call(a,d3.event)},dv.passiveListenerOption).on("touchend.rollover",function(){return a._onTouchEnd.call(a,d3.event)})},a._removeEvents=function(){this.__geom.on("mouseover.rollover",null).on("mouseout.rollover",null),this.__geom._chart.on("tap.rollover",null).on("touchstart.rollover",null).on("touchmove.rollover",null).on("touchend.rollover",null)},a._getElementMetadata=function(a,b){var c={d:b.datum(),i:0,j:0};return a._geomGroup.selectAll(".series ."+a._dataPointStyleClass).each(function(a,b,d){c.d===a&&(c.i=b,c.j=d)}),c},a._defaultShowTooltip=function(a,b,c,d,e){e._shouldShowTooltip(a,b,c)&&(e._darkenGeom.call(this,a,e),e._showTip.call(this,a,b,c,e))},a._defaultHideTooltip=function(a,b,c,d,e){e._brightenGeom.call(this,a,e),e._removeTip.call(this,a,b,c,e)},a._darkenGeom=function(a,b){var c=d3.select(this),d=function(a,c,d){if(c.hasOwnProperty(a)){var e=b.__geom.getScale(a).mapValue(c[a]);d.style(a,d3.rgb(e).darker(1).toString())}};d("fill",a,c),d("stroke",a,c)},a._brightenGeom=function(a,b){var c=d3.select(this),d=function(a,c,d){if(c.hasOwnProperty(a)){var e=b.__geom.getScale(a).mapValue(c[a]);d.style(a,e)}};d("fill",a,c),d("stroke",a,c)},a._showTip=function(a,b,c,d){var e=d.__geom.chart()._chartContainer,f=this.getBBox(),g=dv.absoluteCoordinates(d.__geom.chart(),[f.x,f.y],a.panel),h={height:f.height,width:f.width,x:g[0],y:g[1]};dv.showTooltip(h,e.select(".plot").node().getBBox(),d.content().call(d,a,b,c),d._orientation,d._tooltipPadding,e)},a._removeTip=function(a,b,c,d){dv.removeTooltip(d.__geom.chart()._chartContainer)},a._defaultContent=function(a,b,c){var d=this.__geom.getExplicitScale("group"),e=a[0]?a[0]:a,f=e.panel.xScale(e),g=e.panel.yScale(e),h=this._xGuides[f.scaleIndex()],i=this._yGuides[g.scaleIndex()],j=h.__scale&&h.tickFormat()?h.tickFormat():String,k=i.__scale&&i.tickFormat()?i.tickFormat():String,l='<span class="metric-value">'+k(e.data[g.mapping()])+'</span><span class="metric-name">'+g.mapping()+'</span><span class="metric-value">'+j(e.data[f.mapping()])+'</span><span class="metric-name">'+f.mapping()+"</span>";return d&&d.mapping()&&(l='<span class="series-name">'+e.data[d.mapping()]+"</span>"+l),l},a._onMouseOver=function(a,b,c,d){d._showTooltip.call(this,a,b,c,d3.event,d),this._mouseOver&&this._mouseOver.call(this,a,b,c,d3.event)},a._onMouseOut=function(a,b,c,d){d._hideTooltip.call(this,a,b,c,d3.event,d),d._mouseOut&&d._mouseOut.call(this,a,b,c,d3.event)},a._onContextMenu=function(a,b,c,d){d3.event.preventDefault(),d._contextMenu&&d._contextMenu.call(this,a,b,c,d3.event)},a._onTap=function(a){this._dragInspect=!0,this._onTouchMove.call(this,a),this._onTouchEnd.call(this,a)},a._onTouchStart=function(a){var b=this;return this._lastSelectedTarget&&(clearTimeout(b._timer),this._onTouchEnd.call(this,a,0)),this._dragInspect=!1,clearTimeout(this._pressTimer),this._pressTimer=setTimeout(function(){b._dragInspect=!0,b._onTouchMove.call(b,a)},500),!1},a._onTouchMove=function(a){if(!this._dragInspect)return void clearTimeout(this._pressTimer);var b=a.touches?a.touches[0]:a,c=d3.select(this._elementFromPoint(b)),d=this._lastSelectedTarget&&this._lastSelectedTarget.node()===c.node();if(!c.empty()&&c.classed(this.__geom._dataPointStyleClass)){if(this._lastSelectedTarget&&!d){var e=this._lastSelectedTarget.datum();this._brightenGeom.call(this._lastSelectedTarget.node(),e,this)}if(!d){var f=this._getElementMetadata(this.__geom,c);this._showTooltip.call(c.node(),f.d,f.i,f.j,a,this),this._mouseOver&&this._mouseOver.call(c.node(),f.d,f.i,f.j,a),this._lastSelectedTarget=c}}dv.cancelEvent(a)},a._onTouchEnd=function(a,b){var c=this;clearTimeout(this._pressTimer),this._dragInspect=!1;a.touches&&a.touches[0];if(arguments.length<2&&(b=500),this._lastSelectedTarget){var d=function(){if(c._lastSelectedTarget){var b=c._getElementMetadata(c.__geom,c._lastSelectedTarget);c._hideTooltip.call(c._lastSelectedTarget.node(),b.d,b.i,b.j,a,c),c._mouseOut&&c._mouseOut.call(c._lastSelectedTarget.node(),b.d,b.i,b.j,a),c._lastSelectedTarget=null}};b?timer=setTimeout(d,b):d.call(this)}dv.cancelEvent(a)},a._elementFromPoint=function(a){var b=[a.clientX,a.clientY];return this._testAndroidChromeBug141840()&&(b=[a.screenX,a.screenY]),document.elementFromPoint(b[0],b[1])},a.content=function(a){return arguments.length?(this._content=d3.functor(a),this):this._content},a.tooltipPadding=function(a){return arguments.length?(this._tooltipPadding=a,this):this._tooltipPadding},a.orientation=function(a){return arguments.length?(this._orientation=a,this):this._orientation},a.mouseOver=function(a){return arguments.length?(this._mouseOver=a,this):this._mouseOver},a.mouseOut=function(a){return arguments.length?(this._mouseOut=a,this):this._mouseOut},a.contextMenu=function(a){return arguments.length?(this._contextMenu=a,this):this._contextMenu},a.showTooltip=function(a){return arguments.length?(this._showTooltip=a,this):this._showTooltip},a.hideTooltip=function(a){return arguments.length?(this._hideTooltip=a,this):this._hideTooltip},a.shouldShowTooltip=function(a){return arguments.length?(this._shouldShowTooltip=a,this):this._shouldShowTooltip},a._geom=function(a){return arguments.length?(this.__geom&&this.__geom!==a&&this._removeEvents(),this.__geom=a,this):this.__geom},a}),dv.behavior.voronoiRollover=dv.behavior.rollover.extend(function(){function a(){this._super(),this._voronoiContainer=null,this._points=null,this._pointDetectionRadius=20,this._numHitAreaVertices=12,this._isPolar=!1}return a._render=function(a){this._xGuides=this.__geom._chart._axes._get("x"),this._yGuides=this.__geom._chart._axes._get("y"),this._isPolar=this.__geom.coord()instanceof dv.coord.polar,this._selection=a,this._createTooltipContainer(),this._renderPolygons(this._getPolygonData(),a),this._addEvents()},a._addEvents=function(){var a=this;this.__geom._chart.on("tap.rollover",function(){return a._onTap.call(a,d3.event)},dv.passiveListenerOption).on("touchstart.rollover",function(){return a._onTouchStart.call(a,d3.event)},dv.passiveListenerOption).on("touchmove.rollover",function(){return a._onTouchMove.call(a,d3.event)},dv.passiveListenerOption).on("touchend.rollover",function(){return a._onTouchEnd.call(a,d3.event)},dv.passiveListenerOption)},a._removeEvents=function(){this.__geom._chart.on("tap.rollover",null,dv.passiveListenerOption).on("touchstart.rollover",null,dv.passiveListenerOption).on("touchmove.rollover",null,dv.passiveListenerOption).on("touchend.rollover",null,dv.passiveListenerOption)},a._createTooltipContainer=function(){this._voronoiContainer=this._selection.selectAll(".voronoiSelection-container").data([this]),this._voronoiContainer.enter().append("g").classed("voronoiSelection-container",!0)},a._getPolygonData=function(){var a=[],b=(this.__geom._nestData,this);this._points=[];var c=b.__geom.coord()._point().x(function(a,b){return a.x}).y(function(a,b){return a.y}).defined(function(a,b){return!0});return dv.util.each(this.__geom._nestData,function(d,e){dv.util.each(d.values,function(d,f){var g={},h=d[0]?d[0]:d,i=h.panel.xScale(h),j=h.panel.yScale(h);g.x=i.mapValueToPercent(i.mapToProp(h,f)+i.rangeBand()/2,f)||0,g.y=j.mapValueToPercent(j.mapValue(h.hasOwnProperty("y0")?h.y+h.y0:h.y),f)||0,g.panel=h.panel;var k=c.getBounds(g,f);if(b._isPolar){var l=b.__geom.coord()._transformAngleRadiusToXY(k.bounds.x,k.bounds.y);range.bounds.x=l[0],range.bounds.y=l[1]}b._points.push({data:k,rawData:h,seriesIndex:e,index:f}),a.push([k.bounds.x,k.bounds.y])})}),d3.geom.voronoi(a)},a._renderPolygons=function(a,b){var c=this,d=(this.__geom._nestData.length,this.__geom._nestData[0].values.length,d3.select(b.node().parentNode),0),e=0;if(this._isPolar){var f=this.__geom._nestData[0].values[0].panel,g=dv.util.scaleRangeNoReverse(f.xOuterScale()),h=dv.util.scaleRangeNoReverse(f.yOuterScale());d=(g[0]+g[1])/2,e=(h[0]+h[1])/2}this._voronoiContainer.attr("transform","translate("+d+","+e+")");var i=this._voronoiContainer.selectAll("path").data(a);i.exit().remove(),i.enter().append("path").attr("id",function(a,b){return"path-"+b}).classed("voronoi-overlay",!0),i.attr("d",function(a,b){return c._getPolygonPath(a,b,c)}).on("mouseover.rollover",function(a,b,d){return c._onMouseOver.call(this,a.data,b,d,c)}).on("mouseout.rollover",function(a,b,d){return c._onMouseOut.call(this,a.data,b,d,c)}).on("contextmenu",function(a,b,d){return c._onContextMenu.call(this,a.data,b,d,c)}).call(this._removeRegisteredEvents,this).call(this._addRegisteredEvents,this),i.exit().on("mouseover.rollover",null).on("mouseout.rollover",null).on("contextmenu",null).remove()},a._addRegisteredEvents=function(a,b){b||(b=this),b.__geom&&(a=a||b._voronoiContainer.selectAll(".voronoi-overlay"),dv.util.each(b.__geom.eventMap,function(c,d){a.on(d,function(a,c){b.__geom.eventMap[d].callback.call(this,a,c,d3.event)},c.capture)}),dv.util.each(b.__geom._chart.eventMap,function(c,d){a.on(d+".dvchart",function(a,c){var e=d3.event,f=b.__geom._chart._interactionGroup.node();b._shouldDispatchChartEvent(e,f)&&b.__geom._chart.eventMap[d].callback.call(f,e)},c.capture)}))},a._removeRegisteredEvents=function(a,b){b||(b=this),b.__geom&&(a=a||b._voronoiContainer.selectAll(".voronoi-overlay"),dv.util.each(b.unregisterEventMap,function(b,c){a.on(c,null,b)}),dv.util.each(b.__geom._chart.unregisterEventMap,function(b,c){a.on(c+".dvchart",null,b)}))},a._shouldDispatchChartEvent=function(a,b){var c=!0;if("mouseout"===a.type||"mouseover"===a.type){var d=a.relatedTarget;d||(d="mouseout"===a.type?a.toElement:a.fromElement);var e=d3.select(d);if(e&&!e.empty()){e.attr("class");c=!(e.node()===b||e.classed("voronoi-overlay"))}}return c},a._getPolygonPath=function(a,b,c){if(!a)return null;a.data=c._points[b];var d=(dv.util.clone(a),c._points[b]),e=d3.geom.polygon(c._getPolygonPoints(d.data.bounds.x,d.data.bounds.y)),f=e.clip(a);return f.length?"M"+f.join("L")+"Z":null},a._getPolygonPoints=function(a,b){for(var c=[],d=360;d>0;d-=360/this._numHitAreaVertices){var e=d*Math.PI/180,f=Math.cos(e)*this._pointDetectionRadius+a,g=Math.sin(e)*this._pointDetectionRadius+b;c.push([f,g])}return c},a._defaultShowTooltip=function(a,b,c,d,e){e._showPoint.call(this,a,b,c,e),e._shouldShowTooltip(a,b,c)&&e._showTip.call(this,a,b,c,e)},a._defaultHideTooltip=function(a,b,c,d,e){e._removePoint.call(this,a,b,c,e),e._removeTip.call(this,a,b,c,e)},a._showPoint=function(a,b,c,d){var e=10,f=a.rawData,g=d.getGeomFromVoronoiIndex.call(d,f,b,c);if(!g.empty()){var h=g.node().getBoundingClientRect(),i={height:h.height,width:h.width,x:h.x,y:h.y};e=Math.max(i.height,i.width)/2+2.5}d._voronoiContainer.append("circle").classed("hover-point",!0).attr("id","point-"+c+"-"+b).attr("cx",a.data.bounds.x).attr("cy",a.data.bounds.y).attr("r",0).style("stroke",function(){return d.__geom.getHighlightColor(a.rawData,b)}).style("pointer-events","none").transition().duration(350).attr("r",e)},a._removePoint=function(a,b,c,d){d._voronoiContainer.selectAll("#point-"+c+"-"+b).transition().duration(350).attr("r",0).remove()},a._showTip=function(a,b,c,d){var e,f=d.__geom.chart()._chartContainer,g=a.data,h=a.rawData,i=d.getGeomFromVoronoiIndex.call(d,h,b,c);if(i.empty()){var j=dv.absoluteCoordinates(d.__geom.chart(),[g.bounds.x,g.bounds.y],h.panel),k=10,l=10;e={height:k,width:l,y:j[1]-k/2,x:j[0]-l/2}}else{var m=i.node().getBBox();e={height:m.height,width:m.width,x:m.x,y:m.y}}dv.showTooltip(e,f.select(".panels").node().getBBox(),d.content().call(d,h,b,c),d._orientation,d._tooltipPadding,f)},
a.getGeomFromVoronoiIndex=function(a,b,c){return this.__geom.chart()._g.selectAll(".datum-"+b+".series-"+c).filter(function(b){return a===b})},a._onMouseOver=function(a,b,c,d){d._showTooltip.call(this,a,a.index,a.seriesIndex,d3.event,d),d._mouseOver&&d._mouseOver.call(this,a.rawData,a.index,a.seriesIndex,d3.event)},a._onMouseOut=function(a,b,c,d){d._hideTooltip.call(this,a,a.index,a.seriesIndex,d3.event,d),d._mouseOut&&d._mouseOut.call(this,a.rawData,a.index,a.seriesIndex,d3.event)},a._onContextMenu=function(a,b,c,d){d3.event.preventDefault(),d._contextMenu&&d._contextMenu.call(this,a.rawData,a.index,a.seriesIndex,d3.event)},a._onTouchMove=function(a){if(!this._dragInspect)return void clearTimeout(this._pressTimer);var b=a.touches?a.touches[0]:a,c=d3.select(this._elementFromPoint(b)),d=this._lastSelectedTarget&&this._lastSelectedTarget.node()===c.node();if(!c.empty()&&c.classed("voronoi-overlay")){if(this._lastSelectedTarget&&!d){var e=this._lastSelectedTarget.datum().data;this._removePoint.call(c.node(),e.rawData,e.index,e.seriesIndex,this)}if(!d){var f=c.datum().data;this._showTooltip.call(c.node(),f,f.index,f.seriesIndex,a,this),this._mouseOver&&this._mouseOver.call(c.node(),f.rawData,f.index,f.seriesIndex,a),this._lastSelectedTarget=c}}dv.cancelEvent(a)},a._onTouchEnd=function(a,b){var c=this;if(clearTimeout(this._pressTimer),this._dragInspect&&(this._dragInspect=!1),arguments.length<2&&(b=500),this._lastSelectedTarget){var d=function(){if(c._lastSelectedTarget){var b=c._lastSelectedTarget.datum().data;c._hideTooltip.call(c._lastSelectedTarget.node(),b,b.index,b.seriesIndex,a,c),c._mouseOut&&c._mouseOut.call(c._lastSelectedTarget.node(),b.rawData,b.index,b.seriesIndex,a),c._lastSelectedTarget=null}};b?timer=setTimeout(d,b):d.call(this)}dv.cancelEvent(a)},a.pointDetectionRadius=function(a){return arguments.length?(this._pointDetectionRadius=a,this):this._pointDetectionRadius},a.numHitAreaVertices=function(a){return arguments.length?(this._numHitAreaVertices=a,this):this._numHitAreaVertices},a}),dv.behavior.selection=dv.behavior.extend(function(){function a(){this._super(),this._selectionCache=new dv.util.SelectionCache,this._dispatch=d3.dispatch("selectionChanged"),this._elementFinder=null;var a=this;this._selectionCache.on("selectionChanged",function(b,c,d,e){a._dispatch.selectionChanged.call(b,c,d,e)}),this.on=function(b,c){return a._dispatch.on(b,c),a}}return a.elementFinder=function(a){return a?(this._elementFinder=a,this):this._elementFinder},a._geom=function(a){return arguments.length?(this.__geom&&this.__geom!==a&&this._removeEvents(),this.__geom=a,this._selectionCache.selectionScope(this.__geom.chart()._g),this):this.__geom},a.chart=function(a){return this._selectionCache.selectionScope(a._g),this},a._render=function(a){return this._selectionCache.markSelectable(this.__geom._geomGroup.selectAll("path")),this._addEvents(),this},a._addEvents=function(){this.__geom.on("mousedown.selection",this.makeSelectHandler(null,this._elementFinder))},a._removeEvents=function(){this.__geom.on("mousedown.selection",null)},a.makeSelectHandler=function(a,b){var c=this;return function(d,e){var f=c._selectionCache,g=b?b.call(this,d,e):this,h=dv.util.determineKeyModifiers(d3.event,f._keymap);if(h==dv.util.selectModifiers.toggle)return f.selectionToggle(d3.select(g)),void d3.event.stopPropagation();if(h==dv.util.selectModifiers.set)return f.selectionSet(d3.select(g)),void d3.event.stopPropagation();if(h&dv.util.selectModifiers.range){var i=[],j=f.selectionScope.selectAll("."+f.selectableClass);if(f.savePreviousState(j),a)i=a(f._lastSelected?f._lastSelected:this,this);else{var k=f._lastSelected?f._lastSelected:g,l=g,m=k.getBoundingClientRect(),n=l.getBoundingClientRect(),o=new dv.collisions.rectFromMinMax(m.left+.5*m.width,m.top+.5*m.height,n.left+.5*n.width,n.top+.5*n.height);j.each(function(a,b){var c=this.getBoundingClientRect(),d=new dv.collisions.rectFromMinMax(c.left,c.top,c.right,c.bottom);o.testRect(d)&&i.push(this)}),i.push(g)}return f.brush(d3.selectAll(i)),void d3.event.stopPropagation()}}},a}),dv.behavior.identified=dv.behavior.extend(function(a){function b(a){var b=++c;this._super(),this.idPrefix=a||"geom",this.idPrefix=this.idPrefix+b}var c=0;return b._geom=function(a){return arguments.length?(this.__geom=a,this):this.__geom},b.chart=function(a){return arguments.length?(this.__chart=a,this):this.__chart},b._render=function(a){var b=this;return this.__geom._geomGroup.selectAll("path").attr("id",function(a,c,d){return b.identify(a,c,d)}),this},b.identify=function(a,b,c){return this.idPrefix+"-"+b+"-"+c},b}),dv.log=dv.log||{},dv.log.NOCONSOLE=!1,dv.log.LVL_ERROR=0,dv.log.ERROR="error",dv.log.LVL_WARN=1,dv.log.WARN="warn",dv.log.LVL_DEBUG=2,dv.log.DEBUG="debug",dv.log.LOGLEVEL=dv.log.LVL_DEBUG,dv.log.error=function(a){return dv.log._message(dv.log.ERROR,a)},dv.log.warn=function(a){return dv.log._message(dv.log.WARN,a)},dv.log.debug=function(a){return dv.log._message(dv.log.DEBUG,a)},dv.log.noConsole=function(a){dv.log.NOCONSOLE=a||!1,dv.log.console=window.console||dv.util.noop,dv.log.console.log&&!dv.log.NOCONSOLE||(dv.log.console.log=dv.util.noop),dv.log.console.error&&!dv.log.NOCONSOLE||(dv.log.console.error=dv.log.console.log),dv.log.console.warn&&!dv.log.NOCONSOLE||(dv.log.console.warn=dv.log.console.log),dv.log.console.debug&&!dv.log.NOCONSOLE||(dv.log.console.debug=dv.log.console.log)},dv.log._message=function(a,b){if(dv.log._isValidType(a)){if(dv.log.LOGLEVEL>=dv.log["LVL_"+a.toUpperCase()]&&dv.log.console[a](b.msg,b.data),a===dv.log.ERROR)throw b.msg+" Context Data: "+JSON.stringify(b.data)}else dv.log.console.log("Logging message with invalid type: "+a)},dv.log._isValidType=function(a){return a===dv.log.ERROR||a===dv.log.WARN||a===dv.log.DEBUG},dv.log.noConsole(!1),dv.panel=dv.extend(function(){function a(){this._margins={left:0,top:0,right:0,bottom:0},this._trainedScales={}}return a.getTrainedScale=function(a){return"x"===a?this.xScale():"y"===a?this.yScale():this._trainedScales[a]},a.getOuterScale=function(a){return"x"===a?this._xScale:"y"===a?this._yScale:null},a._updateRanges=function(a){var b=[a.left,a.right],c=[a.bottom,a.top];this._facet._chart.coord().flip()?(this._xScale.range(c),this._yScale.range(b)):(this._xScale.range(b),this._yScale.range(c))},a.bounds=function(a){return arguments.length?(this._bounds=a,this._updateRanges(this._bounds),this):this._bounds},a.margins=function(a){return arguments.length?(this._margins=a,this):this._margins},a.visibleAxisLabelOrientations=function(a){return arguments.length?(this._visibleAxisLabelOrientations=a,this):this._visibleAxisLabelOrientations},a.columnIndex=function(a){return arguments.length?(this._columnIndex=a,this):this._columnIndex},a.rowIndex=function(a){return arguments.length?(this._rowIndex=a,this):this._rowIndex},a.facetIndex=function(a){return arguments.length?(this._facetIndex=a,this):this._facetIndex},a.facetKey=function(a){return arguments.length?(this._facetKey=a,this):this._facetKey},a.xFacetTitle=function(a){return arguments.length?(this._xFacetTitle=a,this):this._xFacetTitle},a.yFacetTitle=function(a){return arguments.length?(this._yFacetTitle=a,this):this._yFacetTitle},a.xOuterScale=function(a){return arguments.length?(this._xScale=a,this):this._xScale},a.yOuterScale=function(a){return arguments.length?(this._yScale=a,this):this._yScale},a.xScale=function(a){var b=0;return a&&a.hasOwnProperty("x-index")&&(b=a["x-index"]),this._xScale.innerScaleGroup()[b]},a.yScale=function(a){var b=0;return a&&a.hasOwnProperty("y-index")&&(b=a["y-index"]),this._yScale.innerScaleGroup()[b]},a.facet=function(a){return arguments.length?(this._facet=a,this._trainedScales={},this):this._facet},a}),dv.facet=dv.extend(function(){function a(){this._numColumns=0,this._numRows=0,this._hGap=10,this._vGap=10}return a._prerender=function(){var a=this;this._trainedScales={},this._panels=[],this._rows=[],this._columns=[],this._panelsWithAxisLabels=[],dv.util.each(a._chart._layers,function(b){b._prerender(a._chart),a._trainFacetGroups(b)}),this._configureFacets(),dv.util.each(a._chart._layers,function(b){b._nestData=a._nestFacet(b),b._handlePositions(),b._trainScales(),b._createDefaultScales()}),this._trainScales()},a._trainScales=function(){var a,b=this,c=function(a){return function(c){return b._getFacetFromFacetKey(c)!==a.facetKey()}},d=function(a){return function(a,b,c){return arguments.length<2&&(b=0),arguments.length<3?void 0===this._globalScales[a]?null:this._globalScales[a][b]:(this._globalScales[a]||(this._globalScales[a]={}),this._globalScales[a][b]=c,c)}};this._globalScales={},this._positionScales={},dv.util.each(this._panels,function(e,f){dv.util.each(b._chart._layers,function(f){for(var g in f._aes){var h=f._aes[g];for(var i in h){f.getScale(g,i)instanceof dv.scale.constant||(a=b._isFree.call(b,g)?b._trainFreeScale(f,e,g,i,c(e)):b._trainScale(f,d(f),g,i),e._trainedScales[g]||(e._trainedScales[g]={}),e._trainedScales[g][i]=a,h[i].domain(a.domain()),h[i].range(a.range()))}}})}),dv.util.each(this._globalScales,function(a,b){dv.util.each(a,function(a,b){a.validateDomain(),a.reverse()&&a.domain(a.domain().reverse())})})},a._isFree=function(a){var b="x"===a||"xMin"===a||"xMax"===a,c="y"===a||"yMin"===a||"yMax"===a;return b&&("free"===this._scales||"free_x"===this._scales)||c&&("free"===this._scales||"free_y"===this._scales)},a._trainScale=function(a,b,c,d,e){var f,g=b.call(this,c,d),h={stack:"stack"===a.position()&&"y"===c,fill:"fill"===a.position()&&"y"===c,filter:e};return g?(f=a._aes[c][d],f.domain(f.calculateDomain(a._nestData,h)),g.unionDomain(f,g.reverse()),g.unionRange(f.range())):(a._aes[c][d].trainDomain(a._nestData,h),g=a._aes[c][d].copy(),b.call(this,c,d,g)),g},a._render=function(){this._axes=this._chart._axes;var a=this._ensureColumnsAndRows();this._adjustPlotBounds(a[0],a[1]),this._configurePanels(a[0],a[1]),this._axes._initializeAxisRenderers(),this._axes._measureTitles(this._chart._plotBounds);var b=this._measureMargins(a[0],a[1]);this._layoutPanels(a[0],a[1],b),this._renderAxisTitles(),this._renderPanels()},a._setVisibleAxisLabelOrientations=function(a,b,c,d){var e=a.rowIndex(),f=a.columnIndex(),g={left:0===f,top:0===e,right:f===c||a.facetIndex()===d-1,bottom:e===b||f>c&&e===b-1};a.visibleAxisLabelOrientations(g)},a._changeScaleRangeToLocal=function(a){var b=a.range(),c=a.innerScaleGroup();for(var d in c)dv.util.scaleRange(c[d],[b[0],b[1]]).applyRangePadding();return c},a._measureMargins=function(a,b){var c=this._panels.length,d=~~((c-1)/a),e=(c-1)%a,f=this._axes._getAllOrientations(),g={rows:[],cols:[]},h=this._isFree("x"),i=this._isFree("y"),j=this._panels[0];j&&(this._changeScaleRangeToLocal(j.getOuterScale("x")),this._changeScaleRangeToLocal(j.getOuterScale("y")));for(var k=-1;++k<c;){var l=this._panels[k],m=l.columnIndex(),n=l.rowIndex();this._setVisibleAxisLabelOrientations(l,d,e,c),l.margins({left:0,top:0,right:0,bottom:0}),n>=g.rows.length&&(g.rows[n]={left:0,top:0,right:0,bottom:0}),m>=g.cols.length&&(g.cols[m]={left:0,top:0,right:0,bottom:0}),this._panelsWithAxisLabels.push(l),this._axes._measure(l);var o=l.margins();void 0!==f.right&&!i&&k===c-1&&m<a-1&&(o.right=0),void 0!==f.bottom&&!h&&m>=e&&n===d-1&&(o.bottom=0);for(var p in g){var q="rows"===p?n:m,r=g[p][q];r.left=Math.max(o.left,r.left),r.top=Math.max(o.top,r.top),r.right=Math.max(o.right,r.right),r.bottom=Math.max(o.bottom,r.bottom)}}return g},a._layoutPanels=function(a,b,c){var d,e,f,g,h=this._chart._plotBounds,i=h.right-h.left-(a-1)*this._hGap,j=h.bottom-h.top-(b-1)*this._vGap,k={x:0,y:0},l=this;for(f=-1,g=c.cols.length;++f<g;)i-=c.cols[f].left+c.cols[f].right;for(f=-1,g=c.rows.length;++f<g;)j-=c.rows[f].bottom+c.rows[f].top;d=Math.max(i/a,0),e=Math.max(j/b,0);var m=this._chart._chartContainer.select(".axes-labels"),n=m.selectAll(".panel-labels").data(this._panelsWithAxisLabels);n.enter().append("div"),n.exit().remove(),n.attr("class",function(a,b){return"panel-labels panel-"+a.facetIndex()});var o=this._chart._panelContainer.selectAll(".panel").data(this._panels);o.enter().append("g").classed("panel",!0),o.exit().remove(),o.each(function(f,g){l._drawPanel.call(this,l,f,g,h,c,d,e,a,b,k),l._axes._render.call(l._axes,d3.select(this),m.select(".panel-labels.panel-"+f.facetIndex()),f)})},a._renderAxisTitles=function(){var a=this.getColumn(0)[0].bounds(),b=this.getRow(0)[0].bounds(),c=this.getColumn(this._columns.length-1)[0].bounds(),d=this.getRow(this._rows.length-1)[0].bounds(),e=(d.bottom-b.top)/2+b.top,f=(c.right-a.left)/2+a.left,g=this._chart.plotBounds();this._axes._renderTitles(g,{left:[g.left,e],right:[g.right,e],top:[f,g.top],bottom:[f,g.bottom]})},a._renderPanels=function(){var a=this._chart,b=(a._plotBounds,a._g.select(".plot")),c=(a._plotBounds,function(a){a.attr("transform","translate(0,0)").each(function(a){this.__previousData__&&this.__previousData__._dataPointStyleClass!=a._dataPointStyleClass&&this.__previousData__.exit(this),a._render(this),this.__previousData__=a})}),d=function(a){a.each(function(b){b.exit(this,function(){a.remove()})})},e=b.selectAll(".geom").data(a._layers);e.exit().call(d),e.enter().append("g").classed("geom",!0),e.call(c)},a._updatePanelTitle=function(a,b,c,d,e,f,g){var h={left:0,top:0,width:0,height:0},i=d3.select(this);if(dv.util.isUndefined(b))return a._removePanelTitle.call(this,c),h;var j=i.selectAll(".panel-title."+c).data([0]),k=j.enter().append("g").classed("panel-title "+c,!0).attr("transform","translate("+d+","+e+")"),l=k.append("rect").classed("panel-title-bg",!0),m=k.append("text").classed("panel-title-label",!0).attr("text-anchor","middle");dv.ANIMATION?j.transition().duration(a._chart._duration).attr("transform","translate("+d+","+e+")"):j.attr("transform","translate("+d+","+e+")");var n=j.selectAll(".panel-title-label").text(b),o=j.selectAll(".panel-title-bg"),p=n.node().getBBox(),q=0;switch(dv.ANIMATION&&(n=n.transition().duration(a._chart._duration),o=o.transition().duration(a._chart._duration)),c){case"top":x=f/2,y=p.height,h.left=0,h.top=0,h.width=f,h.height=p.height+6;break;case"right":x=g/2,y=-f+p.height,h.left=f-(p.height+6),h.top=0,h.width=p.height+6,h.height=g,q=90;break;case"bottom":x=f/2,y=g-6,h.left=0,h.top=g-(p.height+6),h.width=f,h.height=p.height+6;break;case"left":x=-g/2,y=0+p.height,h.left=0,h.top=0,h.width=p.height+6,h.height=g,q=270}return l.attr("x",h.left).attr("y",h.top).attr("width",h.width).attr("height",h.height),m.attr("transform","rotate("+q+" 0,0)").attr("x",x).attr("y",y),n.attr("transform","rotate("+q+" 0,0)").attr("x",x).attr("y",y),o.attr("x",h.left).attr("y",h.top).attr("width",h.width).attr("height",h.height),h},a._removePanelTitle=function(a){d3.select(this).selectAll(".panel-title."+a).remove()},a._updatePanelBackground=function(a,b,c,d,e){var f=d3.select(this).selectAll(".plot-bg").data([0]);f.enter().append("rect").classed("plot-bg",!0).attr("x",b).attr("y",c).attr("width",d).attr("height",e),dv.ANIMATION&&(f=f.transition().duration(a._chart._duration)),f.attr("x",b).attr("width",d).attr("height",e)},a._addToCollection=function(a,b,c){a[b]||(a[b]=[]),a[b].push(c)},a.getPanel=function(a){return this._panels&&a<this._panels.length?this._panels[a]:null},a.getRow=function(a){return this._rows[a]},a.getColumn=function(a){return this._columns[a]},a.getTrainedScale=function(a){return this._panels.length>0?this.getPanel(0).getTrainedScale(a):this._trainedScales[a]},a.scales=function(a){return arguments.length?(this._scales=a,this):this._scales},a.space=function(a){return arguments.length?(this._space=a,this):this._space},a.titleFormat=function(a){return arguments.length?(this._titleFormat=d3.functor(a),this):this._titleFormat},a.hGap=function(a){return arguments.length?(this._hGap=a,this):this._hGap},a.vGap=function(a){return arguments.length?(this._vGap=a,this):this._vGap},a.chart=function(a){return arguments.length?(this._chart=a,this):this._chart},a}),dv.facet.scale=dv.extend(function(){function a(){}return a.domain=function(){return this._innerScale.domain()},a.range=function(a){return arguments.length?(this._range=a,this):this._range},a._applyPercentage=function(a,b){return this._range[0]+(this._range[1]-this._range[0])*a.apply(this._innerScale,b)},a.mapPropToPercent=function(a,b){return this._innerScale.mapPropToPercent(a)},a.mapValueToPercent=function(a,b){return this._innerScale.mapValueToPercent(a)},a.mapToProp=function(a,b){return this._applyPercentage(this._innerScale.mapPropToPercent,[a,b])},a.mapValue=function(a,b){return this._applyPercentage(this._innerScale.mapValueToPercent,[a,b])},a.rangeBand=function(){return this._applyPercentage(this._innerScale.rangeBand)},a.innerScaleGroup=function(a){return arguments.length?(this._innerScaleGroup=a,this):this._innerScaleGroup},a}),dv.facet.wrap=dv.facet.extend(function(){function a(){this._super(),this._facetScale=null,this._preferredAspectRatio=1,this._titleOrientation="top"}return a._prerender=function(){this._facetScale=dv.scale.ordinal().mapping(this._group).domain([]),this._super()},a._trainFacetGroups=function(a){var b=a.data()[this._facetScale.mapping()];b&&this._facetScale.domain(this._facetScale.domain().concat(b))},a._trainFreeScale=function(a,b,c,d,e){var f=function(a,c,d){if(arguments.length<2&&(c=0),arguments.length<3){if(!b._trainedScales[a])return;return b._trainedScales[a][c]}return b._trainedScales[a]||(b._trainedScales[a]={}),b._trainedScales[a][c]=d,d};return this._trainScale(a,f,c,d,e)},a._showAllPanelLabelsIfFree=function(){return!0},a._configureFacets=function(){this._facetKeys=this._facetScale.domain(),this._facetMap={}},a._nestFacet=function(a){var b,c,d=this,e=a.normalizedData(),f=dv.util.filterAndZip(e),g=a.getScale("group"),h=this._group,i=this._facetScale.domain();g&&(b=g.property(),c=b?e[b]:null);for(var j=-1,k=f.length;++j<k;){var l,m=0,n=f[j];n.data.hasOwnProperty(h)&&(m=i.indexOf(n.data[h]))>=0&&(l=i[m]+"");var o=this._facetMap[m];o||(o=dv.panel().facetIndex(m).facetKey(l).xFacetTitle(l).facet(this),this._facetMap[m]=o,this._panels.push(o)),n.panel=o}return d3.nest().key(function(a){var c="";return c+=(a.data.hasOwnProperty(h)?a.data[h]:".")+" ~ ",c+=a.hasOwnProperty(b)?a[b]:"."}).sortKeys(function(a,b){var e=d._getGroupFromFacetKey(a),f=d._getGroupFromFacetKey(b),g=-1,h=-1;return"."!==e&&(g=c.indexOf(e))<0&&(g=c.indexOf(Number(e))),"."!==f&&(h=c.indexOf(f))<0&&(h=c.indexOf(Number(f))),h<g?1:-1}).entries(f)},a._getGroupFromFacetKey=function(a){return/.* ~ (.*)/g.exec(a)[1]},a._getFacetFromFacetKey=function(a){return/(.*) ~ .*/g.exec(a)[1]},a._ensureColumnsAndRows=function(){var a=this._panels.length,b=Math.min(this._numColumns,a),c=Math.min(this._numRows,a);if(b<1&&c<1){var d=this._chart._plotBounds,e=d.right-d.left,f=d.bottom-d.top,g=Math.min(a,Math.ceil(Math.sqrt(1*a*e/(f*this._preferredAspectRatio))));return g=isNaN(g)?1:g,g=Math.max(1,g),[g,Math.ceil(a/g)]}return b<1&&c>=1&&(b=Math.ceil(a/c)),b>=1&&c<1&&(c=Math.ceil(a/b)),[b,c]},a._adjustPlotBounds=function(a,b){},a._configurePanels=function(a,b){for(var c=this._chart._plotBounds,d=c.right-c.left,e=c.bottom-c.top,f=(d-(a-1)*this._hGap)/a,g=(e-(b-1)*this._vGap)/b,h=-1,i=this._panels.length;++h<i;){var j=this._panels[h],k=dv.facet.scale().innerScaleGroup(j._trainedScales.x),l=dv.facet.scale().innerScaleGroup(j._trainedScales.y),m=h%a,n=~~(h/a),o={left:0,top:0,right:f,bottom:g,width:f,height:g};this._panels[h].xOuterScale(k).yOuterScale(l).columnIndex(m).rowIndex(n).bounds(o),this._addToCollection(this._rows,n,j),this._addToCollection(this._columns,m,j)}},a._drawPanel=function(a,b,c,d,e,f,g,h,i,j){var k=b.columnIndex(),l=b.rowIndex(),m=e.rows[l],n=e.cols[k],o=a._titleOrientation;0===k&&(j.x+=d.left,0===l&&(j.y+=d.top));var p=j.y+m.top,q=j.x+n.left,r=a._titleFormat?a._titleFormat.call(this,b.xFacetTitle(),c):b.xFacetTitle(),s=a._updatePanelTitle.call(this,a,r,o,q,p,f,g);b.bounds({width:f,height:g,top:p+("top"===o?s.height:0),left:q+("left"===o?s.width:0),right:q+f+("right"===o?-s.width:0),bottom:p+g+("bottom"===o?-s.height:0)}),a._updatePanelBackground.call(this,a,q,p,f,g),k===h-1?(j.x=0,j.y+=m.top+g+m.bottom+a._vGap):j.x+=n.left+f+n.right+a._hGap},a.group=function(a){return arguments.length?(this._group=a,this):this._group},a.numColumns=function(a){return arguments.length?(this._numColumns=a,this):this._numColumns},a.numRows=function(a){return arguments.length?(this._numRows=a,this):this._numRows},a.preferredAspectRatio=function(a){return arguments.length?(this._preferredAspectRatio=a,this):this._preferredAspectRatio},a}),dv.facet.grid=dv.facet.extend(function(){function a(){this._super(),this._xFacetScale=null,this._yFacetScale=null}return a._prerender=function(){this._xFacetScale=dv.scale.ordinal().mapping(this._xGroup).domain([]),this._yFacetScale=dv.scale.ordinal().mapping(this._yGroup).domain([]),this._super()},a._trainFacetGroups=function(a){var b=a.data()[this._xFacetScale.mapping()];b&&this._xFacetScale.domain(this._xFacetScale.domain().concat(b));var c=a.data()[this._yFacetScale.mapping()];c&&this._yFacetScale.domain(this._yFacetScale.domain().concat(c))},a._trainFreeScale=function(a,b,c,d,e){var f=this,g=function(a,c,d){arguments.length<2&&(c=0),f._positionScales[a]||(f._positionScales[a]={});var e=f._positionScales[a];e[c]||(e[c]=[]);var g=e[c],h=a.indexOf("x")>=0?b.columnIndex():b.rowIndex();return arguments.length<3?g[h][c]:(g[h][c]=d,d)};return this._trainScale(a,g,c,e)},a._showAllPanelLabelsIfFree=function(){return!1},a._configureFacets=function(){var a,b,c,d=this._xFacetScale.domain(),e=this._yFacetScale.domain();this._numColumns=Math.max(this._xFacetScale.domain().length,1),this._numRows=Math.max(this._yFacetScale.domain().length,1);for(var f=-1,g=this._numRows,h=0;++f<g;){yFacetIndex=f,e&&e.length>f&&(b=e[f]);for(var i=-1,j=this._numColumns;++i<j;){xFacetIndex=i,d&&d.length>i&&(a=d[i]),c=(e.length?b:".")+" ~ "+(d.length?a:".");var k=dv.panel().facetIndex(h++).facetKey(c).columnIndex(xFacetIndex).rowIndex(yFacetIndex).xFacetTitle(a).yFacetTitle(b).facet(this);this._panels.push(k),this._addToCollection(this._rows,yFacetIndex,k),this._addToCollection(this._columns,xFacetIndex,k)}}},a._nestFacet=function(a){var b,c,d=this,e=a.normalizedData(),f=dv.util.filterAndZip(e),g=a.getScale("group"),h=this._xFacetScale.domain(),i=this._yFacetScale.domain();g&&(b=g.property(),c=b?e[b]:null);for(var j=-1,k=f.length;++j<k;){var l=f[j],m=0,n=0;l.data.hasOwnProperty(this._xGroup)&&(n=h.indexOf(l.data[this._xGroup]))<0&&(n=0),l.data.hasOwnProperty(this._yGroup)&&(m=i.indexOf(l.data[this._yGroup]))<0&&(m=0),panelIndex=m*this._numColumns+n;var o=this._panels[panelIndex];l.panel=o}return d3.nest().key(function(a){var c="";return c+=(a.data.hasOwnProperty(d._yGroup)?a.data[d._yGroup]:".")+" ~ ",c+=(a.data.hasOwnProperty(d._xGroup)?a.data[d._xGroup]:".")+" ~ ",c+=a.hasOwnProperty(b)?a[b]:"."}).sortKeys(function(a,b){var e=d._getGroupFromFacetKey(a),f=d._getGroupFromFacetKey(b),g=-1,h=-1;return"."!==e&&(g=c.indexOf(e))<0&&(g=c.indexOf(Number(e))),"."!==f&&(h=c.indexOf(f))<0&&(h=c.indexOf(Number(f))),h<g?1:-1}).entries(f)},a._getGroupFromFacetKey=function(a){return/.* ~ .* ~ (.*)/g.exec(a)[1]},a._getFacetFromFacetKey=function(a){return/(.* ~ .*) ~ .*/g.exec(a)[1]},a._ensureColumnsAndRows=function(){return[this._numColumns,this._numRows]},a._adjustPlotBounds=function(a,b){var c=this._measureTitles(this._xFacetScale.domain(),"temp-column-titles",this._chart._g)+3,d=this._measureTitles(this._yFacetScale.domain(),"temp-row-titles",this._chart._g)+3;this._chart._plotBounds;this._xTitleHeight=c,this._yTitleWidth=d,this._chart._plotBounds.top+=c,this._chart._plotBounds.right-=d},a._measureTitles=function(a,b,c){var d=this._createTitlesContainer(b,this._chart._g);d.selectAll(".panel-title").data(a).enter().append("text").text(function(a,b){return a});var e=d.node().getBBox();return d.remove(),e.height},a._createTitlesContainer=function(a,b){var c=b.selectAll("."+a).data([0]);return c.enter().append("g").classed(a,!0),c.exit().remove(),c},a._configurePanels=function(a,b){for(var c=this._chart._plotBounds,d=c.right-c.left,e=c.bottom-c.top,f=(d-(a-1)*this._hGap)/a,g=(e-(b-1)*this._vGap)/b,h=0,i=0,j=0,k=-1,l=this._panels.length;++k<l;){var m=this._panels[k],n=dv.facet.scale().innerScaleGroup(m._trainedScales.x),o=dv.facet.scale().innerScaleGroup(m._trainedScales.y),p={left:0,top:0,right:0+f,bottom:0+g,width:f,height:g};this._panels[k].xOuterScale(n).yOuterScale(o).bounds(p),h+=f+this._hGap,j++,j>=a&&(h=0,i+=g+this._vGap,j=0)}},a._drawPanel=function(a,b,c,d,e,f,g,h,i,j){var k=b.columnIndex(),l=b.rowIndex(),m=e.rows[l],n=e.cols[k];if(j.x+=n.left,0===k&&(j.x+=d.left),0===l){var o=a._titleFormat?a._titleFormat.call(this,b.xFacetTitle(),c):b.xFacetTitle();j.y=m.top+d.top,a._updatePanelTitle.call(this,a,o,"top",j.x,j.y-a._xTitleHeight,f,g)}else a._removePanelTitle.call(this,"top");if(k===a._numColumns-1){var p=a._titleFormat?a._titleFormat.call(this,b.yFacetTitle(),c):b.yFacetTitle();a._updatePanelTitle.call(this,a,p,"right",j.x+a._yTitleWidth,j.y,f,g)}else a._removePanelTitle.call(this,"right");b.bounds({width:f,height:g,top:j.y,left:j.x,right:j.x+f,bottom:j.y+g}),a._updatePanelBackground.call(this,a,j.x,j.y,f,g),j.x+=f+n.right+a._hGap,k===a._numColumns-1&&(j.x=0,j.y+=m.top+g+m.bottom+a._vGap)},a.xGroup=function(a){return arguments.length?(this._xGroup=a,this):this._xGroup},a.yGroup=function(a){return arguments.length?(this._yGroup=a,this):this._yGroup},a.aggregate=function(a){return arguments.length?(this._aggregate=a,this):this._aggregate},a}),dv.chart=dv.container.extend(function(){function a(){this._super(),this._firstRender=!1,this._data={},this._coord=dv.coord.cartesian(),this._facet=dv.facet.wrap().chart(this),this._layers=[],this._behaviors=[],this._legends=dv.guide.legends(),this._axes=dv.guide.axes()._chart(this),this._delay=d3.functor(0),this._duration=d3.functor(1e3),this._ease="cubic-in-out",this._parent=null,this._chartContainer=null,this._svgContainer=null,this._g=null,this._axisLabelContainer=null,this._panelContainer=null,this._interactionGroup=null,this._prerenderFunc=null,this._postrenderFunc=null,this._clipPlot=!1,this._width=NaN,this._height=NaN,this._plotWidth=NaN,this._plotHeight=NaN,this._calcWidth=NaN,this._calcHeight=NaN,this._calcPlotWidth=NaN,this._calcPlotHeight=NaN,this._defaultPadding=this._padding=this._plotBounds=this._guidesBounds={top:0,left:0,right:0,bottom:0},this._position="identity"}return a.render=function(){if(dv.util.isUndefined(this._data)||dv.util.isEmpty(this._data))for(var a=0;a<this._layers.length;a++)(dv.util.isUndefined(this._layers[a]._data)||dv.util.isEmpty(this._layers[a]._data))&&dv.log.error({msg:"Cannot render a chart with no data provided.",data:{chartData:this._data,geom:this._layers[a]}});return this._resolvePercentDimensions(),this._createChartContainer(),this._prerender(),this._renderLegends(),this._prerenderFunc&&this._prerenderFunc.call(this),this._facet._render(),this._postrenderFunc&&this._postrenderFunc.call(this),this._renderBehaviors(),this._clipGeoms(),this._cleanupGuides(),this.unregisterEventMap=null,this},a._resolvePercentDimensions=function(){this._calcWidth=dv.util.getPercentValue(this._width,this._parent.node().offsetWidth),this._calcHeight=dv.util.getPercentValue(this._height,this._parent.node().offsetHeight),dv.util.isFinite(this._calcWidth)?this._calcPlotWidth=dv.util.getPercentValue(this._plotWidth,this._calcWidth):(this._calcPlotWidth=dv.util.getPercentValue(this._plotWidth,this._parent.node().offsetWidth),dv.util.isFinite(this._calcPlotWidth)||(this._calcWidth=this._parent.node().offsetWidth)),dv.util.isFinite(this._calcHeight)?this._calcPlotHeight=dv.util.getPercentValue(this._plotHeight,this._calcHeight):(this._calcPlotHeight=dv.util.getPercentValue(this._plotHeight,this._parent.node().offsetHeight),dv.util.isFinite(this._calcPlotHeight)||(this._calcHeight=this._parent.node().offsetHeight))},a._finalizePlotBounds=function(){var a=this._legends._allowedDimensions(),b=this._legends._getWidth(),c=this._legends._getHeight(),d={left:Math.max(a.left,this._padding.left),top:Math.max(a.top,this._padding.top)};dv.util.isFinite(this._calcWidth)?dv.util.isFinite(this._calcPlotWidth)||(this._calcPlotWidth=this._calcWidth-this._padding.left-this._padding.right-b):this._calcWidth=this._calcPlotWidth+b+this._padding.left+this._padding.right,dv.util.isFinite(this._calcHeight)?dv.util.isFinite(this._calcPlotHeight)||(this._calcPlotHeight=this._calcHeight-this._padding.top-this._padding.bottom-c):this._calcHeight=this._calcPlotHeight+c+this._padding.top+this._padding.bottom,this._calcPlotWidth=Math.min(this._calcPlotWidth,this._calcWidth-this._padding.left-this._padding.right-b),this._calcPlotHeight=Math.min(this._calcPlotHeight,this._calcHeight-this._padding.top-this._padding.bottom-c),d.right=d.left+this._calcPlotWidth,d.bottom=d.top+this._calcPlotHeight,this.plotBounds(d),this._coord instanceof dv.coord.cartesian&&(this._plotBounds.right-=this._coord.endX(),this._plotBounds.left+=this._coord.startX()),this._chartContainer.style("width",this._calcWidth+"px").style("height",this._calcHeight+"px")},a._prerender=function(){this._trainedScales={},this._calculateStats(),this._facet._prerender();var a=this._normalizeData(this.data());this.data(a),this._axes._get("x")||this._axes._add("x",dv.guide.axis()),this._axes._get("y")||this._axes._add("y",dv.guide.axis())},a._createChartContainer=function(){this._chartContainer=this._parent.selectAll(".dv-chart-container").data([0]),this._chartContainer.enter().append("div").classed("dv-chart-container",!0),this._svgContainer=this._chartContainer.selectAll("svg").data([0]),this._svgContainer.enter().append("svg").style("height","100%").style("width","100%"),this._axisLabelContainer=this._chartContainer.selectAll(".axes-labels").data([0]),this._axisLabelContainer.enter().append("div").classed("axes-labels",!0),this._g=this._svgContainer.select(".group"),this._g.empty()&&(this._firstRender=!0,this._g=this._svgContainer.append("g").classed("group",!0),this._panelContainer=this._g.append("g").classed("panels",!0),this._interactionGroup=this._g.append("g").classed("interaction-group",!0),this._g.append("g").classed("behavior-under-geom",!0),this._g.append("g").classed("plot",!0),this._g.append("g").classed("behavior",!0),this._g.append("g").classed("legends",!0),this._interactionGroup.append("rect").classed("interaction-canvas",!0).classed("background",!0)),this._panelContainer||(this._panelContainer=this._g.select(".panels")),this._interactionGroup||(this._interactionGroup=this._g.select(".interaction-group"))},a._addRegisteredEvents=function(){var a=this;dv.util.each(a.eventMap,function(b,c){a._interactionGroup.on(c,function(){var b=d3.event,d=a._interactionGroup.node();a._shouldDispatchChartEvent(b,d)&&a.eventMap[c].callback.call(a._interactionGroup.node(),d3.event)},b.capture)}),dv.util.each(a._layers,function(a){a._addRegisteredEvents()})},a._removeRegisteredEvents=function(){var a=this;dv.util.each(a.unregisterEventMap,function(b,c){a._interactionGroup&&a._interactionGroup.on(c,null,b)}),dv.util.each(a._layers,function(a){a._removeRegisteredEvents()})},a._shouldDispatchChartEvent=function(a,b){var c=!0;if("mouseout"===a.type||"mouseover"===a.type){var d=d3.select(a.relatedTarget);if(d&&!d.empty()){var e=d.attr("class");c=!(e&&e.indexOf("-geom")>=0)}}return c},a._calculateStats=function(){},a._renderLegends=function(){var a=dv.util.isFinite(this._calcWidth)?this._calcWidth-this._padding.left-this._padding.right:this._calcPlotWidth,b=dv.util.isFinite(this._calcHeight)?this._calcHeight-this._padding.top-this._padding.bottom:this._calcPlotHeight,c={left:this._padding.left,top:this._padding.top,width:a,height:b},d={el:this._g,scales:this._facet._globalScales,firstRender:this._firstRender,duration:this._duration,delay:this._delay,ease:this._ease};this._legends._allowedDimensions(c)._render(d),this._finalizePlotBounds()},a._cleanupGuides=function(){this._legends._empty(),this._axes._empty()},a._setRanges=function(){
var a=this.plotBounds(),b=this.getTrainedScale("y"),c=this.getTrainedScale("x"),d=this.coord().flip()?[a.bottom-a.top,0]:[0,a.right-a.left],e=this.coord().flip()?[0,a.right-a.left]:[a.bottom-a.top,0];dv.util.scaleRange(c,d),dv.util.scaleRange(b,e)},a.plotBounds=function(a){return arguments.length?(this._plotBounds=a,this):this._plotBounds},a._renderBehaviors=function(){var a=this._facet.getPanel(0),b=a._bounds,c=this._g.select(".behavior").attr("transform","translate(0,0)"),d=this._g.select(".behavior-under-geom").attr("transform","translate(0, 0)");this._interactionGroup.attr("transform","translate(0,0)").select(".interaction-canvas").attr("visibility","hidden").attr("width",b.right-b.left).attr("height",b.bottom-b.top).attr("x",b.left).attr("y",b.top);var e=this;dv.util.each(this._behaviors,function(a){a.underGeoms&&a.underGeoms()?a.chart(e)._render(d):a.chart(e)._render(c)})},a.guide=function(a,b,c){if(!a||""===a)throw new Error("Property argument cannot be null or empty");if("all"===a){if("none"!==b)throw new Error("'all' can only be used to set all guides to 'none' (e.g. turn off all guides)");this._legends._hide(!0),this._axes._add("x","none",0),this._axes._add("y","none",0)}a=dv.util.isArray(a)?a:[a],c=dv.util.isUndefined(c)?0:c;for(var d=dv.guide.legend(),e="",f=0;f<a.length;f++){var g=b,h=this._isPositionProperty(a[f]);if(e){if(h&&"axis"!=e)throw new Error("Cannot mix positional and non-positional guide types")}else e=h?"axis":"legend";if(g?!this._isValidGuideType(a[f],g)&&dv.util.isObject(g)&&(g=this._buildCustomGuide(g)):g=h?dv.guide.axis():d,this._isValidGuideType(a[f],g))if("none"!==g&&g.scaleIndex(c),h)this._axes._add(a[f],g,c);else{if("none"!==g){this._legends._add({props:a,guide:g});break}this._legends._remove(a)}}return this},a._isPositionProperty=function(a){return"x"===a||"y"===a},a._isValidGuideType=function(a,b){var c=this._isPositionProperty(a);return b&&("none"===b||b instanceof dv.guide.custom)||c&&b instanceof dv.guide.axis||!c&&b instanceof dv.guide.legend},a._buildCustomGuide=function(a){var b=dv.guide.custom();for(var c in a)b.setFunc(c,a[c]);return b},a.getScale=function(a,b){return arguments.length<2&&(b=0),"group"===a?this._getGroup():this._aes.hasOwnProperty(a)?this._aes[a][b]:void 0},a._getGroup=function(){if(this._aes.hasOwnProperty("group"))return this._aes.group[0];for(var a=-1,b=dv.DEFAULT_CATEGORICAL_AES.length-1;a++<b;){var c=this._aes[dv.DEFAULT_CATEGORICAL_AES[a]];if(c&&c[0]&&c[0]instanceof dv.scale.ordinal&&!dv.util.isUndefined(c[0].mapping()))return c[0]}return null},a._clipGeoms=function(){var a=this,b=this._parent.selectAll(".panel").selectAll("defs").data(function(b){return a._clipPlot?[b]:[]});b.enter().append("defs"),b.exit().remove();var c=b.selectAll("clipPath").data(function(a){return[a]});c.enter().append("clipPath").classed("dv-clip",!0),c.exit().remove(),c.attr("id",function(a){return"dv-clip"+a._facetIndex});var d=c.selectAll("rect").data(function(a){return[a]});if(d.enter().append("rect"),d.exit().remove(),d.attr("x",function(a){return a._bounds.left}).attr("y",function(a){return a._bounds.top}).attr("width",function(a){return a._bounds.width}).attr("height",function(a){return a._bounds.height}),a._clipPlot){this._parent.selectAll(".series").attr("clip-path",function(a){var b=a.values[0];return"url(#dv-clip"+(dv.util.isArray(b)?b[0].panel:b.panel)._facetIndex+")"})}},a.getTrainedScale=function(a){return this._facet.getTrainedScale(a)},a.getExplicitScale=function(a,b){return void 0===b&&(b=0),this._aes[a][b]},a.parent=function(a){if(!arguments.length)return this._parent?this._parent.node():null;if(this._parent=d3.select(a),this._parent.empty())throw new Error("The DV parent element was not found.");return this},a.layers=function(a){return arguments.length?(this._layers=a,this):this._layers},a.behaviors=function(a){return arguments.length?(this._behaviors=a,this):this._behaviors},a.data=function(a){return arguments.length?(this._data=a,this):this._data},a.coord=function(a){return arguments.length?(this._coord=a,this):this._coord},a.facet=function(a){return arguments.length?(this._facet=a,this._facet.chart(this),this):this._facet},a.getPlotBounds=function(a){return this._plotBounds},a.plotWidth=function(a){return arguments.length?(this._plotWidth=a,this):this._plotWidth},a.plotHeight=function(a){return arguments.length?(this._plotHeight=a,this):this._plotHeight},a.width=function(a){return arguments.length?(this._width=a,this):this._width},a.height=function(a){return arguments.length?(this._height=a,this):this._height},a.padding=function(a){return arguments.length?(this._padding=dv.util.merge(this._defaultPadding,a),this):this._padding},a.prerender=function(a){return arguments.length?(this._prerenderFunc=a,this):this._prerenderFunc},a.postrender=function(a){return arguments.length?(this._postrenderFunc=a,this):this._postrenderFunc},a.clipPlot=function(a){return arguments.length?(this._clipPlot=a,this):this._clipPlot},a}),dv.collisions=dv.collisions||{},dv.collisions.transformPoint=function(a,b){return[a[0]*b[0]+a[2]*b[1]+a[4],a[1]*b[0]+a[3]*b[1]+a[5]]},dv.collisions.convertMatrixTo2x3=function(a){return[a[0],a[1],a[3],a[4],a[6],a[7]]},dv.collisions.convertMatrixTo3x3=function(a){return[a[0],a[1],0,a[2],a[3],0,a[4],a[5],1]},dv.collisions.matrixMultiply=function(a,b){return[a[0]*b[0]+a[2]*b[1],a[1]*b[0]+a[3]*b[1],a[0]*b[2]+a[2]*b[3],a[1]*b[2]+a[3]*b[3],a[0]*b[4]+a[2]*b[5]+1*a[4],a[1]*b[4]+a[3]*b[5]+1*a[5]]},dv.collisions.matrixMultiply3x3=function(a,b){for(var c=[],d=0;d<7;d+=3)for(var e=0;e<3;e++)c.push(a[e]*b[d]+a[e+3]*b[d+1]+a[e+6]*b[d+2]);return c},dv.collisions.matrixInverse=function(a){var b=dv.collisions.determinant(a);if(0===b)return null;var c=dv.collisions.matrixInverse3x3([a[0],a[1],0,a[2],a[3],0,a[4],a[5],1]);return[c[0],c[1],c[3],c[4],c[6],c[7]]},dv.collisions.matrixInverse3x3=function(a){var b=dv.collisions.determinant3x3(a);if(0===b)return null;for(var c=1/b,d=a[0],e=a[3],f=a[6],g=a[1],h=a[4],i=a[7],j=a[2],k=a[5],l=a[8],m=[h*l-i*k,i*j-g*l,g*k-h*j,f*k-e*l,d*l-f*j,e*j-d*k,e*i-f*h,f*g-d*i,d*h-e*g],n=0;n<m.length;n++)m[n]=m[n]*c;return m},dv.collisions.determinant=function(a){return a[0]*a[3]-a[2]*a[1]},dv.collisions.determinant3x3=function(a){var b=a[0],c=a[3],d=a[6],e=a[1],f=a[4],g=a[7],h=a[2],i=a[5],j=a[8];return b*(f*j-g*i)+c*(g*h-e*j)+d*(e*i-f*h)},dv.collisions.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]},dv.collisions.vectorTo=function(a,b){return[b[0]-a[0],b[1]-a[1]]},dv.collisions.vectorNormal=function(a){return[-a[1],a[0]]},dv.collisions.vectorScale=function(a,b){return[a[0]*b,a[1]*b]},dv.collisions.vectorOffset=function(a,b){return[a[0]+b[0],a[1]+b[1]]},dv.collisions.magSq=function(a){return dv.collisions.dot(a,a)},dv.collisions.distToSegSq=function(a,b,c){var d=dv.collisions.vectorTo(b,c),e=dv.collisions.vectorTo(b,a),f=dv.collisions.vectorTo(c,a),g=dv.collisions.dot(e,d),h=dv.collisions.dot(d,d);return g<0?dv.collisions.dot(e,e):g>=h?dv.collisions.dot(f,f):dv.collisions.dot(e,e)-g*g/h},dv.collisions.pointInside=function(a,b,c){var d=dv.collisions.vectorTo(b,c),e=dv.collisions.vectorNormal(d),f=dv.collisions.vectorTo(b,a);return dv.collisions.dot(f,e)>0},dv.collisions.triangleIsCounterClockwise=function(a,b,c){return b[0]*c[1]-b[1]*c[0]-a[0]*(c[1]-b[1])+a[1]*(c[0]-b[0])<0},dv.collisions.hullPoint=function(a){this.position=a,this.next=null},dv.collisions.hullPoint.prototype.x=function(){return this.position[0]},dv.collisions.hullPoint.prototype.y=function(){return this.position[1]},dv.collisions.hullPoint.prototype.inTriangle=function(a,b,c){var d=dv.collisions.vectorTo(a.position,b.position),e=dv.collisions.vectorTo(a.position,c.position),f=dv.collisions.vectorTo(a.position,this.position),g=dv.collisions.dot(d,d),h=dv.collisions.dot(d,e),i=dv.collisions.dot(e,e),j=dv.collisions.dot(f,d),k=dv.collisions.dot(f,e),l=g*i-h*h,m=(i*j-h*k)/l,n=(g*k-h*j)/l,o=1-m-n;return 0<=m&&0<=n&&0<=o&&m+n+o<=1},dv.collisions.hullPoint.pointFarthestFromEdge=function(a,b,c){for(var d=dv.collisions.vectorTo(a.position,b.position),e=dv.collisions.vectorNormal(d),f=-1,g=-Number.MAX_VALUE,h=-Number.MAX_VALUE,i=0;i<c.length;i++){var j=dv.collisions.dot(e,dv.collisions.vectorTo(a.position,c[i].position));if(j>=0){var k=dv.collisions.dot(d,dv.collisions.vectorTo(a.position,c[i].position));(j>g||j==g&&k>h)&&(f=i,g=j,h=k)}}return f},dv.collisions.quickHull=function(a){function b(a,b,c){for(var d=dv.collisions.vectorTo(b.position,c.position),e=dv.collisions.vectorNormal(d),f=[],g=0;g<a.length;g++)if(a[g]!=b&&a[g]!=c){var h=dv.collisions.dot(e,dv.collisions.vectorTo(b.position,a[g].position));h>=0&&f.push(a[g])}return f}function c(a,b,c,d){for(var e=[],f=0;f<a.length;f++)a[f].inTriangle(b,c,d)||e.push(a[f]);return e}function d(a){for(var b=-1,c=-Number.MAX_VALUE,d=0;d<a.length;d++)a[d].x()>c&&(b=d,c=a[d].x());return b}function e(a){for(var b=-1,c=Number.MAX_VALUE,d=0;d<a.length;d++)a[d].x()<c&&(b=d,c=a[d].x());return b}function f(a,d,e){if(0===a.length)return[];var g=dv.collisions.hullPoint.pointFarthestFromEdge(d,e,a);if(g!=-1){d.next=a[g],a[g].next=e;var h=d,i=d.next,j=e,k=c(a,h,i,j),l=b(k,h,i),m=b(k,i,j);f(l,h,i),f(m,i,j)}}var g=e(a),h=d(a),i=a[g],j=a[h];i.next=j,j.next=i;var k=b(a,i,j),l=b(a,j,i);f(k,i,j),f(l,j,i);for(var m=[[i.x(),i.y()]],n=i.next;n!=i;)m.push([n.x(),n.y()]),n=n.next;return m.reverse()},dv.collisions.collisionPrimitive=dv.extend(function(){function a(){}return a.testHull=function(a){throw new Error("testHull must be implemented in subclass")},a.testPoint=function(a){throw new Error("testPoint must be implemented in a subclass")},a.testRect=function(a){throw new Error("testRect must be implemented in a subclass")},a.testCircle=function(a){throw new Error("testCircle must be implemented in a subclass")},a}),dv.collisions.hullSet=dv.collisions.collisionPrimitive.extend(function(a){function b(a){this._super(),this.hulls=a}return b.testHull=function(a){for(var b=0;b<this.hulls.length;b++)if(this.hulls[b].testHull(a))return!0;return!1},b.testPoint=function(a){for(var b=0;b<this.hulls.length;b++)if(this.hulls[b].testPoint(a))return!0;return!1},b.testRect=function(a){for(var b=0;b<this.hulls.length;b++)if(this.hulls[b].testRect(a))return!0;return!1},b.testCircle=function(a){for(var b=0;b<this.hulls.length;b++)if(this.hulls[b].testCircle(a))return!0;return!1},b}),dv.collisions.hull=dv.collisions.collisionPrimitive.extend(function(a){function b(a){this._super(),this.points=a}return b.testPoint=function(a){var b=this.hullLength(),c=0,d=b;do{var e=Math.floor((c+d)/2);dv.collisions.triangleIsCounterClockwise(this.points[0],a,this.points[e])?c=e:d=e}while(c+1<d);return 0!==c&&d!==b&&dv.collisions.triangleIsCounterClockwise(this.points[c],a,this.points[d])},b.testRect=function(a){for(var b=a.getCorners(),c=0;c<b.length;c++)if(this.testPoint(b[c]))return!0;for(c=0;c<this.points.length;c++)if(a.testPoint(this.points[c]))return!0;return!1},b.testCircle=function(a){var b=this.points;if(this.testPoint(a.center))return!0;for(var c=1;c<b.length;c++)if(a.testSegment(b[c-1],b[1]))return!0;return!!a.testSegment(b[b.length-1],b[0])},b.hullLength=function(){return this.points.length},b}),dv.collisions.hullsFromGeometry=function(a,b){function c(a){for(var c=[],d=0;d<a.length;d++){var e=b(a[d]);e&&c.push(e)}return c}function d(a){var b=c(a[0]);return b?dv.collisions.hullFromPoints(b):null}function e(a){for(var b=[],c=0;c<a.length;c++){var e=d(a[c]);e&&b.push(e)}return b}var f=[];return a?"Polygon"==a.type?(hull=d(a.coordinates),[hull]):"MultiPolygon"==a.type?e(a.coordinates):f:f},dv.collisions.hullFromGeometry=function(a,b){function c(a){function c(a){if(Array.isArray(a))if(2!=a.length||Array.isArray(a[0])||Array.isArray(a[1]))for(var e=0;e<a.length;e++)c(a[e]);else{var f=b(a);null==f||d.push(f)}}var d=[];return c(a.coordinates),d}if(a){if("MultiPolygon"==a.type)return d;if("GeometryCollection"==a.type)return d;var d=c(a);return dv.collisions.hullFromPoints(d)}return null},dv.collisions.hullFromPath=function(a){var b=[];return dv.collisions.hullFromPoints(b)},dv.collisions.hullFromPoints=function(a){if(!a)return null;if(0===a.length)return null;for(var b=[],c=0;c<a.length;c++)b.push(new dv.collisions.hullPoint(a[c]));return dv.collisions.hull(dv.collisions.quickHull(b))},dv.collisions.hullSetFromPoints=function(a){},dv.collisions.rect=dv.collisions.collisionPrimitive.extend(function(){function a(){this.min=[0,0],this.max=[0,0]}return a.setBounds=function(a,b){this.min=[a[0]<=b[0]?a[0]:b[0],a[1]<=b[1]?a[1]:b[1]],this.max=[a[0]<=b[0]?b[0]:a[0],a[1]<=b[1]?b[1]:a[1]]},a.getCorners=function(){return[this.min,[this.max[0],this.min[1]],this.max,[this.min[0],this.max[1]]]},a.testPoint=function(a){for(var b=0;b<2;b++)if(a[b]<this.min[b]||a[b]>this.max[b])return!1;return!0},a.testRect=function(a){for(var b=0;b<2;b++)if(this.max[b]<a.min[b]||this.min[b]>a.max[b])return!1;return!0},a.sqDistanceToPoint=function(a){for(var b=0,c=0;c<2;c++){var d=a[c];d<this.min[c]&&(b+=(this.min[c]-d)*(this.min[c]-d)),d>this.max[c]&&(b+=(d-this.max[c])*(d-this.max[c]))}return b},a.testCircle=function(a){var b=this.sqDistanceToPoint(a.center);return b<1e-7||b<a.radius*a.radius},a}),dv.collisions.rectFromMinMax=function(a,b,c,d){var e=dv.collisions.rect();return e.setBounds([a,b],[c,d]),e},dv.collisions.circle=dv.collisions.collisionPrimitive.extend(function(a,b,c){function d(a,b,c){this.center=[a,b],this.radius=c}return d.setLocation=function(a,b,c){this.center=[a,b],this.radius=c},d.testPoint=function(a){for(var b=0,c=0;c<2;c++)b+=(a[c]-this.center[c])*(a[c]-this.center[c]);return!(b>this.radius*this.radius)},d.testRect=function(a){return a.testCircle(this)},d.testCircle=function(a){for(var b=0,c=0;c<2;c++)b+=(a.center[c]-this.center[c])*(a.center[c]-this.center[c]);var d=a.radius+this.radius;return b<d*d},d.testSegment=function(a,b){return dv.collisions.distToSegSq(this.center,a,b)<=this.radius*this.radius},d}),dv.collisions.QuadtreeNode=function(a,b){this.center=a,this.halfwidth=b,this.children=[],this.contents=[]},dv.collisions.QuadtreeNode.prototype.clear=function(){this.contents=[];for(var a=0;a<this.children.length;a++)this.children[a].clear()},dv.collisions.QuadtreeNode.prototype.buildTree=function(a){if(a<0)return null;for(var b=.5*this.halfwidth,c=0;c<4;c++){var d={x:1&c?b:-b,y:2&c?b:-b},e=new dv.collisions.QuadtreeNode([this.center[0]+d.x,this.center[1]+d.y],b);this.children.push(e),e.buildTree(a-1)}},dv.collisions.QuadtreeNode.prototype.contains=function(a){for(var b=[this.center[0]-this.halfwidth,this.center[1]-this.halfwidth],c=[this.center[0]+this.halfwidth,this.center[1]+this.halfwidth],d=0;d<2;d++)if(a[d]<b[d]||a[d]>c[d])return!1;return!0},dv.collisions.QuadtreeNode.prototype.testRect=function(a,b,c,d,e){this.testMinMaxBox({minX:a,minY:b,maxX:c,maxY:d},e)},dv.collisions.QuadtreeNode.prototype.testRect=function(a,b){if(!(this.center[0]+this.halfwidth<a.min[0]||this.center[0]-this.halfwidth>a.max[0]||this.center[1]+this.halfwidth<a.min[1]||this.center[1]-this.halfwidth>a.max[1])){var c;for(c=0;c<this.contents.length;c++)this.contents[c].geometry.testRect(a)&&b(this.contents[c].payload,this.contents[c].geometry,this);for(c=0;c<this.children.length;c++)this.children[c].testRect(a,b)}},dv.collisions.QuadtreeNode.prototype.testCircle=function(a,b){var c,d=[this.center[0]-this.halfwidth,this.center[1]-this.halfwidth],e=[this.center[0]+this.halfwidth,this.center[1]+this.halfwidth],f=0;for(c=0;c<2;c++){var g=a.center[c];g<d[c]&&(f+=(d[c]-g)*(d[c]-g)),g>e[c]&&(f+=(g-e[c])*(g-e[c]))}if(f<1e-7||f<a.radius*a.radius){for(c=0;c<this.contents.length;c++)this.contents[c].geometry.testCircle(a)&&b(this.contents[c].payload,this.contents[c].geometry,this);for(c=0;c<this.children.length;c++)this.children[c].testCircle(a,b)}},dv.collisions.QuadtreeNode.prototype.testPoint=function(a,b){if(this.contains(a)){var c;for(c=0;c<this.contents.length;c++)this.contents[c].geometry.testPoint(a)&&b(this.contents[c].payload,this.contents[c].geometry,this);for(c=0;c<this.children.length;c++)this.children[c].testPoint(a,b)}},dv.collisions.QuadtreeNode.prototype.nodeContainingRect=function(a){for(var b=0,c=!1,d=this.center,e=0;e<2;e++){if(a.min[e]<d[e]&&a.max[e]>d[e]){c=!0;break}a.min[e]>=d[e]&&(b|=1<<e)}return!c&&this.children.length>b?this.children[b].nodeContainingRect(a):this},dv.collisions.QuadtreeNode.prototype.nodeContainingHull=function(a){for(var b=0,c=this.center,d=0;d<2;d++){for(var e=a.points[0][d]-c[d],f=1;f<a.points.length;f++){if((a.points[f][d]-c[d])*e<0)return this}e>0&&(b|=1<<d)}return this.children.length>b?this.children[b].nodeContainingHull(a):this},dv.collisions.QuadtreeNode.prototype.nodeContainingCircle=function(a){for(var b=0,c=!1,d=a.center,e=this.center,f=0;f<2;f++){var g=d[f]-e[f];if(Math.abs(g)<a.radius){c=!0;break}g>0&&(b|=1<<f)}return!c&&this.children.length>b?this.children[b].nodeContainingCircle(a):this},dv.collisions.QuadtreeNode.prototype.insertHull=function(a,b){this.nodeContainingHull(a).contents.push({geometry:a,payload:b})},dv.collisions.QuadtreeNode.prototype.insertCircle=function(a,b){this.nodeContainingCircle(a).contents.push({geometry:a,payload:b})},dv.collisions.QuadtreeNode.prototype.insertRect=function(a,b){this.nodeContainingRect(a).contents.push({geometry:a,payload:b})},dv.collisions.RenderQuadtree=function(a,b){var c=b.selectAll(".quadtreedebug").data([0]);c.enter().append("g").classed("quadtreedebug",!0);var d,e=[],f=[];for(f.push(a);f.length>0;)d=f[0],f.push.apply(f,d.children),e.push({x:d.center[0]-d.halfwidth,y:d.center[1]-d.halfwidth,width:2*d.halfwidth,height:2*d.halfwidth,content:d.contents.length}),f.splice(0,1);var g=c.selectAll("rect").data(e);g.enter().append("rect"),g.attr("x",function(a){return a.x}).attr("y",function(a){return a.y}).attr("width",function(a){return a.width}).attr("height",function(a){return a.height}).style("fill","none").style("stroke-width","2px").style("stroke",function(a){return a.content>0?"red":"green"}).style("opacity",function(a){return a.content>0?"0.5":"0.05"})},dv.collisions.RenderHull=function(a,b){function c(a,b){var c=dv.collisions.vectorScale(dv.collisions.vectorTo(a,b),.5),d=dv.collisions.vectorNormal(c);d=dv.collisions.vectorScale(dv.collisions.vectorScale(d,1/Math.sqrt(dv.collisions.magSq(d))),16);var e=dv.collisions.vectorOffset(a,c);f.push(e),f.push(dv.collisions.vectorOffset(e,d)),f.push(e),f.push(b)}var d=a.selectAll("g.hull").data([0]);d.enter().append("g").classed("hull",!0),d.selectAll("circle").data(b.points).enter().append("circle").attr("cx",function(a){return a[0]}).attr("cy",function(a){return a[1]}).attr("r",function(a,b){return 4}).text(function(a,b){return b});for(var e=d3.svg.line().x(function(a){return a[0]}).y(function(a){return a[1]}),f=[b.points[0]],g=1;g<b.points.length;g++)c(b.points[g-1],b.points[g]);c(b.points[b.points.length-1],b.points[0]),d=a.selectAll("g.line").data([0]),d.enter().append("g").classed("line",!0),d.datum(f).classed("line",!0).append("path").attr("d",e)},"function"==typeof define&&define.amd?define(function(){return dv}):"undefined"==typeof exports?window.dv=dv:"object"==typeof module&&module.exports?module.exports=dv:exports.dv=dv}(),function(a){"use strict";function b(a,c){if(this instanceof b)return this;var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=c||{},z=0,A=y.displayCount||-1,B=y.showNone,C={},D=C.value=[],E=C.origValue=[],F=C.lowerBound=[],G=C.upperBound=[],H=C.series=[],I=C.series_name=[],J=C.metric_series=[],K=C.metric_series_name=[],L=C.date=[],M=C.category=[],N=C.label=[],O=C.groups=[],P=C.facets=[],Q=C.cell=[],R=C.filter=[],S=y.showMetrics||!1,T=C.metric=[],U=a.metrics.length>1,V=!1,W=!1;for(a.filters.length>1&&a.filters.some(function(a,b,c){return b>0&&!W&&(W=a.data_store!==c[b-1].data_store),b>0&&!V&&(V=(a.info&&a.info.name||"")!==(c[b-1].info&&c[b-1].info.name||"")),V&&W}),m=0,n=a.metrics.length;m<n;++m)for(g=a.metrics[m],j=(g.name||g.id||"")+"",d=g.filter_ref,e=g.date_ref,p=A>=0?Math.min(A,d.length):d.length,o=0;o<p;++o){for(h=a.filters[d[o]],h.facet_ref||(h.facet_ref=[]),w=[],x=[],t=0,u=h.facet_ref.length;t<u;++t)v=a.facets[h.facet_ref[t]],w.push(v),x.push(v.info&&v.info.name||"");if(!h.info||0!==h.info.id||B)for(i=(h.info&&h.info.name||"")+"",l=h.data_store_name||h.data_store&&h.data_store.replace("dms/","")||"",q=0,r=e.length;q<r;++q)k=a.dates[e[q]],f=a.data[d[o]][e[q]][m],D[z]="invalid"===f.status||"transform_error"===f.status||"calc_error"===f.status?void 0:+f.val||0,E[z]="invalid"===f.status?void 0:+f.orig_val||0,F[z]="invalid"===f.status||"transform_error"===f.status?void 0:+f.lower_bound||0,G[z]="invalid"===f.status||"transform_error"===f.status?void 0:+f.upper_bound||0,L[z]=new Date(k.val),M[z]=i,N[z]=j,K[z]=(W?l+"   ":"")+j,J[z]=K[z]+":m"+g.ref_id,s=[],W&&s.push(l),M[z].length&&s.push(M[z]),I[z]=s.join("   "),0===I[z].length?I[z]=j:(S||U||!V)&&j.length&&(I[z]+=" ("+j+")"),H[z]=I[z]+":m"+g.ref_id+"f"+h.ref_id,O[z]=x,R[z]=h,T[z]=g,Q[z]=f,P[z]=w,++z;else p<d.length&&++p}return C}var c=a.rs2dv;b.noConflict=function(){return a.rs2dv=c,this},b.prototype.convert=function(){return b.apply(null,arguments)},a.rs2dv=b,"function"==typeof define&&define.amd?define(function(){return b}):"undefined"==typeof exports?a.rs2dv=b:"object"==typeof module&&module.exports?module.exports=b:exports.rs2dv=b}(this),function(a){"use strict";var b={},c=a.dv||{},d=a.d3||{},e={};e.determineKeyModifiers=function(a){var b=0;return b|=a.metaKey?c.util.selectModifiers.toggle:0,b|=a.ctrlKey?c.util.selectModifiers.toggle:0,b|=a.shiftKey?c.util.selectModifiers.range:0,0==(b&c.util.selectModifiers.toggle)&&(b|=c.util.selectModifiers.set),b},e._options=null,e._changedOptions=null,e.init=function(a){return this._initDefaultOptions(),this.setOptions(a),this},e._initDefaultOptions=function(a){var b={dataAdapter:"standard",data:null,height:null,parent:null,width:null,autoResize:!1,locale:"en-US",tooltipContent:null,onMouseOver:null,onMouseOut:null,onContextMenu:null,customEvents:[],l10n:{}};a&&this._mergeOptions(b,a),this._options=b,this._changedOptions={};for(var c in b)this._changedOptions[c]=b[c];var e=["click","mouseover","mouseout","contextmenu","selectionChanged"],f=this._options.customEvents,g=f?e.concat(f):e;return this._dispatch=d.dispatch.apply(d.dispatch,g),this._options},e._initTooltip=function(a,b,d){var e,f,g=this._cvWrapper.select(".svg-wrapper"),h=this._tooltipParent,i=g.select("svg").node().getBBox(),j=this._options;f=j.tooltipContent?j.tooltipContent(a):this.defaultTooltipContent(a),e=this._getTooltipBounds(a,b,i),c.showTooltip(e,i,f,"right",20,h)},e._getTooltipBounds=function(a,b,c){console.error("Must implement _getTooltipBounds in subclass")},e._teardownTooltip=function(a,b){var d=this._tooltipParent||this._cvWrapper.select(".svg-wrapper");c.removeTooltip(d)},e._getNodeTranslation=function(a){if(!a.transform)return{x:0,y:0};for(var b=a.transform.baseVal,c=2,d=null,e=b.length,f=0;f<e&&!(d=b[f].type===c?b[f].matrix:null);f++);return d?{x:d.e,y:d.f}:{x:0,y:0}},e.defaultTooltipContent=function(a){return"<span class='series-name'>"+this.escapeHtml(a.label)+"</span><span class='metric-value'>"+this.escapeHtml(a.value)+"</span>"},e.on=function(a,b){return this._dispatch.on(a,b),this},e._onSelectionChanged=function(a,b,c,d,e){this._dispatch.selectionChanged.call(a,b,c,d,e)},e._mergeOption=function(a,b,c){switch(b){case"mappings":case"formats":case"scales":a[b]=a[b]||{},this._mergeOptions(a[b],c);break;default:a[b]=c}return a},e._mergeOptions=function(a,b){for(var c in b)this._mergeOption(a,c,b[c]);return a},e._truncateLabel=function(a,b){var c=b||this.X_AXIS_LABEL_MAXLENGTH;return a.length>c?a.substring(0,c)+"...":a},e._formatNumber=function(a,b,c,e){var f,g,h,i,j,k="",l=this._dataAdapter.l10n.numberFormat;if("currency"==a||"percent"==a?(k=l[a].symbol,h=b>=0?l[a].positivePattern:l[a].negativePattern):h=b>=0?"{number}":l.negativePattern,"percent"==a&&(b*=100),b=Math.abs(b),j=b>=100?3:b>=10?b%1?3:2:b>=1?b%1?3:1:b%1?2:1,null!=c)if(b>=.01&&b<1)i=d.format("."+c+"f")(b);else{var m=d.formatPrefix(b);i=m.scale(b).toFixed(c)+m.symbol}else if(b>=1e3&&b<1e4)i=d.format(",.0f")(b);else{var n="."+j;n+=b>=.01&&b<1?"r":"s",i=d.format(n)(b)}return c&&b<Math.pow(10,-c)&&b>0?(g=!0,i=Math.pow(10,-c)+""):null==c&&b<.01&&b>0&&(g=!0,i="0.01"),f=h.replace(/\{number\}/i,i).replace(/\{symbol\}/i,k).replace(/,/g,l.groupSeparator).replace(/\./,l.decimalSeparator),g&&(f="<"+f),f},e._getPropMapping=function(a){return this._dataAdapter.mappings()[a]},e.setOption=function(a,b){return a in this._options&&("dataAdapter"===a&&"rs2dv"===b&&(b="rs"),"clickHandler"===a&&this.on("click",b),"onContextMenu"===a&&this.on("contextmenu",b),"onMouseOver"===a&&this.on("mouseover",b),"onMouseOut"===a&&this.on("mouseout",b),this._mergeOption(this._options,a,b),this._changedOptions||(this._changedOptions={}),this._changedOptions[a]=b,!0)},e.getOption=function(a){var b=this._options;return a in b?b[a]:null},e.setOptions=function(a){for(var b in a)this.setOption(b,a[b])},e.setColors=function(a){if(!(a.colors&&a.colors.length>0)){var b,c=[];c.salmonRun=["#ffe6d2","#f8a16a","#e35037","#a31542","#500046"],c.sunnyDay=["#fffae6","#96d383","#589d72","#336568","#00325a"],c.blueOcean=["#f0fff0","#98cdc1","3795b9","#195c96","#002864"],c.blueGrayGreen=["#1e4f7d","#346894","#5980a3","#7e98af","#a3b0bb","#c8c8c8","#93b986","#65a534","#498d13","#337208","#1e5a00"],c.specialDefault=["#3287d2","#9b8ce6","#d755a5","#fa5a50","#f0a01e","#c3d250","#5faf69","#1ebed7","#5a6eaa","#78b4f5","#aa5fa5","#f0557d","#e8782d","#f5c841","#8cc350","#3cb5a0","#286eaf","#826ee1","#b93282","#f04641","#e18c00","#a0b400","#50965a","#00a0be","#465a87","#4196e6","#964196","#dc3c69","#dc5f00","#e6b43c","#7daf4b","#32a08c"],c.default=["#8cc350","#5a6eaa","#d755a5","#1ebed7","#f0a01e","#9b8ce6","#3cb5a0","#3287d2","#f0557d","#c3d250","#eb782d","#78b4f5","#5faf69","#aa5fa5","#fa5a50","#f5c841"],c["d3.category10"]=[],c["d3.category20"]=[],c["d3.category20b"]=[],c["d3.category20c"]=[];var e=d.scale.category10(),f=d.scale.category20(),g=d.scale.category20b(),h=d.scale.category20c();for(b=0;b<20;b++)b<10&&(c["d3.category10"][b]=e(b)),c["d3.category20"][b]=f(b),c["d3.category20b"][b]=g(b),c["d3.category20c"][b]=h(b);a.colors=c[a.theme]?c[a.theme]:c.default}},e.selectionCache=function(a){return null!=a&&(this._selectionCache=a),this._selectionCache},e.renderRects=function(a,b,c){var e=b||d,f=Array.isArray(a)&&Array.isArray(a[0])?a:[a],g=c?"rect."+c:"rect",h=e.selectAll(g).data(f);return h.enter().append("rect"),c&&h.classed(c,!0),h.attr("x",function(a){return a[0]}).attr("y",function(a){return a[1]}).attr("width",function(a){return a[2]}).attr("height",function(a){return a[3]}),h.exit().remove(),h},e._preRender=function(){if(this._clearErrorMessage(),this.setColors(this._options),"autoResize"in this._changedOptions&&this._updateWindowResize(),"dataAdapter"in this._changedOptions){var a=this._changedOptions.dataAdapter;if(!this._dataAdapter||this._options.dataAdapter!==a){var c=b.dataAdapter[a];if(!c)throw new Error("No data adapters were found for data adapter type "+a);var e=c[this._type]||c.base||b.dataAdapter.standard.base;this._dataAdapter=e()}}this._dataAdapter.process(this._options,this._changedOptions),this._highlightedOverlay=b.util.selectedOverlay(d.select(this._options.parent))},e._render=function(){},e._postRender=function(){this._changedOptions={}},e.render=function(a){return this.reset(),this._preRender(),this._render(a),this._postRender(),this},e.reset=function(){},e._updateWindowResize=function(){this._options.autoResize?(this._autoResizeHandler=this._autoResizeHandler||c.util.bind(this._onAutoResize,this),b.windowResize.addHandler(this._autoResizeHandler)):b.windowResize.removeHandler(this._autoResizeHandler)},e._onAutoResize=function(){},e.RESPONSIVE_WIDTH_THRESHOLD=400,e._isSmallChart=function(a){return a<e.RESPONSIVE_WIDTH_THRESHOLD},e._getChartWidth=function(){var a=this._options,b=d.select(a.parent),e=b.select(".cv-wrapper");if(e.empty()&&(e=b),this.isPresent(this.plotWidth)&&!c.util.isPercentString(a.plotWidth))return a.plotWidth;if(this.isPresent(this.width)&&!c.util.isPercentString(a.width))return a.width;var f=e.node().offsetWidth,g=e.node().offsetHeight;return this.isPresent(this.plotWidth)?parseInt(a.plotWidth,10)/100*f:this.isPresent(this.width)?parseInt(a.width,10)/100*f:this.isPresent(a.aspectRatio)&&this.isPresent(g)?g*a.aspectRatio:f},e._getChartHeight=function(){var a=this._options;if(this.isPresent(a.plotHeight)&&!c.util.isPercentString(a.plotHeight))return a.plotWidth;if(this.isPresent(a.height)&&!c.util.isPercentString(a.height))return a.height;var b=d.select(a.parent).node().offsetWidth,e=d.select(a.parent).node().offsetHeight;return this.isPresent(a.plotHeight)?parseInt(a.plotHeight,10)/100*e:this.isPresent(a.height)?parseInt(a.height,10)/100*e:this.isPresent(a.aspectRatio)&&this.isPresent(b)?b/a.aspectRatio:e},e.handleError=function(a){var b=this._dataAdapter.l10n,c=b.labels.core.erroronrender;return"invaliddata"===a.code&&(c=b.labels.core.nodata),this._setErrorMessage(c),console.log("EXCEPTION",a.message),console.log(a.stack),this},e.isPresent=function(a){return!!a||0===a},e._setErrorMessage=function(a){a&&a.length?d.select(this._options.parent).html('<div class="cv-error">'+a+"</div>"):this._clearErrorMessage()},e._clearErrorMessage=function(){d.select(this._options.parent).select(".cv-error").remove()},e.destroy=function(){this.reset(),b.windowResize.removeHandler(this._autoResizeHandler)},e.escapeHtml=function(a){return b.escapeHtml(a)},e.makeContextMenuHandler=function(a){return function(b,c,e){d.event.altKey||(d.event.preventDefault(),a._dispatch.contextmenu.call(this,b,c,e,d.event))}},e.makeMouseOverHandler=function(a){return function(b,c,e){a._dispatch.mouseover.call(this,b,c,e,d.event)}},e.makeMouseOutHandler=function(a){return function(b,c,e){a._dispatch.mouseout.call(this,b,c,e,d.event)}},e.makeClickHandler=function(a){return function(b,c,e){a._dispatch.click.call(this,b,c,e,d.event)}},e.addToSelectionByDatumSeries=function(){var a=this._selectionCache;return 2!=arguments.length||Array.isArray(arguments[0])?this.selectByDatumSeries(arguments,function(b){a.selectionAdd(b)}):this.selectByDatumSeries([[arguments[0],arguments[1]]],function(b){a.selectionAdd(b)})},e.setSelectionByDatumSeries=function(){var a=this._selectionCache;return 2!=arguments.length||Array.isArray(arguments[0])?this.selectByDatumSeries(arguments,function(b){a.selectionSet(b)}):this.selectByDatumSeries([[arguments[0],arguments[1]]],function(b){a.selectionSet(b)})},e.selectByDatumSeries=function(a,b){function c(a){g.push(this)}for(var e=d.select(this._options.parent),f=null,g=[],h=0;h<a.length;h++)Array.isArray(a[h])&&(f=this.selectDatumSeriesPair(a[h],e),f.each(c));return f=d.selectAll(g),b(f),f},e.selectDatumSeriesPair=function(a,b){var c=null!=a[0]?".datum-"+a[0]:null,d=null!=a[1]?".series-"+a[1]:null;return null==c&&null==d?b.selectAll([]):null==d?b.selectAll(c):null==c?b.selectAll(d):b.selectAll(c).filter(d)},e.currentSelection=function(){return d.select(this._options.parent).selectAll(".selected")},e.makeSelectHandler=function(a,b){var e=this;return this._options.enableSelection?function(f,g){var h=e.selectionCache(),i=b?b.call(this,f,g):this,j=c.util.determineKeyModifiers(d.event,h._keymap);if(j==c.util.selectModifiers.toggle)return h.selectionToggle(d.select(i)),void d.event.stopPropagation();if(j==c.util.selectModifiers.set)return h.selectionSet(d.select(i)),void d.event.stopPropagation();if(j&c.util.selectModifiers.range){var k=[],l=d.selectAll("."+h.selectableClass);if(h.savePreviousState(l),a)k=a(h._lastSelected?h._lastSelected:this,this);else{var m=h._lastSelected?h._lastSelected:i,n=i,o=m.getBoundingClientRect(),p=n.getBoundingClientRect(),q=new c.collisions.rectFromMinMax(o.left+.5*o.width,o.top+.5*o.height,p.left+.5*p.width,p.top+.5*p.height);l.each(function(a,b){var d=this.getBoundingClientRect(),e=new c.collisions.rectFromMinMax(d.left,d.top,d.right,d.bottom);q.testRect(e)&&k.push(this)}),k.push(i)}
return h.brush(d.selectAll(k)),void d.event.stopPropagation()}}:null},a.cloudViz=b,b.d3=d,b.dv=c,b.rs2dv=a.rs2dv||{},b.core=e,b.localeDefinition=function(a,c,d){var e,f,g,h;if(a=a.toLowerCase(),b._localeDefinitions=e=b._localeDefinitions||{},!(arguments.length>1))return h=e[a],h||(h=e["en-us"],console.error("Locale definition for "+a+" not found. Reverting to en-us.")),h;if(f=a.split("-"),f.length<=1)throw new Error("A registered CloudViz locale must be a hyphenated language culture code (e.g. en-US).");g=[a,f[0],f.join("_")],g.forEach(function(b){null==d?e[b]=c:(e[b]=e[a]||{},e[b][d]=c)})},b.escapeHtml=function(a){var b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};return String(a).replace(/[&<>"'\/]/g,function(a){return b[a]})},"function"==typeof define&&define.amd?define(function(){return b}):"undefined"==typeof exports?a.cloudViz=b:"object"==typeof module&&module.exports?module.exports=b:exports.cloudViz=b}(this),function(a){"use strict";a.cloudViz.seriesState=function(){var a={},b=[],c={};return a.isSeriesEnabled=function(a,c){if(!b)return!0;var d,e,f=b.length;for(d=0;d<f;d++)if(e=b[d],e.id===a&&e.type===c)return e.enabled;return!1},a.doesSeriesStateExist=function(a,c){if(!b)return!1;var d,e,f=b.length;for(d=0;d<f;d++)if(e=b[d],e.id===a&&e.type===c)return!0;return!1},a._createStateObject=function(a,b,c,d,e){var f;if(arguments.length<3)throw new Error("A state object requires a label and stateType.");return arguments.length<4&&(d=!0),f={name:a,id:b,type:c,enabled:d,hiddenInLegend:!!e},this.dispatch("create",f),f},a.insertState=function(a,c,d,e,f){b.unshift(this._createStateObject.apply(this,arguments))},a.appendState=function(a,c,d,e,f){b.push(this._createStateObject.apply(this,arguments))},a.enableStateByIndex=function(a,c){if(a<b.length){var d=b[a];d.enabled!==c&&(d.enabled=c,this.dispatch("enableChange",d))}},a.enableStateByTypeAndId=function(a,c,d){var e,f,g=b.length;for(e=0;e<g;e++)f=b[e],f.id===c&&f.type===a&&this.enableStateByIndex(e,d)},a.removeStatesByType=function(a){var c=this;b&&b.length&&(b=b.filter(function(b){return b.type!==a||(c.dispatch("remove",b),!1)}))},a.on=function(a,b){if(arguments.length<1)throw new Error("series state listeners require an eventType to be specified.");var d,e=a.indexOf("."),f="";e>0&&(f=a.substring(e+1),a=a.substring(0,e)),d=c[a]||{},b?(d[f]=b,c[a]=d):delete d[f]},a.dispatch=function(a,b){var d=c[a];if(d)for(var e in d)d[e].call(this,a,b)},a.getStateObjects=function(){return b},a.getVisibleStateObjects=function(){return b.filter(function(a){return!a.hiddenInLegend})},a.areSomeSeriesDisabled=function(){return!!b&&0===Math.min.apply(null,b.map(function(a){return+a.enabled}))},a.areAllSeriesDisabled=function(){return!!b&&0===Math.max.apply(null,b.map(function(a){return+a.enabled}))},a}}(this),function(a){"use strict";var b=a.cloudViz||{},c=b.util=b.util||{};c.deepExtend=function(a){for(var b=Array.prototype.slice.call(arguments,1),d=-1,e=b.length;++d<e;){var f=b[d];if(f)for(var g in f)f[g]&&f[g].constructor&&f[g].constructor===Object?(a[g]=a[g]||{},c.deepExtend(a[g],f[g])):a[g]=f[g]}return a},c.createConstructor=function(a){function b(){var b=Object.create(a);return"function"==typeof b.init&&b.init.apply(b,arguments),b}return b.prototype=a,b},c.selectedOverlay=function(a,b){var c={},d=b||".selected-overlay",e=d.substring(1),f=a||d3;return c.select=function(){return f.selectAll(d)},c.setUpSelectedOverlay=function(a){return a.selectAll(d).data([0]).enter().append("g").classed(e,!0).style("pointer-events","none")},c.updateSelectedDisplay=function(a,b){var c=[],d=b||function(){return this.attributes.transform?this.attributes.transform.nodeValue:"translate(0,0)"};a.each(function(a){c.push([this.id,d.call(this)])});var e=this.select().selectAll("use").data(c);return e.enter().append("use"),e.attr("xlink:href",function(a){return"#"+a[0]}).attr("transform",function(a){return a[1]}),e.exit().remove(),e},c},c.namespace=function(b,c){var d=b.split("."),e=c||a;return d.forEach(function(a){var b=e[a];b||(b=e[a]={}),e=b}),e},c.inputFilter=function(a,b,c){var d={},e=a||".brush-container",f=b||".zoom-container",g=c||".content-container",h=null,i=d3.dispatch("brush","brushstart","brushend"),j=null;return d3.rebind(d,i,"on"),d.setUpBrush=function(a,b,c){function d(a){if(a.empty())return[0,0];var b=a.attr("transform"),c=/translate\((-?\d+\.?\d*),(-?\d+\.?\d*)/,d=c.exec(b),e=[0,0];return d&&(e=[d[1],d[2]],e=dv.collisions.vectorScale(e,-1)),e}function f(a){if(a.empty())return 1;var b=a.attr("transform"),c=/scale\((-?\d+\.?\d*)\)/,d=c.exec(b);return d?1/d[1]:1}var k=this,l=1,m=[0,0];j=b;var n=c,o=[];a.each(function(a){o[0]=this.clientWidth,o[1]=this.clientHeight}),h=d3.svg.brush().x(d3.scale.identity().domain([0,o[0]])).y(d3.scale.identity().domain([0,o[1]])).on("brushstart",function(){var a=d3.selectAll("."+b.selectableClass);b.savePreviousState(a);var c=d3.select(g);m=d(c),l=f(c),i.brushstart()}).on("brushend",function(){d3.event.target.clear(),d3.select(this).call(d3.event.target),k.interceptBrushEvents(),i.brushend()}).on("brush",function(){var a=d3.event.target.extent(),b=a[0],c=a[1];b=dv.collisions.vectorOffset(b,m),c=dv.collisions.vectorOffset(c,m),b=dv.collisions.vectorScale(b,l),c=dv.collisions.vectorScale(c,l);var d=new dv.collisions.rectFromMinMax(b[0],b[1],c[0],c[1]),e=[];if(n)n.testRect(d,function(a,b,c){e.push(a)});else{d3.selectAll(g).selectAll("."+j.selectableClass).each(function(a,b){var c=this.getBoundingClientRect(),f=new dv.collisions.rectFromMinMax(c.left,c.top,c.right,c.bottom);d.testRect(f)&&e.push(this)})}var f=d3.selectAll(e);j.brush(f),i.brush()});a.selectAll(e).data([0]).enter().append("g").call(h).style("pointer-events","none").classed(e.substring(1),!0)},d.setUpBrushOverlay=function(a){if(null==h)throw new Error("you must call setUpBrush first");var b=a.selectAll(".brushOverlay").data([0]).enter().append("g").style("pointer-events","none").classed("brushOverlay",!0),c=b.selectAll(".extent").data([0]).enter().append("rect").classed("extent",!0);return h.on("brush.overlay",function(){var a=d3.event.target.extent();c.attr("x",a[0][0]).attr("y",a[0][1]).attr("width",a[1][0]-a[0][0]).attr("height",a[1][1]-a[0][1])}).on("brushstart.overlay",function(){c.style("visibility","")}).on("brushend.overlay",function(){c.style("visibility","hidden")}),b},d.setUpZoom=function(){},d.interceptBrushEvents=function(){function a(){i.style("pointer-events","none"),l.empty()||l.style("pointer-events","all"),k.style("pointer-events","visible")}function b(){i.style("pointer-events","all"),l.empty()||l.style("pointer-events","none"),k.style("pointer-events","none")}function c(a){var b=dv.util.determineKeyModifiers(a,j.selectionKeymap());return 1==a.buttons&&b&dv.util.selectModifiers.range}function d(a,b,c){var d=new MouseEvent(b,{screenX:c.screenX,screenY:c.screenY,clientX:c.clientX,clientY:c.clientY,ctrlKey:c.ctrlKey,shiftKey:c.shiftKey,altKey:c.altKey,metaKey:c.metaKey,button:c.button,buttons:c.buttons});a.each(function(a,b,c){this.dispatchEvent(d)})}function h(e){0===o&&c(d3.event)&&(p=d3.mouse(e),o++,r.push(d3.event),b()),1==o&&(q=d3.mouse(e),dv.collisions.magSq(dv.collisions.vectorTo(p,q))>256&&c(d3.event)&&(o++,d(i,"mousedown",r[0])),c(d3.event)||(dv.collisions.magSq(dv.collisions.vectorTo(p,q))<2&&j.selectionSet(d3.selectAll([])),o=0,r.length=0,a()))}var i=d3.selectAll(e),k=d3.selectAll(g),l=d3.selectAll(f),m=i.node()["__onmousedown.brush"],n=l.empty()?null:l[0][0]["__onmousedown.zoom"],o=0,p=[0,0],q=[0,0],r=[];i.on("mousedown.brush",function(a){2==o&&m.call(i.node(),d3.event)}),l.on("mousedown.zoom",function(a){c(d3.event)||n.call(l.node(),d3.event)}),d3.selectAll("body").on("mousemove.interceptor",function(){h(this)}).on("mousedown.interceptor",function(){h(this)}).on("mouseup.interceptor",function(){h(this)}).on("keydown.interceptor",function(){}).on("keyup.interceptor",function(){}),a()},d}}(this),function(a){"use strict";var b=a.cloudViz||{},c=b.core||{},d=a.dv||{},e=a.d3||{},f=Object.create(c);f.X_AXIS_LABEL_MAXLENGTH=25,f.LEGEND_ORIENTATIONS=["top","right","left"],f._chart=null,f.clipIdCounter={count:0},f._legend=null,f._seriesState=null,f.init=function(a){return Object.getPrototypeOf(f).init.apply(this,arguments),this._seriesState=b.seriesState(),this},f._initDefaultOptions=function(a){var b={aspectRatio:null,colors:[],theme:"default",dateGranularity:void 0,flip:!1,interactive:!1,legendOrientation:null,legendVerticalWidth:110,legendVisible:!0,targetValues:null,targetNames:null,targetLabel:void 0,mappings:{x:"x",y:"y",series:"series",seriesLabel:"series"},plotHeight:null,plotWidth:null,preRender:null,xAxisTitle:"",yAxisTitle:"",precision:null};return a&&this._mergeOptions(b,a),Object.getPrototypeOf(f)._initDefaultOptions.call(this,b)},f.getChart=function(){return this._chart},f.enableSeriesByIndex=function(a,b){this._seriesState.enableStateByIndex(a,b)},f._highlight=function(a,b){a.classed("cv-highlight",b)},f._getYTitleFromLabels=function(a){var b=d.util.uniq(a);return b&&1===b.length?b[0]:null},f._preRender=function(){Object.getPrototypeOf(f)._preRender.call(this);try{this._createSeriesStates()}catch(b){var a=new Error("The chart data is invalid");a.code="invaliddata",this.handleError(a)}},f._postRender=function(){Object.getPrototypeOf(f)._postRender.call(this);var a=this._options,b=e.select(a.parent);this._updateYAxisHitBox(b),this._colorDualYAxes(a,b),this._highlightedOverlay.setUpSelectedOverlay(b.selectAll(".behavior"));var c=b.selectAll(".interaction-canvas"),d=this.selectionCache();d&&(d.setDeselector(c),d.selectionKeymap(this.determineKeyModifiers))},f._removeYAxisHitBox=function(a){a.selectAll(".axis-y .cv-axis-hitbox").remove()},f._colorDualYAxes=function(a,b){!a.dualYAxis||this._isNormalized&&this._isNormalized()||"identity"!==this._options.position&&"dodge"!==this._options.position||(b.selectAll(".axis-y.axis-index-0 span").style("color",a.colors[0]),b.selectAll(".axis-y.axis-index-1 span").style("color",a.colors[1]),b.selectAll(".axis-title-y.axis-title-index-0").style("color",a.colors[0]),b.selectAll(".axis-title-y.axis-title-index-1").style("color",a.colors[1]))},f._createSeriesStates=function(){var a=this._options;if("data"in this._changedOptions&&this._changedOptions.data){this._seriesState.removeStatesByType("standard");var b=this._dataAdapter.data()[this._getPropMapping("series")],c=this._dataAdapter.data()[this._getPropMapping("seriesLabel")];if(b)for(var d=b.reduce(function(a,b,d){return a.ids.indexOf(b)<0&&(a.ids.push(b),a.names.push(c?c[d]:b)),a},{names:[],ids:[]}),e=d.ids.length;e--;){var f=d.names[e],g=d.ids[e];this._seriesState.insertState(f||g,g,"standard")}}"targetValues"in this._changedOptions&&a.targetValues&&(this._seriesState.removeStatesByType("target"),this._seriesState.appendState(a.targetLabel||this._dataAdapter.l10n.labels.dvcore.target,"target","target"))},f._createTargetHLines=function(){var a=this._options,b=this._chart,c=this,f={y:[],name:[]};if(a.targetValues&&a.targetValues.length){var g,h=b.layers(),i=d.geom.hline(),j=c._seriesState.isSeriesEnabled("target","target"),k=a.targetValues.length,l=[0,this._isSmallChart()?24:6],m=a.scales&&"log"===a.scales.y?d.scale.log():d.scale.linear();for(g=0;g<k;g++)f.y.push(a.targetValues[g]),f.name.push(a.targetNames&&a.targetNames[g]?a.targetNames[g]:"");i.data(f).position("identity").map("y","y",m.includeInDomain(function(){return!c._valuesAreFilterable()||j}).rangePadding(l)).each("start",function(a,b){e.select(this).attr("legend-type","target")}),"line"===this._type?h.unshift(i):h.push(i),b.layers(h)}return f},f._domainNaturallyIncludesZero=function(a){if(!a)return!1;var b=this._options,c=a.property(),d=a.naturalDomain(),e=d[0];return b.scales&&"log"===b.scales[c]?e<=1:e<=0},f._updateYAxisHitBox=function(a){var b=this,c=this._options,d=this._chart.facet().getPanel(0);if(d){var e=this._isSmallChart(),f=this._isNormalized&&this._isNormalized(),g=this._chart.getTrainedScale("y"),h=this._domainNaturallyIncludesZero(g),i=d.bounds().left,j=g.range()[1],k=g.range()[0],l=a.selectAll(".axes-labels .axis-y.axis-index-0"),m=l.selectAll(".cv-axis-hitbox").data([0]);!c.interactive||e||f||h||"identity"!==c.position?this._removeYAxisHitBox(a):(m.enter().append("div").classed("cv-axis-hitbox",!0),m.on("click",function(){c.interactive&&!e&&(c.onYAxisClick?c.onYAxisClick():(b._dataAdapter._forceZero=!b._dataAdapter._forceZero,b._render(!0),b._postRender()))}),"none"!==this._legend&&this._legend.isVertical()&&(i-="left"===this._legend.orientation()?this._legend._getUsedWidth():0),m.style("width",i+"px").style("height",k-j+"px").style("top",j+"px").style("left",-i+"px"),m.exit().on("click",null))}else this._removeYAxisHitBox(a)},f._render=function(a){Object.getPrototypeOf(f)._render.apply(this,arguments);var b,c=this._options;try{if(!this._dataAdapter.isDataValid())throw b=new Error("The chart data is invalid"),b.code="invaliddata",b;if(!c.parent)throw new Error("The chart options did not contain a parent");return this._draw(a)}catch(d){this.handleError(d)}},f.reset=function(){Object.getPrototypeOf(f).reset.apply(this,arguments)},f.destroy=function(){return Object.getPrototypeOf(f).destroy.apply(this,arguments),this._options&&this._options.parent&&e.select(this._options.parent).select(".cv-wrapper").remove(),this},f._isMappedAndExistsInData=function(a){var b=this._getPropMapping(a);return b&&this._options.data[b]},f._setChartCoreOptions=function(){var a=this._options,b=this._chart,c=this,d=a.aspectRatio,f=a.width,g=a.height,h=e.select(a.parent);b.data(this._dataAdapter.data()).width(null!==d&&null!==g?g*d:f).height(null!==d&&null!==f?f/d:g);var i=h.selectAll(".cv-wrapper").data([0]);if(i.enter().insert("div",":first-child").classed("cv-wrapper",!0),i.attr("data-chart-type",this._type),i.classed({interactive:a.interactive,"right-overflow":this._adjustClipWidth,"cv-small-chart":this._isSmallChart()}),b.parent(i.node()),this._legend=this._buildLegend(),this._seriesState.on("enableChange.paths",function(a,b){c._preRender(),c._render(!0),c._postRender(),setTimeout(function(){c._updatePathStates()},10)}),this._isSmallChart())b.padding({});else{var j={left:10};a.dualYAxis&&(j.right=10),b.padding(j)}},f._isVisible=function(a){var b=e.select(a).node();return!!(b.offsetWidth||b.offsetHeight||b.getClientRects().length)},f._draw=function(a){var b=this._chart,c=this._options,d=void 0!==a&&a;if(!this._isVisible(c.parent))return this;if(!b)throw new Error("DV Chart was not created");return this._setChartCoreOptions(),this._setChartTypeOptions(),this._createTargetHLines(),this._isSmallChart()?this._drawSmall():this._drawLarge(),d?b.duration(1e3):b.duration(0),this._renderChart(),this},f._drawBackground=function(){var a=this._options;if(a.interactive){var b=e.select(a.parent).select(".cv-wrapper"),c=b.selectAll(".cv-bg").data([0]),d="none"===this._legend?null:this._legend.orientation();c.enter().insert("div",":first-child").classed("cv-bg",!0);var f=this._chart,g=e.select(a.parent).select(".cv-legend"),h="none"!==this._legend&&this._legend.isVertical()||g.empty()?0:1,i=f.padding(),j=f.facet().getPanel(f.facet()._panels.length-1).bounds(),k=f.plotBounds(),l=this._chart._legends&&this._chart._legends.hasOwnProperty("_w")?this._chart._legends._w:0,m="none"!==this._legend&&("left"===d||!d&&this._legend.isVertical())?l:0,n=k.top-h-i.top,o=f._calcWidth-m-("right"===d?l:0),p=j.top+j.height-k.top+h+i.top;if(c.style("top",n+"px").style("left",m+"px").style("height",p+1+"px").style("width",o+"px"),"none"!==this._legend&&this._legend.isVertical()){var q=1,r=e.select(a.parent).selectAll(".cv-legend"),s=!g.empty()&&r.node().scrollHeight||0,t=s>=p-q;r.style("height",t?p-q+"px":null).classed("clipped",t)}}},f._drawClipping=function(){var a=this._chart,b=this._options,c=a._svgContainer,d=c.selectAll("defs").data([0]);d.enter().insert("defs",":first-child");var e="cv-clip"+this.clipIdCounter.count++,f=d.selectAll(".cv-clip").data([0]);f.enter().append("clipPath").classed("cv-clip",!0).append("rect"),f.attr("id",e);var g=f.selectAll("rect"),h=a.padding(),i=a.facet().getPanel(a.facet()._panels.length-1).bounds(),j=a.plotBounds(),k=j.left-h.left,l=j.top,m=j.right-k+h.right,n=i.top+i.height-j.top+1;b.interactive&&(m-=1,n-=1),this._adjustClipHeight&&(n+=this._adjustClipHeight),this._adjustClipWidth&&(m+=this._adjustClipWidth),g.attr("x",k).attr("y",l).attr("width",Math.max(m,0)).attr("height",Math.max(n,0)),c.selectAll(".geom").attr("clip-path",null),c.selectAll(".geom:not(.no-clip)").attr("clip-path","url(#"+e+")")},f._renderChart=function(){var a=this,b=this._options;"function"==typeof b.preRender&&b.preRender(this.getChart()),this._chart.render(),this._drawBackground(),this._drawClipping(),setTimeout(function(){a._updatePathStates()},10)},f._onAutoResize=function(){this._draw(!1)},f._setChartTypeOptions=function(){},f._drawSmall=function(a){},f._drawLarge=function(a){},f._isSmallChart=function(){return Object.getPrototypeOf(f)._isSmallChart.apply(this,[this._getChartWidth()])},f._constructScale=function(a,b){var c=this._options,e=b;if(!e){var f=c.scales&&c.scales[a];f&&"default"!==f||(f="linear"),e=d.scale[f]()}return c.interactive&&(e=this._adjustLimits(e)),"y"===a&&this._dataAdapter._forceZero&&this._applyForceZero(e),e},f._applyForceZero=function(a){var b=this._options,c=b.scales&&"log"===b.scales.y,d=c?1:0,e=c?-1:1;return a.lowerLimit(function(a,b){return a<d?a:d}),a.upperLimit(function(a,b){return b>e?b:e}),a},f._adjustLimits=function(a){var b=this;this._options;return a.includeInDomain(function(a,c){return!b._valuesAreFilterable()||b._seriesState.isSeriesEnabled(a.data[b._legend.mapping()],"standard")}),a},f._valuesAreFilterable=function(){return this._options.interactive&&this._seriesState.areSomeSeriesDisabled()&&!this._seriesState.areAllSeriesDisabled()},f._getEnabledValues=function(a){var b=this,c=(this._options,this._dataAdapter.data()[this._getPropMapping(a)]);if(!this._valuesAreFilterable())return c;var d=this._dataAdapter.data()[this._legend.mapping()];return c=c.filter(function(a,c){return d[c]&&b._seriesState.isSeriesEnabled(d[c],"standard")})},f._updatePathStates=function(a){var b=this,c=this._options,f=e.select(c.parent);f.selectAll(".plot .series [legend-group]").classed("path-inactive",function(){if(!c.interactive)return!1;var f=e.select(this),g=f.datum(),h=d.util.isArray(g)?g[0].data:g.data,i=h[b._getPropMapping(a||"series")];return b._seriesState.doesSeriesStateExist(i,"standard")?!b._seriesState.isSeriesEnabled(i,"standard"):f.classed("path-inactive")}),c.targetValues&&f.selectAll(".plot .series [legend-type]").classed("path-inactive",function(){if(!c.interactive)return!1;var a=e.select(this),d=a.attr("legend-type");return b._seriesState.doesSeriesStateExist("target",d)?!b._seriesState.isSeriesEnabled("target",d):a.classed("path-inactive")})},f._buildLegend=function(a,b){var c=null,d=this._options,f=e.select(d.parent).select(".cv-wrapper"),g=this._getPropMapping(a||"series"),h=this._getPropMapping(b||"seriesLabel");if(g&&h&&g!==h){var i=this._dataAdapter.data(),j=i[g],k=i[h]||j;c=[],j.forEach(function(a,b,d){d.indexOf(a)===b&&c.push(k[b])})}return d.legendVisible?d.interactive?this._buildInteractiveLegend(c):this._buildStandardLegend(c):(f.selectAll(".cv-legend").remove(),f.selectAll(".cv-bg").remove(),"none")},f._buildStandardLegend=function(a){var b=this._options,c=e.select(b.parent).select(".cv-wrapper");this._legend=null,c.selectAll(".cv-legend").remove(),c.selectAll(".cv-bg").remove();var f,g=this.LEGEND_ORIENTATIONS.indexOf(b.legendOrientation)>-1?b.legendOrientation:"top";switch(this._calculatedLegendOrientation){case"top":case"bottom":f={top:5,bottom:5,left:0,right:0};break;case"left":case"right":f={top:0,bottom:0,left:5,right:5}}var h=d.guide.legend().orientation(g).padding(f);return a&&h.labels(a),this._isSmallChart()&&h.hGap(10).vGap(2),h},f._buildInteractiveLegend=function(a){var c=this._options,d=e.select(c.parent).select(".cv-wrapper");return this._legend&&"none"!==this._legend||(this._legend=b.interactiveLegend()),this._dataAdapter.data()[this._getPropMapping("series")].some(function(a,b,c){return a!==c[b-1]})?(this._legend.parent(d.node()).orientation(c.legendOrientation).chartWidth(this._getChartWidth()).chartHeight(this._getChartHeight()).chartPadding(this._chart.padding()).validOrientations(this.LEGEND_ORIENTATIONS).legendVerticalWidth(c.legendVerticalWidth).type(this._type).seriesState(this._seriesState),a&&this._getCategoryTotal&&this._legend.totals(a.map(function(a){return this._getCategoryTotal(a)})),this._legend):(this._legend.remove(),d.selectAll(".path-inactive").classed("path-inactive",!1),"none")},f._numXTicks=function(){return function(a){return Math.max(a/120,2)}},f._yTitleFormat=function(a,b){var c,e,f=this._dataAdapter,g=f.yAxisTitle(),h=f.l10n,i=this._getYFormatType(a);return"time"===i&&(b||(b=this._getEnabledValues("y")),c=this._yTimeGranularity(b,d.guide.axis().ticks()()),c=h.time.plural[c.gran],e=g?h.labels.dvcore.yAxisTimeWithTitle:h.labels.dvcore.yAxisTimeNoTitle,g=e.replace(/\{time\}/i,c).replace(/\{title\}/i,g)),g},f._formatYValue=function(a,b,c,d,e){return c&&c.divisor>0&&(a/=c.divisor),e=e||{},e.prop=e.prop||"y",this._formatNumber(b,a,d,e)},f._getYFormatType=function(a){var b=this._dataAdapter.formats().y;return b?d.util.isArray(b)?b[a]?b[a]:"decimal":b:"decimal"},f._tickSize=function(a){var b,c=this._options,d=c.dualYAxis&&"y"===a;return function(e){return b=c.scales&&"log"===c.scales[a]&&Math.round(Math.log(Math.abs(e))/Math.LN10*1e6)/1e6%1?10:null,b?b:d?15:null}},f._yLabelFormat=function(a){var b=this._getYFormatType(a),c=this._dataAdapter,d=this._options,e=this;return function(f,g,h){var i,j,k=c.l10n.time;return"time"===b&&(j=c.getTimeGranularity(f,!0),k=1!=+f?k.plural:k.singular),h=h||{},h.seriesIndex=h.seriesIndex||a,h.dataItem=h.dataItem||f,i=e._formatYValue(f,b,j,d.precision,h),j&&j.gran&&(i+=" "+k[j.gran]),i}},f._yTickFormat=function(a,b,c){var f,g,h,i,j=this,k=this._getYFormatType(a),l=this._options,m=l.scales&&"log"===l.scales.y,n=m?1:0;return"time"===k&&(b||(b=this._getEnabledValues("y")),i=j._yTimeGranularity(b,d.guide.axis().ticks()())),function(b,d,o,p){var q,r=e.select(this),s=o.yOuterScale().innerScaleGroup()[a],t=!1,u=l.precision?l.precision:p;if(0===d&&(g=!1),s||(s=o.getTrainedScale("y")),h=s.domain()[0],q=s.range()[0]-s.mapValue(b),m&&!f){var v=e.scale.log().domain(s.domain());f=v.ticks().map(v.tickFormat(5,function(c){return j._formatYValue(c,k,i,u,{seriesIndex:a,isTickLabel:!0,dataItem:b})}))}return q<10&&!l.flip&&(t=!0),m&&""===f[d]&&(t=!0),h>n&&!t&&!g&&l.interactive?(r.classed("arrow-container",!0),g=!0):r.classed("arrow-container",!1),t&&!c?"":m?f[d]:j._formatYValue(b,k,i,u,{seriesIndex:a,isTickLabel:!0,dataItem:b})}},f._yTimeGranularity=function(a,b){if(a=a&&a.filter(function(a){return isFinite(a)})||[],b=b||1,!a.length)return null;var c=Math.max.apply(null,a),d=Math.min.apply(null,a),f=e.scale.linear().domain([d,c]).ticks(b),g=f.length?f.length>1?f[1]-f[0]:c-f[0]:c,h=f.length?g/f.length:g;return this._dataAdapter.getTimeGranularity(h)},f._xTickAnchor=function(a){return function(b,c,e){var f=a.getTrainedScale("x"),g=d.util.scaleRange(f),h=20,i=f.mapValue(b)+f.rangeBand()/2;return i-g[0]<h?"start":g[1]-i<h?"end":"middle"}},f._checkNormalized=function(){var a=this._chart,b=this._dataAdapter.l10n;this._isNormalized&&this._isNormalized()&&(a.guide("y","none",1),a.guide("y",d.guide.axis().ticks(0).tickFormat(function(a,b){return""}).title(b.labels.core.normalized)),a.padding({}))},f._formatTime=function(a,b,c){for(var d=this._dataAdapter.l10n.calendar,f={a:function(a){return d.weekdayAbbreviations[a.getDay()]},A:function(a){return d.weekdays[a.getDay()]},b:function(a){return d.monthAbbreviations[a.getMonth()]},B:function(a){return d.months[a.getMonth()]},p:function(a){return d.ampm[Math.floor(a.getHours()/12)]}},g="",h=-1,i=0,j=b.length,k=function(){var c=b.substring(i,h);c.length&&(g+=e.time.format(c)(a))};++h<j;)if(37==b.charCodeAt(h)){var l=b.charAt(h+1),m=f[l];m&&(k(),g+=m(a),h++,i=h+1)}k();var n=this._options.locale.toLowerCase();return"hour"!==c&&"minute"!==c&&"second"!==c||"en-us"!==n||0!==g.indexOf("0")||(g=g.slice(1)),g},f._timeGranTemplate=function(a,b){var c;switch(a){case"second":c=b.second;break;case"minute":c=b.minute;break;case"hour":c=b.hour;break;case"day":c=b.day;break;case"week":c=b.week;break;case"month":c=b.month;break;case"quarter":c=b.quarter;break;case"year":c=b.year;break;default:c=b.fallback}return c},f._timeSmallXFormat=function(){var a=this,b=a._dataAdapter,c=b.l10n.dateFormat.fullFormat,d=b?b.dateGranularity():"*",e=c.condensed;return"hour"!==d&&"minute"!==d&&"second"!==d||(e=c.timestamp),function(b,c){return a._formatTime(b,e)}},f._timeXTickFormat=function(a){var b=this,c=b._options,d=(this._chart,b._dataAdapter),e=new Date(0),f="",g="",h=d.l10n.dateFormat,i=h.mediumFormat,j=d?d.dateGranularity():"*",k=this._timeGranTemplate(j,h.shortFormat);return function(d,l){var m,n,o,p;if(d=new Date(d),0===l&&(e=new Date(0),f=null,g=null),a&&!a.call(this,d,l))return"";if("second"!==j||0!==l&&e.getMinutes()===d.getMinutes()||(m=i.minute),"hour"!==j||0!==l&&e.getDate()===d.getDate()||(m=i.day),"day"!==j&&"week"!==j||0!==l&&e.getMonth()===d.getMonth()||(m=i.month),"month"!==j&&"quarter"!==j||0!==l&&e.getYear()===d.getYear()||(m=i.year),n=b._formatTime(d,k,j),"minute"===j&&e.getHours()!==d.getHours()&&(n=b._formatTime(d,b._timeGranTemplate("minute",h.mediumFormat),j)),e=d,m){o=b._formatTime(d,m);o=(c.flip?" ":"<br/>").concat(o)}else c.flip||(o="<br/>&nbsp;");return p=n!==f||o!==g&&m?o?n+o:n:"",f=n,g=o,p}},a.cloudViz.dvcore=f}(this),function(a){"use strict";var b,c=[],d=function(a,b){var c=-1;return function(){c>-1&&window.clearTimeout(c),c=window.setTimeout(a,b)}},e=d(function(){c.forEach(function(a){a()})},30),f=function(a){c.indexOf(a)==-1&&c.push(a),b||(window.addEventListener("resize",e),b=!0)},g=function(a){var d=c.indexOf(a);d>-1&&c.splice(d,1),0===c.length&&b&&(window.removeEventListener("resize",e),b=!1)};a.cloudViz.windowResize={addHandler:f,removeHandler:g}}(this),function(a){"use strict";var b=a.cloudViz||{},c=b.dvcore||{},d=a.dv||{},e=a.d3||{},f=Object.create(c);f.init=function(a){return Object.getPrototypeOf(f).init.apply(this,arguments),this._type="line",this._chart=d.chart(),this._displayPoints=null,this._adjustClipHeight=6,this._adjustClipWidth=6,this._minTrendTickSpace=135,this._showRibbons=!1,this._uniqueGroups=null,this},f._initDefaultOptions=function(){var a={normalized:!1,filled:!1,position:"identity",forceZero:null,dualYAxis:!1,showAnomalies:!1,lines:null,pointTooltipContent:null,pointShouldShowTooltip:null,mappings:{upperRangeBand:"upper",lowerRangeBand:"lower",forecast:"forecast"},formats:{x:"decimal",y:"decimal"},scales:{x:"default",y:"default"},enableSelection:!1,onYAxisClick:null};return Object.getPrototypeOf(f)._initDefaultOptions.call(this,a)},f.reset=function(){Object.getPrototypeOf(f).reset.apply(this,arguments);var a=this._options,b=e.select(a.parent);b.selectAll(".behavior").text(""),b.selectAll(".behavior-under-geom").text(""),this._chart.on("mousemove.inspector",null),this._chart.on("mouseout.inspector",null),b.selectAll(".axis-y.axis-index-1").remove()},f._addStatLines=function(){var a,b=this._chart,c=this._options,e=b._data,f=e[this._getPropMapping("y")].slice(),g={xstart:[],xend:[],y:[],name:[]},h=c.lines,i=this._dataAdapter.l10n.labels.bar,j=0,k=0,l=0,m=f.length;if(h&&0!==h.length){if("chart"==h.max&&(g.y.push(Math.max.apply(null,f)),g.name.push(i.max)),"chart"==h.min&&(g.y.push(Math.min.apply(null,f)),g.name.push(i.min)),"chart"==h.mean){for(a=0;a<m;a++)l+=f[a];j=l/m,g.y.push(j),g.name.push(i.mean)}"chart"==h.median&&(f.sort(),m%2==0?(k=(f[m/2]+f[m/2-1])/2,g.y.push(k)):g.y.push(f[Math.floor(m/2)]),g.name.push(i.median));var n=d.geom.hline().data(g).set("alpha",.3).set("stroke",function(a,b){return"#222222"});this._addGeomBehaviors(n,c),this.labelData?(this.labelData.y.push.apply(this.labelData.y,g.y),this.labelData.name.push.apply(this.labelData.name,g.name)):(this.labelData=Object.create(g),this.labelData.y=g.y.slice(),this.labelData.name=g.name.slice()),b.layers().push(n)}},f._createTargetHLines=function(){var a=this._options;if(a.targetValues&&a.targetValues.length){var b=Object.getPrototypeOf(f)._createTargetHLines.apply(this,arguments),c=this._chart;this._addGeomBehaviors(c._layers[0],a),this.labelData?(this.labelData.y.push.apply(this.labelData.y,b.y),this.labelData.name.push.apply(this.labelData.name,b.name)):(this.labelData=Object.create(b),this.labelData.y=b.y.slice(),this.labelData.name=b.name.slice())}},f._setChartTypeOptions=function(){var a=this._chart,b=this._options,g=this._dataAdapter,h=this,i=[d.geom.line().each("start",function(a,b){e.select(this).attr("legend-group",a[0].stroke)}).map("stroke",this._getPropMapping("series"),d.scale.color().values(b.colors))];this._uniqueGroups=d.util.uniq(a.data()[this._getPropMapping("series")]),this._showRibbons=1==this._uniqueGroups.length&&this._isMappedAndExistsInData("upperRangeBand")&&this._isMappedAndExistsInData("lowerRangeBand"),this._showRibbons&&(i.unshift(d.geom.ribbon().map("yMin",this._getPropMapping("lowerRangeBand")).map("yMax",this._getPropMapping("upperRangeBand")).set("alpha",.15).interpolate("cardinal")),b.filled=!1),this._showRibbons&&this._isMappedAndExistsInData("forecast")&&i.push(d.geom.line().map("y",this._getPropMapping("forecast")).set("alpha",.5).set("linetype","dotted").interpolate("cardinal")),b.filled&&i.push(d.geom.area().baseline(void 0).each("start",function(a,b){e.select(this).attr("legend-group",a[0].fill)}).map("fill",this._getPropMapping("series"),d.scale.color().values(b.colors)).set("alpha",.2));var j=d.geom.point().map("stroke",this._getPropMapping("series"),d.scale.color().values(b.colors)).set("fill","#fff").set("size",7);i.push(j);var k=this._getPropMapping("group")||this._getPropMapping("series");a.layers(i).guide("stroke",this._legend).map("group",k).set("linetype",function(a,b,c){return/::incomplete::$/.test(a.data[k])?"0,4,7,0":"solid"}).position(b.position),j.each("start",function(a,b){e.select(this).classed("point-hidden",!h._shouldDisplayPoint.call(h,a)).attr("legend-group",a.stroke).classed("line-point",!0).on("contextmenu",c.makeContextMenuHandler(h))}),this._addBehaviors(a,i.length-1,b);var l=this._getEnabledSeriesIndexes();j.behaviors([d.behavior.voronoiRollover().orientation("top").pointDetectionRadius(7).shouldShowTooltip(function(a,c,d){return b.pointShouldShowTooltip?b.pointShouldShowTooltip.call(this,a,c,d):l.indexOf(d)>-1}).content(function(a,c,d){if(b.pointTooltipContent)return b.pointTooltipContent.call(this,a,c,d);var e=this.__geom.getExplicitScale("group"),i=h._yLabelFormat(d),j='<span class="metric-value">'+f.escapeHtml(i(a.y,null,{dataItem:a}))+'</span><span class="metric-name">'+f.escapeHtml(a.data[h._getPropMapping("seriesLabel")])+"</span>",k=g.dateGranularity(),l=g.l10n.dateFormat.fullFormat,m=g.isOvertime()?h._formatTime(new Date(a.x),h._timeGranTemplate(k,l),k):a.x;return e&&e.mapping()&&(j='<span class="series-name">'+f.escapeHtml(m)+"</span>"+j),j})]),this._mapPositionScales(a,b)},f._getEnabledSeriesIndexes=function(){var a=this._seriesState.getStateObjects()||[],b=[];return a.forEach(function(a,c){a.enabled===!0&&b.push(c)}),b},f._shouldDisplayPoint=function(a){return this._showRibbons?this._isAnomalousDataPoint(a):this._shouldDisplayPoints()},f._shouldDisplayPoints=function(){if(null!==this._displayPoints)return this._displayPoints;var a=this._options,b=this._chart,c=b.layers()[1]._nestData,d=Math.max.apply(null,c.map(function(a){return a.values.length})),e=b.getTrainedScale("x").range();return this._displayPoints=a.showAnomalies&&this._showRibbons||(e[1]-e[0])/d>=60},f._isAnomalousDataPoint=function(a){return a.data[this._getPropMapping("y")]>a.data[this._getPropMapping("upperRangeBand")]||a.data[this._getPropMapping("y")]<a.data[this._getPropMapping("lowerRangeBand")]},f._hLineToolTip=function(a,b,c){
return'<span class="metric-value">'+f.escapeHtml(a[0].data.name)+'</span><span class="metric-name">'+f.escapeHtml(a[0].data.y)+"</span>"},f._addGeomBehaviors=function(a,b){var c,f=e.select(b.parent),g=(this._dataAdapter,this);!this._isSmallChart()&&b.interactive&&a.behaviors([d.behavior.rollover().orientation("top").content(function(a,b,c){return"data"in a?"":g._hLineToolTip(a,b,c)}).showTooltip(function(a,b,d,h,i){e.select(this).classed("path-inactive")||(i._showTip.call(this,a,b,d,i),clearTimeout(c),f.selectAll(".bar-geom").classed("cv-medium-duration",!1).classed("cv-unselected",function(b){return a!==b}),f.selectAll(".cv-legend-marker").classed("cv-unselected",function(b){return b.id!==a.fill}).classed("cv-medium-duration",!1),g._dispatch.mouseover.call(this,a,b,d,h))}).hideTooltip(function(a,b,d,h,i){e.select(this).classed("path-inactive")||(i._removeTip.call(this,a,b,d,i),c=setTimeout(function(){f.selectAll(".bar-geom, .cv-legend-marker").classed("cv-unselected",!1).classed("cv-medium-duration",!0),g._dispatch.mouseout.call(this,a,b,d,h)},400))})])},f._addBehaviors=function(a,b,c){var f=this,g=e.select(c.parent),h=this._dataAdapter,i=h.formats().x;if(c.interactive){var j=[d.behavior.identified()];if(this._options.enableSelection){var k=d.behavior.selection().on("selectionChanged",function(a,c,d){f._highlightedOverlay.updateSelectedDisplay(a).style("visibility","visible"),f._onSelectionChanged(this,a,c,d,b)});this.selectionCache(k._selectionCache),j.push(k)}a._layers[b].behaviors(j),a.behaviors([d.behavior.inspector().gutterPadding(0).orientation("bottom").thickness(2).label(function(a){if(h.isOvertime()){var b=h.dateGranularity(),d=h.l10n.dateFormat.fullFormat;return f._formatTime(a,f._timeGranTemplate(b,d),b)}return f._formatNumber(i,a,c.precision,{prop:"x",dataItem:a})}).inspectorMove(function(b,c,h,i){var j=a.getTrainedScale("stroke")[0];f._highlightHoveredPoints.call(f,g,i,j),d.setVisibilityWaning(g.selectAll(".axis-x .axis-label")),d.setVisibilityWaning(g.selectAll(".axis-x-title")),d.setVisibilityWaning(g.selectAll(".text-geom")),f._dispatch.mouseover.call(this,b,c,h,i,e.event)}).inspectorOut(function(){var b=a.getTrainedScale("stroke")[0];f._highlightHoveredPoints.call(f,g,null,b),d.setVisibilityForeground(g.selectAll(".axis-x .axis-label")),d.setVisibilityForeground(g.selectAll(".axis-x-title")),d.setVisibilityForeground(g.selectAll(".text-geom")),f._dispatch.mouseout.call(this,e.event)}).underGeoms(!0)])}},f._highlightHoveredPoints=function(a,b,c){var f={},g=this,h=c.domain(),i=this._options;a.selectAll(".line-point").each(function(a){var d=e.select(this),i=c.mapValue(a.stroke),j=g._dataValuesEqual.call(g,a.x,b),k=d.datum();if(d.classed("point-hidden",!j&&!g._shouldDisplayPoint.call(g,a)),d.style("fill",j?i:"#FFF").style("opacity",j?1:""),j){var l=d.datum().data[g._getPropMapping("series")];f[l]={yVal:k.y,scaleIndex:h.indexOf(a.stroke)}}}),a.selectAll(".cv-legend-entry").each(function(a){var b=a.id,c=f[b],h=e.select(this).select(".cv-legend-num");if(!c)return h.text("");var j,k=g._getYFormatType(c.scaleIndex),l=c.yVal;if("time"===k){var m=g._dataAdapter.l10n,n=g._yTimeGranularity(g._dataAdapter.getUniqueStrokeExtentByStroke(b),d.guide.axis().ticks()()),o=m.time.plural[n.gran],p=m.labels.dvcore.legendTime;n&&n.divisor>0&&(l/=n.divisor),j=p.replace(/\{time\}/i,o).replace(/\{value\}/i,g._formatNumber(k,l,i.precision,{prop:"y",seriesIndex:c.scaleIndex,isLegend:!0,dataItem:a}))}else j=g._formatNumber(k,l,i.precision,{prop:"y",seriesIndex:c.scaleIndex,isLegend:!0,dataItem:a});h.text(j)})},f._dataValuesEqual=function(a,b){return!(!a||!b)&&(!(!this._dataAdapter.isOvertime()||a.getTime()!==b.getTime())||a===b)},f._mapPositionScales=function(a,b){var c=[0,this._isSmallChart()?24:6],e=this._constructScale("y").rangePadding(c),f=this._getPropMapping("series"),g=this._getPropMapping("y"),h=this._getPropMapping("x"),i=this;if(null===i._dataAdapter._forceZero&&b.filled&&(i._dataAdapter._forceZero=!0,this._applyForceZero(e)),b.normalized||b.dualYAxis&&("identity"===b.position||"dodge"===b.position)){i._dataAdapter.uniqueStrokeValues().forEach(function(b,c){var d=0===c?e:e.copy();d.includeInDomain(function(a,b){return a.data[f]===i._dataAdapter.uniqueStrokeValues()[c]}),c>0&&a.map("y",g,d,c)})}else for(var j=a.getExplicitScalesMap().y,k=1;j&&j[k];)delete j[k],k++;var l=this._dataAdapter.isOvertime()?d.scale.time():"log"===b.scales.x?d.scale.log():d.scale.linear();l.rangePadding([10,10]),a.map("y",g,e,0),a.map("x",h,this._constructScale("x",l))},f._xTickFormat=function(){var a=this,b=this._dataAdapter,c=this._options,d=b.formats().x;return function(b,e){return a._formatNumber(d,b,c.precision,{prop:"x",dataItem:b})}},f._drawSmall=function(){var a,b,c=this._options,f=this._chart,g=this,h=this._computeExtents(),i=e.extent(this._getEnabledValues("x")),j=this._getYFormatType(0),k=d.guide.axis().tickSize(0).title(this._dataAdapter.xAxisTitle()).tickDy(h.y.length>1?-26:-14).tickAnchor(function(a,b){return b>0?"end":"start"}),l=d.guide.axis().ticks(2).title(this._dataAdapter.yAxisTitle()),m=c.dualYAxis||"stack"===c.position&&this._uniqueGroups.length>1;if(a=this._dataAdapter.isOvertime()?d.scale.time():"log"===c.scales.x?d.scale.log():d.scale.linear(),b="log"===c.scales.y?d.scale.log():d.scale.linear(),!m){var n=[d.geom.point().data(h).set("stroke","none").map("y","y",b).map("x","x",a).each("start",function(a,b){var c=a.panel.getTrainedScale("fill")[0];e.select(this).style("fill",c.mapValue(a.data.fill)).attr("legend-group",a.data.fill)}).map("group","fill").set("size",6),d.geom.text().data(h).set("stroke","none").map("y","y",b).map("x","x",a).each("start",function(a,b){var c=a.panel.getTrainedScale("fill")[0];e.select(this).style("fill",c.mapValue(a.data.fill)).attr("legend-group",a.data.fill),this.parentNode&&e.select(this.parentNode.parentNode).classed("no-clip",!0).attr("clip-path",null)}).map("group","fill").set("size","11px").set("label",function(a,b){var c=a.panel.getTrainedScale("fill")[0].domain(),e=c.indexOf(a.data.fill),f=g._yTickFormat(e,null,!0)(a.y,b,a.panel);if("time"===j){var h=g._yTimeGranularity(g._getEnabledValues("y"),d.guide.axis().ticks()());f+=" "+g._dataAdapter.l10n.time.plural[h.gran]}return f}).textAnchor(function(a,b){return a.data&&a.data.anchor||"middle"}).dy(function(a,b){return 1===h.y.length||a.y===h.y[1]?-8:15}).dx(function(a,b){return a.data&&"end"==a.data.anchor?3:0})];f.layers(f.layers().concat(n))}if(f.map("fill",this._getPropMapping("series"),d.scale.color().values(c.colors)),this._dataAdapter.isOvertime())k.tickValues(i).tickFormat(g._timeSmallXFormat()),m?l.tickFormat(this._yTickFormat(0)):l.tickFormat(function(){return""});else if(c.dualYAxis){var o=d.guide.axis().tickFormat(this._yTickFormat(1)).orientation("right").tickSize(this._tickSize("y")).tickDy(-8).tickAnchor("end").tickDx(4).ticks(3);l.tickSize(this._tickSize("y")).tickDy(-8).tickAnchor("start").tickDx(4).ticks(3),f.guide("y",o,1)}else{var p=e.extent(this._dataAdapter.data()[this._getPropMapping("x")]);k.tickValues(p).tickFormat(this._xTickFormat()),l.tickFormat(this._yTickFormat(0)),f.guide("y","none",1)}f.guide("x",k).guide("y",l),this._checkNormalized()},f._numXTicks=function(){var a=this;if(this._dataAdapter.isOvertime()){var b=this._chart._data[this._getPropMapping("x")].length;return function(c){var d=Math.max(c/b,a._minTrendTickSpace);return Math.max(Math.min(Math.floor(c/d),b),2)}}return Object.getPrototypeOf(f)._numXTicks.call(this)},f._drawLarge=function(){var a,b=this._options,c=this._chart,f=(e.select(b.parent),this._dataAdapter.getUniqueStrokeExtent(0)),g=this._dataAdapter.getUniqueStrokeExtent(1),h=d.guide.axis().ticks(this._numXTicks()).title(this._dataAdapter.xAxisTitle()).tickSize(this._tickSize("x")).tickDy(-8).tickAnchor(this._xTickAnchor(c)),i=d.guide.axis().htmlLabels(!0);if(this._dataAdapter.isOvertime()?h.tickFormat(this._timeXTickFormat()).htmlLabels(!0):h.tickFormat(this._xTickFormat()),!b.dualYAxis||"identity"!==b.position&&"dodge"!==b.position)a=this._yTickFormat(0),i.title(this._yTitleFormat(0)),i.tickSize(this._tickSize("y")),c.guide("y","none",1);else{a=this._yTickFormat(0,f),i.title(this._yTitleFormat(0,f));var j=d.guide.axis().tickFormat(this._yTickFormat(1,g)).title(this._yTitleFormat(1,g)).orientation("right").tickSize(this._tickSize("y"));i.tickSize(this._tickSize("y")),c.guide("y",j,1)}i.tickFormat(a),c.guide("x",h).guide("y",i),this._checkNormalized(),this._addStatLines()},f._preRender=function(){Object.getPrototypeOf(f)._preRender.call(this),this._displayPoints=null},f._computeExtents=function(){var a=-1,b=this._options,c=this._getEnabledValues("y"),d=this._getEnabledValues("x"),e=this._getEnabledValues("series"),f=c.length,g={x:[void 0,void 0],y:[void 0,void 0],fill:[void 0,void 0],anchor:[void 0,void 0]},h=null,i=null;for(d.forEach(function(a,b){h=null===h||h>a?a:h,i=null===i||i<a?a:i});++a<f;){var j=c[a],k=d[a],l=e?e[a]:b.colors[0];(void 0===g.y[0]||j<g.y[0])&&(g.y[0]=j,g.x[0]=k,g.fill[0]=l,g.anchor[0]=+k==+h?"start":+k==+i?"end":"middle"),(void 0===g.y[1]||j>g.y[1])&&(g.y[1]=j,g.x[1]=k,g.fill[1]=l,g.anchor[1]=+k==+h?"start":+k==+i?"end":"middle")}return 0===g.y[0]&&(g.y.splice(0,1),g.x.splice(0,1),g.fill.splice(0,1),g.anchor.splice(0,1)),g},f._isNormalized=function(){var a=this._options,b=this._isSmallChart()?1:2;return a.normalized||a.dualYAxis&&this._dataAdapter.uniqueStrokeValues().length>b&&("identity"===a.position||"dodge"===a.position)},f.lineWithinBounds=function(a,b,c){var d,e=this.labelData,f=e.y.length,g=this._chart,h=g.getTrainedScale("y");for(d=0;d<f;d++){var i=h.mapValue(e.y[d]);if(d!=c&&i>=a&&i<=b)return d}return-1},f._postRender=function(){Object.getPrototypeOf(f)._postRender.apply(this,arguments),this._changedOptions={};var a=e.select(this._chart.parent());a=a.selectAll(".behavior"),this._highlightedOverlay.setUpSelectedOverlay(a);var b=this.selectionCache();if(b&&b.setDeselector(e.select(this._chart.parent()).select("rect.interaction-canvas")),this.labelData){var c,d=this.labelData,g=this._chart,h=(this._options,g.getTrainedScale("x"),g.getTrainedScale("y")),i=e.select(g.parent()).select(".plot"),j=g._facet.getPanel(0).bounds(),k=[],l=d.y.length,m=e.select(g.parent()).select(".axis-index-0"),n=Number(m.style("left").slice(0,-2)),o=[];for(i.append("g").selectAll(".dummyText").data(d.name).enter().append("text").classed("data-label",!0).text(function(a){return a}).each(function(a,b){var c=this.getComputedTextLength();o.push(c)}).remove(),c=0;c<l;c++){var p=h.mapValue(d.y[c]);this.lineWithinBounds(p-15,p,c)==-1&&p>=12?k.push(-2):this.lineWithinBounds(p,p+15,c)==-1||p<12?k.push(11):(k.push(-2),d.name[c]="")}var q=i.selectAll(".data-label").data(d.name);q.enter().append("text").classed("data-label",!0).text(function(a){return a}).attr("x",j.top).attr("y",h.range()[0]),q.transition().duration(0).attr("x",function(a,b){return n+(d.xstart&&d.xstart[b]?d.xstart[b]*j.width:0)}).attr("y",function(a,b){return h.mapValue(d.y[b])+k[b]}),q.exit().transition().duration(0).attr("y",h.range()[0]).remove()}},a.cloudViz.line=b.util.createConstructor(f)}(this),function(a){"use strict";var b=a.cloudViz||{},c=b.dvcore||{},d=a.dv||{},e=a.d3||{},f=Object.create(c);f.init=function(a){return Object.getPrototypeOf(f).init.apply(this,arguments),this._type="point",this._chart=d.chart(),this._inputFilter=b.util.inputFilter(".brush-interaction-group","",".plot"),this},f.getSelected=function(){return this.selectionCache.currentSelection()},f.setSelected=function(a){var b=this,c=[];return e.select(this._options.parent).selectAll(".point-geom").filter(a).each(function(a){c.push(a)}),b.selectionCache().selectionSet(e.selectAll(c)),b},f._initDefaultOptions=function(){var a={mappings:{size:"size"},sizeTitle:"",formats:{x:"decimal",y:"decimal",size:"decimal"},scales:{x:"default",y:"default"},domains:{x:null,y:null},position:"identity",selectionEnabled:!1,selectPolicyCB:function(){return{start:null,end:null,move:null}},tooltipContent:null,customEvents:["selectionStart","selectionEnd"],enableSelection:!1};return Object.getPrototypeOf(f)._initDefaultOptions.call(this,a)},f._setChartTypeOptions=function(){var a=this._chart,b=this._options,c=[],f=this;c[0]=d.geom.point().each("start",function(a,b){e.select(this).attr("legend-group",a.fill)}),a.layers(c).map("x",this._getPropMapping("x"),this._constructScale("x").rangePadding([this._isSmallChart()?10:20,this._isSmallChart()?10:20])).map("y",this._getPropMapping("y"),this._constructScale("y").rangePadding([this._isSmallChart()?10:20,this._isSmallChart()?10:20])).map("fill",this._getPropMapping("series"),d.scale.color().values(b.colors)).guide("fill",this._legend).padding({left:10}),this._dataAdapter.isBubble()?c[0].map("size",this._getPropMapping("size"),d.scale.linear().to([9,60])):c[0].set("size",10).set("alpha",.6),b.selectionEnabled&&a.postrender(function(a){f._inputFilter.setUpBrush(e.selectAll(".behavior-under-geom"),f.selectionCache(),null),f._inputFilter.setUpBrushOverlay(e.selectAll(".behavior")),f._inputFilter.interceptBrushEvents()}),this._addBehaviors(a,c[0],b)},f._addBehaviors=function(a,b,c){var g,h=e.select(c.parent),i=this,j=this._getYFormatType(),k=this._getSizeFormatType(),l=function(a,b,c,d){return a.data.hasOwnProperty(b.mapping())?'<span class="metric-value">'+f.escapeHtml(c(a.data[b.mapping()]))+'</span><span class="metric-name">'+f.escapeHtml(d)+"</span>":""};if(a.behaviors([]),!this._isSmallChart()&&c.interactive){var m=d.behavior.voronoiRollover().pointDetectionRadius(25).content(function(a,b,d){if(c.tooltipContent)return c.tooltipContent.call(this,a,b,d);var e=this.__geom.getExplicitScale("group"),g=a.panel.xScale(a),h=a.panel.yScale(a),m=this._xGuides[g.scaleIndex()],n=(this._yGuides[h.scaleIndex()],i._dataAdapter.l10n),o=m.__scale&&m.tickFormat()?m.tickFormat():String,p=function(a){return i._formatNumber(j,a,c.precision,{prop:"y",seriesIndex:g.scaleIndex(),dataItem:a})},q=function(a){return i._formatNumber(k,a,c.precision,{prop:"size",dataItem:a})},r=l(a,h,p,i._dataAdapter.yAxisTitle()||n.labels.point.yScale)+l(a,g,o,i._dataAdapter.xAxisTitle()||n.labels.point.xScale);if(i._dataAdapter.isBubble()){var s=a.panel.getTrainedScale("size")[0];r+=l(a,s,q,i._dataAdapter.sizeMetricName()||n.labels.point.sizeScale)}return e&&e.mapping()&&(r='<span class="series-name">'+f.escapeHtml(a.data[i._getPropMapping("seriesLabel")||e.mapping()])+"</span>"+r),r}).mouseOver(function(a,b,c,d){clearTimeout(g),h.selectAll(".point-geom").classed("cv-medium-duration",!1).classed("cv-unselected",function(b){return a!==b}),h.selectAll(".cv-legend-marker").classed("cv-unselected",function(b){return b.id!==a.fill}).classed("cv-medium-duration",!1),i._dispatch.mouseover.call(this,a,b,c,d)}).contextMenu(function(a,b,c,d){i._dispatch.contextmenu.call(this,a,b,c,d)}).mouseOut(function(a,b,c,d){g=setTimeout(function(){h.selectAll(".point-geom, .cv-legend-marker").classed("cv-unselected",!1).classed("cv-medium-duration",!0),i._dispatch.mouseout.call(this,a,b,c,d)},400)}),n=[d.behavior.identified(),m];if(this._options.enableSelection){var o=d.behavior.selection().on("selectionChanged",function(a,b,c){i._highlightedOverlay.updateSelectedDisplay(a),i._onSelectionChanged(this,a,b,c,0)}).elementFinder(function(a,b){var c=a.data;if(!c)return this;var d=m.getGeomFromVoronoiIndex(c.rawData,c.index,c.seriesIndex);return d.empty()?this:d[0][0]});this.selectionCache(o._selectionCache),n.push(o)}b.behaviors(n)}},f._getSizeFormatType=function(){return(this._dataAdapter.formats()||{}).size||"decimal"},f._drawSmall=function(){var a=this._chart,b=e.extent(this._getEnabledValues("x")),c=this,f=this._dataAdapter,g=this._options,h=f.formats().x;this._getYFormatType();a.guide("x",d.guide.axis().tickSize(0).tickValues(b).title(this._dataAdapter.xAxisTitle()).tickFormat(function(a,b,d){return c._formatNumber(h,a,g.precision,{prop:"x",seriesIndex:d?d._trainedScales.x[0].scaleIndex():null,dataItem:a})}).tickAnchor(function(a,b){return b>0?"end":"start"}).domain(g.domains.x)).guide("y",d.guide.axis().ticks(2).title(this._dataAdapter.yAxisTitle()).tickFormat(this._yTickFormat(0)).domain(g.domains.y))},f._drawLarge=function(){var a=this._chart,b=function(a){return Math.max(2,Math.min(5,a/70))},c=this,e=this._dataAdapter,f=this._options,g=e.formats().x;this._getYFormatType();a.guide("x",d.guide.axis().ticks(this._numXTicks()).title(this._dataAdapter.xAxisTitle()).tickFormat(function(a,b,d){return c._formatNumber(g,a,f.precision,{prop:"x",seriesIndex:d?d._trainedScales.x[0].scaleIndex():null,dataItem:a})}).domain(f.domains.x)).guide("y",d.guide.axis().ticks(b).tickSize(this._tickSize("y")).title(this._dataAdapter.yAxisTitle()).tickFormat(this._yTickFormat(0)).domain(f.domains.y))},f._postRender=function(){Object.getPrototypeOf(f)._postRender.call(this);var a=this._options,b=this._chart,c=e.select(a.parent).select(".cv-wrapper"),d=c.selectAll(".cv-bubble-size-metric").data([0]);this._dataAdapter.sizeMetricName()?(d.enter().append("div").classed("cv-bubble-size-metric",!0).html("<span>"+f.escapeHtml(this._dataAdapter.sizeMetricName())+"</span>  <i></i> &ndash; <i></i>"),setTimeout(function(){var a,c,e=b.padding(),f=b.facet().getPanel(b.facet()._panels.length-1).bounds(),g=b.plotBounds(),h=(d.selectAll("span"),g.right+e.right),i=f.top+f.height,j=d.node();j&&(a=h-j.offsetWidth-5,c=i-j.offsetHeight,d.style("top",c+"px").style("left",a+"px"))},300)):d.remove()},a.cloudViz.point=b.util.createConstructor(f)}(this),function(a){"use strict";var b=a.cloudViz||{},c=b.dvcore||{},d=a.dv||{},e=a.d3||{},f=Object.create(c);f.init=function(a){return Object.getPrototypeOf(f).init.apply(this,arguments),this._type="bar",this._chart=d.chart(),this._minTickSpace=60,this},f._initDefaultOptions=function(){var a={normalized:!1,position:"dodge",dualYAxis:!1,xAxisTruncation:"ellipsis",clickHandler:null,formats:{x:"decimal",y:"decimal"},lines:null,tooltipContent:null,forceHistogramStyles:!1,enableSelection:!1};return Object.getPrototypeOf(f)._initDefaultOptions.call(this,a)},f.reset=function(){Object.getPrototypeOf(f).reset.apply(this,arguments);var a=this._options;a.data;e.select(a.parent).selectAll(".axis-y.axis-index-1").remove()},f._addStatLines=function(){var a,b=this._chart,c=this._options,e=b._data,f=e[this._getPropMapping("y")].slice(),g={xstart:[],xend:[],y:[],name:[]},h=c.lines,i=this._dataAdapter.l10n.labels.bar,j=0,k=0,l=0,m=f.length,n=this;if(!c.normalized&&"stack"!=c.position&&h&&0!==h.length){if("chart"==h.max&&(g.y.push(Math.max.apply(null,f)),g.name.push(i.max)),"chart"==h.min&&(g.y.push(Math.min.apply(null,f)),g.name.push(i.min)),"chart"==h.mean){for(a=0;a<m;a++)l+=f[a];j=l/m,g.y.push(j),g.name.push(i.mean)}"chart"==h.median&&(f.sort(),m%2==0?(k=(f[m/2]+f[m/2-1])/2,g.y.push(k)):g.y.push(f[Math.floor(m/2)]),g.name.push(i.median));var o=n._seriesState.isSeriesEnabled("target","target"),p=c.scales&&"log"===c.scales.y?d.scale.log():d.scale.linear(),q=d.geom.hline().data(g).position("identity").map("y","y",p.includeInDomain(function(){return!n._valuesAreFilterable()||o})).set("alpha",.3).set("stroke",function(a,b){return"#222222"});this.labelData?(this.labelData.y.push.apply(this.labelData.y,g.y),this.labelData.name.push.apply(this.labelData.name,g.name)):(this.labelData=Object.create(g),this.labelData.y=g.y.slice(),this.labelData.name=g.name.slice()),b.layers().push(q)}},f._createTargetHLines=function(){var a=this._options;if(a.targetValues&&a.targetValues.length){var b=Object.getPrototypeOf(f)._createTargetHLines.apply(this,arguments),c=this._chart,d=c._layers.length;this._addBehaviors(c._layers[d-1],a),this.labelData?(this.labelData.y.push.apply(this.labelData.y,b.y),this.labelData.name.push.apply(this.labelData.name,b.name)):(this.labelData=Object.create(b),this.labelData.y=b.y.slice(),this.labelData.name=b.name.slice())}},f._setChartTypeOptions=function(){var a=this._chart,b=this._options;b.data;this._minTickSpace=this._options.flip?15:this._minTickSpace,a.layers([d.geom.bar().each("start",function(a,b){e.select(this).attr("legend-group",a.fill)})]).map("fill",this._getPropMapping("series"),d.scale.color().values(b.colors)).guide("fill",this._legend).position(b.position).coord(d.coord.cartesian().flip(b.flip)),a._layers[0].on("click",c.makeClickHandler(this)),a._layers[0].on("contextmenu",c.makeContextMenuHandler(this)),this._addBehaviors(a.layers()[0],b),this._mapPositionScales(a,b)},f._mapPositionScales=function(a,b){var c=this._isSmallChart(),f=[0,c?10:15],g=this._applyForceZero(this._constructScale("y")).rangePadding(f),h=this._getPropMapping("series"),i=this._getPropMapping("y"),j=this._getPropMapping("x"),k=c?Math.max(.3,Math.min(.6,this._getChartWidth()/this._dataAdapter.uniqueXValues().length/200)):Math.min(.6,Math.max(.05,this._getChartWidth()/4e3)),l=c?.3:.5,m=15,n=this;if((this._dataAdapter.isOvertime()||b.forceHistogramStyles)&&(k=.05),this._dataAdapter.isOvertime())l=.7;else if(c&&b.flip){l=.5;var o=!0,p=this._options.interactive?61:39,q=e.scale.ordinal().domain(this._dataAdapter.data()[j]).rangeBands([p,this._getChartHeight()]);k=this._findMinimumPadding(.3,.7,m,q.rangeBand()),o=q.rangeBand()*k>m,this._hideXTicks=!o}else this._hideXTicks=!1;if(b.normalized||b.dualYAxis&&("identity"===this._options.position||"dodge"===this._options.position)){n._dataAdapter.uniqueFillValues().forEach(function(b,c){var d=0===c?g:g.copy();d.includeInDomain(function(a,b){return a.data[h]===n._dataAdapter.uniqueFillValues()[c]}),c>0&&a.map("y",i,d,c)})}else for(var r=a.getExplicitScalesMap().y,s=1;r&&r[s];)delete r[s],s++;a.map("y",i,g,0),a.map("x",this._getPropMapping("x"),d.scale.ordinal().padding(k).outerPadding(l).reverse(b.flip))},f._findMinimumPadding=function(a,b,c,d,e){e=e||.1;for(var f,g=b,h=b;h>=a&&!((f=h)*d<c&&g*d>=c);h-=e)g=f;return g},f._hLineToolTip=function(a,b,c){return'<span class="metric-value">'+f.escapeHtml(a[0].data.name)+'</span><span class="metric-name">'+f.escapeHtml(a[0].data.y)+"</span>"},f._addBehaviors=function(a,b){var c,g=e.select(b.parent),h=this._dataAdapter,i=this;if(!this._isSmallChart()&&b.interactive){var j=d.behavior.selection().on("selectionChanged",function(a,b,c){i._highlightedOverlay.updateSelectedDisplay(a),i._onSelectionChanged(this,a,b,c,0)});this.selectionCache(j._selectionCache);var k=[d.behavior.identified(),d.behavior.rollover().orientation("_data"in a?b.flip?"right":"top":b.flip?"top":"right").content(function(a,c,d){if(!("data"in a))return i._hLineToolTip(a,c,d);if(b.tooltipContent)return b.tooltipContent.call(this,a,c,d);var e=this.__geom.getExplicitScale("group"),g=i._yLabelFormat(d),j='<span class="metric-value">'+f.escapeHtml(g(a.y,null,{dataItem:a}))+'</span><span class="metric-name">'+f.escapeHtml(a.data[i._getPropMapping("seriesLabel")])+"</span>",k=h.dateGranularity(),l=h.l10n.dateFormat.fullFormat,m=h.isOvertime()?i._formatTime(new Date(a.x),i._timeGranTemplate(k,l),k):a.x;return e&&e.mapping()&&(j='<span class="series-name">'+f.escapeHtml(m)+"</span>"+j),j}).showTooltip(function(a,b,d,f,h){e.select(this).classed("path-inactive")||(h._showTip.call(this,a,b,d,h),clearTimeout(c),g.selectAll(".bar-geom").classed("cv-medium-duration",!1).classed("cv-unselected",function(b){return a!==b}),g.selectAll(".cv-legend-marker").classed("cv-unselected",function(b){return b.id!==a.fill}).classed("cv-medium-duration",!1),i._dispatch.mouseover.call(this,a,b,d,f))}).hideTooltip(function(a,b,d,f,h){e.select(this).classed("path-inactive")||(h._removeTip.call(this,a,b,d,h),c=setTimeout(function(){g.selectAll(".bar-geom, .cv-legend-marker").classed("cv-unselected",!1).classed("cv-medium-duration",!0),i._dispatch.mouseout.call(this,a,b,d,f)},400))})];this._options.enableSelection&&k.push(j),a.behaviors(k)}},f._drawSmall=function(){var a,b=this._chart,c=this._options,f=c.width,g=(c.height,c.flip?f/7:10),h=(this._dataAdapter.uniqueXValues().length,this);if(a=c.flip?d.guide.axis().tickDx(function(a,b){return e.select(this).select("span").node().offsetWidth+2}).tickDy(0).tickSize(10):d.guide.axis().tickSize(0).tickDy(function(a,b){return b%2==0?-8:-26}),this._dataAdapter.isOvertime()){var i={},j=0;b._data[this._getPropMapping("x")].forEach(function(a,b){i[+new Date(a)]||(j++,i[+new Date(a)]=1)}),a.tickValues(e.extent(this._dataAdapter.data()[this._getPropMapping("x")])).tickFormat(this._timeXTickFormat(j)).tickAnchor(function(a,b){return b>0?"end":"start"}).tickDx(function(a,c){var d=b.getTrainedScale("x").rangeBand()/2;return c>0?d:-d}).tickDy(-8).htmlLabels(!0)}else c.forceHistogramStyles?a.tickDy(-8).tickFormat(function(c,d,e){return a.tickDx(-e.getTrainedScale("x").rangeBand()/2),h._timeXTickValidator(b._data.x.length)(c,d)?c:""}).htmlLabels(!0):(this._formatNonDateXAxis(a),a.tickFormat(function(a,b){return h._truncateLabel(a,g)}));b.guide("x",a.title(this._dataAdapter.xAxisTitle())).guide("y",d.guide.axis().ticks(0).tickSize(0).tickFormat(function(a,b){return""}).title(this._dataAdapter.yAxisTitle())),this._checkNormalized()},f._drawLarge=function(){var a,b=this._chart,c=this._options,e=this,f=function(a){return Math.max(2,Math.min(5,a/75))},g=d.guide.axis().tickSize(0),h=d.guide.axis().ticks(f);if(!c.dualYAxis||"identity"!==this._options.position&&"dodge"!==this._options.position)h.tickFormat(this._yTickFormat(0)).title(this._yTitleFormat(0)),b.guide("y","none",1);else{var i=e._dataAdapter.getUniqueFillExtent(0),j=e._dataAdapter.getUniqueFillExtent(1);h.tickSize(this._tickSize("y")).tickFormat(this._yTickFormat(0,i)).title(this._yTitleFormat(0,i)),a=d.guide.axis().ticks(f).tickFormat(this._yTickFormat(1,j)).title(this._yTitleFormat(1,j)).orientation("right").tickSize(this._tickSize("y")),b.guide("y",a,1)}if(c.flip?g.tickDx(-10):(g.tickDy(function(a,b){return b%2==0?-8:-26}),h.tickDx(-10),a&&a.tickDx(-10)),this._dataAdapter.isOvertime()){var k={},l=0;b._data[this._getPropMapping("x")].forEach(function(a,b){k[+new Date(a)]||(l++,k[+new Date(a)]=1)}),g.tickDy(c.flip?-4:-8).tickFormat(this._timeXTickFormat(l)).htmlLabels(!0)}else c.forceHistogramStyles?g.tickDy(c.flip?-4:-8).tickFormat(function(a,c,d){return g.tickDx(-d.getTrainedScale("x").rangeBand()/2),e._timeXTickValidator(b._data.x.length)(a,c)?a:""}).htmlLabels(!0):this._formatNonDateXAxis(g);b.guide("x",g.title(this._dataAdapter.xAxisTitle())).guide("y",h),this._checkNormalized(),this._addStatLines()},f._timeSmallXFormat=function(a){var b=this,c=b._dataAdapter,d=c.l10n.dateFormat.fullFormat,e=c?c.dateGranularity():"*",f=d.condensed;return"hour"!==e&&"minute"!==e&&"second"!==e||(f=d[e]),function(c,d){return a&&!a.call(this,c,d)?"":b._formatTime(c,f)}},f._formatNonDateXAxis=function(a){var b=this._options;if(this._hideXTicks)a.tickValues([""]);else if(b.flip&&!this._isSmallChart()){var c=0,d=this._dataAdapter.uniqueXValues(),e=this._options.height||this._getChartHeight(),f=Math.ceil(d.length/(e/this._minTickSpace)),g=d.map(function(a,b){return c++%f==0?a:null});a.tickValues(g)}a.tickFormat(function(a,b){return a}),a.tickWidth(function(a,c,d,e){if(!b.flip&&("ellipsis"===b.xAxisTruncation||"clip"===b.xAxisTruncation)){var f=e/2;f+=c%2==0&&e%2==1?1:0;return.8*(d._bounds.width/f)+"px"}return"100%"}),a.tickDisplay(function(a,c,d){return b.flip||"ellipsis"!==b.xAxisTruncation&&"clip"!==b.xAxisTruncation?"inline":"inline-block"}),a.tickOverflow(function(a,c,d){return"ellipsis"===b.xAxisTruncation||"clip"===b.xAxisTruncation?"hidden":""}),a.tickTextOverflow(function(a,c,d){return b.xAxisTruncation})},f._timeXTickValidator=function(a){var b=this,c=b._options;return function(e,f){var g=b._chart.getTrainedScale("x"),h=d.util.scaleRange(g),i=c.flip?h[0]-h[1]:h[1]-h[0];return f%Math.ceil(b._minTickSpace/(i/a))==0}},f._timeXTickFormat=function(a){return this._isSmallChart()?this._timeSmallXFormat(this._options.flip?null:this._timeXTickValidator(a)):Object.getPrototypeOf(f)._timeXTickFormat.call(this,this._timeXTickValidator(a))},f._isNormalized=function(){var a=this._options,b=this._isSmallChart()?1:2;return a.normalized||a.dualYAxis&&this._dataAdapter.uniqueFillValues().length>b&&("identity"===a.position||"dodge"===a.position)},f._postRenderLabels=function(){var a=this._chart,b=this._dataAdapter.isOvertime(),c={},d={},f=(e.select(a.parent()).selectAll(".series").each(function(a,b){e.select(this).selectAll("path").each(function(a,b){var f=e.select(this).node().getBBox();c[a.x]||(c[a.x]=f.y),d[a.x]||(d[a.x]=f.height)})}),e.select(a.parent()).selectAll(".axis-label").style("left"));this.selectionCache();e.select(a.parent()).selectAll(".axis-label").style("left",function(a,b){return f}).style("top",function(a,e){return b&&e>0?c[a]+d[a]+"px":c[a]-13+"px"})},f.lineWithinBounds=function(a,b,c){var d,e=this.labelData,f=e.y.length,g=this._chart,h=g.getTrainedScale("y");for(d=0;d<f;d++){var i=h.mapValue(e.y[d]);if(d!=c&&i>=a&&i<=b)return d}return-1},f._postRender=function(){var a=this.labelData,b=this._chart,c=this._options,d=c.flip;this._changedOptions={},this._isSmallChart()&&d&&this._postRenderLabels();var f=e.select(b.parent());f=f.selectAll(".behavior"),this._highlightedOverlay.setUpSelectedOverlay(f);var g=(e.select(b.parent()).selectAll(".interaction-canvas"),this.selectionCache());if(g&&(g.setDeselector(e.select(this._chart.parent()).select("rect.interaction-canvas")),g.selectionKeymap(this.determineKeyModifiers)),this.labelData){var h,i=(b.getTrainedScale("x"),b.getTrainedScale("y")),j=e.select(b.parent()).select(".plot"),k=b._facet.getPanel(0).bounds(),l=[],m=a.y.length,n=e.select(b.parent()).select(".axis-index-0"),o=Number(n.style("left").slice(0,-2)),p=e.select(b.parent()).select(".cv-bg"),q=Number(p.style("top").slice(0,-2))+10,r=[];if(j.append("g").selectAll(".dummyText").data(a.name).enter().append("text").classed("data-label",!0).text(function(a){return a}).each(function(a,b){var c=this.getComputedTextLength();r.push(c)}).remove(),d)for(h=0;h<m;h++){var s=i.mapValue(a.y[h]);this.lineWithinBounds(s,s+r[h],h)==-1&&s+r[h]<k.right?l.push(2):this.lineWithinBounds(s-r[h],s,h)==-1&&s-r[h]>k.left?l.push(-r[h]):(l.push(0),a.name[h]="")}else for(h=0;h<m;h++){var t=i.mapValue(a.y[h]);this.lineWithinBounds(t-15,t,h)==-1?l.push(-2):this.lineWithinBounds(t,t+15,h)==-1?l.push(11):(l.push(0),a.name[h]="")}var u=j.selectAll(".data-label").data(a.name);u.enter().append("text").classed("data-label",!0).text(function(a){return a}).attr("x",k.top).attr("y",i.range()[0]),u.transition().duration(0).attr("x",function(b,c){return d?i.mapValue(a.y[c])+l[c]:o+(a.xstart&&a.xstart[c]?a.xstart[c]*k.width:0)}).attr("y",function(b,c){return d?q+(a.xstart&&a.xstart[c]?a.xstart[c]*k.width:0):i.mapValue(a.y[c])+l[c]}),u.exit().transition().duration(0).attr("y",i.range()[0]).remove()}},a.cloudViz.bar=b.util.createConstructor(f)}(this),function(a){"use strict";var b=a.cloudViz||{},c=b.dvcore||{},d=a.dv||{},e=a.d3||{},f=Object.create(c);f.init=function(a){return Object.getPrototypeOf(f).init.apply(this,arguments),this._type="donut",this._chart=d.chart(),this.__other__="__other__",this},f._initDefaultOptions=function(){var a={sort:"descending",maxSlices:6,innerRadius:"45%",outerRadius:"35%",clickHandler:null,formats:{x:"decimal",y:"decimal"},mappings:{totals:""},showPrecalculatedSubtitle:!1,tooltipContent:null,enableSelection:!1};return Object.getPrototypeOf(f)._initDefaultOptions.call(this,a)},f._buildLegend=function(){var a=this,b=this._options,c=Object.getPrototypeOf(f)._buildLegend.call(this,"x","x");if(this._dataAdapter.processLabelData(c),"none"!==c){if(1==this._dataAdapter.numberOfFacets()){var d=this._dataAdapter.labelData().cvtextvallabel.map(function(b,c){return a._yLabelFormat(0)(b)});c.values(d)}else c.values([]);b.interactive||b.legendOrientation&&"top"!==b.legendOrientation||c.padding({bottom:20})}return c},f._isNumber=function(a){return!isNaN(parseFloat(a))},f._usePretotals=function(a){var b,c=this._dataAdapter,d=c.data(),e=d[this._getPropMapping("series")],g=e.length,h=d[this._getPropMapping("totals")]||[];if(h.length==e.length)for(b=0;b<g;++b)if(e[b]+""==a+""&&f._isNumber(h[b])&&h[b]>=0)return!0;return!1},
f._getSeriesTotal=function(a){var b,c=this._dataAdapter,d=c.data(),e=d[this._getPropMapping("y")],g=d[this._getPropMapping("series")],h=d[this._getPropMapping("totals")]||[],i=g.length,j=0,k=h.length==g.length;for(b=0;b<i;++b)if(g[b]+""==a+""){if(k&&f._isNumber(h[b])&&h[b]>=0)return h[b];j+=e[b]}return j},f._createSeriesStates=function(){var a=this._options;if("data"in this._changedOptions&&this._changedOptions.data){this._seriesState.removeStatesByType("standard");var b=this._dataAdapter.data()[this._getPropMapping("legendLabel")],c=b?d.util.uniq(b):d.util.uniq(this._dataAdapter.data()[this._getPropMapping("x")]),e=d.util.uniq(this._dataAdapter.data()[this._getPropMapping("sliceId")]),f=c.indexOf(this.__other__);f!==-1&&(c.splice(f,1),c.push(this._dataAdapter.l10n.labels.core.other),e.length&&(e.splice(f,1),e.push(this._dataAdapter.l10n.labels.core.other)));for(var g=c.length;g--;){var h=c[g],i=e?e[g]:null;this._seriesState.insertState(h,i||h,"standard")}}"targetValues"in this._changedOptions&&a.targetValues&&(this._seriesState.removeStatesByType("target"),this._seriesState.appendState(a.targetLabel||this._dataAdapter.l10n.labels.dvcore.target,"target","target"))},f._getCategoryTotal=function(a){if(1!==this._dataAdapter.numberOfFacets())return"";var b,c=this._dataAdapter.data(),d=c[this._getPropMapping("y")],e=c[this._getPropMapping("x")],f=e.length,g=0;for(b=0;b<f;++b)e[b]+""==a+""&&(g+=d[b]);return g},f._shouldHideLabels=function(a){var b=a.panel.bounds();return a.y<=.05||Math.min(b.width,b.height)/2<80},f._setChartTypeOptions=function(){var a=this._chart,b=this._dataAdapter,f=this._options,g=(e.select(f.parent),this),h=b.colors().slice(0);if(f.interactive&&a.padding({top:10}),b.showOtherCategory())for(var i=f.maxSlices-1;i<b.data().cvdonutorder.length;i+=f.maxSlices)h.splice(i,0,"#ccc"),this._getPropMapping("sliceId")&&(b._processedOptions.data[this._getPropMapping("sliceId")][i]=b.l10n.labels.core.other),b._processedOptions.data[this._getPropMapping("x")][i]=b.l10n.labels.core.other;var j=[d.geom.bar().position("fill").set("stroke","#fff").each("start",function(a,b){e.select(this).attr("legend-group",a.fill)})];j[0].on("click",c.makeContextMenuHandler(this)),j[0].on("contextmenu",c.makeContextMenuHandler(this));var k=g._dataAdapter.labelData();j.push(d.geom.text().data(k).map("label","cvtextperclabel").set("stroke","none").position("fill").textAnchor(function(a,b){var c=100*(a.y0+a.y/2);return c<50?"start":c>50?"end":"middle"}).each("start",function(a,b){e.select(this).classed("slice-label",!0).classed("hidden",g._shouldHideLabels.call(g,a)).attr("dy",".35em").attr("legend-group",a.fill)}).set("alpha",function(a,b,c){return g._shouldHideLabels.call(g,a)?0:1}).dx(function(a,b){var c=a.panel.xOuterScale().range(),e=c[1]-c[0],g=e?e/2:0,h=d.util.getPercentValue(f.outerRadius,g);a.y0,a.y;return g+h-30}).dy(function(a,b){var c=-a.panel._bounds.width/2*a.y,d=100*(a.y0+a.y/2);return d<10&&(c-=(10-d)/2),d>90&&(c+=(10-(100-d))/2),d<=50&&d>40&&(c+=(10-(50-d))/2),d>50&&d<60&&(c-=(10-(d-50))/2),c})),a.layers(j).map("group","cvdonutorder").map("x",this._getPropMapping("series"),d.scale.ordinal()).map("y",this._getPropMapping("y"),this._constructScale("y")).map("fill",this._getPropMapping("sliceId")||this._getPropMapping("x"),d.scale.color().values(h)).guide("fill",this._legend).guide(["x","y"],"none").coord(d.coord.polar().flip(!0).innerRadius(f.innerRadius).outerRadius(f.outerRadius)).postrender(function(){var a=e.select(f.parent).select(".cv-wrapper"),b=a.selectAll(".cv-donut-facet-labels").data([0]),c=g._dataAdapter;b.enter().append("div").classed("cv-donut-facet-labels",!0),b.exit().remove();var h=b.selectAll(".cv-donut-facet-label").data(this.facet()._panels);h.enter().append("div").classed("cv-donut-facet-label",!0);h.each(function(a,b){var h=a.bounds(),i=e.select(this),j=Math.min(h.width,h.height)/2,k=h.height/2-j,l=d.util.getPercentValue(f.innerRadius,j),m=l<25?"small":l>50?"large":"medium",n="large"===m?2*l:h.width,o="large"===m?h.left+h.width/2-n/2:h.left,p="large"===m?h.top+h.height/2-27:h.top+k-10;i.style("top",p+"px").style("width",n+"px").style("left",o+"px").classed("cv-donut-small-facet cv-donut-medium-facet cv-donut-large-facet",!1).classed("cv-donut-"+m+"-facet",!0);var q=i.selectAll(".cv-donut-label-number").data([0]);q.enter().append("div").classed("cv-donut-label-number",!0);var r=g._getSeriesTotal(a.xFacetTitle());q.text(g._yLabelFormat(a._facetIndex)(r));var s=i.selectAll(".cv-donut-label-title").data([0]);if(s.enter().append("div").classed("cv-donut-label-title",!0),s.text(c.yAxisTitle(a._facetIndex)),g._usePretotals(a.xFacetTitle())&&f.showPrecalculatedSubtitle){var t=c.l10n.labels.donut;s.enter().append("div").classed("cv-donut-label-subtitle",!0),s.text(t.precalculated)}"medium"===m&&q.style("top",h.height/2-k+"px")}),h.exit().remove()}),this._addBehaviors(j[0],f)},f._addBehaviors=function(a,b){var c,g=e.select(b.parent),h=this._dataAdapter,i=this;if(b.interactive){var j=d.behavior.selection().on("selectionChanged",function(a,b,c){i._highlightedOverlay.updateSelectedDisplay(a,function(){return this.parentNode.attributes.transform?this.parentNode.attributes.transform.nodeValue:"translate(0,0)"}),i._onSelectionChanged(this,a,b,c,0)});this.selectionCache(j._selectionCache);var k=[d.behavior.identified(),d.behavior.rollover().content(function(a,c,e){if(b.tooltipContent)return b.tooltipContent.call(this,a,c,e);var g=this.__geom.getExplicitScale("group"),j=a.panel.columnIndex(),k=i._yLabelFormat(j),l='<span class="metric-value">'+f.escapeHtml(k(a.data[i._getPropMapping("y")]))+'</span><span class="metric-name">'+f.escapeHtml(a.data[i._getPropMapping("seriesLabel")])+"</span>",m=i._dataAdapter.dateGranularity(),n=h.l10n.dateFormat.fullFormat,o=d.util.isDate(a.fill)?i._formatTime(a.fill,i._timeGranTemplate(m,n),m):a.data[i._getPropMapping("x")];return g&&g.mapping()&&(l='<span class="series-name">'+f.escapeHtml(o)+"</span>"+l),l}).showTooltip(function(a,b,d,f,h){e.select(this).classed("path-inactive")||(h._showTip.call(this,a,b,d,h),clearTimeout(c),g.selectAll(".bar-geom").classed("cv-medium-duration",!1).classed("cv-unselected",function(b){return a!==b}),g.selectAll(".text-geom").classed("cv-medium-duration",!1).classed("cv-unselected",function(b){return a.group!==b.group}).classed("cv-selected",function(b){return a.group===b.group}),g.selectAll(".cv-legend-marker").classed("cv-unselected",function(b){return b.id!==a.fill}).classed("cv-medium-duration",!1),i._dispatch.mouseover.call(this,a,b,d,f))}).hideTooltip(function(a,b,d,f,h){e.select(this).classed("path-inactive")||(h._removeTip.call(this,a,b,d,h),c=setTimeout(function(){g.selectAll(".bar-geom, .cv-legend-marker").classed("cv-unselected",!1).classed("cv-medium-duration",!0),g.selectAll(".text-geom").classed("cv-unselected cv-selected",!1).classed("cv-medium-duration",!0),i._dispatch.mouseout.call(this,a,b,d,f)},400))})];b.enableSelection&&k.push(j),a.behaviors(k)}},f._drawSmall=function(){var a=this._chart;this._options;a.facet(d.facet.wrap().group(this._getPropMapping("series")).scales("free").numColumns(1).titleFormat(void 0))},f._drawLarge=function(){this._chart.facet(d.facet.wrap().group(this._getPropMapping("series")).scales("free").numColumns(3).titleFormat(void 0))},f._updatePathStates=function(){Object.getPrototypeOf(f)._updatePathStates.call(this,this._getPropMapping("sliceId")||this._getPropMapping("x"))},a.cloudViz.donut=b.util.createConstructor(f)}(this),function(a){"use strict";a.cloudViz.interactiveLegend=function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=10,p=110,q=110,r=["top","right","left"],s=!0,t={};return t._render=function(a,b,c){this._initSVG(b),this._sizeAndPositionLegendEntries(),this._positionLegend()},t._initSVG=function(e){m=d3.select(b).selectAll(".cv-legend").data([0]),m.enter().append("div").classed("cv-legend",!0),l=this._createLegendEntries(m,e),k=Math.floor(this._getLegendContainingWidth()/l.size()),r.indexOf(c)>-1?this._calculatedLegendOrientation=c:this._calculatedLegendOrientation="top";var f=a.cloudViz.core._isSmallChart(d);switch(k<p&&!f&&("top"==this._calculatedLegendOrientation||"bottom"==this._calculatedLegendOrientation)&&(this._calculatedLegendOrientation="left"),this._calculatedLegendOrientation){case"top":case"bottom":k=Math.max(k,p),m.style("height",null),g=!1;break;case"left":case"right":k=q,g=!0}r.forEach(dv.util.bind(function(a){m.classed(a,this._calculatedLegendOrientation===a)},this))},t._getAdjustedDimensions=function(a){m.node();switch(this._calculatedLegendOrientation){case"top":a.top+=this._getUsedHeight();break;case"right":a.width-=this._getUsedWidth();break;case"left":a.left+=this._getUsedWidth();break;case"bottom":a.height-=this._getUsedHeight()}return a},t._createLegendEntries=function(a,b){var c,d,e,f,g=j.getStateObjects();g=g.filter(function(a){return!a.hiddenInLegend});for(e in b)f=b[e][0],n=f._mapping;c=a.selectAll(".cv-legend-entry").data(g),d=c.enter().append("div").attr("class",function(a){return"cv-legend-entry cv-legend-"+a.type+"-entry"}),d.append("div").classed("cv-legend-title",!0);var k=d.append("div").classed("cv-legend-details",!0);return k.append("div").classed("cv-legend-marker",!0),k.append("div").classed("cv-legend-num",!0),c.exit().on("click",null).remove(),c.each(function(a,b){var c=d3.select(this);c.select(".cv-legend-title").text(a.name),c.select(".cv-legend-num").text(h&&h.length>b?h[b]:""),c.select(".cv-legend-marker").attr("class","cv-legend-marker "+i).style("background-color",function(a){var b=f.mapValue(a.id);return b?b:null})}),c.classed("inactive",function(a,b){return s&&!a.enabled}),c.on("click",function(a,b){s&&j.enableStateByIndex(b,!a.enabled)}),c},t._onSeriesEnableChange=function(a,b){s&&l.filter(function(a){return a.id===b.id&&a.type===b.type}).classed("inactive",!b.enabled)},t._positionLegend=function(){var a={top:0,left:0};switch(this._calculatedLegendOrientation){case"bottom":a.top=e-m.node().offsetHeight;break;case"right":a.left=d-q}m.style("top",a.top+"px").style("left",a.left+"px")},t._sizeAndPositionLegendEntries=function(){if(g)m.style("width",""),l.each(function(a,b,c){d3.select(this).style("width",k+"px").select(".cv-legend-title").style("height",null)});else{var a,b,c=0,d=!1,e=l[0].length,f=e*k,h=this._getLegendContainingWidth(),i=0;f<h&&f+e>h&&(i=h-f),m.style("width",f>h&&!g?h+"px":""),l.each(function(e,f,g){a=d3.select(this);var h=k;i>0&&(h+=1,i-=1),a.style("width",h+"px"),(b=a.select(".cv-legend-title").style("height",null).node().offsetHeight)!==c&&(d=!0,c=Math.max(b,c))}),d&&l.selectAll(".cv-legend-title").style("height",c+"px")}},t._getLegendContainingWidth=function(){return d},t._getUsedWidth=function(){return g?q+o:0},t._getUsedHeight=function(){return g?0:m.node().offsetHeight||0},t.destroy=function(){m.remove()},t.parent=function(a){return arguments.length?(b=a,t):b},t.minLegendEntryWidth=function(a){return arguments.length?(p=a,t):p},t.legendVerticalWidth=function(a){return arguments.length?(q=+a,t):q},t.values=function(a){return arguments.length?(h=a,t):h},t.type=function(a){return arguments.length?(i=a,t):i},t.chartWidth=function(a){return arguments.length?(d=a,t):d},t.chartHeight=function(a){return arguments.length?(e=a,t):e},t.chartPadding=function(a){return arguments.length?(f=a,t):f},t.seriesState=function(a){return arguments.length?(j=a,j.on("enableChange.legend",this._onSeriesEnableChange),t):j},t.validOrientations=function(a){return arguments.length?(r=a,t):r},t.orientation=function(a){return arguments.length?(c=a,t):c},t.interactive=function(a){return arguments.length?(s=a,t):s},t.mapping=function(){return n},t.isVertical=function(){return g},t}}(this),function(a){"use strict";d3.anomaly=function(){function a(a,b){for(var c in b)a[c]=b[c];return a}function b(){var a=O.append("g").classed("temp-axis",!0);m(a,R[0],R[1]),y=c(a),G=R[0]-y.left-y.right,F=R[1]-y.top-y.bottom,a.remove()}function c(a){var b=a.node().getBBox(),c=Math.abs(b.x),d=Math.abs(b.y);return{left:c,top:d,right:b.width-R[0]-c,bottom:b.height-R[1]-d}}function d(a){var b=e(x,function(a){return Date.parse(a[L])},[D,C]),c=e(x,function(a){return a[M]});Y.domain(b);var d=Y.ticks(W,B),f=+d[1]-+d[0];b[1]=f+ +d[d.length-1],b[0]=+d[0]>b[0]?+d[0]-f:b[0],Y.domain(b),K=Y.ticks(W,B);var g=Math.max(Math.abs(c[0]),Math.abs(c[1]));U?(Z.domain([0,g]),E=d3.scale.linear().domain([-g,g])):(Z.domain([-g,g]),E=d3.scale.linear().domain(Z.domain())),E.domain([0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1].map(E.invert)),E.range(a.colors)}function e(a,b,c){var d=[];return arguments.length<3||void 0===c[0]&&void 0===c[1]?d=d3.extent(a,b):(d[0]=void 0===c[0]?d3.min(a,b):c[0],d[1]=void 0===c[1]?d3.max(a,b):c[1]),d}function f(){N=d3.select(V);var a=N.selectAll(".cv-wrapper").data([x]);a.enter().append("div").classed("cv-wrapper",!0),a.classed("cv-anomaly",!0);var b=a.selectAll("svg").data([x]);b.enter().append("svg").on("contextmenu",function(a,b){d3.event.preventDefault()}),b.exit().remove(),b.attr("width",R[0]).attr("height",R[1]),$.setUpBrush(b,_,aa);var c=b.selectAll(".anom-container").data([0]);return c.enter().append("g").classed("anom-container",!0),$.setUpBrushOverlay(b),c}function g(){J=Z.ticks(T);var a=J[1]-J[0];J.push(a+J[J.length-1]),U||J.unshift(J[0]-a),x=h(x),i(x);var b=j(x);return k(J,b),b}function h(a,b){var c=Y.domain();return a.filter(function(a){var b=new Date(a[L]);return b>=c[0]&&b<c[1]})}function i(a){a.sort(function(a,b){return a=new Date(a[L]),b=new Date(b[L]),a<b?-1:a>b?1:0})}function j(a){return d3.nest().key(function(a){for(var b=Date.parse(a[L]),c=0,d=-1,e=K.length;++d<e&&!(+K[d]>+b);)c=d;return+K[c]}).entries(a)}function k(a,b){b.forEach(function(b){b.values=d3.layout.histogram().bins(a).value(function(a){return U?Math.abs(a[M]):a[M]})(b.values),I=b.values[0].dx})}function l(a){var b=new Date(0),c=K.length,d=Math.max(Math.ceil((K.length-1)/(a/70)),1),e=d3.time.format("%b %e, %Y"),f=d3.time.format("%b %e"),g=d3.time.format("%a %e"),h=d3.time.format("%I:%M %p");return function(a,i){var j="";return i===c-1||i%d!=0?"":(0===i||b.getYear()!==a.getYear()?j=e(a):b.getMonth()!==a.getMonth()?j=f(a):b.getDate()!==a.getDate()?j=g(a):b.getHours()!==a.getHours()&&(j=h(a)),b=a,j)}}function m(a,b,c){var d=K.length,e=K.length>1&&+K[1]-+K[0]<=ea;Y.rangeRound([0,b]),Z.rangeRound([c,0]);var f=a.selectAll(".anom-axes").data([0]);f.enter().append("g").classed("anom-axes",!0),f.selectAll(".anom-axis").data(["x","y"]).enter().append("g").attr("class",function(a){return"anom-"+a+" anom-axis"});var g=f.selectAll(".anom-x").attr("transform","translate(0,"+c+")").call(d3.svg.axis().scale(Y).ticks(W,B).orient("bottom").tickSize(-c).tickPadding(20).tickFormat(l(b)));g.selectAll("text").style("text-anchor","start"),g.selectAll("line").style("opacity",function(a,b){return b===d-1?0:e&&(6===a.getDay()||1===a.getDay())&&0===a.getHours()&&b<d-1?.3:null});var h=f.selectAll(".anom-y").call(d3.svg.axis().scale(Z).tickValues(J).orient("left").tickSize(-b).tickPadding(10).tickFormat(function(a,b){return 0===b||b===Math.floor(J.length/2)||b===J.length-1?Math.round(1e5*a)/1e5+"%":""}));U||h.selectAll("line").filter(function(a,b){return 0===a}).style("stroke-dasharray","4 4").style("opacity",.7)}function n(){var a=Math.round(J.length>1?Z(J[0])-Z(J[1]):F)-1,b=Math.round(r(a))-1,c=O.selectAll(".anom-plot").data([H]);c.enter().append("g").classed("anom-plot",!0),c.exit().remove();var d=c.selectAll(".anom-column").data(function(a){return a});d.enter().append("g").classed("anom-column",!0),d.exit().remove(),d.attr("transform",function(a){return"translate("+Y(+a.key)+",0)"});var e=d.selectAll(".anom-row").data(function(a){return a.values});e.enter().append("g").classed("anom-row",!0),e.exit().remove(),e.attr("transform",function(b,c){return"translate(0,"+(Z(J[c])-a)+")"});var f=e.selectAll(".anom-anomaly").data(function(a){return a}),g=f.enter().append("g").attr("class",function(a,b,c){return"datum-"+b+" series-"+c}).classed("anom-anomaly",!0);f.attr("transform",function(c,d){var e=q(U?Math.abs(c[M]):c[M]);return c[M]>=0&&(e+=I),c.bounds={x:Y(Date.parse(c[L]))+(d*(b+da)+da),y:Z(e),width:b,height:a},"translate("+(d*(b+da)+da)+",0)"}),f.exit().remove(),g.append("rect").classed("anom-cell",!0).attr("x",b/2).attr("y",a/2).attr("width",0).attr("height",0),f.selectAll(".anom-cell").attr("fill",function(a){var b=q(U?Math.abs(a[M]):a[M]);return U&&a[M]<0&&(b*=-1),E(b)}).transition().duration(500).attr("x",0).attr("y",0).attr("width",b).attr("height",a);var h=g.append("g").classed("anom-select",!0);h.append("path").classed("outer-border",!0),h.append("path").classed("inner-border",!0);var i=f.selectAll(".anom-select");i.select(".outer-border").attr("d",p(0,0,b+.5,a+.5,1)),b>3&&i.select(".inner-border").attr("d",p(0,0,b+1,a+1,2));var j=function(a,b){var c=a.__data__.bounds.x+a.__data__.bounds.width/2,d=a.__data__.bounds.y+a.__data__.bounds.height/2,e=b.__data__.bounds.x+b.__data__.bounds.width/2,f=b.__data__.bounds.y+b.__data__.bounds.height/2,g=new dv.collisions.rectFromMinMax(c,d,e,f),h=[];return aa.testRect(g,function(b,c,d){b!=a&&h.push(b)}),h};g.on("contextmenu",function(a,b,c){X.contextmenu.call(this,a,b,c)}).on("mouseover",function(a,b,c){X.mouseover.call(this,a,b,c)}).on("mouseout",function(a,b,c){X.mouseout.call(this,a,b,c)}).on("mousedown",ba.makeSelectHandler(j)).on("click",function(a,b){d3.event.preventDefault()}).classed("selectable",!0),g.each(function(a,b){var c=new dv.collisions.rectFromMinMax(a.bounds.x,a.bounds.y,a.bounds.x+a.bounds.width,a.bounds.y+a.bounds.height);aa.insertRect(c,this)})}function o(){var a=O.selectAll(".anom-plot").data([0]);a.enter().append("g").classed("anom-plot",!0),a.exit().remove()}function p(a,b,c,d,e){return"M"+e+","+e+"L"+(c-2*e)+","+e+"L"+(c-2*e)+","+(d-2*e)+"L"+e+","+(d-2*e)+"z"}function q(a){for(var b=-1,c=J.length;++b<c;){if(a>=0&&J[b]+I>a)return J[b];if(a<0&&J[b]+I>a)return J[b]+I}return J[0]}function r(a){var b=(K.length>1?Y(K[1])-Y(K[0]):G)-ca,c=s();return z=b/c,z>a?a:z}function s(){var a=0;return H.forEach(function(b){b.values.forEach(function(b){a=Math.max(b.length,a)})}),a}function t(a){if(void 0===Q[a])throw new u(a);return Q[a]}function u(a){this.type="MappingNotDefinedException",this.message="The mapping for property "+a+" was not defined.",this.toString=function(){return this.type+" - "+this.message}}function v(){this.type="EmptyDataException",this.message="The data is empty or null",this.toString=function(){return this.type+" - "+this.message}}function w(){this.type="ParentNotSpecifiedException",this.message="A p was not specified for this visualization",this.toString=function(){return this.type+" - "+this.message}}var x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P={},Q={x:"date",y:"deviation"},R=[50,25],S=!0,T=6,U=!1,V=null,W=7,X=d3.dispatch("select","mouseover","mouseout","contextmenu"),Y=d3.time.scale(),Z=d3.scale.linear(),$=cloudViz.util.inputFilter(".brush-container",".zoom-container",".anom-container"),_=new dv.util.SelectionCache,aa=new dv.collisions.QuadtreeNode([512,512],512),ba=null;aa.buildTree(3),_.lastSelected=function(){return this._lastSelected},_.on("selectionChanged",function(a,b,c,d){X.select.call(a,b,c,d)});var ca=8,da=1,ea=864e5;return d3.rebind(P,X,"on"),P.selectionCache=function(){return _},P.chart=function(a){return a&&(ba=a),ba},P.data=function(a){return arguments.length?(x=a,P):x},P.mappings=function(b){return arguments.length?(Q=a(Q,b),P):Q},P.xUpperLimit=function(a){return arguments.length?(C=a,P):C},P.xLowerLimit=function(a){return arguments.length?(D=a,P):D},P.normalizePositive=function(a){return arguments.length?(U=a,P):U},P.xTicks=function(a,b){if(!arguments.length)return void 0!==b?[W,B]:this.xTicks;var c=!!(a&&a.constructor&&a.call&&a.apply);return W=c?d3.functor(a):a,B=c?b:void 0,this},P.bins=function(a){return arguments.length?(T=a,P):T},P.size=function(a){return arguments.length?(R=a,P):R},P.interactive=function(a){return arguments.length?(S=a,P):S},P.parent=function(a){return arguments.length?(V=a,P):V},P.anomalyWidth=function(){return z},P.anomalyHeight=function(){return A},P.layout=function(a){if(!P.data()||!P.data().length)throw new v;if(!P.parent())throw new w;L=t("x"),M=t("y"),d(a),H=g(),Z.domain([J[0],J[J.length-1]]);var c=G>F?G:F;c/=2,aa=new dv.collisions.QuadtreeNode([c,c],c),aa.buildTree(4),O=f(),b(),O.attr("transform","translate("+y.left+","+y.top+")");var e=O.selectAll(".anom-background").data([0]).enter().append("rect").classed("anom-background",!0);return _.setDeselector(e),m(O,G,F),o(),n(),$.interceptBrushEvents(),P},P.nodes=function(a){if(!N)throw new Error("layout must be called before nodes may be requested.");N.selectAll(".anom-anomaly").each(a)},P}}(),function(a){"use strict";var b=a.cloudViz||{},c=b.core||{},d=a.dv||{},e=a.d3||{},f=Object.create(c),g=400;f.init=function(a){if(this._type="pathing",this._initDefaultOptions(),this.setOptions(a),this._pathLocked=null,this._pathedObj=null,this._activePaths=[],this._lineLocked=null,this._lastSide=0,this._identifiedBehavior=d.behavior.identified(),a.enableSelection){this.selectionCache(new d.util.SelectionCache);var b=this;this._selectionCache.on("selectionChanged",function(a,c,d,e){b._highlightedOverlay.updateSelectedDisplay(c,function(){return"translate(0,0)"}),b._onSelectionChanged(a,c,d,e,0)})}return this},f._initDefaultOptions=function(){var a="Visits",b={mappings:{},colors:[],theme:"specialDefault",nodeWidth:100,nodeTitleMaxChars:22,nodeTitleTruncationTailLength:10,minNodeHeight:1,avgNodeHeight:30,padding:{top:80,left:30,right:30,bottom:20},metricName:a,minNodeHorzPadding:80,nodeVertPadding:34,iterations:32,shouldShowTooltip:function(a,b,c){return!0},enableInfoPane:!0,enableQuickActionsMenu:!0,pivotNode:null,collapseNode:null,expandNode:null,pathSelected:null,toggleNode:null,disableTruncation:!1,wrappedTitleLineHeight:1.1,wrappedTitleWidth:100,enableSelection:!1};return Object.getPrototypeOf(f)._initDefaultOptions.call(this,b)},f._onAutoResize=function(){this.render()},f.reset=function(){Object.getPrototypeOf(f).reset.apply(this,arguments)},f._preRender=function(){Object.getPrototypeOf(f)._preRender.apply(this);var a=this._options,b=e.select(a.parent),c=a.padding,d=b.selectAll(".pathing-cv-info-wrapper").data([0]);d.enter().insert("div",":first-child").classed("pathing-cv-info-wrapper",!0);var g=d.selectAll(".pathing-cv-wrapper").data([0]);g.enter().insert("div",":first-child").classed("pathing-cv-wrapper",!0),g.classed("cv-wrapper",!0);var h=g.selectAll(".pathing-cv-container").data([0]);h.enter().insert("div",":first-child").classed("pathing-cv-container",!0);var i=h.selectAll(".pathing-svg").data([0]);i.enter().append("svg").classed("pathing-svg",!0);var j=i.selectAll(".pathing-svg-container").data([0]);if(j.enter().append("g").classed("pathing-svg-container",!0),j.attr("transform","translate("+c.left+","+c.top+")"),a.enableInfoPane){var k=d.selectAll(".pathing-cv-info-pane").data([0]);k.enter().append("div").classed("pathing-cv-info-pane",!0),k.exit().remove();var l=k.selectAll(".info-pane-content").data([0]);l.enter().append("div").classed("info-pane-content",!0),l.exit().remove();var m=l.selectAll(".pathing-cv-info-title").data([0]);m.enter().append("div").classed("pathing-cv-info-title",!0),m.exit().remove();var n=l.selectAll(".pathing-cv-info-value").data([0]);n.enter().append("div").classed("pathing-cv-info-value",!0),n.exit().remove();var o=l.selectAll(".pathing-cv-info-paths").data([0]);o.enter().append("div").classed("pathing-cv-info-paths",!0),o.exit().remove()}this._sizeChart(),this._createGradients(i);var p=this._pathedObj;this._changedOptions&&this._changedOptions.data&&p?this._isDataObjNode(p.data)?this._unlockNode(p.data,p.elem)():this._unlockLink(p.data,p.elem)():(h.on("mousemove.node",null).on("click.node",null).on("click.link",null),this._removePathOverlays(h),this._removeNodeOptions(!0),this._defaultInformation())},f._render=function(){if(Object.getPrototypeOf(f)._render.apply(this),this._dataAdapter.isValidPathingData()){this._createDiagram();var a=this._pathedObj;this._activePaths.length&&a&&(this._isDataObjNode(a.data)?(this._renderNodePaths(a.data,a.elem,!0),this._showNodeOptions(a.data,a.elem)):this._renderLinkPaths(a.data,a.elem,!0))}},f._postRender=function(){Object.getPrototypeOf(f)._postRender.apply(this),this._highlightedOverlay.setUpSelectedOverlay(e.selectAll(".pathing-svg-container"))},f._sizeChart=function(a){clearTimeout(this._wrapperAnimation),clearTimeout(this._scrollAnimation);var b=this._options,c=this._dataAdapter.data(),f=e.select(b.parent),g=f.selectAll(".pathing-cv-info-wrapper"),h=g.selectAll(".pathing-cv-wrapper"),i=h.selectAll(".pathing-cv-container"),j=g.selectAll(".pathing-cv-info-pane"),k=b.parent.offsetWidth,l=b.parent.offsetHeight,m=void 0!==b.width&&null!==b.width?d.util.getPercentValue(b.width,k):k,n=d.util.getPercentValue(b.height,l),o=b.enableInfoPane?parseInt(j.style("width"),10):0,p=m-o,q=b.padding,r=c&&c.nodes||[],s=this._numColumns=r.length&&Math.max.apply(null,r.map(function(a){return a.column}))+1||1,t=[],u=0;c.nodes.forEach(function(a,b){t[a.column]?t[a.column]++:t[a.column]=1}),u=t.length&&Math.max.apply(null,t)||0;var v=p-2,w=n-2,x=s*b.nodeWidth+(s-1)*b.minNodeHorzPadding+q.left+q.right,y=u*b.avgNodeHeight+u*b.nodeVertPadding+q.top+q.bottom,z=x>p,A=y>n;h.classed("is-wider",z),z&&(v=x,w-=20),h.classed("is-taller",A),A&&(w=y,v-=20),b.enableInfoPane?g.style("width",m+"px").style("height",n+"px"):g.select(".pathing-cv-info-pane").style("display","none"),h.style("width",p+"px").style("height",n+"px"),i.style("width",v+"px").style("height",w+"px"),w=this._measureChart(b,c)+q.top+q.bottom,i.style("height",w+"px")},f._getInnerDimensions=function(){var a=this._options,b=a.padding,c=e.select(a.parent).select(".pathing-cv-container"),d=c.node().getBoundingClientRect(),f=d.width,g=d.height;return this.innerDimensions=[f-b.right-b.left,g-b.top-b.bottom],this.innerDimensions},f.splitLongWord=function(a,b,c){for(var d=(this._options,[]),e=a.split("").reverse(),f=[];e.length;){var g=e.pop();d.push(g),c.text(d.join("")),c.node().getComputedTextLength()>b&&(d.pop(),f.push(d.join("")),d=[g])}return f.push(d.join("")),f.reverse(),f},f._wrapText=function(a){var b,c=this._options,d=a.text().split(/\s+/).reverse(),e=[],f=0,g=c.wrappedTitleLineHeight,h=parseFloat(a.attr("x"))||0,i=parseFloat(a.attr("y"))||0,j=a.text(null).append("tspan").attr("x",h).attr("y",i),k=c.wrappedTitleWidth;for(j.style("font-size",c.wrappedTitleFontSize);b=d.pop();)for(e.push(b),j.text(e.join(" "));j.node().getComputedTextLength()>k;){if(1==e.length){d=d.concat(this.splitLongWord(b,k,j)),e=[];break}e.pop(),j.text(e.join(" ")),e=[b],++f,j=a.append("tspan").attr("x",h).attr("y",i).attr("dy",f*g+"em").text(b)}return a},f._measureColumns=function(a,b){var c=this,d=(e.pathing().nodeWidth(a.nodeWidth).nodePadding(a.nodeVertPadding).size(this._getInnerDimensions()).nodes(b.nodes).links(b.links).minNodeHeight(a.minNodeHeight).layout(a.iterations),[]);b.nodes.map(function(a){d[a.column]?d[a.column].push(a):d[a.column]=[a]}),this.columns=d;var f=e.select(a.parent).select(".pathing-svg"),g=[];return d.forEach(function(b,d){var e=0,h=f.append("g").classed("node",!0);b.forEach(function(d,f,g){var i=h.append("text").classed("node-title",!0).text(d.label);a.disableTruncation&&c._wrapText(i),d.titleHeight=i.node().getBBox().height;var j=Math.max(d.dy,d.titleHeight);d.height=j,e+=f===b.length-1?j:j+a.nodeVertPadding,i.remove()}),h.remove(),g.push(e)}),Math.max.apply(Math,g)},f._measureLabels=function(a,b){var c=0,d=this,f=b.filter(function(a){return 0===a.row}),g=e.select(a.parent).select(".pathing-svg");return f.forEach(function(b){var e=g.append("text").classed("node-title",!0).text(b.dimensionLabel);a.disableTruncation&&d._wrapText(e);var f=e.node().getBBox().height;f>c&&(c=f),e.remove()}),this.maxLabelHeight=c+a.nodeVertPadding,this.maxLabelHeight},f._measureChart=function(a,b){var c=this._measureColumns(a,b);return this._measureLabels(a,b.nodes)+c},f._setOffsets=function(a,b){var c=this._options;this.columns.forEach(function(a,b){a.forEach(function(a,b,d){var e=d[b-1];if(e){var f=Math.max(e.titleHeight,e.dy);a.y=e.y+f+c.nodeVertPadding}else a.y=0;a.totalY=a.titleHeight})})},f._createDiagram=function(){var a=this._options,b=this._dataAdapter.data(),c=e.select(a.parent).selectAll(".pathing-cv-container"),d=parseInt(c.style("width"),10),f=parseInt(c.style("height"),10),g=this._path=e.pathing().nodeWidth(a.nodeWidth).nodePadding(a.nodeVertPadding).size(this.innerDimensions).nodes(b.nodes).links(b.links).minNodeHeight(a.minNodeHeight).layout(a.interations),h=e.select(a.parent);if(this._setOffsets(),this._cvWrapper=h.selectAll(".cv-wrapper"),this._tooltipParent=h,this._cvWrapper.select(".pathing-cv-container").classed("svg-wrapper",!0),!b.nodes.some(function(a){return 0!==a.column})){var i=g.nodeWidth(),j=a.padding;b.nodes.forEach(function(a){a.x+=(d-j.left-j.right)/2-i/2})}var k=this._updateLinks(g,b.links);this._updateNodes(g,b.nodes,k,f);var l=e.select(a.parent).select(".pathing-svg").node();l.style.display="none";l.offsetHeight;l.style.display=""},f._updateNodes=function(a,b,c,d){function f(a,b){a.each(function(){j._wrapText(e.select(this))})}function h(a){var b=k.nodeTitleMaxChars,c=k.nodeTitleTruncationTailLength;return a.length<=b+c?a:a.slice(0,Math.max(b-c,0))+""+a.slice(a.length-c)}function i(a){var b=!0,c=!1,d=!1;j._numColumns>1&&(c=0===a.column,d=j._numColumns-1===a.column,b=!(c||d)),e.select(this).attr("x",b?q/2:c?2:q-4).attr("text-anchor",b?"middle":c?"start":"end")}var j=this,k=this._options,l=e.select(k.parent).select(".pathing-svg-container"),m=(this._options.onNodeSelect,this._options.padding,!this._changedOptions||!this._changedOptions.data),n=m?0:g,o=l.selectAll(".node-container").data([0]);o.enter().append("g").classed("node-container",!0),o.exit().remove();var p=o.selectAll(".node").data(b,this._dataAdapter.nodeKey()),q=a.nodeWidth();l.selectAll(".path-overlay-container").transition().duration(n).attr("transform",function(a){return"translate(0,"+j.maxLabelHeight+")"}),l.selectAll(".link-container").transition().duration(n).attr("transform",function(a){return"translate(0,"+j.maxLabelHeight+")"}),o.transition().duration(n).attr("transform",function(a){return"translate(0,"+j.maxLabelHeight+")"});var r=l.selectAll(".column-label-container").data([0]);r.enter().append("g").classed("column-label-container",!0),r.exit().remove(),r.selectAll(".column-label").remove();var s=b.filter(function(a){return 0===a.row}),t=r.selectAll(".column-label").data(s);t.enter().append("text").attr("transform",function(a){return"translate("+a.x+", 0)"}).classed("column-label",!0).text(function(a){return k.disableTruncation?a.dimensionLabel:h(a.dimensionLabel)}),t.exit().remove(),t.each(i),k.disableTruncation&&f(t),p.enter().append("g").classed("hide-node",!0).attr("transform",function(a){return"translate("+a.x+",0)"}),p.attr("id",function(a,b,c){return j._identifiedBehavior.identify(a,b,c)}),p.on("mouseover.node",function(a,b){j._showNodePaths(a,this),k.disableTruncation||j._showFullTitle(a,this),!j.getOption("enableInfoPane")&&j.getOption("shouldShowTooltip")(a,b,e.event)&&j._initTooltip(a,e.event),j._dispatch.mouseover.call(this,a)}).on("contextmenu.node",j.makeContextMenuHandler(j)).on("contextmenu.node",function(a,b,c,d){j._dispatch.contextmenu.call(this,a)}).on("mouseout.node",function(a,b){j._hideNodePaths(),j._truncateFullTitle(a,this),j.getOption("enableInfoPane")||j._teardownTooltip(a,e.event),j._dispatch.mouseout.call(this,a)}).on("mousedown.node",j.makeSelectHandler()).on("click.node",function(a,b){k.enableQuickActionsMenu?j._activateNode(a,this):j._toggleNode(a,this),j._dispatch.click.call(this,a)});var u=p.exit();u.classed("hide-node",!0).on("mousedown.node",null).on("mouseover.node",null).on("mouseout.node",null).on("click.node",null).transition().duration(n).style("opacity",0).attr("transform",function(a){return"translate("+a.x+",0)"}),setTimeout(function(){u.remove()},n),p.selectAll(".node-total").remove(),
p.transition().duration(n).attr("transform",function(a){return"translate("+a.x+","+a.y+")"});this._numColumns;p.each(function(b,c){var d=e.select(this),g=d.classed("hide-node");d.attr("class","node"),d.classed("hide-node",g),d.classed("filter","E_0"===b.id),d.classed("exit-filter","X_0"===b.id),b.classname&&d.classed(b.classname,!0);var j=d.selectAll(".node-bg").data([b]);j.enter().append("rect").classed("node-bg",!0),j.exit().remove(),j.attr("width",q),j.transition().duration(n).attr("height",function(a){return a.dy});var l=d.selectAll(".node-title").data([b]);l.enter().append("text").classed("node-title",!0).attr("y",-5).attr("transform",null),l.exit().remove(),l.each(i),l.text(function(a){return k.disableTruncation?a.label:h(a.label)}),k.disableTruncation&&f(l,k.wrappedTitleWidth);var m=d.selectAll(".node-total").data([b]);m.enter().append("text").classed("node-total",!0).attr("y",function(a){return a.totalY}).attr("transform",null),m.exit().remove(),m.each(i),m.text(function(a){return e.format(",.0f")(a.value)});var o=d.selectAll(".node-hit-area").data([b]);o.enter().append("rect").classed("node-hit-area",!0),o.exit().remove(),o.attr("height",function(a){return a.dy+4}).attr("y",-4).attr("width",a.nodeWidth()).style("opacity",0),setTimeout(function(){d.classed("hide-node",!1)},n)})},f.defaultTooltipContent=function(a){return this._isDataObjNode(a)?this.nodeTooltipContent(a):this.pathTooltipContent(a)},f.nodeTooltipContent=function(a){return"<span class='series-name'>"+this.escapeHtml(a.label)+"</span><span class='metric-value'>"+a.value+"</span>"},f.pathTooltipContent=function(a){function b(a){return a?a.label:""}var c=b(a.source),d=b(a.target);return"<span class='series-name'>"+this.escapeHtml(c)+" "+this.nodeJoinCharacter+" "+this.escapeHtml(d)+"</span><span class='metric-value'>"+a.value+"</span>"},f.getNodeBounds=function(a,b,c){var d,e=b;if(d=e.getBBox(),"g"===e.nodeName){d=e.getBBox();var f=this._getNodeTranslation(e);d.x+=f.x,d.y+=f.y}return{x:d.x,y:d.y,height:d.height,width:0}},f._getTooltipBounds=function(a,b,c){var d=e.mouse(this._options.parent);return{x:d[0],y:d[1],height:0,width:0}},f.nodeJoinCharacter="&#x2192;",f._toggleNode=function(a,b){var c=this._options,d=this._dataAdapter;a.canExpand=d.canExpandNode(a),a.canCollapse=d.canCollapseNode(a),"function"==typeof c.toggleNode&&c.toggleNode.call(this,a)},f.gradientCounter={count:0},f._updateLinks=function(a,b){var c=this._options,d=this,f=e.select(c.parent).select(".pathing-svg-container"),h=e.select(c.parent).selectAll("svg"),i=h.selectAll("defs").data([0]),j=!this._changedOptions||!this._changedOptions.data,k=j?0:g;i.enter().append("defs");var l=i.selectAll(".path-fills").data([0]),m=(l.enter().append("g").classed("path-fills",!0),f.selectAll(".link-container").data([0]));m.enter().append("g").classed("link-container",!0),m.exit().remove();var n=f.selectAll(".path-overlay-container").data([0]);n.enter().append("g").classed("path-overlay-container",!0),n.exit().remove();var o=m.selectAll("path").data(b,this._dataAdapter.linkKey());o.enter().append("path").classed("hide-link",!0),o.on("mouseover.link",function(a,b){d._showLinkPaths(a,this)}).on("mousedown.link",d.makeSelectHandler()).on("mouseout.link",function(a,b){d._hideLinkPaths()}),c.enableInfoPane&&o.on("click.link",function(a,b){d._activateLink(a,this)});var p=o.exit();return p.classed("hide-link",!0).on("mousedown.link",null).on("click.link",null).on("mouseover.link",null).on("mouseout.link",null),setTimeout(function(){p.remove()},k),o.each(function(b,c){var d=e.select(this),f=d.classed("hide-link");d.attr("class",function(a){return a.source?a.target?"link":"exit":"entry"}),d.classed("hide-link",f),d.classed("hide-link")?(d.attr("d",a.link()(b)),setTimeout(function(){d.classed("hide-link",!1)},k)):d.transition().duration(k).attr("d",a.link()(b)),b.source&&"E_0"===b.source.id?d.classed("entry-path",!0):b.target&&"X_0"===b.target.id&&d.classed("exit-path",!0);var g=b.source&&"E_0"===b.source.id,h=b.target&&"X_0"===b.target.id;d.classed("filter",g),d.classed("exit-filter",h)}),o},f._createGradients=function(a){var b=a.selectAll("style").data([0]);b.enter().append("style"),b.text(function(a){var b=".pathing-svg .exit { fill: url(#exitFill); } \n";return b+=".pathing-svg .entry { fill: url(#entryFill); } \n",b+=".pathing-svg .exit:hover { fill: url(#exitHighlightFill); } \n",b+=".pathing-svg .entry:hover { fill: url(#entryHighlightFill); } \n",b+=".pathing-svg .pivot-entry { mask: url(#pivotEnterMask); } \n",b+=".pathing-svg .pivot-exit { mask: url(#pivotExitMask); } \n",b+=".pathing-svg .link-container .entry-path { fill: url(#entryGradient); } \n",b+=".pathing-svg .link-container .exit-path { fill: url(#exitGradient); } \n"});var c=e.select("body").selectAll("svg.global-cv-pathing-defs").data([0]);c.enter().append("svg").classed("global-cv-pathing-defs",!0);var d=c.selectAll("defs").data([0]);d.enter().append("defs");var f=d.selectAll(".bounce-fills").data([0]),g=f.enter().append("g").classed("bounce-fills",!0),h=g.append("linearGradient").attr("id","pivotEnterGrad");h.append("stop").attr("offset","0%").style("stop-color","#fff").style("stop-opacity",0),h.append("stop").attr("offset","50%").style("stop-color","#fff").style("stop-opacity",0),h.append("stop").attr("offset","70%").style("stop-color","#fff").style("stop-opacity",.5),h.append("stop").attr("offset","100%").style("stop-color","#fff").style("stop-opacity",1),g.append("mask").attr("id","pivotEnterMask").attr("x","0").attr("y","0").attr("width","1").attr("height","1").attr("maskUnits","objectBoundingBox").attr("maskContentUnits","objectBoundingBox").append("rect").attr("x","0").attr("y","0").attr("width","1").attr("height","1").attr("fill","url(#pivotEnterGrad)");var i=g.append("linearGradient").attr("id","pivotExitGrad").attr("x1","100%").attr("y1","0%").attr("x2","0%").attr("y2","0%");i.append("stop").attr("offset","0%").style("stop-color","#fff").style("stop-opacity",0),i.append("stop").attr("offset","50%").style("stop-color","#fff").style("stop-opacity",0),i.append("stop").attr("offset","70%").style("stop-color","#fff").style("stop-opacity",.5),i.append("stop").attr("offset","100%").style("stop-color","#fff").style("stop-opacity",1),g.append("mask").attr("id","pivotExitMask").attr("x","0").attr("y","0").attr("width","1").attr("height","1").attr("maskUnits","objectBoundingBox").attr("maskContentUnits","objectBoundingBox").append("rect").attr("x","0").attr("y","0").attr("width","1").attr("height","1").attr("fill","url(#pivotExitGrad)");var j=g.append("linearGradient").attr("id","entryGradient").attr("x1","0%").attr("y1","100%").attr("x2","100%").attr("y2","100%");j.append("stop").attr("offset","0%").style("stop-color","#8cc350"),j.append("stop").attr("offset","100%").style("stop-color","#3287D2");var k=g.append("linearGradient").attr("id","exitGradient").attr("x1","0%").attr("y1","100%").attr("x2","100%").attr("y2","100%");k.append("stop").attr("offset","0%").style("stop-color","#3287D2"),k.append("stop").attr("offset","100%").style("stop-color","#cc2539");var l=g.append("linearGradient").attr("id","exitFill").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%");l.append("stop").attr("offset","0%").style("stop-color","#FA5A50").style("stop-opacity",.5),l.append("stop").attr("offset","85%").style("stop-color","#FA5A50").style("stop-opacity",.5),l.append("stop").attr("offset","100%").style("stop-color","#FA5A50").style("stop-opacity",.1);var m=g.append("linearGradient").attr("id","exitHighlightFill").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%");m.append("stop").attr("offset","0%").style("stop-color","#FA5A50").style("stop-opacity",1),m.append("stop").attr("offset","85%").style("stop-color","#FA5A50").style("stop-opacity",1),m.append("stop").attr("offset","100%").style("stop-color","#FA5A50").style("stop-opacity",.1);var n=g.append("linearGradient").attr("id","entryFill").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%");n.append("stop").attr("offset","0%").style("stop-color","#58AF5E").style("stop-opacity",.1),n.append("stop").attr("offset","15%").style("stop-color","#58AF5E").style("stop-opacity",.5),n.append("stop").attr("offset","100%").style("stop-color","#58AF5E").style("stop-opacity",.5);var o=g.append("linearGradient").attr("id","entryHighlightFill").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%");o.append("stop").attr("offset","0%").style("stop-color","#58AF5E").style("stop-opacity",.1),o.append("stop").attr("offset","15%").style("stop-color","#58AF5E").style("stop-opacity",1),o.append("stop").attr("offset","100%").style("stop-color","#58AF5E").style("stop-opacity",1)},f._setOptionContainerContent=function(a,b){var c,d=this._options,e="",g=0,h=a.classed("is-last-column"),i=this._dataAdapter,j=i.l10n.labels.pathing,k=[{id:"expand",label:j.expand,valid:d.expandNode&&i.canExpandNode(b)},{id:"pivot",label:j.focus,valid:d.pivotNode&&i.canPivotNode(b)},{id:"collapse",label:j.collapse,valid:d.collapseNode&&i.canCollapseNode(b)}];if(h&&k.reverse(),k=k.filter(function(a){return a.valid}),d.expandNode||d.collapseNode||d.pivotNode)for(var l=0,m=k.length;l<m;++l)c=k[l],e+='<a class="cv-node-option cv-node-option'+(h?m-g-1:g)+" cv-node-"+c.id+'"><i class="'+c.id+'"></i><span>'+f.escapeHtml(c.label)+"</span></a>",++g;e='<div class="cv-node-options num-options-'+g+'">'+e+"</div>",a.html(e)},f._activateNode=function(a,b){var c,d=this;if(this._pathLocked&&a===this._pathLocked.data){d._unlockNode(a,b)();var f=e.mouse(b)[0]>=d._options.nodeWidth/2?1:-1;if(!a.isPivot||f===d._lastSide)return}this._setPathLocked({data:a,elem:b}),e.select(d._options.parent).select(".pathing-cv-container").on("click.node",null).on("click.link",null),c=e.selectAll(".cv-node-active"),c.classed("cv-node-active",!1),e.selectAll(".cv-link-active").classed("cv-link-active",!1),e.select(b).classed("cv-node-active",!0),c.node()&&this._truncateFullTitle(c.datum(),c.node()),this._renderNodePaths(a,b),this._showNodeOptions(a,b),this._showInformation(a,b),this._scrollToElem(b),this._showFullTitle(a,b),setTimeout(function(){e.select(d._options.parent).select(".pathing-cv-container").on("click.node",d._unlockNode(a,b))},10)},f._showNodePaths=function(a,b){this._pathLocked||this._renderNodePaths(a,b)},f._showFullTitle=function(a,b){var c=e.select(b).select(".node-title");c.text()!==a.label&&(b.parentNode.appendChild(b),a.truncation=c.text(),c.text(a.label),this._titleBackground(c,!0))},f._truncateFullTitle=function(a,b){if((!this._pathLocked||this._pathLocked.data!==a)&&a.truncation){var c=e.select(b).select(".node-title");c.text(a.truncation),this._titleBackground(c,!1)}},f._titleBackground=function(a,b){var c,d,f=e.select(a.node().parentNode);b?(c=a.node().getBoundingClientRect(),d=c.width+10,f.insert("rect",":first-child").classed("text-bg",!0).attr("height",c.height).attr("width",d).attr("x",this._getTitleBackgroundXValue(a,d)).attr("y",(c.height+1)*-1)):f.select(".text-bg").remove()},f._getTitleBackgroundXValue=function(a,b){var c=a.attr("x");return"start"===a.attr("text-anchor")?c:"middle"===a.attr("text-anchor")?c-b/2:"end"===a.attr("text-anchor")?c-b:void 0},f._renderNodePaths=function(a,b,c){function d(){i=k._activePaths=l.filter(function(b){var c=b.nodes.indexOf(a._pid);return j>0&&c+1<b.nodes.length||j<0&&c>0}),h=k._dataAdapter.nodePathData(i,a,j),k._createPathOverlays(h)}function f(){var a=0;try{a=e.mouse(b)[0]}catch(f){}var c=a>=k._options.nodeWidth/2?1:-1;c!==j&&(k._lastSide=j=c,d())}var g=e.select(this._options.parent).select(".pathing-cv-container");if(clearTimeout(this._hidePathOverlaysTimer),g.on("mousemove.node",null),!this._pathedObj||this._pathedObj.data!==a||c){this._setPathedObj({data:a,elem:b});var h,i,j=0,k=this,l=this._dataAdapter.nodePaths(a);a.isPivot?c?(j=k._lastSide,d()):(f(),k._pathLocked||g.on("mousemove.node",function(a,b){f()})):(k._lastSide=0,k._activePaths=l,h=this._dataAdapter.nodePathData(l,a,j),k._createPathOverlays(h)),setTimeout(function(){g.classed("path-overlays",!0)},1)}},f._showNodeOptions=function(a,b){var c=this._numColumns,d=e.select(this._options.parent).select(".pathing-cv-container"),f=d.node(),g=this._options,h=50,i=e.select(b).select(".node-bg").node(),j=f.getBoundingClientRect(),k=i.getBoundingClientRect(),l=k.top-j.top,m=k.left-j.left+g.nodeWidth/2,n=d.select(".cv-path-node-options");n.empty()?n=d.append("div").classed("cv-path-node-options",!0).attr("node",a._pid):n.attr("node")==a._pid&&n.classed("is-open")||(this._removeNodeOptions(),h=300,n=d.append("div").classed("cv-path-node-options",!0).attr("node",a._pid)),n.classed("is-last-column",c>1&&c-1===a.column).style("top",l+"px").style("left",m+"px"),this._setOptionContainerContent(n,a),setTimeout(function(){n.classed("is-open",!0)},h)},f._formatMetricValue=function(a){return this._formatNumber("decimal",a.value,null,{dataItem:a})+" "+this._options.metricName},f._formatPathInformation=function(a){var b=this._options,c=this,d=b.colors;return function(b,e){var g=c._dataAdapter.getPathEnd(b),h=g&&g.value?g.value:a,i="",j=b.values[0],k=j/h;return e%=d.length,i+='<span class="pathing-path-marker" style="background-color: '+f.escapeHtml(d[e])+'"></span>',i+='<span class="pathing-path-value"><span class="pathing-path-num">'+f.escapeHtml(c._formatNumber("decimal",j,null,{dataItem:b}))+'</span> <span class="pathing-path-perc">'+f.escapeHtml(c._formatNumber("percent",k,null,{dataItem:b}))+"</span></span>"}},f._highlightPath=function(a,b,c){var d=this._options,f=d.parent,g=e.event,h=!g||g&&"click"===g.type,i=e.select(f).selectAll(".path-overlay-container"),j=e.select(f).selectAll(".pathing-cv-info-pane"),k=i.selectAll(".link.path"+b),l=i.selectAll(".link:not(.path"+b+")");if(h&&d.enableInfoPane){if(this._lineLocked===a)return this._setLineLock(null),this._removeHightlightPath();this._setLineLock(a),j.selectAll(".locked").classed("locked",!1),e.select(c).classed("locked",!0)}else if(this._lineLocked)return;i.selectAll(".link.inactive").classed("inactive",!1),l.classed("inactive",!0),k.classed("active",!0)},f._setLineLock=function(a){this._options;this._lineLocked!==a&&(this._lineLocked=a,this._callPathSelected(a))},f._setPathedObj=function(a){this._pathedObj=a},f._setPathLocked=function(a){this._options;this._pathLocked!==a&&(this._pathLocked=a,this._callPathSelected())},f._callPathSelected=function(a){var b={},c=this._options,d=this._pathLocked&&this._pathLocked.data||{};a&&(b.path=a.nodes+""),void 0!==d._pid&&(b.node=d._pid,b.side=this._lastSide),void 0===d.source&&void 0===d.target||(b.source=d.source?d.source._pid:null,b.target=d.target?d.target._pid:null),"function"==typeof c.pathSelected&&c.pathSelected(b,this._pathLocked,a)},f._removeHightlightPath=function(){if(!this._lineLocked){var a=this._options,b=a.parent,c=e.select(b).selectAll(".pathing-cv-info-pane");e.select(b).selectAll(".path-overlay-container").selectAll(".link").classed("inactive",!1).classed("active",!1),a.enableInfoPane&&c.selectAll(".locked").classed("locked",!1)}},f._showInformation=function(a,b){var c=this._options;if(c.enableInfoPane){var d=this,g=this._isDataObjNode(a),h=this._dataAdapter.l10n.labels.pathing,i=e.select(this._options.parent).select(".pathing-cv-info-pane"),j=i.selectAll(".pathing-cv-info-title"),k=i.selectAll(".pathing-cv-info-value"),l=i.selectAll(".pathing-cv-info-paths");this._setLineLock(null),this._removeHightlightPath();var m,n=this._formatMetricValue(a),o=!1;if(g)m=f.escapeHtml(a.label),n=f.escapeHtml(this._formatMetricValue(a)),o=a.column==this._numColumns-1;else{var p=h.percOfNode;if(a.source)if(a.target){var q=this._dataAdapter,r=q.getPathDirection(q.data().paths[a.paths[0]]),s=r<0?a.target:a.source;m=h.nodeToNode.replace(/\{source\}/i,a.source.label).replace(/\{target\}/i,a.target.label),n=this._formatMetricValue(a)+'<span class="perc">'+f.escapeHtml(p.replace(/\{perc\}/i,this._formatNumber("percent",a.value/s.value,null,{dataItem:a})).replace(/\{label\}/i,s.label))+"</span>"}else m=h.nodeExits.replace(/\{label\}/i,a.source.label),n=this._formatMetricValue(a)+'<span class="perc">'+f.escapeHtml(p.replace(/\{perc\}/i,this._formatNumber("percent",a.value/a.source.value,null,{dataItem:a})).replace(/\{label\}/i,a.source.label))+"</span>";else m=h.nodeEntries.replace(/\{label\}/i,a.target.label),n=this._formatMetricValue(a)+'<span class="perc">'+f.escapeHtml(p.replace(/\{perc\}/i,this._formatNumber("percent",a.value/a.target.value,null,{dataItem:a})).replace(/\{label\}/i,a.target.label))+"</span>"}i.classed("is-last-column",o),j.html(m),k.html(n);var t=l.selectAll(".pathing-cv-path-title").data([0]);t.enter().append("span").classed("pathing-cv-path-title",!0),t.html(this._dataAdapter.activePathsTitle(this._activePaths));var u=l.selectAll(".pathing-cv-path-info").data(this._activePaths);u.enter().append("span").classed("pathing-cv-path-info",!0),c.enableInfoPane&&u.on("click.line",function(a,b){d._highlightPath(a,b,this)}).html(this._formatPathInformation(a.value)),u.on("mouseover.line",function(a,b){d._highlightPath(a,b,this)}).on("mousedown.line",d.makeSelectHandler()).on("mouseout.line",function(a,b){d._removeHightlightPath()}),u.exit().on("mousedown.line",null).on("click.line",null).on("mouseover.line",null).on("mouseout.line",null).remove()}},f._defaultInformation=function(){var a=this._options;if(a.enableInfoPane){this._setLineLock(null),this._removeHightlightPath();var b=e.select(a.parent).select(".pathing-cv-info-pane"),c=b.selectAll(".pathing-cv-info-title"),d=b.selectAll(".pathing-cv-info-value"),f=b.selectAll(".pathing-cv-info-paths"),g=this._dataAdapter.l10n.labels.pathing,h="<p>"+g.help1+"</p>";h+="<p>"+g.help2+"</p>",h+="<p>"+g.help3+"</p>",h+='<p><span class="cv-node-option"><i class="pivot"></i></span><span class="cv-option-title">'+g.focus+"</span></p>",h+="<p>"+g.focusHelp+"</p>",h+='<p><span class="cv-node-option"><i class="expand"></i></span><span class="cv-option-title">'+g.expand+"</span></p>",h+="<p>"+g.expandHelp+"</p>",h+='<p><span class="cv-node-option"><i class="collapse"></i></span><span class="cv-option-title">'+g.collapse+"</span></p>",h+="<p>"+g.collapseHelp+"</p>",c.html(g.title),d.html('<div class="help">'+h+"</div>"),f.html("")}},f._scrollToElem=function(a){function b(a,b){return function(){var c=null!==a?e.interpolateNumber(g.node().scrollLeft,a):null,d=null!==b?e.interpolateNumber(g.node().scrollTop,b):null;return function(a){null!==c&&(g.node().scrollLeft=c(a)),null!==d&&(g.node().scrollTop=d(a))}}}var c=this._options,d=e.select(this._options.parent).select(".pathing-cv-container"),f=d.node(),g=e.select(c.parent).select(".pathing-cv-wrapper"),h=e.select(a),i=h.selectAll(".node-bg").empty()?h.node():h.select(".node-bg").node(),j=f.getBoundingClientRect(),k=i.getBoundingClientRect(),l=k.top-j.top,m=k.left-j.left+c.nodeWidth/2;if(g.classed("is-wider")||g.classed("is-taller")){var n=null,o=null;if(g.classed("is-wider")){var p=parseInt(g.style("width"),10),q=parseInt(d.style("width"),10);n=Math.min(q-p,Math.max(0,m-p/2))}if(g.classed("is-taller")){var r=parseInt(g.style("height"),10),s=parseInt(d.style("height"),10);o=Math.min(s-r,Math.max(0,l+40-r/2))}e.transition().duration(300).tween("scroll",b(n,o))}},f._unlockNode=function(a,b){var c=this;return function(d,f){c._setPathLocked(null),e.select(c._options.parent).select(".pathing-cv-container").on("click.node",null),c._deactivateNode(e.event,a,b),c._truncateFullTitle(a,b)}},f._deactivateNode=function(a,b,c){if(e.select(c).classed("cv-node-active",!1),this._removeNodeOptions(!1),this._defaultInformation(),this._hideNodePaths(),a){var d=e.select(a.target),f=this._options,g=b||{};"click"===a.type&&(d.classed("cv-node-option")||(d=e.select(d.node().parentNode)),d.classed("cv-node-expand")&&"function"==typeof f.expandNode&&f.expandNode(g),d.classed("cv-node-collapse")&&"function"==typeof f.collapseNode&&f.collapseNode(g),d.classed("cv-node-pivot")&&"function"==typeof f.pivotNode&&f.pivotNode(g))}},f._removeNodeOptions=function(a){var b=e.selectAll(".cv-path-node-options");b.classed("is-open",!1),setTimeout(function(){b.remove()},a?0:300)},f._hideNodePaths=function(){var a=e.select(this._options.parent).select(".pathing-cv-container");a.on("mousemove.node",null),this._pathLocked||this._removePathOverlays(a)},f._activateLink=function(a,b){var c=this;if(this._pathLocked&&a===this._pathLocked.data)return void c._unlockLink(a,b);this._setPathLocked({data:a,elem:b}),e.select(c._options.parent).select(".pathing-cv-container").on("click.node",null).on("click.link",null),e.selectAll(".cv-node-active").classed("cv-node-active",!1),e.selectAll(".cv-link-active").classed("cv-link-active",!1),e.select(b).classed("cv-link-active",!0),this._removeNodeOptions(),this._renderLinkPaths(a,b),this._showInformation(a,b),this._scrollToElem(b),setTimeout(function(){e.select(c._options.parent).select(".pathing-cv-container").on("click.link",c._unlockLink(a,b))},10)},f._showLinkPaths=function(a,b){this._pathLocked||(this.getOption("enableInfoPane")||this._initTooltip(a,e.event),this._renderLinkPaths(a,b))},f._renderLinkPaths=function(a,b,c){if(clearTimeout(this._hidePathOverlaysTimer),!this._pathedObj||this._pathedObj.data!==a||c){this._setPathedObj({data:a,elem:b});var d=this._dataAdapter;this._activePaths=d.linkSortActivePaths(a),this._createPathOverlays(d.linkPathData(this._activePaths));var f=e.select(this._options.parent).select(".pathing-cv-container");setTimeout(function(){f.classed("path-overlays",!0)},1)}},f._unlockLink=function(a,b){var c=this;return function(d,f){c._setPathLocked(null),e.select(c._options.parent).select(".pathing-cv-container").on("click.link",null),c._deactivateLink(e.event,a,b)}},f._deactivateLink=function(a,b,c){e.select(this._options.parent).select(".pathing-cv-container");e.select(c).classed("cv-link-active",!1),this._defaultInformation(),this._hideLinkPaths()},f._hideLinkPaths=function(){var a=e.select(this._options.parent).select(".pathing-cv-container");this._pathLocked||(this.getOption("enableInfoPane")||this._teardownTooltip(),this._removePathOverlays(a))},f._createPathOverlays=function(a){var b=this._options,c=this._path,d=e.select(b.parent).select(".path-overlay-container"),f=d.selectAll("path").data(a);f.enter().append("path"),f.exit().remove(),f.attr("class",function(a){var b=a.pivotStart?" pivot-entry":a.pivotEnd?" pivot-exit":"";return"link path"+a.path+b}).attr("d",c.link()).attr("style",function(a,c){var d=a.path%b.colors.length;return"fill: "+b.colors[d]+";"}).sort(function(a,b){return a||b?a?b?b.dy-a.dy:-1:1:0})},f._removePathOverlays=function(a){clearTimeout(this._hidePathOverlaysTimer),this._setPathedObj(null),this._hidePathOverlaysTimer=setTimeout(function(){a.classed("path-overlays",!1)},20)},f.getColumnElementsByDataNode=function(a){return this._cvWrapper.select("svg").selectAll(".node").filter(function(b){return b.column===a.column})},f.getColumnBBox=function(a){var b=this.columns[a.datum().column],c=this._getNodeTranslation(this._cvWrapper.select(".pathing-svg-container").node()),d=a.node().getBBox().width,e=b[0].x+c.x,f=b[0].y+c.y+this.maxLabelHeight-15,g=b.reduce(function(a,b){return a+b.height},0);return g+=this._options.nodeVertPadding*(b.length-1)+15,{width:d,height:g,x:e,y:f}},f._isDataObjNode=function(a){return void 0!==a._pid},f.setActivePath=function(a){var b=this._options,c=this,d=this._dataAdapter.data();a=a||{};var f,g,h=void 0!==a.node;if(h?f=d.nodesById[a.node]:(f=d.links.filter(function(b){return(!b.source&&!a.source||b.source&&a.source&&b.source._pid+""===a.source)&&(!b.target&&!a.target||b.target&&a.target&&b.target._pid+""===a.target)}),f=f.length&&f[0]||null),g=h?".node":".link",f){var i,j=!1;j=d.paths.some(function(b){return i=b.nodes,b.nodes.toString()===a.path}),e.select(b.parent).selectAll(g).each(function(a,d){if(a===f){if(h?c._activateNode(a,this):c._activateLink(a,this),!j)return;e.select(b.parent).selectAll(".pathing-cv-path-info").filter(function(a,b){a.nodes.toString()===i.toString()&&c._highlightPath(a,b,this)})}})}},a.cloudViz.pathing=b.util.createConstructor(f)}(this),function(a){"use strict";d3.pathing=function(){function a(){m.forEach(function(a){a.sourceLinks=[],a.targetLinks=[],a.entryLinks=[],a.exitLinks=[]}),n.forEach(function(a){var b=a.source,c=a.target;null!==b&&"number"==typeof b&&(b=a.source=m[a.source]),null!==c&&"number"==typeof c&&(c=a.target=m[a.target]),null!==b&&null!==c?(b.sourceLinks.push(a),c.targetLinks.push(a)):null===b?c.entryLinks.push(a):b.exitLinks.push(a)})}function b(){function a(a){return a.sourceLinks&&a.sourceLinks.length||a.targetLinks&&a.targetLinks.length||a.exitLinks&&a.exitLinks.length||a.entryLinks&&a.entryLinks.length}m.forEach(function(a){a.hasOwnProperty("total")?a.value=a.total:a.value=Math.max(d3.sum(a.sourceLinks,h)+d3.sum(a.exitLinks,h),d3.sum(a.targetLinks,h)+d3.sum(a.entryLinks,h))}),m.sort(function(b,c){if(b.isMoreNode)return 1;if(c.isMoreNode)return-1;var d=a(b),e=a(c);return d&&!e?-1:e&&!d?1:c.value-b.value})}function c(){var a=[],b=l[0]-j;m.forEach(function(b){b.x=b.column,b.dx=j,a.indexOf(b.column)<0?(a.push(b.column),b.columnIndex=a.length-1):b.columnIndex=a.indexOf(b.column)}),o=a.length,d(o>1?b/(o-1):b)}function d(a){m.forEach(function(b){b.x*=a})}function e(a){function b(){var a=d3.min(i,function(a){var b=d3.sum(a,h)||1;return(l[1]-(a.length-1)*k)/b});i.forEach(function(b){b.forEach(function(b,c){b.y=c,b.row=c,b.dy=Math.max(p,b.value*a)})}),n.forEach(function(b){b.dy=b.value*a})}function c(a){function b(a){return g(a.source)*a.value}i.forEach(function(c,d){c.forEach(function(c){if(c.targetLinks.length){var d=d3.sum(c.targetLinks,b)/d3.sum(c.targetLinks,h);c.y+=(d-g(c))*a}})})}function d(a){function b(a){return g(a.target)*a.value}i.slice().reverse().forEach(function(c){c.forEach(function(c){if(c.sourceLinks.length){var d=d3.sum(c.sourceLinks,b)/d3.sum(c.sourceLinks,h);c.y+=(d-g(c))*a}})})}function e(){i.forEach(function(a){var b,c,d,e=0,g=a.length;for(a.sort(f),d=0;d<g;++d)b=a[d],c=e-b.y,c>0&&(b.y+=c),e=b.y+b.dy+k;if((c=e-k-l[1])>0)for(e=b.y-=c,d=g-2;d>=0;--d)b=a[d],c=b.y+b.dy+k-e,c>0&&(b.y-=c),e=b.y})}function f(a,b){return a.y-b.y}var i=d3.nest().key(function(a){return a.x}).sortKeys(d3.ascending).entries(m).map(function(a){return a.values});b(),e();for(var j=1;a>0;--a)d(j*=.99),e(),c(j),e()}function f(){function a(a,b){return a.source.y-b.source.y}function b(a,b){return a.target.y-b.target.y}m.forEach(function(c){c.sourceLinks.sort(b),c.targetLinks.sort(a)}),m.forEach(function(a){var b=0,c=0;a.entryLinks.forEach(function(a){a.ty=c,c+=a.dy}),a.sourceLinks.forEach(function(a){a.sy=b,b+=a.dy}),a.targetLinks.forEach(function(a){a.ty=c,c+=a.dy}),a.exitLinks.forEach(function(a){a.sy=b,b+=a.dy})})}function g(a){return a.y+a.dy/2}function h(a){return a.value}var i={},j=24,k=8,l=[1,1],m=[],n=[],o=NaN,p=0;return i.nodeWidth=function(a){return arguments.length?(j=+a,i):j},i.nodePadding=function(a){return arguments.length?(k=+a,i):k},i.nodes=function(a){return arguments.length?(m=a,i):m},i.links=function(a){return arguments.length?(n=a,i):n},i.size=function(a){return arguments.length?(l=a,i):l},i.numColumns=function(){return o},i.minNodeHeight=function(a){return arguments.length?(p=a,i):p},i.layout=function(d){return a(),b(),c(),e(d),f(),i},i.relayout=function(){return f(),i},i.link=function(){function a(a){var c,d,e,f,g,h,i,j,k,l,m,n,o,p=5;return n=o=Math.min(a.dy+p,15),null===a.source?(c=a.target.x-n,d=a.target.x,j=a.target.y-p,k=a.target.y+a.dy,"M"+c+","+j+"h"+n+"v"+(k-j)+"c-"+n+",0,-"+n+",-"+o/2+",-"+n+",-"+o+"z"):null===a.target?(c=a.source.x+a.source.dx,d=a.source.x+a.source.dx+n,j=a.source.y+a.source.dy-a.dy,k=a.source.y+a.source.dy+p,"M"+d+","+k+"h-"+n+"v-"+(k-j)+"c"+n+",0,"+n+","+o/2+","+n+","+o+"V"+k+"z"):(c=a.source.x+a.source.dx,d=a.target.x,e=d3.interpolateNumber(c,d),f=e(b),g=e(1-b),h=g+(a.dy<15?a.source.y<a.target.y?-1*a.dy:a.dy:0),i=f+(a.dy<15?a.source.y<a.target.y?-1*a.dy:a.dy:0),j=a.source.y+a.sy,k=a.target.y+a.ty,l=k+a.dy,m=j+a.dy,"M"+c+","+j+"C"+f+","+j+" "+g+","+k+" "+d+","+k+"v"+a.dy+"C"+h+","+l+" "+i+","+m+" "+c+","+m+"Z")}var b=.5;return a.curvature=function(c){return arguments.length?(b=+c,a):b},a},i}}(),function(a){"use strict";function b(a){var b=[],c=!0;for(var d in a){for(var e=a[d],f=-1,g=e.length;++f<g;){var h,i=e[f];c?(h={},b.push(h)):h=b[f],h[d]=i}c=!1}return b}var c=a.cloudViz||{},d=c.core||{},e=a.dv||{},f=a.d3||{},g=Object.create(d);g.init=function(a){return this._type="anomaly",a=a||{},this._initDefaultOptions(),this.setOptions(a),this._initializeAnomaly(),this},g._initDefaultOptions=function(a){var b={mappings:{x:"date",y:"deviation",category:"metric"},bins:12,xTicks:7,xTickInterval:void 0,xUpperLimit:void 0,xLowerLimit:void 0,normalizePositive:!1,onMouseOverAnomaly:null,onMouseOutAnomaly:null,onContextMenu:null,onSelectAnomalies:null,colors:[],theme:"blueGrayGreen"};return Object.getPrototypeOf(g)._initDefaultOptions.call(this,b)},g._render=function(){this._configureAnomaly(),this._anom.layout(this._options)},g._initializeAnomaly=function(){var a=this._options,b=a.mappings,c=this;this._anom=f.anomaly();var d=f.dispatch("contextmenu","mouseoveranomaly","mouseoutanomaly","selectanomalies");d.on("contextmenu",a.onContextMenu),d.on("mouseoveranomaly",a.onMouseOverAnomaly),d.on("mouseoutanomaly",a.onMouseOutAnomaly),d.on("selectanomalies",a.onSelectAnomalies),this.selectionCache(this._anom.selectionCache()),this._anom.chart(this),this._anom.selectionCache().selectionKeymap(this.determineKeyModifiers),this._anom.on("mouseover",function(a,e,g){c._anom.nodes(function(c,d){f.select(this).transition().duration(750).style("opacity",c[b.category]===a[b.category]?.8:.2)}),d.mouseoveranomaly.call(this,a,e,g,f.event)}).on("mouseout",function(a,b,e){c._anom.nodes(function(a,b){f.select(this).transition().duration(750).style("opacity",1)}),d.mouseoutanomaly.call(this,a,b,e,f.event)}).on("contextmenu",function(a,b,c){d.contextmenu.call(this,a,b,c,f.event)}),a.enableSelection&&this._anom.on("select",function(a,b,e){c._anom.nodes(function(a,b){f.select(this).classed("selected",!1)}),a.classed("selected",!0),d.selectanomalies.call(this,a,b,e,0)}),f.rebind(this,d,"on")},g._configureAnomaly=function(){var a=this._options,c=e.util.getPercentValue(a.width,a.parent.offsetWidth),d=e.util.getPercentValue(a.height,a.parent.offsetHeight);this._anom.data(b(a.data)).parent(a.parent).mappings(a.mappings).bins(a.bins).size([c,d]).xUpperLimit(a.xUpperLimit).xLowerLimit(a.xLowerLimit).normalizePositive(a.normalizePositive).xTicks(a.xTicks,a.xTickInterval)},g._onAutoResize=function(){this.render()},g.chart=function(){return this._anom},a.cloudViz.anomaly=c.util.createConstructor(g)}(this),function(a){"use strict";d3.choroplethID=0,d3.choropleth=function(){function a(){this.type="EmptyDataException",this.message="The data is empty or null",this.toString=function(){return this.type+" - "+this.message}}function b(){this.type="ParentNotSpecifiedException",this.message="A parent was not specified for this visualization",this.toString=function(){return this.type+" - "+this.message}}var c,d,e,f,g,h,i,j,k,l,m,n,o={},p=new dv.util.SelectionCache,q=new dv.collisions.QuadtreeNode([2,2],2),r=cloudViz.util.inputFilter(".interaction-group",".zoom-container",".choro-container"),s=cloudViz.util.selectedOverlay(),t=[],u=[0,1],v=(m-n)*u[0],w=(m-n)*u[1],x=!1,y={top:0,left:0,right:0,bottom:40},z=d3.choroplethID++,A=null;return o.selectionCache=function(){return p},o.chart=function(a){return a&&(A=a),A},o.layout=function(){var c=this;if(!o.data())throw new a;if(!o.parent())throw new b;t=o.determineSize(j);var d=t[0]>t[1]?t[0]/2:t[1]/2;q=new dv.collisions.QuadtreeNode([d,d],d),q.buildTree(5),o.calcRange(),g=o.createSVGContainer(),"string"==typeof j.geoJson?d3.json(j.geoJson,function(a){c._layoutWithData.call(c,a)}):this._layoutWithData(j.geoJson)},o._layoutWithData=function(a){o.drawGeos(a),j.interactive&&o.drawTooltip(),o.drawLegend(j.theme,j.colors,a)},o.determineSize=function(a){
var b=a.parent,c=a.width?a.width:b.offsetWidth,d=a.height?a.height:b.offsetHeight;return c=c?c:700,d=d?d:450,[c,d]},o.calcRange=function(){for(var a in j.data.values)void 0===m&&(m=j.data.values[a],n=j.data.values[a]),j.data.values[a]>m&&(m=j.data.values[a]),j.data.values[a]<n&&(n=j.data.values[a])},o.drawLegend=function(a,b,d){var e=9,g=12,i=35,k=Math.min(t[0]-y.left,630)-25,l=(t[0]-y.left-k)/2,p=k-2*i-2*g,q=h.selectAll(".legend").data([c]);q.enter().append("g").classed("legend",!0),q.attr("transform","translate("+l+","+(t[1]-24)+")");var r=q.selectAll("defs").data([a]);r.enter().append("defs"),r.exit().remove();var s=r.selectAll("#defaultGradient-"+a).data([a]);s.enter().append("linearGradient").attr("id","defaultGradient-"+a),s.exit().remove();var v,w=b.length,z=[];for(v=1;v<w;v++)z[v]=(v+0)/(w-1);z[0]=0;var A=s.selectAll("stop").data(z);A.enter().append("stop").attr("class",function(a,b){return"stop"+b}),A.attr("offset",function(a){return a}).attr("stop-color",function(a,c){return b[c]});var B=q.selectAll(".grad-bg").data([c]);B.enter().append("rect").classed("grad-bg",!0),B.attr("x",i+g).attr("y",0).attr("rx",e/2).attr("ry",e/2).attr("width",p).attr("height",e);var C=q.selectAll(".grad-rect").data([c]);C.enter().append("rect").classed("grad-rect",!0),C.classed("grad-rect",!0).attr("x",i+g).attr("y",0).style("fill","url(#defaultGradient-"+a+")").attr("width",p).attr("height",e);var D=f.selectAll(".legend-label").data([n,m]);if(D.enter().append("div").attr("class",function(a,b){return"legend-label "+(b?"max":"min")}),D.style("left",function(a,b){return b?null:l+"px"}).style("right",function(a,b){return b?l+"px":null}).text(function(a,b){return j.formatFunction(b?m:n)}),j.interactive){var E=d3.svg.brush().x(d3.scale.linear().range([0,p])).extent(u).on("brushstart",function(){x=!0}).on("brushend",function(){x=!1}).on("brush",function(){u=E.extent(),h.selectAll(".grad-rect").attr("width",(u[1]-u[0])*p).attr("x",p*u[0]+i+g),o.drawGeos(d)}),F=9,G=26,H=q.selectAll(".brush").data([c]);H.enter().append("g").classed("brush",!0),H.attr("transform","translate("+(i+g)+",0)").call(E);var I=H.selectAll(".resize"),J=I.selectAll(".handle").data(function(a){return a});J.enter().append("rect").classed("handle",!0),J.attr("transform","translate("+-(F/2)+","+-F+")").attr("rx",F/3).attr("ry",F/3).attr("width",F).attr("height",G)}},o.drawTooltip=function(a){var b=null==a||null==a.value;l=f.selectAll(".tooltip").data(b?[]:[a]),l.enter().append("div").classed("tooltip",!0),l.exit().classed("visible",!1),setTimeout(function(){l.classed("visible",!0)},10);var c=l.selectAll(".tooltip-back").data([a]);c.enter().append("div").classed("tooltip-back",!0);var d=c.selectAll(".tt-name").data(function(a){return[a.name]});d.enter().append("p").classed("tt-name",!0),d.text(function(a){return a});var e=c.selectAll(".tt-value").data(function(a){return[a.value]});e.enter().append("p").classed("tt-value",!0),e.text(function(a){return j.formatFunction(a)});var g=c.selectAll(".tt-metric").data(void 0!==j.metric?[j.metric]:[]);g.enter().append("p").classed("tt-metric",!0),g.text(function(a){return a}),g.exit().remove()},o.hideTooltip=function(){o.drawTooltip({})},o.showTooltip=function(a){"value"in a&&a.value?o.drawTooltip(a):o.hideTooltip()},o.drawGeos=function(a){q.clear();var b=null,d=[],f=(Math.min(t[0],t[1]),t[0]-y.left-y.right),h=t[1]-y.top-y.bottom,l=1,p=[0,0];k=j.projection?d3.geo[j.projection]():d3.geo.equirectangular(),k.scale(l).translate(p);var B=d3.geo.path().projection(k),C=B.bounds(a);l=.95/Math.max((C[1][0]-C[0][0])/f,(C[1][1]-C[0][1])/h),p=[(f-l*(C[1][0]+C[0][0]))/2,(h-l*(C[1][1]+C[0][1]))/2];var D=l*((C[1][1]-C[0][1])/h)*h,E=l*((C[1][0]-C[0][0])/f)*f;if(k.scale(l).translate(p),B=B.projection(k),j.interactive){var F=d3.behavior.zoom();i.call(F.scaleExtent([1,4]).translate([f/2,h/2]).scale(1).on("zoom",function(){if(d3.event){var a=d3.event.translate,b=d3.event.scale,c=f/2*b,d=h/2*b,e=a[0]-c,i=a[1]-d,j=E/6,k=D/6,l=-c-j,m=f-c+j,n=-d-k,o=h-d+k;e=Math.min(e,m),e=Math.max(e,l),i=Math.min(i,o),i=Math.max(i,n),a[0]=e+c,a[1]=i+d,F.translate(a),g.attr("transform","translate("+e+","+i+") scale("+b+")"),s.select().attr("transform","translate("+e+","+i+") scale("+b+")")}})),r.interceptBrushEvents()}var G,H=j.colors.length;for(v=(m-n)*u[0]+n,w=(m-n)*u[1]+n,d[0]=0,G=1;G<H;G++)d[G]=G*(w-v)/(H-1);e.selectAll(".legend-label.min").text(function(a,b){return j.formatFunction(v)}),e.selectAll(".legend-label.max").text(function(a,b){return j.formatFunction(w)}),b=d3.scale.linear().domain(d).range(j.colors);var I=function(a){return void 0===c.values[a.properties.GEO_ID]||c.values[a.properties.GEO_ID]<v||c.values[a.properties.GEO_ID]>w?"#ddd":b(c.values[a.properties.GEO_ID])},J=function(a,b,d){if(j.interactive){if(x)return;var e=this;d3.rgb(e.style.fill);e.parentNode.appendChild(e),d3.select(this).classed("hovered",!0),o.showTooltip({name:a.properties.name,id:a.properties.GEO_ID,value:c.values[a.properties.GEO_ID]}),o._dispatch.mouseover.call(this,a,b,d,d3.event)}},K=function(a,b,c){if(j.interactive){if(x)return;var d=this;d.parentNode;d3.select(this).classed("hovered",!1),o.hideTooltip(),o._dispatch.mouseout.call(this,a,b,c,d3.event)}},L=function(a,b,c){d3.event.preventDefault(),j.interactive&&o._dispatch.contextmenu.call(this,a,b,c,d3.event)},M=function(a,b){var c=a.getBBox(),d=b.getBBox(),e=[c.x+c.width,c.y+c.height,d.x+d.width,d.y+d.height],f=new dv.collisions.rectFromMinMax(c.x>d.x?d.x:c.x,c.y>d.y?d.y:c.y,e[0]>e[2]?e[0]:e[2],e[1]>e[3]?e[1]:e[3]),g=[];return q.testRect(f,function(b,c,d){b!=a&&g.push(b)}),g},N=g.selectAll(".geo").data(a.features,function(a){return a.properties.GEO_ID});N.enter().append("path").attr("class",function(a,b,c){return"datum-"+b+" series-"+c+" geo_id-"+a.properties.GEO_ID}).classed("geo",!0).classed("selectable",!0).attr("id",function(a,b){return a.properties.GEO_ID+z}).attr("vector-effect","non-scaling-stroke").on("mousedown.choro",A.makeSelectHandler(M)).on("mouseover.choro",J).on("mouseout.choro",K).on("contextmenu",L).on("click",function(a,b,c){o._dispatch.click.call(this,a,b,c,d3.event)}),N.exit().on("mouseover.choro",null).on("mouseout.choro",null).on("contextmenu",null).on("click",null),N.attr("d",B).style("fill",I),A._options.enableSelection&&N.each(function(a,b){for(var c=dv.collisions.hullsFromGeometry(a.geometry,B.projection()),d=0;d<c.length;d++)q.insertHull(c[d],this)})},o.createSVGContainer=function(){e=d3.select(d),f=e.selectAll(".cv-choropleth").data([c]),f.enter().append("div").classed("cv-choropleth",!0),f.classed("cv-wrapper",!0),f.style("width",t[0]+"px").style("height",t[1]+"px"),h=f.selectAll("svg").data([c]),h.enter().append("svg").attr("width","100%").attr("height","100%"),h.exit().remove();var a=h.selectAll("#plotClip").data([0]);a.enter().append("clipPath").attr("id","plotClip").append("rect"),a.select("rect").attr("x",y.left).attr("y",y.top).attr("width",t[0]-y.left-y.right).attr("height",t[1]-y.top-y.bottom),h.selectAll(".container-bg").data([c]).enter().append("rect").classed("container-bg",!0).attr("width","100%").attr("height","100%").style("visible","false");r.setUpBrush(h,p,q);i=h.selectAll(".zoom-container").data([c]),i.enter().append("g").classed("zoom-container",!0).attr("clip-path","url(#plotClip)"),r.setUpBrushOverlay(h);var b=i.selectAll(".zoom-container-plot-bg").data([c]);b.enter().append("rect").classed("zoom-container-plot-bg",!0),b.attr("x",y.left).attr("y",y.top).attr("width",t[0]-y.left-y.right).attr("height",t[1]-y.top-y.bottom),p.setDeselector(b);var g=i.selectAll(".choro-container").data([c]);g.enter().append("g").classed("choro-container",!0),s=cloudViz.util.selectedOverlay(i),s.setUpSelectedOverlay(i);h.selectAll(".zoom-container").style("pointer-events","none");return g},o.selectedOverlay=function(){return s},o.data=function(a){return arguments.length?(c=a,o):c},o.parent=function(a){return arguments.length?(d=a,o):d},o.options=function(a){return arguments.length?(j=a,o):j},o},d3.choropleth.gradIdCounter=0}(),function(a){"use strict";var b=a.cloudViz||{},c=b.core||{},d=(a.dv,a.d3||{}),e=(b.dvcore,Object.create(c));e.init=function(a){return this._type="choropleth",a=a||{},this._initDefaultOptions(),this.setOptions(a),this._initChoropleth(a),this},e._initDefaultOptions=function(a){var b={geoJson:null,colors:[],theme:"sunnyDay",metric:"",projection:"equirectangular",format:"decimal",interactive:!0,enableSelection:!1};return Object.getPrototypeOf(e)._initDefaultOptions.call(this,b)},e._render=function(){this._configure(),this._choro.layout()},e._initChoropleth=function(a){var b=this;this._choro=d.choropleth(),this._choro._dispatch=this._dispatch,this._choro.chart(this),this._options.enableSelection&&(this._choro.selectionCache().selectionKeymap(this.determineKeyModifiers),this._choro.selectionCache().on("selectionChanged",function(a,c,d,e){b._choro.selectedOverlay().updateSelectedDisplay(c),b._onSelectionChanged(a,c,d,e,0)}),this.selectionCache(this._choro.selectionCache()))},e._configure=function(){var a=this,b=this._options,c=this._dataAdapter;b.formatFunction=function(c){return a._formatNumber(b.format,c)},b.metric=c.metric(),b.format=c.format(),b.data=c.data(),this._choro.data(this._options.data).parent(this._options.parent).options(this._options)},a.cloudViz.choropleth=b.util.createConstructor(e)}(this),function(a){"use strict";function b(a,b){for(var c=new Array(a[1].length||0),d=0;d<c.length;++d)c[d]=a[0]*a[1][d]+b[0]*b[1][d];return c}a.venn=function(b,c,d){d=d||{},d.distance=d.distance||0,d.maxIterations=d.maxIterations||500;var e=d.lossFunction||a.lossFunction,f=d.layoutFunction||a.greedyLayout;b=f(b,c,d.distance);for(var g=new Array(2*b.length),h=0;h<b.length;++h)g[2*h]=b[h].x,g[2*h+1]=b[h].y;var i=0,j=a.fmin(function(a){i+=1;for(var d=new Array(b.length),f=0;f<b.length;++f)d[f]={x:a[2*f],y:a[2*f+1],radius:b[f].radius,size:b[f].size};return e(d,c)},g,d),k=j.solution;for(h=0;h<b.length;++h)b[h].x=k[2*h],b[h].y=k[2*h+1];return b},a.distanceFromIntersectArea=function(b,c,d){return Math.min(b,c)*Math.min(b,c)*Math.PI<=d?Math.abs(b-c):a.bisect(function(a){return window.circleIntersection.circleOverlap(b,c,a)-d},0,b+c)},a.getDistanceMatrix=function(b,c,d){var e,f=[];for(e=0;e<b.length;++e){f.push([]);for(var g=0;g<b.length;++g)f[e].push(0)}for(e=0;e<c.length;++e){var h=c[e];if(2===h.sets.length){var i=h.sets[0],j=h.sets[1],k=Math.sqrt(b[i].size/Math.PI),l=Math.sqrt(b[j].size/Math.PI),m=d;try{m=a.distanceFromIntersectArea(k,l,h.size)+d}catch(n){console.error("Error creating distance matrix: ",n)}f[i][j]=f[j][i]=m}}return f},a.greedyLayout=function(b,c,d){function e(a,b){return b.size-a.size}function f(a){return a.set in q}function g(a,c){b[c].x=a.x,b[c].y=a.y,q[c]=!0}var h,i,j,k={};for(i=0;i<b.length;++i)k[i]=[],b[i].radius=Math.sqrt(b[i].size/Math.PI),b[i].x=b[i].y=0;for(i=0;i<c.length;++i){var l=c[i];if(2===l.sets.length){var m=l.sets[0],n=l.sets[1];k[m]&&k[n]&&(k[m].push({set:n,size:l.size}),k[n].push({set:m,size:l.size}))}}var o=[];for(h in k)if(k.hasOwnProperty(h)){var p=0;for(i=0;i<k[h].length;++i)p+=k[h][i].size;o.push({set:h,size:p})}if(!o.length)return b;o.sort(e);var q={};g({x:0,y:0},o[0].set);var r=a.getDistanceMatrix(b,c,d);for(i=1;i<o.length;++i){var s=o[i].set,t=k[s].filter(f);if(h=b[s],t.sort(e),0===t.length)throw"Need overlap information for set "+h;var u=[];for(j=0;j<t.length;++j){var v=b[t[j].set],w=r[s][t[j].set];u.push({x:v.x+w,y:v.y}),u.push({x:v.x-w,y:v.y}),u.push({y:v.y+w,x:v.x}),u.push({y:v.y-w,x:v.x});for(var x=j+1;x<t.length;++x)for(var y=b[t[x].set],z=r[s][t[x].set],A=window.circleIntersection.circleCircleIntersection({x:v.x,y:v.y,radius:w},{x:y.x,y:y.y,radius:z}),B=0;B<A.length;++B)u.push(A[B])}var C=1e50,D=u[0];for(j=0;j<u.length;++j){b[s].x=u[j].x,b[s].y=u[j].y;var E=a.lossFunction(b,c);E<C&&(C=E,D=u[j])}g(D,s)}return b},a.classicMDSLayout=function(b,c){for(var d=a.getDistanceMatrix(b,c,0),e=window.mds.classic(d),f=0;f<b.length;++f)b[f].x=e[f][0],b[f].y=e[f][1],b[f].radius=Math.sqrt(b[f].size/Math.PI);return b},a.lossFunction=function(a,b){function c(b){return b.map(function(b){return a[b]})}for(var d=0,e=0;e<b.length;++e){var f,g=b[e];if(2==g.sets.length){var h=a[g.sets[0]],i=a[g.sets[1]];f=null==h||null==i?0:window.circleIntersection.circleOverlap(h.radius,i.radius,window.circleIntersection.distance(h,i))}else f=window.circleIntersection.intersectionArea(c(g.sets));d+=(null==g.weight?1:g.weight)*(f-g.size)*(f-g.size)}return d},a.scaleSolution=function(a,b,c,d){var e=function(b){return{max:Math.max.apply(null,a.map(function(a){return a[b]+a.radius})),min:Math.min.apply(null,a.map(function(a){return a[b]-a.radius}))}};b-=2*d,c-=2*d;for(var f=e("x"),g=e("y"),h=f.max-f.min,i=g.max-g.min,j=h?b/h:0,k=i?c/i:0,l=Math.min(k,j),m=0;m<a.length;++m){var n=a[m];n.radius=l*n.radius,n.x=d+(n.x-f.min)*l,n.y=d+(n.y-g.min)*l}return a.scaling=l,a},a.bisect=function(a,b,c,d){d=d||{};var e=d.maxIterations||100,f=d.tolerance||1e-10,g=a(b),h=a(c),i=c-b;if(g*h>0)throw"initial bisect points must have opposite signs";if(0===g)return b;if(0===h)return c;for(var j=0;j<e;++j){i/=2;var k=b+i,l=a(k);if(l*g>=0&&(b=k),Math.abs(i)<f||0===l)return k}return b+i},a.fmin=function(a,c,d){d=d||{};var e=d.maxIterations||200*c.length,f=d.nonZeroDelta||1.1,g=d.zeroDelta||.001,h=d.minErrorDelta||1e-5,i=d.rho||1,j=d.chi||2,k=d.psi||-.5,l=d.sigma||.5,m=d.callback,n=c.length,o=new Array(n+1);o[0]=c,o[0].fx=a(c);for(var p=0;p<n;++p){var q=c.slice();q[p]=q[p]?q[p]*f:g,o[p+1]=q,o[p+1].fx=a(q)}for(var r=function(a,b){return a.fx-b.fx},s=0;s<e&&(o.sort(r),m&&m(o),!(Math.abs(o[0].fx-o[n].fx)<h));++s){var t=new Array(n);for(p=0;p<n;++p){t[p]=0;for(var u=0;u<n;++u)t[p]+=o[u][p];t[p]/=n}var v=o[n],w=b([1+i,t],[-i,v]);w.fx=a(w);var x=w;if(w.fx<=o[0].fx){var y=b([1+j,t],[-j,v]);y.fx=a(y),y.fx<w.fx&&(x=y)}else if(w.fx>=o[n-1].fx){var z,A=!1;if(w.fx<=v.fx?(z=b([1+k,t],[-k,v]),z.fx=a(z),z.fx<v.fx?x=z:A=!0):(z=b([1-k*i,t],[k*i,v]),z.fx=a(z),z.fx<=w.fx?x=z:A=!0),A)for(p=1;p<o.length;++p)o[p]=b([1-l,o[0]],[l-1,o[p]]),o[p].fx=a(o[p])}o[n]=x}return o.sort(r),{f:o[0].fx,solution:o[0]}},a.drawD3Diagram=function(b,c,d,e,f){f=f||{};var g=d3.scale.category10(),h=f.circleFillColours||g,i=f.circleStrokeColours||h,j=f.circleStrokeWidth||function(a){return 0},k=f.textFillColours||g,l=f.textStrokeColours||k,m=f.opacity||.3,n=f.padding||6;c=a.scaleSolution(c,d,e,n);var o=b.append("svg").attr("width",d).attr("height",e),p=o.selectAll("circle").data(c).enter().append("g");return{svg:o,nodes:p,circles:p.append("circle").attr("r",function(a){return a.radius}).style("fill-opacity",m).attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y}).style("stroke",function(a,b){return i(b)}).style("stroke-width",function(a,b){return j(b)}).style("fill",function(a,b){return h(b)}),text:p.append("text").attr("x",function(a){return a.x}).attr("y",function(a){return a.y}).attr("text-anchor","middle").style("stroke",function(a,b){return l(b)}).style("fill",function(a,b){return k(b)}).text(function(a){return a.label})}},a.updateD3Diagram=function(b,c){var d=b.select("svg"),e=parseInt(d.attr("width"),10),f=parseInt(d.attr("height"),10);c=a.scaleSolution(c,e,f,6),b.selectAll("circle").data(c).transition().duration(400).attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y}).attr("r",function(a){return a.radius}),b.selectAll("text").data(c).transition().duration(400).attr("x",function(a){return a.x}).attr("y",function(a){return a.y})}}(window.venn=window.venn||{}),function(a){"use strict";function b(b){for(var c=[],d=0;d<b.length;++d)for(var e=d+1;e<b.length;++e)for(var f=a.circleCircleIntersection(b[d],b[e]),g=0;g<f.length;++g){var h=f[g];h.parentIndex=[d,e],c.push(h)}return c}var c=1e-10;a.intersectionArea=function(d,e){var f,g=b(d),h=g.filter(function(b){return a.containedInCircles(b,d)}),i=0,j=0,k=[];if(h.length>1){var l=a.getCenter(h);for(f=0;f<h.length;++f){var m=h[f];m.angle=Math.atan2(m.x-l.x,m.y-l.y)}h.sort(function(a,b){return b.angle-a.angle});var n=h[h.length-1];for(f=0;f<h.length;++f){var o=h[f];j+=(n.x+o.x)*(o.y-n.y);for(var p={x:(o.x+n.x)/2,y:(o.y+n.y)/2},q=null,r=0;r<o.parentIndex.length;++r)if(n.parentIndex.indexOf(o.parentIndex[r])>-1){var s=d[o.parentIndex[r]],t=Math.atan2(o.x-s.x,o.y-s.y),u=Math.atan2(n.x-s.x,n.y-s.y),v=u-t;v<0&&(v+=2*Math.PI);var w=u-v/2,x=a.distance(p,{x:s.x+s.radius*Math.sin(w),y:s.y+s.radius*Math.cos(w)});(null===q||q.width>x)&&(q={circle:s,width:x,p1:o,p2:n})}k.push(q),i+=a.circleArea(q.circle.radius,q.width),n=o}}else{var y=d[0];for(f=1;f<d.length;++f)d[f].radius<y.radius&&(y=d[f]);var z=!1;for(f=0;f<d.length;++f)if(a.distance(d[f],y)>Math.abs(y.radius-d[f].radius)){z=!0;break}z?i=j=0:(i=y.radius*y.radius*Math.PI,k.push({circle:y,p1:{x:y.x,y:y.y+y.radius},p2:{x:y.x-c,y:y.y+y.radius},width:2*y.radius}))}return j/=2,e&&(e.area=i+j,e.arcArea=i,e.polygonArea=j,e.arcs=k,e.innerPoints=h,e.intersectionPoints=g),i+j},a.containedInCircles=function(b,d){for(var e=0;e<d.length;++e)if(a.distance(b,d[e])>d[e].radius+c)return!1;return!0},a.circleIntegral=function(a,b){var c=Math.sqrt(a*a-b*b);return b*c+a*a*Math.atan2(b,c)},a.circleArea=function(b,c){return a.circleIntegral(b,c-b)-a.circleIntegral(b,-b)},a.distance=function(a,b){return Math.sqrt((a.x-b.x)*(a.x-b.x)+(a.y-b.y)*(a.y-b.y))},a.circleOverlap=function(b,c,d){if(d>=b+c)return 0;if(d<=Math.abs(b-c))return Math.PI*Math.min(b,c)*Math.min(b,c);var e=b-(d*d-c*c+b*b)/(2*d),f=c-(d*d-b*b+c*c)/(2*d);return a.circleArea(b,e)+a.circleArea(c,f)},a.circleCircleIntersection=function(b,c){var d=a.distance(b,c),e=b.radius,f=c.radius;if(d>=e+f||d<=Math.abs(e-f))return[];var g=(e*e-f*f+d*d)/(2*d),h=Math.sqrt(e*e-g*g),i=b.x+g*(c.x-b.x)/d,j=b.y+g*(c.y-b.y)/d,k=-(c.y-b.y)*(h/d),l=-(c.x-b.x)*(h/d);return[{x:i+k,y:j-l},{x:i-k,y:j+l}]},a.getCenter=function(a){for(var b={x:0,y:0},c=0;c<a.length;++c)b.x+=a[c].x,b.y+=a[c].y;return b.x/=a.length,b.y/=a.length,b}}(window.circleIntersection=window.circleIntersection||{}),function(a){"use strict";var b,c=a.cloudViz||{},d=c.core||{},e=a.dv||{},f=a.d3||{},g=Object.create(d),h=0;g.init=function(a){var b=this;return this._type="venn",a=a||{},this._initDefaultOptions(),this.setOptions(a),this._cvWrapper=null,this._identity="venn-"+h++,this._seriesState=c.seriesState(),this._seriesState.on("enableChange.venn",function(a,c){b._onEnableState(c)}),a.enableSelection&&(this.selectionCache(new e.util.SelectionCache),this._selectionCache.on("selectionChanged",function(a,c,d,e){b._highlightedOverlay.updateSelectedDisplay(c),b._onSelectionChanged(a,c,d,e,0)}),this.selectionCache().selectionKeymap(this.determineKeyModifiers)),this._dvColorScale=e.scale.ordinal(),this},g._initDefaultOptions=function(a){var b={colors:[],theme:"default",legendVerticalWidth:110,duration:500,defineAudience:!0,hideOverlapInLegend:!0,legendVisible:!0,legendOrientation:"top",distance:0,tooltipContent:null,formatType:"decimal",enableSelection:!1};return this._margins={top:0,left:0,right:0,bottom:0},Object.getPrototypeOf(g)._initDefaultOptions.call(this,b)},g._render=function(a){this._id=Math.floor(1e4*Math.random());try{this._determineSize(),this._initScales(),this._draw(a)}catch(b){this.handleError(b)}},g.reset=function(){if(Object.getPrototypeOf(g).reset.apply(this,arguments),this._d3Container){[this._d3Container.selectAll(".set-hit-areas-container circles"),this._d3Container.selectAll(".filled-regions"),this._cvWrapper.selectAll(".cv-legend-entry")].forEach(function(a){a.on("mouseover",null),a.on("mouseout",null),a.on("contextmenu",null)}),f.select(this._options.parent).selectAll(".cv-wrapper.cv-venn svg").remove()}},g._draw=function(a){var b=f.select(this._options.parent),c=this._options.data;c.distance=this._options.distance,this._initSVG(),this._createStates(),this._parsedSetNotation=this._parseSetNotation(c.notation),this._overlapMap=this._createOverlapMap(c.sets,c.overlaps);var d=this._drawLegend();this._positionContainer(d);var e=this._configureSets(c),g=this._generateOverlayCombinations(e,this._parsedSetNotation);this._drawCircles(e,g,a),this._highlightedOverlay.setUpSelectedOverlay(b.selectAll(".transformed-container"));var h=this.selectionCache();h&&h.setDeselector(b.selectAll(".interaction-canvas"))},g._onAutoResize=function(){this.render()},g._determineSize=function(a){var b=this._options,c=(this._dataAdapter.data(),b.parent.getBoundingClientRect()),d=c.width,f=c.height,g=e.util.getPercentValue(b.width,d)||d,h=e.util.getPercentValue(b.height,f)||f;g=Math.floor(g-2),h=Math.floor(h-2),this.width(g),this.height(h)},g._size=[0,0],g.width=function(a){return void 0!==a?this._size[0]=Math.max(0,a):this._size[0]},g.height=function(a){return void 0!==a?this._size[1]=Math.max(0,a):this._size[1]},g._initScales=function(){this._dvColorScale.range(this._options.colors)},g._parseSetNotation=function(a){var b=[];if(!a)return b;var c,d,e=a.split("|"),f=/\d+/g,g=e.length;for(c=0;c<g;c++){d=e[c];var h,i=d.match(f),j=[],k=i.length;for(h=0;h<k;h++)j.push(+i[h]);b.push(j)}return b},g._initSVG=function(){var a=this._options,c=f.select(a.parent);this._cvWrapper=c.selectAll(".cv-wrapper.cv-venn").data([0]),this._cvWrapper.enter().append("div").classed("cv-wrapper cv-venn",!0),this._cvWrapper.style("width",this._size[0]+"px").style("height",this._size[1]+"px"),b=this._cvWrapper.selectAll(".svg-wrapper").data([0]),b.enter().append("div").classed("svg-wrapper",!0);var d=b.selectAll("svg").data([0]);d.enter().append("svg");var e=d.selectAll(".cv-venn-background").data([0]).enter().append("rect").classed("cv-venn-background",!0);this.selectionCache()&&this.selectionCache().setDeselector(e),this._d3Container=d.selectAll("g").data([0]),this._d3Container.enter().append("g").classed("transformed-container",!0).selectAll(".interaction-group").data([0]).enter().append("g").classed("interaction-group",!0).append("rect").attr("x","0").attr("y","0").attr("width",this._size[0]).attr("height",this._size[1]).classed("interaction-canvas",!0)},g._positionContainer=function(a){this.width(this._size[0]-(a.left+a.right)),this.height(this._size[1]-(a.top+a.bottom)),this._cvWrapper.select(".svg-wrapper").style({"margin-left":a.left+"px","margin-top":a.top+"px","margin-right":a.right+"px","margin-bottom":a.bottom+"px",height:this._size[1]+"px"}),this._cvWrapper.selectAll(".cv-legend").style("height",a.left||a.right?this._size[1]-1+"px":null)},g._configureSets=function(b){this._options;b=this._sanitizeOverlaps(b);var c=a.venn.scaleSolution(a.venn.venn(b.sets,b.overlaps,{distance:b.distance}),this._size[0],this._size[1],7);c.scaling=Math.max(0,c.scaling);var d,e,f=c.length;for(d=0;d<f;d++)e=c[d],e.index=d,e.radius=Math.max(0,e.radius);return c},g._combine=function(a,b,c){arguments.length<3?c=a.length-1:c--,arguments.length<2&&(b=1);for(var d=function(a,b,c,e){if(0===a)return void(c.length>0&&(e[e.length]=c));for(var f=0;f<b.length;f++)d(a-1,b.slice(f+1),c.concat([b[f]]),e)},e=[],f=b;f<=c+1;f++)d(f,a,[],e);return e},g._intersect=function(a,b){for(var c=[],d=0;d<a.length;d++)for(var e=0;e<b.length;e++)if(a[d]==b[e]){c.push(a[d]);break}return c},g._union=function(a,b){for(var c={},d=a.length-1;d>=0;--d)c[a[d]]=a[d];for(var e=b.length-1;e>=0;--e)c[b[e]]=b[e];var f=[];for(var g in c)c.hasOwnProperty(g)&&f.push(c[g]);return f.sort(function(a,b){return a-b}),f},g._generateOverlayCombinations=function(b,c){var d=this,e={},f=[],g=[];c.sort(function(a,b){return b.length-a.length}),c.forEach(function(a,b){var c=a.join("-");f=f.concat(d._combine(a,1)),f.forEach(function(b,f){var g,h=b.join("-"),i=e[h]||{};i.fill||(g=d._intersect(a,b),i.fill=g.join("-")===c),e[h]=i})});for(var h in e){var i,j=h.split("-"),k=[],l=j.length;for(i=0;i<l;i++){b[j[i]]&&k.push(b[j[i]])}var m={};k.length>1&&a.circleIntersection.intersectionArea(k,m),k.length?m.area=Math.PI*Math.pow(k[0].radius,2):m.area=0,g.push({key:h,fill:e[h].fill,area:m.area})}return g.sort(function(a,b){var c=b.area-a.area;return c?c:a.key.length-b.key.length}),g},g._sanitizeOverlaps=function(a){var b,c,d,e,f=a.sets,g=a.overlaps,h=[],i=f.length,j=g.length,k={},l=function(a,b){return+a-+b};for(d=0;d<j;d++)e=g[d],e.sets.sort(l),k[e.sets.join("-")]=e;for(b=0;b<i;b++)for(f[b],c=b+1;c<i;c++)f[c],!1,k.hasOwnProperty(b+"-"+c)&&"0"!==k[b+"-"+c].size||h.push({sets:[b,c],size:0});return a.overlaps=g.concat(h),a},g._createOverlapMap=function(a,b){var c,d,e={},f=function(a,b){return a-b},g=a.length;for(c=0;c<g;c++)d=a[c],e[c]=d.size;var h,i=b.length;for(c=0;c<i;c++)h=b[c],h.sets.sort(f),e[h.sets.join("-")]=h.size;return e},g._drawCircles=function(a,b,c){this._createClipPaths(a,b),this._drawSetFills(a,c),this._drawBorders(a,c),this._drawFilledRegions(b,c),this._drawPadding(a,c),this._makePlotFit(a)},g._drawSetHitAreas=function(a,b){var c=this,d=this._options,e=this._d3Container.selectAll(".set-hit-areas-container").data([a]);e.enter().append("g").classed("set-hit-areas-container",!0),e.exit().remove();var g=e.selectAll("circle").data(function(a){return a});g.enter().append("circle").attr("r",b?0:function(a){return Math.max(a.radius,0)}).attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y}).attr("tooltip",function(a){return a.tooltip}),g.exit().remove(),g.attr("id",function(a,b,d){return c._identity+"-circles-"+b+"-"+d}).on("mouseover",function(a,b,d){c._initTooltip(a,f.event),c._seriesState.enableStateByTypeAndId("standard",a.index,!0),c._dispatch.mouseover.call(this,a,b,d,f.event)}).on("mouseout",function(a,b,d){c._teardownTooltip(a,f.event),c._seriesState.enableStateByTypeAndId("standard",a.index,!1),c._dispatch.mouseout.call(this,a,b,d,f.event)}).on("contextmenu",c.makeContextMenuHandler(c)).on("mousedown",c.makeSelectHandler()),b&&g.transition().duration(d.duration).attr("r",function(a){return Math.max(a.radius,0)}).attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y}),this._selectionCache.markSelectable(g)},g._conditionClipPath=function(a){var b=/((-\d)*)\)$/g,c=a.match(b);return c&&(a=c[0].slice(1,-1),a=a.replace(/\"/g,"")),a},g._updateDataItemForOverlapHover=function(a,b){var c=b.split("-"),d=this._options.data.sets,e=c.map(function(a){return d[a]}),f=this._getOverlapByKey(a.key),g=this._getCenterVector(e);a.label=e.map(function(a){return a.label}).join(" & "),a.size=f.size,a.x=g.x,a.y=g.y},g._getOverlapByKey=function(a){return(this._options.data.overlaps||[]).filter(function(b){return b.sets.join("-")===a})[0]},g._getCenterVector=function(a){return a.reduce(function(b,c,d){return b.x+=c.x/a.length,b.y+=c.y/a.length,b},{x:0,y:0})},g._initTooltip=function(a,b,c){var d,f,g,h=this._cvWrapper.select(".svg-wrapper"),i=h.select("svg").node().getBBox(),j=this._options;f=j.tooltipContent?j.tooltipContent(a):this.defaultTooltipContent(a),d=this._getTooltipBounds(a,b,i),g={top:parseFloat(h.style("margin-top")),left:parseFloat(h.style("margin-left"))},d.x+=g.left,d.y+=g.top,i.x+=g.left,i.y+=g.top,e.showTooltip(d,i,f,"top",20,h)},g._getTooltipBounds=function(a,b,c){var d=f.select(this._options.parent).select(".svg-wrapper"),e=f.mouse(d.node());return{x:e[0],y:e[1],height:0,width:0}},g.defaultTooltipContent=function(a){return"<span class='series-name'>"+this.escapeHtml(a.label)+"</span><span class='metric-value'>"+this.escapeHtml(a.size)+"</span>"},g._createClipPaths=function(a,b){var c=this,d=this._cvWrapper.select("svg").selectAll("defs").data(b.length?[0]:[]);d.enter().insert("defs",":first-child"),d.exit().remove();var e=d.selectAll("clipPath").data(b);e.enter().append("clipPath"),e.exit().remove(),e.attr("id",function(a){return"clip-"+c._id+"-"+a.key});var f=e.selectAll("circle").data(function(b){if(!b.key||!b.key.length)return[];var c=b.key.split("-"),d={circleIndex:c.shift()};return c.length&&(d.maskId=c.join("-")),a&&a[d.circleIndex]?[d]:[]});f.enter().append("circle"),f.exit().remove(),f.attr("clip-path",function(a){return a.hasOwnProperty("maskId")?"url(#clip-"+c._id+"-"+a.maskId+")":null}).attr("r",function(b){return a[b.circleIndex].radius}).attr("cx",function(b){return a[b.circleIndex].x}).attr("cy",function(b){return a[b.circleIndex].y}).style("fill","#FFF")},g._drawFilledRegions=function(a,b){var c=this,d=this._options;a.sort(function(a,b){var d,e=c._getOverlapByKey(a.key)||{area:0,key:""},f=c._getOverlapByKey(b.key)||{area:0,key:""};return d=f.area-e.area,d?d:a.key.length-b.key.length});var e=this._d3Container.selectAll(".filled-regions").data(a?[a]:[]);e.enter().append("g").classed("filled-regions",!0),e.exit().remove();var g=e.selectAll(".fill-region").data(function(a){return a});g.enter().append("rect").classed("fill-region",!0),g.exit().remove(),g.attr("clip-path",function(a){return"url(#clip-"+c._id+"-"+a.key+")"}).style("opacity",d.defineAudience&&!b?1:1e-6).attr("width",c._size[0]).attr("height",c._size[1]).attr("id",function(a,b,d){return c._identity+"-regions-"+b+"-"+d}).classed("overlay",function(a){return a.fill}).on("mouseover",function(a,b,e){var g=f.select(f.event.target).attr("clip-path")||"";g=c._conditionClipPath(g),g&&c._updateDataItemForOverlapHover(a,g),c._initTooltip(a,f.event),c._seriesState.enableStateByTypeAndId("overlap",d.defineAudience?"audience":a.key,!0),c._dispatch.mouseover.call(this,a,b,e,f.event)}).on("mouseout",function(a,b,e){c._teardownTooltip(a,f.event),c._seriesState.enableStateByTypeAndId("overlap",d.defineAudience?"audience":a.key,!1),c._dispatch.mouseout.call(this,a,b,e,f.event)}).on("contextmenu",c.makeContextMenuHandler(c)).on("mousedown",c.makeSelectHandler()),this.selectionCache()&&this.selectionCache().markSelectable(g),d.defineAudience&&g.transition().delay(d.duration).duration(d.duration).style("opacity",1)},g._drawPadding=function(a,b){function c(a){return a.radius}var d=this._options,e=this._d3Container.selectAll(".padding-container").data([a]);e.enter().append("g").classed("padding-container",!0),e.exit().remove();var f=e.selectAll("circle").data(function(a){return a});f.enter().append("circle").attr("r",b?0:c).attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y}),f.exit().remove(),b&&f.transition().duration(d.duration).attr("r",c).attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y})},g._drawSetFills=function(a,b){var c=this,d=this._options,e=this._d3Container.selectAll(".set-fills-container").data([a]);e.enter().append("g").classed("set-fills-container",!0),e.exit().remove();var g=e.selectAll("circle").data(function(a){return a});g.enter().append("circle").attr("r",b?0:function(a){return Math.max(a.radius,0)}).attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y}),g.exit().remove(),g.attr("id",function(a,b,d){return c._identity+"-circles-"+b+"-"+d}).on("mouseover",function(a,b,d){c._initTooltip(a,f.event),c._seriesState.enableStateByTypeAndId("standard",a.index,!0),c._dispatch.mouseover.call(this,a,b,d,f.event)}).on("mouseout",function(a,b,d){c._teardownTooltip(a,f.event),c._seriesState.enableStateByTypeAndId("standard",a.index,!1),c._dispatch.mouseout.call(this,a,b,d,f.event)}).on("contextmenu",c.makeContextMenuHandler(c)).on("mousedown",c.makeSelectHandler()).style("fill",function(a,b){return c._dvColorScale.mapValue(b)}),b&&g.transition().duration(d.duration).attr("r",function(a){return Math.max(a.radius,0)}).attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y}),this.selectionCache()&&this.selectionCache().markSelectable(g)},g._drawBorders=function(a,b){function c(a){return Math.max(0,a.radius-1)}var d=this,e=this._options,f=this._d3Container.selectAll(".border-container").data([a]);f.enter().append("g").classed("border-container",!0),f.exit().remove();var g=f.selectAll("circle").data(function(a){return a});g.enter().append("circle").attr("r",b?0:c).attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y}),g.exit().remove(),g.style("stroke",function(a,b){return d._dvColorScale.mapValue(b)}).classed("predicted",function(a){return a.predicted}),b&&g.transition().duration(e.duration).attr("r",c).attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y})},g._createStates=function(){var a=this._options,b=a.data.sets,c=this._seriesState,d=b.map(function(a){
return a.label});if("data"in this._changedOptions&&this._changedOptions.data){c.removeStatesByType("standard"),c.removeStatesByType("overlap"),a.defineAudience&&c.appendState(this._dataAdapter.l10n.labels.venn.definedAudience,"audience","overlap",!1,!1);var e,f,g=b.length,h=[];for(e=0;e<g;e++)f=b[e],h.push(e),c.appendState(f.label||e,e,"standard",!1);a.defineAudience||a.data.notation&&a.data.notation.split("|").forEach(function(b){var e=b.split("&").map(function(a){return parseInt(a,10)}),f=e.map(function(a){return d[a]}),g=!!a.hideOverlapInLegend;c.appendState(f.join(" & "),b.replace(/\&/g,"-"),"overlap",!1,g)}),this._dvColorScale.domain(h)}},g._drawLegend=function(){var a=this._options,b=this,d=a.legendOrientation;if(a.legendVisible===!1||a.normalized)return this._legend&&(this._legend.destroy(),this._legend=void 0),{left:0,bottom:0,right:0,top:0};this._legend||(this._legend=c.interactiveLegend()),this._legend.parent(this._cvWrapper.node()).orientation(d).chartWidth(this._size[0]).chartHeight(this._size[1]).chartPadding({left:0,top:0,right:0,bottom:0}).validOrientations(["top","left","bottom","right"]).legendVerticalWidth(a.legendVerticalWidth).type("bar").seriesState(this._seriesState).interactive(!1).values(this._calculateValues(this._options.data.sets,this._overlapMap,this._parsedSetNotation))._render(null,{fill:[this._dvColorScale]});var e=this._legend._getUsedWidth(),f=this._legend._getUsedHeight(),g=0!==f,h=this._cvWrapper.selectAll(".cv-legend-entry").on("mouseover",function(a){b._seriesState.enableStateByTypeAndId(a.type,a.id,!0)}).on("mouseout",function(a){b._seriesState.enableStateByTypeAndId(a.type,a.id,!1)});if(g){var i=this._seriesState.getVisibleStateObjects(),j=Math.max(i.length,1),k=b._size[0]/j;h.style("width",function(a,b){return k+"px"})}var l=g||"right"==d?0:e,m=g||"right"!=d?0:e,n=g&&"bottom"!=d?f:0;return{left:l,bottom:g&&"bottom"==d?f:0,right:m,top:n}},g._onEnableState=function(a){this._cvWrapper.selectAll(".set-fills-container circle").style("fill-opacity",function(b,c){return"standard"===a.type&&a.id===c&&a.enabled?"0.5":"0.2"}),"overlap"===a.type&&this._cvWrapper.selectAll(".set-fills-container circle").style("fill-opacity",function(b,c){return a.enabled?"0.1":"0.2"}),this._cvWrapper.selectAll(".border-container circle").style("stroke-width",function(b,c){return"standard"===a.type&&a.id===c&&a.enabled?"2":"1"}),this._options.defineAudience?this._cvWrapper.selectAll(".filled-regions rect").classed("muted",function(b,c){return"standard"===a.type&&a.enabled}):this._cvWrapper.selectAll(".fill-region.overlay").style("opacity",function(b,c){return b.key===a.id&&a.enabled?".75":"0"});var b;if(!this._options.defineAudience&&this._options.hideOverlapInLegend){var c=a.id.toString().split("-").map(function(a){return parseInt(a,10)});b=function(b){return a.enabled&&c.indexOf(b.id)==-1}}else b=function(b){return a.enabled&&(b.id!==a.id||b.type!==a.type)};this._cvWrapper.selectAll(".cv-legend-entry").classed("inactive",b)},g._calculateValues=function(a,b,c){var d,e=this._options,f=[],g=e.formatType;e.defineAudience&&f.push(this._formatNumber(g,this._calculateHighlightedValue(a,b,c,null,{isLegend:!0})));for(d in b)f.push(this._formatNumber(g,b[d],null,{dataItem:d,isLegend:!0}));return f},g._calculateHighlightedValue=function(a,b,c){var d=function(a,c,e,f){var g,h,i=this._combine(c,f,f),j=i.length,k=f%2?1:-1;for(g=0;g<j;g++){h=i[g];var l,m,n,o=h.length,p=[];for(l=0;l<o;l++)m=h[l],p=this._union(a[m],p);n=p.join("-"),e+=(b.hasOwnProperty(n)?b[n]:0)*k}return f++,f<=a.length&&(e=d.call(this,a,c,e,f)),e},e=function(a){var b,c=[];for(b=0;b<a;b++)c.push(b);return c};return d.call(this,c,e(c.length),0,1)},g._makePlotFit=function(a){var b=(this._options,{x:0,y:0}),c=0,d=0,e=4;a.forEach(function(a){c=Math.max(c,a.x+a.radius),d=Math.max(d,a.y+a.radius)}),this._size[0]-c>this._size[1]-d?b.x=(this._size[0]-c)/2-e:b.y=(this._size[1]-d)/2-e,this._cvWrapper.select("g").attr("transform","translate("+b.x+","+b.y+")")},a.cloudViz.venn=c.util.createConstructor(g)}(this),function(a){"use strict";var b=0,c=a.cloudViz||{},d=c.core||{},e=a.dv||{},f=a.d3||{},g=Object.create(d);g.init=function(a){if(this._type="sunburst",this._hiddenNodes=[],this._outRangeNodes=[],this._invalidNodes=[],this._initDefaultOptions(),this.setOptions(a),this.chartId="sunburst-"+b++,a.enableSelection){this.selectionCache(new e.util.SelectionCache);var c=this;this._selectionCache.on("selectionChanged",function(a,b,d,e){c._highlightedOverlay.updateSelectedDisplay(b),c._onSelectionChanged(a,b,d,e,0)})}return this},g._initDefaultOptions=function(){var a={otherColor:"#ccc",otherGrayColor:"#999",outRangeColor:"#5a5a5a",metricColor:"#fff",seqColors:["#faf0c8","#d2dc73","#5faf69","#00505A"],seqColorsHeat:["#5a6eaa","#3287d2","#3cb5a0","#5faf69","#8cc350","#c3d250","#f5c841","#f0a01e","#eb782d","#fa5a50"],colors:[],theme:"specialDefault",padding:{top:10,bottom:60,left:10,right:10},customEvents:["metric","select","zoom","hidden"],selectActions:[],hiddenItems:[],selectedItem:null,zoomedItem:null,secondaryMetricIndex:null,secondaryMetricType:null,enableSelection:!1};return Object.getPrototypeOf(g)._initDefaultOptions.call(this,a)},g._onAutoResize=function(){this.resize()},g.resize=function(){f.select(this._options.parent).selectAll(".sunburst-cv").node()&&(this._sizeChart(),this._render(!0))},g.reset=function(){Object.getPrototypeOf(g).reset.apply(this,arguments)},g._preRender=function(){if(this._paths){var a,b,c=this._oldKeys=this._dataAdapter.getDataByPathKey();for(a in c)b=c[a],c[a]={xo:b.x,dxo:b.dx,yo:b.y,dyo:b.dy}}Object.getPrototypeOf(g)._preRender.apply(this);var d=this._options,e=this,h=this._dataAdapter,i=h.l10n.labels.sunburst,j=f.select(d.parent);d.secondaryMetricIndex&&h.setSecondaryMetricIndex(d.secondaryMetricIndex),d.secondaryMetricType&&h.setSecondaryMetricType(d.secondaryMetricType),d.selectActions&&(this._customActions=d.selectActions),h.getSecondaryMetricIndex()&&e._hideNode(h.data(),e._invalidNodes,function(a){return e._isInvalidNode(a)});var k=d.hiddenItems||[];k=k.length?k:this._hiddenNodes,this._setHiddenNodes(k),this._setZoomPath(d.zoomedItem||this._zoomedPath),this._setSelectedNode(d.selectedItem||this._lockedNode,!0);var l=j.selectAll(".sunburst-cv").data([0]);l.enter().insert("div",":first-child").classed("sunburst-cv",!0);var m=l.selectAll(".sunburst-cv-wrapper").data([0]);m.enter().insert("div",":first-child").classed("sunburst-cv-wrapper",!0);var n=m.selectAll(".sunburst-cv-container").data([0]);n.enter().insert("div",":first-child").classed("sunburst-cv-container",!0);var o=n.selectAll(".sunburst-svg").data([0]);o.enter().append("svg").classed("sunburst-svg",!0);var p=o.selectAll(".sunburst-svg-container").data([0]);p.enter().append("g").classed("sunburst-svg-container",!0),p.selectAll(".sunburst-path-container").data([0]).enter().append("g").classed("sunburst-path-container",!0);var q=m.selectAll(".sunburst-cv-label").data([0]);q.enter().append("div").classed("sunburst-cv-label",!0);var r=q.selectAll(".sunburst-cv-label-wrap").data([0]);r.enter().append("div").classed("sunburst-cv-label-wrap",!0),r.selectAll(".sunburst-cv-label-metric").data([0]).enter().append("div").classed("sunburst-cv-label-metric",!0);var s=r.selectAll(".sunburst-audiences").data([0]);s.enter().append("div").classed("sunburst-audiences",!0),s.exit().remove(),e._highlightedOverlay.setUpSelectedOverlay(p);var t=l.selectAll(".sunburst-cv-actions-pane").data([0]);t.enter().append("div").classed("sunburst-cv-actions-pane",!0),t.exit().remove();var u=t.selectAll(".actions-pane-zoomout").data([0]);u.enter().append("div").classed("actions-pane-zoomout",!0).classed("actions-pane-action",!0),u.html('<i class="icon zoomout"></i><span>'+g.escapeHtml(i.zoomout)+"</span>"),u.on("click",function(){e._zoomPath(h.data())}),u.exit().remove();var v=t.selectAll(".actions-pane-hidden").data([0]);v.enter().append("div").classed("actions-pane-hidden",!0).classed("actions-pane-action",!0),v.html('<i class="icon hide"></i><span>'+g.escapeHtml(e._hideLabelText())+"</span>"),v.on("click",function(){e._unhidePaths()}),v.exit().remove();var w=m.selectAll(".sunburst-cv-sec-viz").data([0]),x=w.enter().append("div").classed("sunburst-cv-sec-viz",!0);x.append("span").classed("title",!0);var y=x.append("span").classed("bar",!0);y.append("span").classed("button",!0).classed("color",!0).append("span"),y.append("span").classed("button",!0).classed("height",!0).append("span"),y.append("span").classed("button",!0).classed("both",!0).append("span"),w.selectAll(".button.color").on("click",function(){h.setSecondaryMetricType("color"),e._secondaryMetricChanged()}).selectAll("span").html(i.color),w.selectAll(".button.height").on("click",function(){h.setSecondaryMetricType("height"),e._secondaryMetricChanged()}).selectAll("span").html(i.height),w.selectAll(".button.both").on("click",function(){h.setSecondaryMetricType("both"),e._secondaryMetricChanged()}).selectAll("span").html(i.both),w.exit().remove();var z=m.selectAll(".sunburst-cv-secondary").data([0]);z.enter().append("div").classed("sunburst-cv-secondary",!0),z.exit().remove();var A=z.selectAll(".sunburst-cv-color").data([0]);A.enter().append("div").classed("sunburst-cv-color",!0),A.exit().remove();var B=l.selectAll(".sunburst-cv-info-pane").data([0]);B.enter().append("div").classed("sunburst-cv-info-pane",!0),B.exit().remove();var C=B.selectAll(".info-pane-content").data([0]);C.enter().append("div").classed("info-pane-content",!0),C.exit().remove();var D=C.selectAll(".info-pane-categories").data([0]);D.enter().append("div").classed("info-pane-categories",!0).append("div").classed("pane-title",!0).append("span"),D.exit().remove();var E=C.selectAll(".sunburst-audiences").data([0]);E.enter().append("div").classed("sunburst-audiences",!0).append("div").classed("pane-title",!0).append("span").text(i.audience),E.exit().remove();var F=C.selectAll(".info-pane-actions").data([0]);F.enter().append("div").classed("info-pane-actions",!0),F.exit().remove();var G=C.selectAll(".info-pane-metrics").data([0]),H=G.enter().append("div").classed("info-pane-metrics",!0);H.append("div").classed("pane-title",!0).classed("pri-metric",!0).append("span"),H.append("div").classed("info-pane-metrics-labels",!0).classed("pri-metric-labels",!0),H.append("div").classed("pane-title",!0).classed("sec-metric",!0).append("span"),H.append("div").classed("info-pane-metrics-labels",!0).classed("sec-metrics-labels",!0).append("span").classed("sec-metrics-help",!0),H.append("div").classed("pane-title",!0).classed("rank-chart",!0).append("span"),H.append("div").classed("info-pane-metrics-chart",!0),G.exit().remove();var I=C.selectAll(".info-pane-extra").data([0]);I.enter().append("div").classed("info-pane-extra",!0),I.exit().remove();var J=l.selectAll(".sunburst-cv-mobile-scroll").data([0]);J.enter().append("div").classed("sunburst-cv-mobile-scroll",!0),J.html(i.mobilescroll),J.exit().remove(),this._sizeChart(),l.classed("hiddenpaths",!!this._hiddenNodes.length)},g._render=function(a){Object.getPrototypeOf(g)._render.apply(this);var b=this._options,c=this._dataAdapter,d=c.data(),e=f.select(b.parent).selectAll(".sunburst-cv"),h=e.selectAll(".sunburst-cv-container"),i=h.selectAll(".sunburst-svg-container"),j=parseInt(h.style("width"),10),k=parseInt(h.style("height"),10),l=this._radius=Math.min(j,k)/2,m=this._isMobileSize(),n=d.categories.length+1,o=this._ringDivisor=1/n,p=m?20:140,q=this._centerRadius=Math.ceil(p/2/Math.cos(Math.PI/4));i.attr("transform","translate("+j/2+","+k/2+")"),!a&&this._yScale&&(this._oldYScale=this._yScale),!a&&this._xScale&&(this._oldXScale=this._xScale);var r=this._xScale=f.scale.linear().domain(this._oldXScale?this._oldXScale.domain():[0,1]).range([0,2*Math.PI]),s=this._yScale=f.scale.linear().domain([0,o,1]).range([0,q,l]);this._arc=f.svg.arc().startAngle(function(a){return Math.max(0,Math.min(2*Math.PI,r(a.x)))}).endAngle(function(a){return Math.max(0,Math.min(2*Math.PI,r(a.x+a.dx)))}).innerRadius(function(a){return Math.max(0,s(a.y))}).outerRadius(function(a){return Math.max(0,s(a.y+a.dy))});this._layoutPaths(a);var t=f.select(b.parent).select(".sunburst-cv-label"),u=Math.ceil(q*Math.cos(Math.PI/4)*2),v=u,w=b.padding.top+Math.floor(k/2-v/2),x=b.padding.left+Math.floor(j/2-u/2);m?t.style("top","").style("left","").style("width","").style("height",""):t.style("top",w+"px").style("left",x+"px").style("width",u+"px").style("height",v+"px"),this._updateDetails(this._lockedNode),c.isDataEmpty()?this._setErrorMessage(c.l10n.labels.core.nodata):c.isSizeEmpty()?this._setErrorMessage(c.l10n.labels.sunburst.emptyFirstMetric):this._clearErrorMessage()},g._getHiddenNodes=function(){return this._hiddenNodes.concat(this._outRangeNodes,this._invalidNodes)},g._adjustDataSize=function(a,b,c){var d=(this._options,this),e=this._dataAdapter,g=a.depth-1,h=this._zoomedPath,i=e.getStackedMetricIndex();if(g>=0&&a.metrics&&a.metrics[i]){a.y-=b;var j=a.metrics[i].value,k=c[g],l=k.max,m=Math.min(0,k.min),n=f.scale.linear().domain([m,l]).range([.15,1]),o=n(j)*a.dy;(l===m||h&&h.depth>a.depth)&&(o=a.dy),b+=a.dy-o,a.dy=o}a.children&&a.children.length&&a.children.forEach(function(a){d._adjustDataSize(a,b,c)})},g._getLevelUniqueNodes=function(a,b,c){function d(a){if(!h||h.depth!==a.depth||h===a){if(a.depth===b){if(!c&&e.indexOf(a)>=0)return;if(g.indexOf(a.name)>=0)return;return f.push(a),void g.push(a.name)}a.children&&a.children.length&&a.children.forEach(function(a){d(a)})}}var e=(this._dataAdapter,this._getHiddenNodes()),f=[],g=[],h=this._zoomedPath;return d(a),f||[]},g._layoutPaths=function(a){var b=this._options,c=(this._arc,this),d=this._dataAdapter,g=d.data(),h=this._getHiddenNodes(),i=f.select(b.parent).selectAll(".sunburst-path-container"),j=f.layout.partition().value(function(a){return h.indexOf(a)<0?a.size:0}).sort(function(a,b){return d.isOther(a)?1:d.isOther(b)?-1:b.size-a.size});a&&c._paths&&c._paths.each(function(a){a.xo=a.x,a.dxo=a.dx,a.yo=a.y,a.dyo=a.dy});var k=j.nodes(g),l=this._paths=i.selectAll("path").data(k,d.getPathKey);l.enter().insert("path",":first-child"),l.attr("id",function(a,b,d){return c.chartId+"-"+a._sid}).attr("class",function(a,b,c){return"datum-"+a._sid}).attr("data-sid",function(a,b){return a._sid}).on("contextmenu",c.makeContextMenuHandler(c)).on("mousedown",c.makeSelectHandler()).on("click",function(a,b){e.util.determineKeyModifiers(f.event,c._selectionCache.selectionKeymap())||c._lockNode({data:a,type:"path"})}).on("dblclick",function(a,b){e.util.determineKeyModifiers(f.event,c._selectionCache.selectionKeymap())||c._zoomPath(a)}).on("mouseenter",function(a,b){c._lockedNode||c._isTouch()||c._highlightNode({data:a,type:"path"})});var m=l.exit().classed("removing",!0);setTimeout(function(){m.remove()},501),c.setColorScale(),this._updatePathColors(),c._buildColorSlider(),this._updateSecondaryMetricClasses();if(d.getStackedMetric()){var n,o=d.getStackedMetricIndex(),p=(this._zoomedPath,!1);if(p){var q=c.getMetricCategoryMinMax(o);n=Array.apply(null,new Array(g.categories.length)).map(function(){return q})}else n=g.categories.map(function(a,b){return c.getMetricCategoryMinMax(o,b)});c._adjustDataSize(g,0,n)}if(this._oldKeys){var r,s,t=this._oldYScale,u=t.domain(),v=this._yScale,w=v.domain();c._paths.each(function(a){r=d.getPathKey(a),(s=c._oldKeys[r])&&(a.xo=s.xo,a.dxo=s.dxo,a.yo=v.invert(t(s.yo)),d.isRoot(a)?a.dyo=v.invert(t(s.dyo)):a.dyo=v.invert(t(u[1]+s.dyo))-w[1])}),this._oldKeys=null}l.each(function(a){d.getPathKey(a);void 0===a.xo&&(a.xo=a.x,a.dxo=a.dx,a.yo=0,a.dyo=0)}),l.transition().duration(500).attrTween("d",this._changeTween(!0)),i.on("mouseleave",function(a,b){c._lockedNode||c._isTouch()||c._unhighlightNode()}),a||(this._oldLockedNode?this._lockNode(this._oldLockedNode):this._unlockNode(),this._oldLockedNode=null,this._updateZoomPathStyles(this._oldZoomed),this._oldZoomed=null)},g._isMobileSize=function(){var a=this._options,b=a.parent.offsetWidth;return e.util.getPercentValue(a.width,b)<640},g._isTouch=function(){return"ontouchstart"in document.documentElement},g._postRender=function(){Object.getPrototypeOf(g)._postRender.apply(this)},g._sizeChart=function(a){var b=this._options,c=(this._dataAdapter.data(),f.select(b.parent)),d=c.selectAll(".sunburst-cv"),g=d.selectAll(".sunburst-cv-wrapper"),h=g.selectAll(".sunburst-cv-container"),i=(d.selectAll(".sunburst-cv-info-pane"),d.selectAll(".sunburst-cv-mobile-scroll")),j=b.parent.offsetWidth,k=b.parent.offsetHeight,l=e.util.getPercentValue(b.width,j),m=e.util.getPercentValue(b.height,k),n=this._isMobileSize(),o=l+(n?0:-250),p=n?Math.min(o,m):m,q=b.padding,r=o-2-(q.left+q.right),s=p-2-(q.top+q.bottom);d.style("width",l+"px").style("height",m+"px").classed("is-desktop",!n).classed("not-touch",!this._isTouch()),g.style("width",o+"px").style("height",p+"px"),h.style("width",r+"px").style("height",s+"px"),h.style("padding-top",q.top+"px").style("padding-left",q.left+"px"),i.style("top",m-30+"px").classed("visible",!d.node().scrollTop).classed("show",m<=p+130),d.on("scroll",function(){i.classed("visible",!d.node().scrollTop)})},g._buildColorSlider=function(){var a=this._options,b=this,c=this._dataAdapter,d=f.select(a.parent).selectAll(".sunburst-cv-color");if(!c.getColorMetric())return d.text("");var e=(c.data(),c.getColorMetric()),g=(this._colorExtent,b._colorExtentMin),h=b._colorExtentMax,i=f.select(a.parent).selectAll(".sunburst-cv-container"),j=parseInt(i.style("width"),10),k=j/2,l=c.seqColors(),m=Math.round(100/(l.length-1)),n=[],o=12,p=10,q=9,r=40,s=o+2*p+2,t=k,u=t-2*r-2*q;l.forEach(function(a,b){n.push(b*m+"%")}),d.style("width",t+"px");var v=d.selectAll(".legend-title").data([0]);v.enter().insert("div",":first-child").classed("legend-title",!0),v.text(e.name);var w=d.selectAll(".color-slider-legend").data([0]);w.enter().append("div").classed("color-slider-legend",!0),w.style("width",t+"px").style("height",s+"px");var x=w.selectAll(".color-slider").data([0]);x.enter().append("svg").classed("color-slider",!0).style("height",s+"px").style("width","100%");var y=x.selectAll("style").data([0]);y.enter().append("style"),y.text(function(a){return".sunburst-cv .sunburst-cv-color .grad-rect { fill: url(#backGradient); \n"});var z=x.selectAll("defs").data([0]);z.enter().append("defs");var A=z.selectAll("#backGradient").data([0]);A.enter().append("linearGradient").attr("id","backGradient"),function(a,b,c){var d=a.selectAll("stop").data(b);d.enter().append("stop").attr("class",function(a,b){return"stop"+b}),d.attr("offset",function(a){return a}).attr("stop-color",function(a,b){return c[b]})}(A,n,l);var B=x.selectAll(".grad-rect").data([0]);B.enter().append("rect").classed("grad-rect",!0),B.attr("x",r+q).attr("y",p).attr("rx",o/2).attr("ry",o/2).attr("width",u).attr("height",o);var C=w.selectAll(".legend-label").data(["min","max"]);C.enter().append("div").attr("class",function(a){return"legend-label "+a}),C.style("left",function(a){return("min"===a?0:r+2*q+u)+"px"}).style("width",r+"px").text(function(a){var c="min"===a?g:h;return c=null===c?"min"===a?"-":"+":b._formatNumber(e.format,c,null,{dataItem:a})})},g._isNodeOutsideRange=function(a){var b=(this._dataAdapter,this);return!(a.children||[]).some(function(a){return!b._isNodeOutsideRange(a)})&&this.isOutsideRange(a)},g._isInvalidNode=function(a){return this._dataAdapter.isOther(a)},g._getDataNode=function(a){if(!a)return null;var b=this._dataAdapter;return"object"==typeof a&&(a=b.getPathKey(a)),b.getDataByPathKey()[a]||null},g._getCategoryObj=function(a){return a?this._dataAdapter.getCategoryByName(a):null},g._hideLabelText=function(){var a=this._hiddenNodes.length,b=this._dataAdapter.l10n.labels.sunburst;return(1===a?b.hidden:b["hidden2+"]).replace(/\{value\}/i,a)},g._hideNode=function(a,b,c){var d=this;b.indexOf(a)>-1||((c&&c(a)||!c)&&b.push(a),a.children&&a.children.length&&a.children.forEach(function(a){d._hideNode(a,b,c)}))},g._hidePath=function(a,b,c){this._hideNode(a,b,c),this._hidePathRender(b)},g._hidePathRender=function(a){var b=this._options,c=this._dataAdapter;this._layoutPaths(!0),this._updateHiddenState(this._hiddenNodes),this._lockedNode&&a.indexOf(this._lockedNode.data)>-1&&this._unlockNode(),this._zoomedPath&&a.indexOf(this._zoomedPath)>-1&&this._zoomPath(c.data());var d=this._hiddenNodes.length,e=f.select(b.parent);e.selectAll(".actions-pane-hidden").selectAll("span").html(this._hideLabelText()),e.selectAll(".sunburst-cv").classed("hiddenpaths",!!d)},g._setHiddenNodes=function(a){a=[].concat(a||[]);var b=this;this._hiddenNodes=[],a.forEach(function(a){(a=b._getDataNode(a))&&b._hideNode(a,b._hiddenNodes)})},g._unhidePaths=function(){this._hiddenNodes=[],this._layoutPaths(!0),this._updateHiddenState(this._hiddenNodes),f.select(this._options.parent).selectAll(".sunburst-cv").classed("hiddenpaths",!1)},g._zoomPath=function(a){this._canZoomIn(a)&&(this._zoomedPath=a,this._zoomPathRender())},g._zoomPathRender=function(){this._layoutPaths(!0),this._updateZoomPathStyles(this._zoomedPath),this._updateZoomedState(this._zoomedPath),this._updateDetails(this._lockedNode)},g._setZoomPath=function(a){this._zoomedPath=null;var b=this._getDataNode(a);b&&this._canZoomIn(b)&&(this._zoomedPath=this._oldZoomed=b)},g._updateZoomPathStyles=function(a){var b=this,c=f.select(this._options.parent).selectAll(".sunburst-cv");c.classed("zoomed",a&&a.depth>0),c.selectAll(".sunburst-cv-container").selectAll("path").each(function(c){f.select(this).classed("beyondzoom",c&&a&&c!==a&&c.depth>0&&(c.depth<=a.depth||!b._hasAncestorNode(c,a))),f.select(this).classed("zoomed",c===a)})},g._changeTween=function(a){var b=this._xScale,c=this._yScale,d=this._zoomedPath||this._dataAdapter.data(),e=this._arc,g=this._radius,h=this._ringDivisor,i=this._centerRadius,j=(this._dataAdapter.categories(),f.interpolate(b.domain(),[d.x,d.x+d.dx])),k=f.interpolate(c.domain(),d.y?[0,h,d.y,1]:[0,h,1]),l=f.interpolate(c.range(),d.y?[0,i,i,g]:[0,i,g]);return function(d,g){var h=f.interpolate({x:d.xo,dx:d.dxo,y:d.yo,dy:d.dyo},d);return g?function(b){return e(a?h(b):d)}:function(f){return b.domain(j(f)),c.domain(k(f)).range(l(f)),e(a?h(f):d)}}},g._updatePathColors=function(){var a=this,b=(this._dataAdapter,this._getHiddenNodes()),c=f.select(this._options.parent).selectAll(".sunburst-cv"),d=c.classed("node-highlighted");this._paths.style("fill",function(b){var c=f.select(this),e=d&&!c.classed("highlighted");return a.getNodeColor(b,e)}).classed("hidden",function(a){return b.indexOf(a)>=0})},g._lockNode=function(a){var b=this,c=b._lockedNode;if(c&&c.data===a.data&&c.type===a.type)return b._unlockNode(a);b._lockedNode=a,b._highlightNode(a),b._updateLockedState(a),setTimeout(function(){f.select(b._options.parent).select(".sunburst-cv-wrapper").on("click.cvpath",function(){f.event&&f.event.target&&"path"===f.event.target.nodeName||b._unlockNode()})},10)},g._setSelectedNode=function(a,b){this._lockedNode=null;var c=this._determineSelectedNode(a);if(!c)return void(b||this._unlockNode());b?this._oldLockedNode=c:this._lockNode(c)},g._determineSelectedNode=function(a){if(!a)return null;var b=null;if(a.type)return"path"===a.type&&(a.data=this._getDataNode(a.data),a.data&&(b=a)),"category"===a.type&&a.data&&a.data.name&&(b=this._dataAdapter.getCategoryByName(a.data.name)),b;var c;return(c=this._getCategoryObj(a))?{data:c,type:"category"}:(c=this._getDataNode(a),c?{data:c,type:"path"}:void 0)},g._unlockNode=function(a){var b=this;b._lockedNode=null,b._updateLockedState(),a&&!b._isTouch()?b._highlightNode(a):b._unhighlightNode(),f.select(b._options.parent).select(".sunburst-cv-container").on("click.cvpath",null)},g._highlightNode=function(a){var b=this,c=a&&a.type||"path",d=a&&a.data||null,e=this._getAncestorNodes(d),g={};g.category=function(a){return a.depth===d.index+1},g.item=function(a){return a&&d&&a.name===d.name},g.path=function(a){return e.indexOf(a)>=0||b._lockedNode&&a.parent===d};var h=f.select(this._options.parent).selectAll(".sunburst-cv");h.classed("node-highlighted",!0),h.selectAll(".sunburst-cv-container").selectAll("path").each(function(a){f.select(this).classed("highlighted",g[c](a))}),b._lockedNode||h.selectAll(".info-pane-category").each(function(a){f.select(this).classed("disabled","category"===c&&a!==d)}),this._updateDetails(a),this._updatePathColors()},g._unhighlightNode=function(){this._removeHighlights(),this._updateDetails()},g._removeHighlights=function(){var a=f.select(this._options.parent);a.selectAll(".sunburst-cv").classed("node-highlighted",!1).selectAll("path").classed("highlighted",!1),a.selectAll(".info-pane-category").classed("disabled",!1),this._updatePathColors()},g._secondaryMetricChanged=function(){var a=this,b=this._dataAdapter,c=b.getSecondaryMetricIndex();a._outRangeNodes=[],c?a._hidePath(b.data(),a._invalidNodes,function(b){return a._isInvalidNode(b)}):(a._invalidNodes=[],a._layoutPaths(!0)),this._updateDetails(this._lockedNode),this._updateMetricState()},g._updateSecondaryMetricClasses=function(){var a=this._dataAdapter,b=a.l10n.labels.sunburst,c=a.getSecondaryMetricIndex(),d=f.select(this._options.parent);d.selectAll(".sunburst-cv").classed("secondary-metric",!!c);var e=d.selectAll(".sunburst-cv-sec-viz");e.selectAll(".button").classed("active",!1);var g=a.getSecondaryMetricType();g&&e.selectAll(".button."+g).classed("active",!0);var h=a.getSecondaryMetric(),i=h&&h.name||null;e.selectAll(".title").html(i?b.mapmetric.replace(/\{metric\}/i,i):"")},g._updateDetails=function(a){a&&"item"===a.type||(this._setChartMetrics(a),this._setDetailsMetrics(a),this._setDetailsAudiences(a),this._setDetailsCategories(a),this._setDetailsActions(a))},g._setDetailsCategories=function(a){var b=this,c=this._dataAdapter,d=c.l10n.labels.sunburst,e=(c.data(),c.categories()),h=f.select(this._options.parent).select(".info-pane-categories"),i=Math.max(0,b._zoomedPath?b._zoomedPath.depth-1:0),j=a&&"path"===a.type&&b._lockedNode?[]:e.slice(i),k=j.length,l=a||{},m=h.selectAll(".info-pane-category").data(j),n=m.enter().append("div").classed("info-pane-category",!0).classed("inactive",!0);h.select(".pane-title").select("span").text(1===k.length?d.category:d["category2+"]),m.each(function(a,c){var e=f.select(this);e.text(""),b._createRingMarker(e,k,c),e.append("span").classed("name",!0).html(a&&g.escapeHtml(a.name)||""),e.append("span").classed("top",!0).html("("+d.topresults.replace(/\{value\}/i,a.top)+")"),"path"===l.type?e.classed("disabled",!b._lockedNode&&l.data&&l.data.depth-1!=c-i):b._lockedNode&&"category"===b._lockedNode.type&&e.classed("disabled",a!==b._lockedNode.data)}),setTimeout(function(){n.classed("inactive",!1)},1);var o=m.exit().classed("inactive",!0).on("mouseenter",null).on("mouseleave",null).on("click",null);setTimeout(function(){o.remove()},400),m.on("mouseenter",function(a,c){b._lockedNode||b._isTouch()||b._highlightNode({data:a,type:"category"})}),m.on("mouseleave",function(a,c){b._lockedNode||b._isTouch()||b._unhighlightNode()}),m.on("click",function(a,c){b._lockNode({data:a,type:"category"})}),h.classed("empty",!j.length)},g._setDetailsAudiences=function(a){var b=this,c=this._dataAdapter,d=a&&a.type||"",e=a&&a.data||null,g="category"===d,h=c.data(),i=g?this._getLevelUniqueNodes(h,e.index+1,!1):this._getAncestorNodes(e),j=g?function(a,b){return b}:function(a,b){return a&&a.depth||0},k=c.categories(),l=f.select(this._options.parent).selectAll(".sunburst-audiences"),m=i&&i[0]||h,n=h===m,o=!i||n?[]:i.slice();l.each(function(a){var c=f.select(this),d=o.slice(),e=f.select(c.node().parentNode).classed("sunburst-cv-label-wrap");g||e?g&&e&&(d=[]):(b._lockedNode||(d=[]),d.reverse());var h=c.selectAll(".sunburst-audience").data(d,j),i=h.enter().append("span").classed("sunburst-audience",!0).classed("inactive",!0);i.append("span").classed("marker",!0).style("background-color","#dcdcdc"),i.append("span").classed("category",!0),i.append("span").classed("name",!0),h.each(function(a,d){var h=f.select(this),i=k[a.depth-1];if(h.select(".marker").style("background-color",b.getNodeColor(a)),h.select(".category").classed("hidden",g||e).text(!g&&i&&i.name||""),h.select(".name").text(a.name),h.classed("to-remove",!1).attr("my-name",a.name).attr("my-depth",a.depth),h.on("mouseenter",function(a,c){b._isTouch()||b._highlightNode({data:a,type:"item"})}),h.on("mouseleave",function(a,c){b._isTouch()||(b._lockedNode?b._highlightNode(b._lockedNode):b._unhighlightNode())}),!e){var j=f.select(h.node().cloneNode(!0)).style("height","").classed("test",!0).classed("inactive",!1);c.node().appendChild(j.node()),h.attr("my-height",parseInt(j.style("height"),10)),j.remove()}}),h.order(),setTimeout(function(){h.each(function(a,b){var c=f.select(this);c.classed("inactive",!1),e||c.style("height",c.attr("my-height")+"px")})},1);var l=h.exit().classed("inactive",!0).style("height","").classed("to-remove",!0).on("mouseenter",null).on("mouseleave",null).on("click",null);setTimeout(function(){l.each(function(a,b){var c=f.select(this);c.classed("to-remove")&&c.remove()})},400),c.classed("empty",!d.length)})},g._setDetailsActions=function(a){function b(){f._zoomPath(f._lockedNode.data)}function c(){f._zoomPath(h)}function d(){f._hidePath(f._lockedNode.data,f._hiddenNodes)}function e(){var a=f._lockedNode.data,b=f._hiddenNodes;a&&f._hidePath(h,b,function(c){return c.name===a.name||b.indexOf(c.parent)>=0})}var f=this,g=this._dataAdapter,h=g.data(),i=[],j=g.l10n.labels.sunburst;if(a&&"path"===a.type&&f._lockedNode){var k=a.data,l=f._canZoomIn(k),m=k===h;f._lockedNode?m||(l?i.push({click:b,className:"zoomin",icon:"zoomin",label:j.zoomin}):f._canZoomOut(k)&&i.push({click:c,className:"zoomout",icon:"zoomout",label:j.zoomout}),i.push({click:d,className:"hide",icon:"hide",label:j.hide}),i.push({click:e,className:"hideallname",icon:"hide",label:j.hideall})):(m||i.push({click:!1,icon:"more",label:j.moreAction}),l&&i.push({click:!1,icon:"zoomin",label:j.zoomAction}))}this._actions=i,this._renderDetailsActions()},g._renderDetailsActions=function(){var a=this,b=f.select(this._options.parent).select(".info-pane-actions"),c=b.selectAll(".info-pane-actions-chart").data([0]);c.enter().append("div").classed("info-pane-actions-chart",!0).classed("info-pane-actions-pane",!0);var d=b.selectAll(".info-pane-actions-extra").data([0]);d.enter().append("div").classed("info-pane-actions-extra",!0).classed("info-pane-actions-pane",!0);var e=this._actions||[],g=a._lockedNode&&"path"===a._lockedNode.type?a._customActions:[],h=!!e.length,i=!!g.length;b.classed("full-width",!h&&i||!i&&h),b.classed("empty",!h&&!i),a._buildActionsPane(c,e),a._buildActionsPane(d,g);var j=b.selectAll(".hideallname");j.on("mouseenter",function(){a._isTouch()||a._highlightNode({data:a._lockedNode.data,type:"item"})}),j.on("mouseleave",function(b,c){a._isTouch()||(a._lockedNode?a._highlightNode(a._lockedNode):a._unhighlightNode())})},g._buildActionsPane=function(a,b){var c=a.selectAll(".info-pane-action").data(b),d=c.enter().append("a").classed("info-pane-action",!0).classed("inactive",!0);d.append("i").classed("icon",!0),d.append("span"),c.each(function(b,c){var d=f.select(this);d.select(".icon").attr("class","icon").classed(b.icon,!0),d.select("span").text(b.label),d.attr("class","info-pane-action"+(d.classed("inactive")?" inactive":"")+(b.click||b.href?" action":" help")),b.click?d.on("click",b.click):d.on("click",null),b.href?d.attr("href",b.href):d.attr("href",null),b.className&&d.classed(b.className,!0);var e=f.select(d.node().cloneNode(!0)).style("height","").classed("test",!0).classed("inactive",!1);a.node().appendChild(e.node()),d.attr("my-height",parseInt(e.style("height"),10)),e.remove()}),setTimeout(function(){c.each(function(a,b){var c=f.select(this);c.style("height",c.attr("my-height")+"px").classed("inactive",!1)})},1);var e=c.exit().classed("inactive",!0).style("height","").classed("to-remove",!0).on("click",null);return setTimeout(function(){e.each(function(a,b){var c=f.select(this);c.classed("to-remove")&&c.remove()})},400),!!b.length},g._setDetailsMetrics=function(a){
var b=f.select(this._options.parent).select(".info-pane-metrics"),c=b.select(".pri-metric-labels"),d=b.select(".sec-metrics-labels"),e=b.select(".info-pane-metrics-chart"),g=this._dataAdapter,h=g.data(),i=h.metrics.slice(0,1),j=h.metrics.slice(1),k=g.categories(),l=g.l10n.labels.sunburst,m=a&&"path"===a.type?a.data:null,n=m||h,o=m&&m.children&&m.children.length&&this._lockedNode;b.classed("total",!o),b.selectAll(".pane-title").each(function(a,b){var c=f.select(this),d=c.select("span");return c.classed("pri-metric")?d.text(l.primarymetric):c.classed("sec-metric")?(c.classed("hidden",!j.length),d.text(j.length?1===j.length?l.secondarymetric:l["secondarymetric2+"]:"")):void(c.classed("rank-chart")&&d.text(o?k[m.depth]&&k[m.depth].name:""))}),b.selectAll(".sec-metrics-help").each(function(a,b){f.select(this).text(1===j.length?l.secondarymetrichelp:l["secondarymetrichelp2+"]).classed("hidden",!j.length)}),this._setNodeMetricLabels(c,n,i,!!m),this._setNodeMetricLabels(d,n,j,!!m),this._setNodeMetricChart(e,this._lockedNode?m:null)},g._setChartMetrics=function(a){var b=f.select(this._options.parent).select(".sunburst-cv-label-wrap"),c=this._dataAdapter.data(),d=c.metrics.slice(),e=a&&"path"===a.type?a.data:c;d.length>1&&(d.length=1),this._setNodeMetricLabels(b,e,d,!1)},g._setNodeMetricLabels=function(a,b,c,d){var e=this,g=this._dataAdapter,h=g.data(),i=g.l10n.labels.sunburst,j=a.classed("pri-metric-labels")||a.classed("sunburst-cv-label-wrap"),k=a.selectAll(".sunburst-cv-label-metric").data(c);k.enter().append("div").classed("sunburst-cv-label-metric",!0);d=!!(b&&b.children&&b.children.length&&this._lockedNode)&&d,k.each(function(a,c){var k=f.select(this),l=e.getNodeValue(b,j?c:c+1),m=e.getNodeValue(h,j?c:c+1),n="percent"===a.format,o=g.isOther(b)&&!j||0===m,p=n?l:l/e.getNodeValue(h,j?c:c+1),q=j||c+1===g.getSecondaryMetricIndex(),r=d&&q,s=null!==l&&!n&&!o&&b!==h;k.classed("active",q);var t=k.selectAll(".sunburst-cv-label-icon").data([a]);t.enter().append("i"),t.each(function(b){f.select(this).attr("class","sunburst-cv-label-icon icon").classed(a.icon||(j?"donut":"stack"),!0)});var u=k.selectAll(".sunburst-cv-label-number").data([a]);u.enter().append("span").classed("sunburst-cv-label-number",!0),u.html(o?"":e._formatValue(a,l)).classed("hidden",o);var v=k.selectAll(".sunburst-cv-label-name").data([a]);v.enter().append("span").classed("sunburst-cv-label-name",!0).append("span"),v.select("span").html(s?i.percmetric.replace(/\{percent\}/i,e._formatNumber("percent",p)).replace(/\{metric\}/i,a.name):a.name);var w=e.getMetricMaskNum(j?c:c+1),x=v.selectAll(".sunburst-cv-label-marker").data([a]);x.enter().insert("svg",":first-child").classed("sunburst-cv-label-marker",!0).append("rect").attr("width",12).attr("height",12),x.classed("hidden",!r).select("rect").attr("style",null===w?"":"mask: url(#diagmask"+w+");"),k.on("click",j?null:function(){g.setSecondaryMetricIndex(c+1,!0),e._secondaryMetricChanged()})}),k.exit().remove()},g._formatValue=function(a,b,c){if("time"!==a.format)return this._formatNumber(a.format,b);var d=b,e=this._dataAdapter,f=c?e.l10n.time.abbreviation:1===d?e.l10n.time.singular:e.l10n.time.plural,g=e.getTimeGranularity(d,!0);return this._formatNumber(a.format,d/g.divisor)+" "+f[g.gran]},g._setNodeMetricChart=function(a,b){function c(a,b){return 0===b||b===g.getSecondaryMetricIndex()}var d=this,g=this._dataAdapter,h=g.data(),i=d._getHiddenNodes(),j=b&&b.children||[],k=j.filter(function(a){return i.indexOf(a)<0}),l=[],m=[],n=[],o=[],p=[],q=[],r={x:l,y:m,fill:n,metric:o,format:q,node:p},s=h.metrics.slice(),t=s.filter(c),u=t.map(function(a){return a.name});k.reverse().forEach(function(a){var b;s.forEach(function(e,f){c(e,f)&&null!==(b=d.getNodeValue(a,f))&&(m.push(b),l.push(a.name),n.push(e.name),o.push(e.name),q.push(e.format),p.push(a))})});var v=!!m.length,w=a.selectAll(".info-pane-chart-svg").data([0]);if(w.enter().append("div").classed("info-pane-chart-svg",!0),w.exit().remove(),a.classed("hidden",!v),v){var x=15,y=25,z=.05,A=t.length,B=k.length,C=A*x+y,D=y/C,E=Math.ceil(A*B*x/(1-D));w.style("height",E+"px");var F=e.chart().layers([e.geom.bar().map("group","fill").set("fill",function(a,b){return d.getNodeColor(a.data.node)}).each("start",function(a,b){var c=d.getMetricMaskNum(u.indexOf(a.data.metric));f.select(this).attr("mask",null===c?"":"url(#diagmask"+c+")")}).on("click",function(a){d._selectChildFromRanked(a)}).dodgePadding(z),e.geom.text().map("label","y").map("group","fill").set("fill","#4b4b4b").textFormat(function(a,b){return a?d._formatValue({format:this.__data__.data.format},a,!0):""}).textAnchor("start").set("fill","#4b4b4b").dx(4).dy(5).on("click",function(a){d._selectChildFromRanked(a)})]).coord(e.coord.cartesian().flip(!0)).data(r).position("dodge").guide("x",e.guide.axis().tickDx(function(a,b){return f.select(this).select("span").node().offsetWidth}).tickDy(function(a,b){return-A*x/2-f.select(this).select("span").node().offsetHeight/2}).tickSize(0).tickAnchor("end")).guide("y",e.guide.axis().ticks(0).tickSize(0).tickFormat(function(a,b){return""})).map("x","x",e.scale.ordinal().padding(D)).width("100%").height(E).duration(400).padding({top:2,right:65}).parent(w.node());u.forEach(function(a,b){var c=e.scale.linear().lowerLimit(0);c.includeInDomain(function(a,c){return a.data.metric===u[b]}),F.map("y","y",c,b)}),F.render();var G=w.select("svg").selectAll("defs").data([0]);G.enter().append("defs");var H=[45],I=G.selectAll("pattern").data(H),J=I.enter().append("pattern").attr("id",function(a,b){return"diag"+b}).attr("patternUnits","userSpaceOnUse").attr("width","3").attr("height","3").attr("patternTransform",function(a,b){return"rotate("+a+" 2 2)"});J.append("rect").attr("x","0").attr("y","0").attr("width","3").attr("height","3").attr("style","fill:#fff;"),J.append("path").attr("d","M -1,0 l 10,0").attr("style","stroke:#222; fill:none; stroke-width: 3px;");G.selectAll("mask").data(H).enter().append("mask").attr("id",function(a,b){return"diagmask"+b}).attr("x","0").attr("y","0").append("rect").attr("x","0").attr("y","0").attr("width","100%").attr("height","1").attr("style",function(a,b){return"stroke:none; fill:url(#diag"+b+")"}),G.selectAll("mask").selectAll("rect").attr("height",E)}else w.style("height","0px")},g._selectChildFromRanked=function(a){var b=this._lockedNode.data,c=a.data.x;if(b&&b.children&&b.children.length){var d,e,f=b.children.length,g=null;for(d=0;d<f;++d)if((e=b.children[d]).name===c){g=e;break}g&&this._lockNode({data:g,type:"path"})}},g._createRingMarker=function(a,b,c){var d,e,g,h=a.append("svg").classed("category-ring",!0),i=h.append("g").attr("transform","translate(12,12)"),j=parseInt(h.style("width"),10),k=j/2,l=2,m=1,n=k-l*b-m*(b-1);for(g=0;g<b;++g)d=n+(l+m)*g,e=d+l,i.append("path").classed("active",g===c).attr("d",f.svg.arc().innerRadius(d).outerRadius(e).startAngle(0).endAngle(2*Math.PI))},g._canZoomIn=function(a){var b=this._dataAdapter.data(),c=this._zoomedPath;return a!==b&&a!==c||a===b&&b!==c&&!!c},g._canZoomOut=function(a){return a===this._zoomedPath},g._getAncestorNodes=function(a){var b=[],c=a;if(!a)return b;for(;c.parent;)b.push(c),c=c.parent;return b.length||(b=[a]),b},g._hasAncestorNode=function(a,b){if(!a||!b||a.depth<b.depth||a===b)return!1;for(var c=a;c.parent;){if(c.parent===b)return!0;c=c.parent}return!1},g._getInfoPaneHeight=function(a){var b,c=0;return f.selectAll(a.node().childNodes).each(function(a,d){b=f.select(this),c+=parseInt(b.style("height"),10)+parseInt(b.style("padding-bottom"),10)+parseInt(b.style("padding-top"),10)}),c},g._updateZoomedState=function(a){this._dispatch.zoom.call(this,a,this._dataAdapter.data())},g._updateLockedState=function(a){this._dispatch.select.call(this,a,this._dataAdapter.data())},g._updateHiddenState=function(a){this._dispatch.hidden.call(this,a,this._dataAdapter.data())},g._updateMetricState=function(){var a=this._dataAdapter;this._dispatch.metric.call(this,a.getSecondaryMetricIndex(),a.getSecondaryMetricType(),a.data())},g.getNodeValue=function(a,b){return a?a.metrics&&a.metrics.length&&a.metrics[b]&&void 0!==a.metrics[b].value?a.metrics[b].value:b>0?null:void 0!==a.size?a.size:a.value:0},g.getMetricCategoryMinMax=function(a,b){function c(g){if(!i||i.depth!==g.depth||i===g){if(void 0===b||g.depth===b+1){if(f.isOther(g))return;if(h.indexOf(g)>=0)return;var j=e.getNodeValue(g,a);if(void 0===d?d={min:j,max:j}:(d.min=Math.min(d.min,j),d.max=Math.max(d.max,j)),b)return}g.children&&g.children.length&&g.children.forEach(function(a){c(a)})}}var d,e=this,f=this._dataAdapter,g=f.data(),h=this._getHiddenNodes(),i=this._zoomedPath;return c(g),d||null},g.getNodeColor=function(a,b){var c,d=this._dataAdapter,e=this.getColorScale(a);return a.depth?(c=d.isOther(a)?d.otherColor():d.getColorMetric()?this.isOutsideRange(a)?d.outRangeColor():e(a.metrics[d.getColorMetricIndex()].value):e(a.name),b&&(c=this._grayColor(c,a)),c):d.metricColor()},g._grayColor=function(a,b){var c=this._dataAdapter;if(c.isOther(b))return c.otherGrayColor();var d=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,e=a&&a.match(d);if(!e)return a;var f=[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)],g=Math.round(.21*f[0]+.71*f[1]+.07*f[2]);return"#"+((1<<24)+(g<<16)+(g<<8)+g).toString(16).slice(1)},g.getMetricMaskNum=function(a){return 0===a?null:0},g.isOutsideRange=function(a){var b=this._dataAdapter,c=b.getColorMetric(),d=b.getColorMetricIndex();if(!c||!a||!a.metrics||"percent"!==c.format)return!1;var e=a.metrics[d].value;return e>this._colorExtentMax||e<this._colorExtentMin},g.getColorScale=function(a){var b,c=this._dataAdapter;return(b=c.getColorMetric())?"percent"===b.format?this._colorScale:this._categoryColorScales[a.depth-1]:this._colorScale},g._createColorScale=function(a,b,c,d){var e=this._dataAdapter,g=e.seqColors(),h=(b-c)*a[0]+c,i=(b-c)*a[1]+c,j=i-h,k=g.length-1;d&&(this._colorExtent=a,this._colorExtentMin=h,this._colorExtentMax=i);for(var l=[h],m=1;m<k;++m)l.push(j/k*m+h);return l.push(i),f.scale.linear().domain(l).range(g).clamp(!0)},g.setColorScale=function(a){a=a||[0,1];var b,c=this,d=this._dataAdapter,e=d.data();if(!(b=d.getColorMetric()))return void(this._colorScale=f.scale.ordinal().domain(d.uniques()).range(d.colors()));var g,h=d.getColorMetricIndex();if("percent"===b.format)return g=c.getMetricCategoryMinMax(h),void(this._colorScale=this._createColorScale(a,g.max,g.min,!0));g=e.categories.map(function(a,b){return c.getMetricCategoryMinMax(h,b)}),this._categoryColorScales=g.map(function(b,d){return c._createColorScale(a,b.max,b.min,!d)}),this._colorExtentMin=null,this._colorExtentMax=null},g.getNodeForKey=function(a){return this._dataAdapter.getDataByPathKey()[a]},g.getKeyForNode=function(a){return this._dataAdapter.getPathKey(a)},g.setSelectActions=function(a){this._customActions=a,this._renderDetailsActions()},g.getSelectActions=function(){return this._customActions},g.setSecondaryMetricIndex=function(a){this._dataAdapter.setSecondaryMetricIndex(a),this._secondaryMetricChanged()},g.getSecondaryMetricIndex=function(){return this._dataAdapter.getSecondaryMetricIndex()},g.setSecondaryMetricType=function(a){this._dataAdapter.setSecondaryMetricType(a),this._secondaryMetricChanged()},g.getSecondaryMetricType=function(){return this._dataAdapter.getSecondaryMetricType()},g.setHiddenItems=function(a){this._setHiddenNodes(a),this._hidePathRender(this._hiddenNodes)},g.getHiddenItems=function(){return this._hiddenNodes},g.getHiddenItemsByKey=function(){var a=this._dataAdapter;return this._hiddenNodes.map(function(b){return a.getPathKey(b)})},g.setZoomedItem=function(a){this._setZoomPath(a),this._zoomPathRender()},g.getZoomedItem=function(){return this._zoomedPath},g.getZoomedItemByKey=function(){return this._dataAdapter.getPathKey(this._zoomedPath)},g.setSelectedItem=function(a){this._setSelectedNode(a,!1)},g.getSelectedItem=function(){return this._lockedNode},g.getSelectedItemByKey=function(){var a=this._lockedNode;return a&&a.type&&a.data?"path"===a.type?this._dataAdapter.getPathKey(this._lockedNode.data):this._dataAdapter.getCategoryName(this._lockedNode.data):null},a.cloudViz.sunburst=c.util.createConstructor(g)}(this),function(a){"use strict";var b=a.cloudViz||{},c=b.core||{},d=a.dv||{},e=a.d3||{},f=Object.create(c);f.init=function(a){this._type="flower",this._initDefaultOptions(),this.setOptions(a),this.colorScale=d.scale.color()._d3Scale,this.selectionCache(new d.util.SelectionCache),this.identifyBehavior=d.behavior.identified("color-petal-");var b=this;return a.enableSelection&&(this._selectionCache.on("selectionChanged",function(a,c,d,e){b._highlightedOverlay.updateSelectedDisplay(c,function(){return"rotate(0)"}),b._onSelectionChanged(a,c,d,e,0)}),this.selectionCache().selectionKeymap(this.determineKeyModifiers)),this},f._initDefaultOptions=function(){var a={animationDuration:500,labelFormatter:null,clickHandler:null,onlyUseThreePetalLengths:!0,isEmotionChart:!0,mouseoverCallback:[null,null],horizontalPadding:70,verticalPadding:30,text_offset:5,onMouseOver:null,onMouseOut:null,onContextMenu:null,enableSelection:!1};return Object.getPrototypeOf(f)._initDefaultOptions.call(this,a)},f._onAutoResize=function(){this._render()},f.resize=function(){this._render()},f.reset=function(){Object.getPrototypeOf(f).reset.apply(this,arguments)},f._preRender=function(){Object.getPrototypeOf(f)._preRender.apply(this)},f._setUpLayer=function(a,b){this["layer"+b]=a.selectAll(".flower-cv-svg-group-layer"+b).data([0]),this["layer"+b].enter().append("g").classed("flower-cv-svg-group-layer"+b,!0)},f.sprintf=function(a,b){return a.replace(/\{([\w]+)\}/gi,function(a,c){return b[c]})},f._render=function(){Object.getPrototypeOf(f)._render.apply(this);var a=this;this._parent=e.select(this._options.parent);var b=this._parent.selectAll(".cv-wrapper.cv-flower").data([0]);b.enter().append("div").classed("cv-wrapper cv-flower",!0);var g=b.selectAll(".flower-cv-svg").data([0]);g.enter().append("svg").classed("flower-cv-svg",!0);var h=g.selectAll(".flower-cv-background").data([0]).enter().append("rect").classed("flower-cv-background",!0);this.selectionCache().setDeselector(h),this._svg_group=g.selectAll(".flower-cv-svg-group").data([0]),this._svg_group.enter().append("g").classed("flower-cv-svg-group",!0),this._setUpLayer(this._svg_group,1),this._setUpLayer(this._svg_group,2),this._setUpLayer(this._svg_group,3),this._setUpLayer(this._svg_group,4),this._setUpLayer(this._svg_group,5),this._setUpLayer(this._svg_group,6);var i=this._options.width||parseInt(this._parent.style("width"),10),j=this._options.height||parseInt(this._parent.style("height"),10);b.style("width",i+"px").style("height",j+"px");var k=i/2,l=j/2;this._svg_group.attr("transform",this.sprintf("translate({width},{height})",{width:k,height:l}));var m=a._dataAdapter.data(),n=k-this._options.horizontalPadding,o=l-this._options.verticalPadding,p=this._options.labelFormatter||function(b){b.append("tspan").attr("class","flower-cv-petal-label").text(function(a){return a.label+" "}),b.append("tspan").attr("class","flower-cv-petal-label-value").text(function(b){return a._formatNumber("percent",b.value/a._total,0,{dataItem:b})})},q=this._options.mouseoverCallback[0]||function(){e.select(this).attr("opacity",1)},r=this._options.mouseoverCallback[1]||function(a){e.select(this).attr("opacity",a.petal_opacity).attr("fill",a.petal_color)};this._is_single_mode=this._options.onlyUseThreePetalLengths,this._petal_size=Math.min(n,o),this._circle_size=.676*this._petal_size/2,this._arc_thickness=.027*this._petal_size,this._arc_half_angle=360/m.length/2+.5,this._petal_count=m.length;var s=e.scale.linear().domain([55,185]).range([9,12]).clamp(!0);this._font_size=s(this._petal_size);var t=[{offset_y:1,fixed_offset_y:0,offset_x:0,location:"middle"},{offset_y:1,fixed_offset_y:0,offset_x:-1.5,location:"middle"},{offset_y:0,fixed_offset_y:-2.5,offset_x:-.8,location:"start"},{offset_y:-1,fixed_offset_y:-9,offset_x:-1.5,location:"middle"},{offset_y:-1,fixed_offset_y:-9,offset_x:0,location:"middle"},{offset_y:-1,fixed_offset_y:-9,offset_x:1.5,location:"middle"},{offset_y:0,fixed_offset_y:-2.5,offset_x:.8,location:"end"},{offset_y:1,fixed_offset_y:0,offset_x:1.5,location:"middle"}];this._total=e.sum(m,function(a){return a.value});var u=e.scale.linear().domain([0,m.length]).range([0,360]);this._getTextOffsetIndex=e.scale.linear().domain([0,360]).rangeRound([0,8]).clamp(!0),this._getSizeZeroToThree=e.scale.linear().domain([0,e.max(m,function(a){return a.value})]).rangeRound([0,3]),this._getPetalSize=e.scale.linear().domain([e.min(m,function(a){return a.value}),e.max(m,function(a){return a.value})]).rangeRound([this._circle_size+this._arc_thickness+10,this._petal_size]),d.util.each(m,function(b,c){b.angle=u(c),a._addPetalSizes(b)}),this._getTextOffsetScale=function(a){var b=this._getTextOffsetIndex(a);return 8==b&&(b=0),t[b]};var v=this.layer1.selectAll(".flower-cv-gray-petals").data(m);v.enter().append("path").attr("class","flower-cv-gray-petals").attr("transform",function(a){return"rotate("+a.angle+")"}).attr("d",a._makePetal(0,0,0,0)).attr("opacity",0),v.transition().duration(a._options.animationDuration).attr("transform",function(a){return"rotate("+a.angle+")"}).attr("d",function(b){return a._makePetal(0,0,0,b.full_petal)}).attr("opacity",function(a){return 3==a.petal_size_number?0:1}),v.exit().transition().duration(a._options.animationDuration).attr("d",a._makePetal(0,0,0,0)).attr("opacity",0).remove();var w=this.layer2.selectAll(".flower-cv-color-petals").data(m);w.enter().append("path").attr("id",function(b,c,d){return a.identifyBehavior.identify(b,c,d)}).attr("class","flower-cv-color-petals").attr("transform",function(a){return"rotate("+a.angle+")"}).attr("opacity",function(a){return a.petal_opacity}).attr("d",a._makePetal(0,0,0,0)).attr("fill",function(a){return a.petal_color}).on("mouseover",q).on("mouseout",r).on("click",function(b,c,d){a._options.clickHandler&&a._options.clickHandler(b),a._dispatch.click.call(this,b,c,d,e.event)}).on("contextmenu",c.makeContextMenuHandler(a)).on("mousedown",a.makeSelectHandler()),w.transition().duration(a._options.animationDuration).attr("d",function(b){return a._makePetal(0,0,0,b.petal_size)}).attr("transform",function(a){return"rotate("+a.angle+")"}).attr("fill",function(a){return a.petal_color}).attr("opacity",function(a){return a.petal_opacity}),w.exit().transition().duration(a._options.animationDuration).attr("d",a._makePetal(0,0,0,0)).attr("opacity",0).remove();var x=this.layer3.selectAll(".flower-cv-white-arcs").data(m),y=e.svg.arc().innerRadius(0).outerRadius(this._circle_size+this._arc_thickness+1).startAngle(-a._arc_half_angle*(Math.PI/180)).endAngle(a._arc_half_angle*(Math.PI/180));x.enter().append("path").attr("class","flower-cv-white-arcs").attr("transform",function(a){return"rotate("+a.angle+")"}).attr("fill","white"),x.transition().duration(a._options.animationDuration).attr("d",y).attr("transform",function(a){return"rotate("+a.angle+")"}),x.exit().remove(),y=e.svg.arc().innerRadius(0).outerRadius(this._circle_size+this._arc_thickness).startAngle(-(a._arc_half_angle-1)*(Math.PI/180)).endAngle((a._arc_half_angle-1)*(Math.PI/180));var z=this.layer4.selectAll(".flower-cv-color-arcs").data(m);z.enter().append("path").attr("class","flower-cv-color-arcs").attr("d",y).attr("transform",function(a){return"rotate("+a.angle+")"}).attr("fill",function(a){return a.arc_color}),z.transition().duration(a._options.animationDuration).attr("d",y).attr("fill",function(a){return a.arc_color}).attr("transform",function(a){return"rotate("+a.angle+")"}),z.exit().remove();var A=this.layer5.selectAll(".flower-cv-petal-labels").data(m);A.enter().append("text").attr("class","flower-cv-petal-labels").attr("x",0).attr("y",0).attr("text-anchor",function(b){return a._getTextOffsetScale(b.angle).location}).attr("dx",function(b){return a._getTextOffsetScale(b.angle).offset_x*-a._options.text_offset}).attr("dy",function(b){return a._getTextOffsetScale(b.angle).offset_y*-a._options.text_offset-a._getTextOffsetScale(b.angle).fixed_offset_y}).style("font-size",a._font_size).attr("transform",function(a){return"rotate("+a.angle+") rotate("+-a.angle+", 0, 0)"}).attr("opacity",0),A.style("font-size",a._font_size+"px").attr("text-anchor",function(b){return a._getTextOffsetScale(b.angle).location}).attr("dx",function(b){return a._getTextOffsetScale(b.angle).offset_x*-a._options.text_offset}).attr("dy",function(b){return a._getTextOffsetScale(b.angle).offset_y*-a._options.text_offset-a._getTextOffsetScale(b.angle).fixed_offset_y}).selectAll("*").remove(),p(A),A.transition().duration(a._options.animationDuration).attr("y",function(a){return a.petal_size}).attr("transform",function(a){return"rotate("+a.angle+") rotate("+-a.angle+", 0, "+a.petal_size+")"}).attr("opacity",function(a){return 0===a.petal_number_size?0:1}),A.exit().remove();var B=this.layer6.selectAll(".flower-cv-main-circle").data([1]);B.enter().append("circle").attr("class","flower-cv-main-circle").attr("cx",0).attr("cy",0),B.transition().duration(a._options.animationDuration).attr("r",a._circle_size)},f._postRender=function(){this._highlightedOverlay.setUpSelectedOverlay(this._svg_group)},f._makePetal=function(a,b,c,d){var e=this._circle_size+this._arc_thickness+1,f=2*e*Math.PI/this._petal_count/2,g=f/(2*e*Math.PI)*360,h=Math.cos(g*Math.PI/180)*e,i=Math.sin(g*Math.PI/180)*e;b=-h;var j=a-i,k=a+i,l=(d-b)*-1*.6,m=(d-b)*-1,n=.2*m;return["M",j,b,"C",j-n,b-l,a,d,c,d,"C",c,d,k+n,b-l,k,b].join(" ")},f._addPetalSizes=function(a){a.color||(a.color=this.colorScale(a.label));var b=this._getSizeZeroToThree(a.value);this._is_single_mode||0===b&&(b=1),0===a.value&&(b=0);var c=.9,d=a.color,e=d,f=this._petal_size,g=f*-1;switch(b){case 0:c=0,e="#e6e6e6",f=0,d=d;break;case 3:c=.9;break;case 2:c=.75,f*=.795;break;case 1:c=.5,f*=.6}this._is_single_mode||(f=this._getPetalSize(a.value)),0===a.value&&(f=0),f*=-1,a.petal_opacity=c,a.petal_size=f,a.petal_color=d,a.full_petal=g,a.petal_number_size=b,a.arc_color=e},a.cloudViz.flower=b.util.createConstructor(f)}(this),function(a){"use strict";var b=a.cloudViz||{},c=b.dvcore||{},d=a.dv||{},e=a.d3||{},f=Object.create(c);f.init=function(a){return Object.getPrototypeOf(f).init.apply(this,arguments),this._type="funnel",this._chart=d.chart(),this._avgColor="#b1b1b1",this},f._initDefaultOptions=function(){var a={averageSeries:null,averageSeriesLabel:null,disableAverage:!1,normalized:!0,formats:{x:"decimal",y:"decimal"},tooltipContent:null,enableSelection:!1};return Object.getPrototypeOf(f)._initDefaultOptions.call(this,a)},f.reset=function(){Object.getPrototypeOf(f).reset.apply(this,arguments)},f._setChartTypeOptions=function(){var a=this._chart,b=this._options,f=this,g=this._dataAdapter,h=this._getPropMapping("series"),i=0,j=100,k=28,l=this._isNormalized()&&!g.isSingleSeries()?k:30,m=this._getChartWidth()-2*l,n=.05,o=g.getNumBarsPerStep(),p=g.getNumSteps(),q=p*(o+1)-1,r=Math.min(Math.max(i,m/q),j),s=g.isSingleSeries()?r/3:r,t=r>=36?12:r>=28?10:0,u=o*r+s,v=s/u,w=r===j?(m-(u*p-s))/2/u:0;this._stepWidth=o*r,this._stepPadding=s;var x=[d.geom.bar().data(g.currentStepData()).dodgePadding(n).each("start",function(a,b){e.select(this).attr("legend-group",a.fill)}),d.geom.bar().data(g.previousStepData()).dodgePadding(n).set("alpha",.15).each("start",function(a,b){e.select(this).attr("legend-group",a.fill)}),d.geom.text().data(g.textStepData()).each("start",function(a,b){e.select(this).attr("legend-group",a.group).classed("cv-funnel-text")}).map("label","cv_label").map("group",h).set("fill","#666").textAnchor("middle").dy(-5).textFormat(function(a){return f._formatNumber("percent",a,null,{dataItem:a})}).set("size",t)];if(g.isSingleSeries()&&x.splice(1,1),!b.interactive&&g.averageStepData()&&(!g.isAvgCalculated()||!g.isSingleSeries())){var y={x:[0],y:[0],cvfake:["cvfakeline"]};x.push(d.geom.line().data(y).map("stroke","cvfake",d.scale.color().values([this._avgColor])));var z=this._legend;a.guide("stroke",this._buildStandardLegend([g.averageDataLabel()])),this._legend=z}a.layers(x).data({}).map("fill",h,d.scale.color().values(b.colors)).map("x",this._getPropMapping("x"),d.scale.ordinal().padding(v).outerPadding(w).reverse(b.flip)).guide("fill",this._legend).position("dodge").padding(this._isNormalized()&&!g.isSingleSeries()?{left:l-k,right:l}:{left:l,right:l}),a._layers[0].on("click",c.makeClickHandler(this)),a._layers[0].on("contextmenu",c.makeContextMenuHandler(this)),this._addBehaviors(a.layers()[g.isSingleSeries()?0:1],b),this._mapPositionScales(a,b)},f._mapPositionScales=function(a,b){var c=this,d=[0,25],f=this._applyForceZero(this._constructScale("y")).rangePadding(d),g=this._getPropMapping("series"),h=this._getPropMapping("y"),i=c._dataAdapter;if(i.useAvgMaxValue()){var j=i.averageStepData(),k=e.extent(j[c._getPropMapping("y")])[1];f.upperLimit(function(a,b){var c=b>0?b:0;return k>c?k:c})}if(b.normalized){c._dataAdapter.uniqueFillValues().forEach(function(b,d){var e=0===d?f:f.copy();e.includeInDomain(function(a,b){return a.data[g]===c._dataAdapter.uniqueFillValues()[d]}),d>0&&a.map("y",h,e,d)})}a.map("y",h,f,0)},f._addBehaviors=function(a,b){var c,g=e.select(b.parent),h=this._dataAdapter,i=this,j=h.l10n.labels.funnel;if(!this._isSmallChart()&&b.interactive){var k=d.behavior.selection().on("selectionChanged",function(a,b,c){i._highlightedOverlay.updateSelectedDisplay(a),i._onSelectionChanged(this,a,b,c,h.isSingleSeries()?0:1)});i.selectionCache(k._selectionCache);var l=[d.behavior.identified(),d.behavior.rollover().orientation(b.flip?"top":"right").content(function(a,c,d){if(b.tooltipContent)return b.tooltipContent.call(this,a,c,d);var e,g,k,l,m=(this.__geom.getExplicitScale("group"),a.panel.yScale(a),i._yLabelFormat(d)),n=a.data.cv_tt_val,o=a.data.cv_tt_pval,p=h.getStepName(a.x),q=h.isSingleSeries()&&h.isAvgCalculated()?null:h.averageStepData();q&&(l=h.averageDataLabel(),e=q[i._getPropMapping("x")].indexOf(a.x),g=q[i._getPropMapping("y")][e],k=q[i._getPropMapping("y")][e>0?e-1:0]);var r='<span class="cv-tooltip-content"><span class="cv-funnel-title">'+f.escapeHtml(j.step)+'</span><span class="cv-funnel-series-name">'+f.escapeHtml(p)+'</span><span class="cv-funnel-title">'+f.escapeHtml(j.segment)+'</span><span class="cv-funnel-metric-name">'+f.escapeHtml(a.data[i._getPropMapping("seriesLabel")])+'</span><span class="cv-funnel-title">'+f.escapeHtml(j.conversion)+'</span><span class="cv-funnel-percent-value">'+f.escapeHtml(i._formatYValue(o?n/o:0,"percent"))+'</span><span class="cv-funnel-metric-value">'+f.escapeHtml(m(n))+"</span>";return q&&(r+='<span class="cv-funnel-sub-title">'+f.escapeHtml(l)+'</span><span class="cv-funnel-percent-value">'+f.escapeHtml(i._formatYValue(k?g/k:0,"percent"))+'</span><span class="cv-funnel-metric-value">'+f.escapeHtml(m(g))+"</span>"),r+='<span class="cv-funnel-title">'+f.escapeHtml(j.fallout)+'</span><span class="cv-funnel-percent-value">'+f.escapeHtml(i._formatYValue(o?1-n/o:0,"percent"))+'</span><span class="cv-funnel-metric-value">'+f.escapeHtml(m(o-n))+"</span>",q&&(r+='<span class="cv-funnel-sub-title">'+f.escapeHtml()+'</span><span class="cv-funnel-percent-value">'+f.escapeHtml(i._formatYValue(k?1-g/k:0,"percent"))+'</span><span class="cv-funnel-metric-value">'+f.escapeHtml(m(k-g))+"</span>"),r+"</span>"}).showTooltip(function(a,b,d,f,h){e.select(this).classed("path-inactive")||(h._showTip.call(this,a,b,d,h),clearTimeout(c),g.selectAll(".bar-geom").classed("cv-medium-duration",!1).classed("cv-unselected",function(b){return a.x!==b.x||a.fill!==b.fill}),g.selectAll(".text-geom").classed("cv-medium-duration",!1).classed("cv-unselected",function(b){return a.x!==b.x||a.fill!==b.group}),g.selectAll(".cv-legend-marker").classed("cv-unselected",function(b){return b.id!==a.fill}).classed("cv-medium-duration",!1),g.selectAll(".avg-geom").classed("cv-unselected",!0).classed("cv-medium-duration",!1),i._dispatch.mouseover.call(this,a,b,d,f))}).hideTooltip(function(a,b,d,f,h){e.select(this).classed("path-inactive")||(h._removeTip.call(this,a,b,d,h),c=setTimeout(function(){g.selectAll(".bar-geom, .text-geom, .cv-legend-marker, .avg-geom").classed("cv-unselected",!1).classed("cv-medium-duration",!0),i._dispatch.mouseout.call(this,a,b,d,f)},400))})];this._options.enableSelection&&l.push(k),a.behaviors(l)}},f._getStepLabel=function(a,b){var c=this._dataAdapter,d=c.getSingleSeriesStepValue(a,b),e=c.getStepName(a),g='<div class="cv-funnel-step-label" style="width: '+Math.floor(this._stepWidth)+'px">';return void 0!==d&&(g+='<span class="cv-funnel-step-label-value">'+f.escapeHtml(this._yLabelFormat(0)(d))+"</span>"),(g+='<span class="cv-funnel-step-label-name">'+f.escapeHtml(e)+"</span>")+"</div>"},f._drawSmall=function(){this._drawLarge()},f._drawLarge=function(){var a=this._chart,b=(this._options,this),c=this._dataAdapter,e=d.guide.axis();if(e.htmlLabels(!0).tickSize(0).tickAnchor("middle").tickFormat(function(a,c){return b._getStepLabel(a,c)}).title(this._dataAdapter.xAxisTitle()),a.guide("x",e).guide("y","none"),!c.isSingleSeries()){var f=a.padding();this._checkNormalized(),a.padding(f)}},f._renderChart=function(){Object.getPrototypeOf(f)._renderChart.call(this),this._drawAllLine()},f._drawAllLine=function(){var a=this._chart,b=(this._options,this._dataAdapter),c=this._isNormalized(),d=a.getTrainedScale("x"),f=a.getTrainedScale("y"),g=b.averageStepData(),h=(b.mappings(),this._getPropMapping("series"),this._getPropMapping("seriesLabel"),this._getPropMapping("x")),i=this._getPropMapping("y"),j=Math.min(this._stepPadding/2,5),k=[];if(g){var l=b.getUniqueFillExtent(0)[1],m=e.extent(g[i])[1],n=c?l||m:Math.max(l,m),o=e.scale.linear().domain([0,m]).range([0,n]);g[h].forEach(function(a,b){var e=g[i][b],h=f.mapValue(c?o(e):e);k.push({x:d.mapValue(a)-j,y:h}),k.push({x:d.mapValue(a)+d.rangeBand()+j,y:h})})}var p=e.select(a.parent()).selectAll("svg").selectAll(".cv-funnel-avg-group").data([0]);p.enter().insert("g",".group").classed("cv-funnel-avg-group",!0);var q=p.selectAll(".avg-group-line").data([0]);q.enter().append("g").classed("avg-group-line series",!0);var r=p.selectAll(".avg-group-point").data([0]);r.enter().append("g").classed("avg-group-point series",!0);var s=e.svg.line().x(function(a){return a.x}).y(function(a){return a.y}),t=a.duration(),u=a.ease(),v=q.selectAll(".avg-line").data([k]);v.enter().append("path").classed("avg-line avg-geom",!0),v.attr("legend-group",b.averageSeries()).transition().duration(t).ease(u).attr("d",s).style("stroke",this._avgColor),v.exit().remove();var w=r.selectAll(".avg-dot").data(k);w.enter().append("circle").classed("avg-dot avg-geom",!0),w.attr("legend-group",b.averageSeries()).style("stroke",this._avgColor).transition().duration(t).ease(u).attr("cx",s.x()).attr("cy",s.y()).attr("r",3),w.exit().remove()},f._createSeriesStates=function(){if(Object.getPrototypeOf(f)._createSeriesStates.call(this),"data"in this._changedOptions&&this._changedOptions.data){var a=this._dataAdapter;this._seriesState.removeStatesByType("funnel-average"),a.averageStepData()&&this._seriesState.insertState(a.averageDataLabel(),a.averageSeries(),"funnel-average")}},f._updatePathStates=function(){Object.getPrototypeOf(f)._updatePathStates.call(this);var a=this,b=this._options,c=this._dataAdapter,d=c.averageSeries();e.select(b.parent).selectAll(".cv-funnel-avg-group .series [legend-group]").classed("path-inactive",function(){if(!b.interactive)return!1;var c=e.select(this),f=c.attr("legend-group");return f===d&&a._seriesState.doesSeriesStateExist(f,"funnel-average")?!a._seriesState.isSeriesEnabled(f,"funnel-average"):c.classed("path-inactive")})},f._isNormalized=function(){return this._options.normalized},a.cloudViz.funnel=b.util.createConstructor(f)}(this),function(a){"use strict";function b(a,b,e,f){return d(c(a,b,e,f))-d(e)-d(f)-Math.PI/2}function c(a,b,c,d){return c+a(b)*(d-c)}function d(a){return a*Math.PI/180}function e(a,b,c){return Math.max(b,Math.min(c,a))}function f(a,b,c){var d=[];if(c&&b.length>1){
for(var e,f,h=g(a.domain()),i=-1,j=b.length,k=(b[1]-b[0])/++c;++i<j;)for(e=c;--e>0;)(f=+b[i]-e*k)>=h[0]&&d.push(f);for(--i,e=0;++e<c&&(f=+b[i]+e*k)<h[1];)d.push(f)}return d}function g(a){var b=a[0],c=a[a.length-1];return b<c?[b,c]:[c,b]}var h=a.cloudViz||{},i=h.core||{},j=a.dv||{},k=a.d3||{},l=Object.create(i),m=.05,n=1+m,o=.05,p=2,q=14,r=.1,s=null,t=null;l.init=function(a){this._type="gauge",a=a||{},this._initDefaultOptions(),this.setOptions(a),this.selectionCache(new j.util.SelectionCache),this._idBehavior=j.behavior.identified();var b=this;return a.enableSelection&&(this._selectionCache.on("selectionChanged",function(a,c,d,e){b._highlightedOverlay.updateSelectedDisplay(c),b._onSelectionChanged(a,c,d,e,0)}),this._selectionCache.selectionKeymap(this.determineKeyModifiers)),this},l._initDefaultOptions=function(a){var b={duration:750,percentOpen:r,showNeedle:!0,showAxis:!0,ticks:5,tickSubdivisions:0,ringThickness:.15,format:"decimal",fillColor:"#3284d4",minValue:0,maxValue:10,colors:[{color:"#ff3400",alpha:1,from:"0%",to:"33%"},{color:"#faca00",alpha:1,from:"33%",to:"66%"},{color:"#68b672",alpha:1,from:"66%",to:"100%"}],metric:"",value:0,enableSelection:!1};return this._margins={top:0,left:0,right:0,bottom:0},Object.getPrototypeOf(l)._initDefaultOptions.call(this,b)},l.createDeselector=function(a){var b=a.selectAll("g.interaction-group").data([0]).enter().append("g").classed("interaction-group",!0),c=b.selectAll("rect.interaction-canvas").data([0]).enter().append("rect").attr("width",this._size[0]+"px").attr("height",this._size[1]+"px").style("visibility","hidden").classed("interaction-canvas background",!0);this.selectionCache().setDeselector(c)},l.render=function(){return Object.getPrototypeOf(l).render.call(this,arguments),this._determineSize(),this._initScales(),this._draw(),this},l._onAutoResize=function(){this.render()},l._determineSize=function(a){var b=this._options,c=b.parent,d=b.width?b.width:c.offsetWidth,e=b.height?b.height:c.offsetHeight,f=Math.max(r,Math.min(.75,b.percentOpen));b.showNeedle&&(this._margins.bottom=.05*e),this._maxAngle=180*(1-f),this._minAngle=(1-f)*-180,d-=this._margins.left+this._margins.right,this._size=[d,e],this._radius=Math.min(d-this._margins.left-this._margins.right,e-this._margins.top-this._margins.bottom)/2},l._initScales=function(){var a=this._options;if(a.minValue>a.maxValue)throw new Error("The minimum value is greater than the maximum value.");this._scale=k.scale.linear().domain([a.minValue,a.maxValue]).range([0,1])},l._draw=function(){this._initSVG(),this._drawTrack(),this._drawAxis(),this._drawSelectedIndicator(),this._drawLabels()},l._initSVG=function(){var a=this._options,b=k.select(a.parent);s=b.selectAll(".cv-wrapper.cv-gauge").data([0]),s.enter().append("div").classed("cv-wrapper cv-gauge",!0),s.style("width",this._size[0]+"px").style("height",this._size[1]+"px");var c=s.selectAll(".chart-wrapper").data([0]);c.enter().append("div").classed("chart-wrapper",!0);var d=c.selectAll("svg").data([0]);d.enter().append("svg"),this.createDeselector(d),t=d.selectAll("g.plot").data([0]),t.enter().append("g").classed("plot",!0),t.attr("transform","translate("+(this._size[0]-this._margins.left-this._margins.right)/2+","+(this._size[1]-this._margins.top-this._margins.bottom)/2+")")},l._drawTrack=function(){var a=this,b=this._options,c=k.svg.arc().innerRadius(this._radius*(1-m-b.ringThickness)).outerRadius(this._radius*(1-m)).startAngle(function(b,c){var e=j.util.isPercentString(b.from)?parseInt(b.from,10)/100:a._scale(b.from);return d((a._maxAngle-a._minAngle)*e+a._minAngle)}).endAngle(function(b,c){var e=j.util.isPercentString(b.to)?parseInt(b.to,10)/100:a._scale(b.to);return d((a._maxAngle-a._minAngle)*e+a._minAngle)}),e=t.selectAll(".arc").data([0]);e.enter().append("g").classed("arc",!0);var f=e.selectAll("path").data(b.colors);f.enter().append("path").attr("class",function(a,b,c){return"datum-"+b+" series-"+c}).on("contextmenu",a.makeContextMenuHandler(a)).on("click",a.makeClickHandler(a)).on("mouseover",a.makeMouseOverHandler(a)).on("mouseout",a.makeMouseOutHandler(a)).on("mousedown",a.makeSelectHandler()).attr("id",function(b,c,d){return a._idBehavior.identify(b,c,d)}),f.exit().remove(),f.attr("fill",function(a,b){return a.color}).attr("opacity",function(a,b){return a.hasOwnProperty("alpha")?a.alpha:1}).attr("d",c),a._highlightedOverlay.setUpSelectedOverlay(e)},l._drawAxis=function(){var a=this,d=this._options,g=this._scale.ticks(d.ticks),h=function(b,e,f,g){return function(h){h.attr("x1",0).attr("y1",p).attr("x2",0).attr("y2",a._radius*g+p).attr("transform",function(g){return c(b,g,e,f),"rotate("+c(b,g,e,f)+") translate(0,"+(a._radius*(d.ringThickness+m)-a._radius)+")"})}},i=t.selectAll(".axis").data(d.showAxis?[0]:[]);i.enter().append("g").classed("axis",!0),i.exit().remove();var j=i.selectAll(".tick").data(g);j.enter().append("line").classed("tick",!0),j.exit().remove(),j.call(h(this._scale,this._minAngle,this._maxAngle,o));var k=f(this._scale,g,d.tickSubdivisions),l=i.selectAll(".minor-tick").data(k);l.enter().append("line").classed("minor-tick",!0),l.exit().remove(),l.call(h(this._scale,a._minAngle,a._maxAngle,.025));var n=i.selectAll(".tick-label").data(g);n.enter().append("text").classed("tick-label",!0),n.exit().remove(),n.attr("transform",function(e){var f=c(a._scale,e,a._minAngle,a._maxAngle),g=b(a._scale,e,a._minAngle,a._maxAngle),h=(a._radius-q)*(1-d.ringThickness-m-o),i=Math.cos(g)*h,j=Math.sin(g)*h;return f<-10&&f>-170&&(i-=3),f>10&&f<170&&(i+=3),"translate("+i+","+j+")"}).attr("text-anchor",function(b){var d=c(a._scale,b,a._minAngle,a._maxAngle);return d>-10&&d<10?"middle":d<0?null:"end"}).attr("dy",".35em").style("font-size",e(.05*a._radius,8,14)+"px").text(function(b){return a._formatNumber(d.format,b,null,{dataItem:b})})},l._drawSelectedIndicator=function(){var a=this._options;this._drawNeedle(a.showNeedle?[a.value]:[]),this._drawProgressFill(a.showNeedle?[]:[a.value])},l._drawNeedle=function(a){var b=this,d=this._options,e=.09*this._radius/2,f=this._radius*n,g=t.selectAll(".needle").data(a);g.enter().append("path").classed("needle",!0).attr("transform","rotate("+b._minAngle+")"),g.exit().remove(),g.attr("d","M"+e/2+"-"+e+"L0-"+f+"L-"+e/2+"-"+e+"C-"+.8257*e+"-"+.8212*e+"-"+1.035*e+"-"+e/2*.9448+"-"+1.035*e+"-1C-"+1.035*e+","+e/2*.9078+"-"+.5796*e+","+.9314*e+",0,"+.9314*e+"S"+1.035*e+","+e/2*.9078+","+1.035*e+"-1C"+1.035*e+"-"+e/2*.9448+","+.8257*e+"-"+.8212*e+","+e/2+"-"+e+"z").transition().duration(d.duration).ease("cubic-in-out").attrTween("transform",function(a){var e=this,f=Math.min(d.maxValue,Math.max(d.minValue,a)),g=c(b._scale,f,b._minAngle,b._maxAngle),h=void 0===this.__previousD__?b._minAngle:this.__previousD__,i=k.interpolate(h,g);return function(a){return e.__previousD__=i(a),"rotate("+e.__previousD__+")"}})},l._drawProgressFill=function(a){var b=this,e=this._options,f=k.svg.arc().innerRadius(this._radius*(1-m-e.ringThickness)).outerRadius(this._radius*(1-m)).startAngle(d(b._minAngle)).endAngle(function(a){return d(c(b._scale,a,b._minAngle,b._maxAngle))}),g=t.selectAll(".progress").data(a);g.enter().append("path").on("contextmenu",b.makeContextMenuHandler(b)).on("click",b.makeClickHandler(b)).on("mouseover",b.makeMouseOverHandler(b)).on("mouseout",b.makeMouseOutHandler(b)).on("mousedown",b.makeSelectHandler()).classed("progress",!0),g.exit().remove(),g.attr("fill",e.fillColor).transition().duration(e.duration).attrTween("d",function(a){var b=this,c=Math.min(e.maxValue,Math.max(e.minValue,a)),d=void 0===this.__previousD__?e.minValue:this.__previousD__,g=k.interpolate(d,c);return function(a){return b.__previousD__=g(a),f(b.__previousD__)}})},l._drawLabels=function(){var a=this,c=this._options,d=void 0===c.value?[]:[c.value],f=void 0===c.metric?[]:[c.metric],g=b(this._scale,c.minValue,this._minAngle,this._maxAngle),h=b(this._scale,c.maxValue,this._minAngle,this._maxAngle),i=this._radius*(1-c.ringThickness-m),j=(this._radius-q)*(1-c.ringThickness-m-o),k=Math.cos(g)*j+this._radius,l=Math.cos(h)*j+this._radius,n=Math.sin(g)*i+this._radius,p=s.selectAll(".label-container").data([0]);p.enter().append("div").classed("label-container",!0),p.style("left",this._size[0]/2-this._radius+"px");var r=p.selectAll(".label-title").data(f);r.enter().append("span").classed("label-title",!0),r.exit().remove(),r.style("font-size",e(.1*this._radius,11,18)+"px").classed("multiline-ellipsis",!c.showNeedle).text(String);var t=p.selectAll(".label-number").data(d),u=Math.max(n,1.1*this._radius);if(t.enter().append("span").classed("label-number",!0).style("line-height",this._radius*c.ringThickness+"px"),t.exit().remove(),t.style("left",k+"px").style("width",l-k+"px").style("font-size",this._radius*c.ringThickness+"px").text(function(b){return a._formatNumber(c.format,b,{dataItem:b})}),c.showNeedle)r.style("top",u+.2*this._radius+"px").style("left",0).style("width",2*this._radius+"px"),t.style("top",u+"px");else{var v=2.3*e(.1*this._radius,11,20),w=this._radius*(1-m);r.style("top",w+"px").style("left",this._radius*(c.ringThickness+m+o+.3)+"px").style("width",this._radius*(1-c.ringThickness-m-o-.3)*2+"px").style("height",v+"px"),t.style("top",Math.max(w+v,u)+"px")}},a.cloudViz.gauge=h.util.createConstructor(l)}(this),function(a){"use strict";function b(a){return"<span class='series-name'>"+l.escapeHtml(a.parent.name)+"</span><span class='metric-value'>"+l.escapeHtml(a.value)+"</span><span class='metric-name'>"+l.escapeHtml(a.name)+"</span>"}function c(a){a.style("left",function(a){return s(a.x)+1+"px"}).style("top",function(a){return a.children&&!a.parent?0:t(a.y)+1-o+"px"}).style("width",function(a){return s(a.x+a.dx)-s(a.x)-2+"px"}).style("height",function(a){return a.children?null:t(a.y+a.dy)-t(a.y)-2+"px"})}function d(a){a.style("background-color",function(a){return a.children||!a.parent?null:u(a.parent.name)})}var e,f,g,h=a.cloudViz||{},i=h.core||{},j=a.dv||{},k=a.d3||{},l=Object.create(i),m=0,n=0,o=25,p=0,q=0,r=0,s=k.scale.linear(),t=k.scale.linear(),u=k.scale.ordinal(),v=!0;l.init=function(a){if(this._type="treemap",a=a||{},this._initDefaultOptions(),this.setOptions(a),a.enableSelection){this.selectionCache(new j.util.SelectionCache),this._selectionCache.selectionKeymap(this.determineKeyModifiers);var b=this;this._selectionCache.on("selectionChanged",function(a,c,d,e){b._highlightedOverlay.updateSelectedDisplay(c),b._onSelectionChanged(a,c,d,e,0)})}return this},l._initDefaultOptions=function(a){var c={theme:"default",colors:[],layout:"squarify",duration:750,autoResize:!1,tooltipContent:b,cellContent:null,enableSelection:!1};return Object.getPrototypeOf(l)._initDefaultOptions.call(this,c)},l._onAutoResize=function(){this.render()},l.reset=function(){},l._preRender=function(){Object.getPrototypeOf(l)._preRender.call(this),this.setColors(this._options),this._determineSize(),this._configureScales(this._options.data),this._configureLayout(),this._highlightedOverlay=h.util.selectedOverlay(k.select(this._options.parent))},l._render=function(){return this._initContainer(),this._draw(this._options.data),v=!1,this},l._postRender=function(){Object.getPrototypeOf(l)._postRender.call(this)},l._determineSize=function(){m=this._getChartWidth(),n=this._getChartHeight()},l._configureScales=function(a){var b=this._options;u.domain(a.map(function(a){return a.name})).range(b.colors);var c=a.hasOwnProperty("dx")?[a.x,a.x+a.dx]:[0,m],d=a.hasOwnProperty("dy")?[a.y,a.y+a.dy]:[0,n];s.domain(c).range([1,m-2]),t.domain(d).range([1,n-2])},l._configureLayout=function(){g=k.layout.treemap().sticky(!0).value(function(a){return a.value||0}).sort(function(a,b){return a.value-b.value}).mode(this._options.layout).round(!1)},l._initContainer=function(){function a(){return c}var b=this._options,c=[0],d=k.select(b.parent).selectAll(".cv-wrapper.cv-treemap").data(a(),a);d.enter().append("div").classed("cv-wrapper cv-treemap",!0),e=d.selectAll(".chart-wrapper").data(a(),a),e.enter().append("div").classed("chart-wrapper",!0).style("position","relative"),e.style("width",m+"px").style("height",n+"px"),f=e.selectAll(".node-container").data(a(),a),f.enter().append("div").classed("node-container",!0).style("overflow","hidden"),f.style("width",m+"px").style("height",n+"px")},l._initNodeValues=function(a){var b,c=0,d=void 0!==a.children?a.children.length:0;for(b=0;b<d;b++)c+=this._initNodeValues(a.children[b]);return void 0===a.value&&(a.value=c),a.value},l._removeZeroNodes=function(a){var b,c,d=a.children.length,e=!1;for(b=0;b<d;b++){this._initNodeValues(a.children[b]);var f=a.children[b].children.length;for(c=0;c<f;c++)0===a.children[b].children[c].value&&(a.children[b].children.splice(c,1),c-=1,f-=1);e=e||f>0}if(e)for(b=0;b<d;b++)0===a.children[b].children.length&&(a.children.splice(b,1),b-=1,d-=1);else for(b=0;b<d;b++)0===a.children[b].value&&(a.children.splice(b,1),b-=1,d-=1);return a},l._draw=function(a){var b,e=this,h=this._options,i=this._removeZeroNodes({children:this._options.data}),s=g.size([m,n+o]).padding([o,p,r,q]).nodes(i),t=(s.filter(function(a){return!a.children}),s.filter(function(a){return a.parent&&a.children}),k.select(h.parent).selectAll(".cv-wrapper.cv-treemap").data([0])),u=t.selectAll(".chart-wrapper").data([0]),v=f.selectAll(".cv-node").data(s),w=v.enter().append("div").attr("class",function(a,b,c){return"datum-"+b+" series-"+c}).classed("cv-node",!0).on("click",function(a,c,d){if(a.depth>0){var g=(k.select(this),[]);if(a.children){g=f.selectAll(".second-level").filter(function(b){return a.children.indexOf(b)>=0}),g[0].push(this);var h=f.selectAll(".cv-node.selected"),i=[];i=h[0].indexOf(this)>=0?h[0].filter(function(a){return!(g[0].indexOf(a)>=0)}):g[0].concat(h[0]),g[0]=i,e._selectNodes(g)}else{g=f.selectAll(".cv-node.selected");var j,l=g[0].indexOf(this);if(l>=0){g[0].splice(l,1),j=e._getParentNode(this);var m=g[0].indexOf(j);m>=0&&(b=0,j.__data__.children.forEach(function(a){g.each(function(c){c==a&&b++})}),j.__data__.children.length-1===b&&g[0].splice(m,1))}else g[0].push(this),j=e._getParentNode(this),b=0,j.__data__.children.forEach(function(a){g.each(function(c){c==a&&b++})}),j.__data__.children.length===b&&g[0].push(j);e._selectNodes(g)}e._dispatch.click.call(this,a,c,d,k.event)}}).on("mouseover",function(a,b,c){if(!a.children){var d=k.select(this),f={x:a.x+a.dx/4,y:a.y+a.dy/2-o,width:a.dx/2,height:a.dy/2},g={x:0,y:0,width:u.node().getBoundingClientRect().width,height:u.node().getBoundingClientRect().height},i=null;d.classed("hovered",!0),i=h.tooltipContent.call(this,a,b),j.showTooltip(f,g,i,"top",5,u),e._dispatch.mouseover.call(this,a,b,c,k.event)}}).on("mouseout",function(a,b,c){if(!a.children){k.select(this).classed("hovered",!1),j.removeTooltip(u),e._dispatch.mouseout.call(this,a,b,c,k.event)}}).on("contextmenu",e.makeContextMenuHandler(e)).on("mousedown",e.makeSelectHandler());w.append("div"),w.call(c).call(d),v.exit().remove(),v.classed("root-level",function(a){return a.depth===i.depth}).classed("first-level",function(a){return a.depth===i.depth+1}).classed("second-level",function(a){return a.depth===i.depth+2}).call(d).call(c),v.select("div").html(function(a,b){var c=a.hasOwnProperty("name")&a.parent===i?l.escapeHtml(a.name):null,d=a.hasOwnProperty("label")&&a.parent===i?l.escapeHtml(a.label):null,e=h.cellContent?h.cellContent.call(this,a,b):null,f=a.dx,g=a.dy;return(f<100||g<14)&&(e=null),d||c||e}).style("opacity",function(a){return a.dx<50||a.dy<25?0:1})},l._selectNodes=function(a){f.selectAll(".cv-node.selected").classed("selected",!1),a.classed("selected",!0)},l._getParentNode=function(a){var b;return k.select(this._options.parent).selectAll(".first-level")[0].forEach(function(c){c.__data__.children.indexOf(a.__data__)>=0&&(b=c)}),b},l.setSelected=function(a){var b=this,c=k.select(this._options.parent).selectAll(".second-level").filter(a);return c[0].forEach(function(a){var d=b._getParentNode(a),e=0;d&&(d.__data__.children.forEach(function(a){c.each(function(b){b==a&&e++})}),d.__data__.children.length===e&&c[0].push(d))}),b._selectNodes(c),b},l.getSelected=function(){var a=[],b=f.selectAll(".second-level.cv-node.selected");return b&&b[0].forEach(function(b){a.push(b.__data__)}),a},a.cloudViz.treemap=h.util.createConstructor(l)}(this),function(a){"use strict";function b(a,b,c){if(!a.sprite){n.clearRect(0,0,(k<<5)/m,l/m);var d=0,e=0,f=0,g=0,h=0,i=b.length;for(--c;++c<i;){if(a=b[c],n.save(),n.font=a.style+" "+a.weight+" "+~~((a.size+1)/m)+"px "+a.font,f=n.measureText(a.text+"m").width*m,g=a.size<<1,a.rotate){var o=Math.sin(a.rotate*j),p=Math.cos(a.rotate*j),q=f*p,r=f*o,s=g*p,t=g*o;f=Math.max(Math.abs(q+t),Math.abs(q-t))+31>>5<<5,g=~~Math.max(Math.abs(r+s),Math.abs(r-s))}else f=f+31>>5<<5;if(g>h&&(h=g),d+f>=k<<5&&(d=0,e+=h,h=0),e+g>=l)break;n.translate((d+(f>>1))/m,(e+(g>>1))/m),a.rotate&&n.rotate(a.rotate*j),n.fillText(a.text,0,0),a.padding&&(n.lineWidth=2*a.padding,n.strokeText(a.text,0,0)),n.restore(),a.width=f,a.height=g,a.xoff=d,a.yoff=e,a.x1=f>>1,a.y1=g>>1,a.x0=-a.x1,a.y0=-a.y1,a.hasText=!0,d+=f}for(var u=n.getImageData(0,0,(k<<5)/m,l/m).data,v=0,w=[];--c>=0;)if(a=b[c],a.hasText){f=a.width;var x=f>>5;for(g=a.y1-a.y0,v=0;v<g*x;v++)w[v]=0;if(null==(d=a.xoff))return;e=a.yoff;for(var y=0,z=-1,A=0;A<g;A++){for(v=0;v<f;v++){var B=x*A+(v>>5),C=u[(e+A)*(k<<5)+(d+v)<<2]?1<<31-v%32:0;w[B]|=C,y|=C}y?z=A:(a.y0++,g--,A--,e++)}a.y1=a.y0+z,a.sprite=w.slice(0,(a.y1-a.y0)*x)}}}function c(a,b,c){c>>=5;for(var d,e=a.sprite,f=a.width>>5,g=a.x-(f<<4),h=127&g,i=32-h,j=a.y1-a.y0,k=(a.y+a.y0)*c+(g>>5),l=0;l<j;l++){d=0;for(var m=0;m<=f;m++)if((d<<i|(m<f?(d=e[l*f+m])>>>h:0))&b[k+m])return!0;k+=c}return!1}function d(a,b){var c=a[0],d=a[1];b.x+b.x0<c.x&&(c.x=b.x+b.x0),b.y+b.y0<c.y&&(c.y=b.y+b.y0),b.x+b.x1>d.x&&(d.x=b.x+b.x1),b.y+b.y1>d.y&&(d.y=b.y+b.y1)}function e(a,b){return a.x+a.x1>b[0].x&&a.x+a.x0<b[1].x&&a.y+a.y1>b[0].y&&a.y+a.y0<b[1].y}function f(a){var b=a[0]/a[1];return function(a){return[b*(a*=.1)*Math.cos(a),a*Math.sin(a)]}}function g(a){var b=4,c=b*a[0]/a[1],d=0,e=0;return function(a){var f=a<0?-1:1;switch(Math.sqrt(1+4*f*a)-f&3){case 0:d+=c;break;case 1:e+=b;break;case 2:d-=c;break;default:e-=b}return[d,e]}}function h(a){for(var b=[],c=-1;++c<a;)b[c]=0;return b}d3.wordcloud=function(){function a(a,b,d){for(var f,g,h,i=(r[0],r[1],b.x),j=b.y,k=Math.sqrt(r[0]*r[0]+r[1]*r[1]),l=p(r),m=Math.random()<.5?1:-1,n=-m;(f=l(n+=m))&&(g=~~f[0],h=~~f[1],!(Math.min(g,h)>k));)if(b.x=i+g,b.y=j+h,!(b.x+b.x0<0||b.y+b.y0<0||b.x+b.x1>r[0]||b.y+b.y1>r[1])&&(!d||!c(b,a,r[0]))&&(!d||e(b,d))){for(var o,q=b.sprite,s=b.width>>5,t=r[0]>>5,u=b.x-(s<<4),v=127&u,w=32-v,x=b.y1-b.y0,y=(b.y+b.y0)*t+(u>>5),z=0;z<x;z++){o=0;for(var A=0;A<=s;A++)a[y+A]|=o<<w|(A<s?(o=q[z*s+A])>>>v:0);y+=t}return delete b.sprite,!0}return!1}var f,g,i,j,k,l,m,n,p,q={},r=[256,256],s=new dv.util.SelectionCache,t=[0,90],u=1/0,v=d3.dispatch("word","end"),w=null;return q.selectionCache=function(){return s},q.coreChart=function(a){return a&&(m=a,this.makeContextMenuHandler=m.makeContextMenuHandler,this.__dispatch=m._dispatch),m},q.draw=function(){k=q.createSVGContainer();var a,b=l.append("g").attr("transform","translate("+[r[0]/2,r[1]/2]+")").selectAll("text").data(f),c=n.colorSpread,d=n.colors,e=[],g=d.length,h=n.data,i=h.length,j=n.colorLoopSize>g?g:n.colorLoopSize;for(a=0;a<g;a++)e.push(d3.hsl(d[a]));for("gradient"==c?e.sort(function(a,b){return b.l-a.l}):e.sort(function(a,b){return a.l-b.l}),a=0;a<g;a++)d[a]=e[a].toString();var o,p,s=[],t=0,u=99999;if("gradient"==c){for(a=0;a<i;a++)t=h[a].size>t?h[a].size:t,u=h[a].size<u?h[a].size:u;for(s[0]=0,a=1;a<g;a++)s[a]=a*(t-u)/(g-1);p=d3.scale.linear().domain(s).range(d)}b.enter().append("text").attr("transform",function(a){return"translate("+[a.x,a.y]+")rotate("+a.rotate+")"}).on("mousedown",m.makeSelectHandler()).style("fill",function(a,b){if("truncate"==c)return d[b%g];if("gradient"==c)return p(a.size);if("loop"==c){if(b<g)return d[b];return o=(b-g)%j+(g-j),d[o]}return o=Math.round(g*b/i),d[o<g?o:g-1]}).attr("text-anchor","middle").style("font-size",function(a){return a.size+"px"}).style("font-family",function(a){return a.font}).on("contextmenu",q.makeContextMenuHandler(q)).text(function(a,b){return a.text})},q.start=function(){function c(){for(var c,h=+new Date;+new Date-h<u&&++j<i&&w;)c=f[j],c.x=r[0]*(Math.random()+.5)>>1,c.y=r[1]*(Math.random()+.5)>>1,b(c,f,j),c.hasText&&a(e,c,g)&&(k.push(c),v.word(c),g?d(g,c):g=[{x:c.x+c.x0,y:c.y+c.y0},{x:c.x+c.x1,y:c.y+c.y1}],c.x-=r[0]>>1,c.y-=r[1]>>1);j>=i&&(q.stop(),v.end(k,g))}var e=h((r[0]>>5)*r[1]),g=null,i=f.length,j=-1,k=[];return f.forEach(function(a,b){a.font=n.fontFamily,a.style="normal",a.weight="normal",n.allowIntermediateAngles?a.rotate=Math.random()*(t[1]-t[0])+t[0]:a.rotate=~~(2*Math.random())*(t[1]-t[0])-t[0],a.padding=n.padding}),f.sort(function(a,b){return b.size-a.size}),"truncate"==n.colorSpread&&i>n.colors.length&&(i=f.length=n.colors.length),w&&clearInterval(w),w=setInterval(c,0),c(),q},q.stop=function(){return w&&(clearInterval(w),w=null),q},q.timeInterval=function(a){return arguments.length?(u=null==a?1/0:a,q):u},q.createSVGContainer=function(){i=d3.select(g),j=i.selectAll(".cv-wordcloud").data([f]),j.enter().append("div").classed("cv-wordcloud",!0),j.style("width",r[0]+"px").style("height",r[1]+"px"),l=j.selectAll("svg").data([f]),l.enter().append("svg").attr("width","100%").attr("height","100%"),l.exit().remove();var a=l.selectAll(".wordcloud-bg").data([0]).enter().append("rect").classed("wordcloud-bg",!0);return s.setDeselector(a),l},q.data=function(a){return arguments.length?(f=a,q):f},q.parent=function(a){return arguments.length?(g=a,q):g},q.size=function(a){return arguments.length?(r=[+a[0],+a[1]],q):r},q.options=function(a){return arguments.length?(n=a,p=o[n.spiral+""]||n.spiral,q):n},q.rotateRange=function(a){return arguments.length?(t=a,q):t},q.setCallback=function(a,b){return q.on(a,b),q},d3.rebind(q,v,"on")};var i,j=Math.PI/180,k=64,l=2048,m=1;i=document.createElement("canvas"),i.width=1,i.height=1,m=Math.sqrt(i.getContext("2d").getImageData(0,0,1,1).data.length>>2),i.width=(k<<5)/m,i.height=l/m;var n=i.getContext("2d");n.fillStyle=n.strokeStyle="red",n.textAlign="center";var o={archimedean:f,rectangular:g};d3.wordcloud.gradIdCounter=0}(),function(a){"use strict";var b=a.cloudViz||{},c=b.dvcore||{},d=a.dv||{},e=a.d3||{},f=Object.create(c);f.init=function(a){return Object.getPrototypeOf(f).init.apply(this,arguments),this._type="wordcloud",this._chart=d.chart(),a=a||{},this._initDefaultOptions(),this.setOptions(a),this._initWordcloud(),this},f._initDefaultOptions=function(){var a={fontFamily:"Impact",spiral:"archimedean",size:[800,400],rotateRange:[0,0],allowIntermediateAngles:!1,colors:[],colorSpread:"stretch",colorLoopSize:1,theme:"default",padding:1,enableSelection:!1};return Object.getPrototypeOf(f)._initDefaultOptions.call(this,a)},f._initWordcloud=function(){this._wordcloud=e.wordcloud(),this._wordcloud.coreChart(this);var a=this;this._options.enableSelection&&(this.selectionCache(this._wordcloud.selectionCache()),this._wordcloud.selectionCache().on("selectionChanged",function(b,c,d,e){a._onSelectionChanged(b,c,d,e,0)}))},f._render=function(){this._configure()},f._configure=function(){var a=this._options;a.data=this._dataAdapter.data(),this._wordcloud.data(a.data).parent(a.parent).options(a).size(a.size).rotateRange(a.rotateRange).setCallback("end",this._wordcloud.draw).start()},a.cloudViz.wordcloud=b.util.createConstructor(f)}(this),function(a){"use strict";var b=a.cloudViz,c=a.dv,d=b.util.namespace("cloudViz.dataAdapter.standard"),e={};e._isDataValid=null,e.process=function(a,c){this._options=a,this.l10n=b.util.deepExtend({},b.localeDefinition(a.locale),a.l10n||{}),("data"in c||"mappings"in c)&&this._validateData(a.data,a.mappings)&&this._processOptions(a,c)},e._processOptions=function(a,b){},e._determineOvertime=function(a){var b=this.mappings(),d=a[b.x];return!(!d||!d.length)&&(d.every(function(a){return c.util.isDate(a)})||d.every(function(a){return/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/.test(a)}))},e._calculateDateGranularity=function(a){var b=this.mappings(),c=a[b.x];if(!c||!c.length)return"*";c=c.map(function(a){return new Date(a)});var d=Math.min.apply(Math,c),e=Math.max.apply(Math,c),f=(e-d)/1e3,g=f/c.length;return this.getTimeGranularity(g).gran},e.getTimeGranularity=function(a,b){var c="second",d=1;return a?(b?a>=(d=31536e3)?c="year":a>=(d=2678400)?c="month":a>=(d=604800)?c="week":a>=(d=86400)?c="day":a>=(d=3600)?c="hour":a>=(d=60)?c="minute":(c="second",d=1):a<=(d=1)?c="second":a<=(d=60)?c="minute":a<=(d=3600)?c="hour":a<=(d=86400)?c="day":a<=(d=604800)?c="week":a<=(d=2678400)?c="month":(c="year",d=31536e3),{gran:c,divisor:d}):{gran:c,divisor:d}},e._getYTitleFromLabels=function(a){var b=c.util.uniq(a);return b&&1===b.length?b[0]:null},e.data=function(){return this._options.data},e.mappings=function(){return this._options.mappings},e.formats=function(){return this._options.formats},e.xAxisTitle=function(){return this._options.xAxisTitle||null},e.yAxisTitle=function(){return this._options.yAxisTitle||null},e.dateGranularity=function(){return this._processedOptions.dateGranularity},e.colors=function(){return this._processedOptions.colors},e.isDataValid=function(){return this._validateData(this._options.data,this._options.mappings)},e._validateData=function(a,b){if(!a)return!1;for(var c in a)if(a[c].length)return!0;return!1},d.baseObj=e,d.base=b.util.createConstructor(e)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.standard"),d=Object.create(c.baseObj);d._processOptions=function(a,b){var c=this._processedOptions=Object.create(a),e=this.data(),f=this.mappings();null==c.isOvertime&&(c.isOvertime=this._determineOvertime(e),c.isOvertime&&(c.dateGranularity=c.dateGranularity||this._calculateDateGranularity(e))),this._uniqueFillValues=this._processUniqueFillValues(e,f),this._uniqueFillExtents=this._processUniqueFillExtents(e,f,this._uniqueFillValues),this._uniqueXValues=this._processUniqueXValues(e,f,c.isOvertime),Object.getPrototypeOf(d)._processOptions.call(this,c,b)},d.isOvertime=function(){return this._processedOptions.isOvertime},d.uniqueFillValues=function(){return this._uniqueFillValues||[]},d.uniqueFillExtents=function(){return this._uniqueFillExtents},d.uniqueXValues=function(){return this._uniqueXValues||[]},d.getUniqueFillExtent=function(a){var b=this._uniqueFillValues[a];return b?this._uniqueFillExtents[b]:null},d.getUniqueFillExtentByFill=function(a){return this._uniqueFillExtents[a]},d._processUniqueFillValues=function(a,b){var c=a[b.series];return c?dv.util.uniq(c):[]},d._processUniqueFillExtents=function(a,b,c){var d=a[b.series],e=a[b.y],f={};return e.map(function(a,b){var c=d[b];isFinite(a)&&null!==a&&(f[c]||(f[c]=[a,a]),f[c][0]=Math.min(a,f[c][0]),f[c][1]=Math.max(a,f[c][1]))}),f},d._processUniqueXValues=function(a,b,c){if(c)return[];var d=a[b.x];return d?dv.util.uniq(d):[]},c.barObj=d,c.bar=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.standard"),d=Object.create(c.baseObj);a.d3;d._processOptions=function(a,b){Object.getPrototypeOf(d)._processOptions.apply(this,arguments)},d._validateData=function(a,b){return!!a},d.data=function(){return this._options.data},d.metric=function(){return this._options.metric},d.format=function(){return this._options.format},c.choroplethObj=d,c.choropleth=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.standard"),d=Object.create(c.barObj);d._processOptions=function(a,b){this._processCategories(a),Object.getPrototypeOf(d)._processOptions.call(this,this._processedOptions,b)},d._processCategories=function(a){var b,c,d,e=Object.create(a),f=Object.create(a.data),g=a.mappings,h=g.y,i=g.sliceId,j=g.legendLabel||g.x,k=g.series,l=g.seriesLabel||k,m=[],n=f[h].length,o=[],p=[],q={},r=[],s=[],t=e.colors,u="__other__";for(i||(i=j),b=0;b<n;++b){m[b]={};for(c in f){if(d=f[c][b],c===k)if(o.length){if(d!==o[o.length-1]){if(o.length===this.maxFacets){n--,b--,m.pop();break}o[o.length]=d,p[p.length]=f[l][b],q[d]=o.length}}else o=[d],p=[f[l][b]],q[d]=o.length;c===i&&r.indexOf(d)===-1&&r.push(d),m[b][c]=d}}this.numFacets=o.length;var v=e.sort;m.sort(function(a,b){return a[k]===b[k]?"none"===v?0:"ascending"===v?a[h]-b[h]:b[h]-a[h]:q[a[k]]-q[b[k]]});for(c in f)f[c]=[];f.cvdonutorder=[];var w,x,y,z=0,A=this._options.maxSlices,B=[];for(this.otherIncluded=!1,b=0,n=m.length;b<n;++b)if(x=m[b][k],y=m[b][i],x!==w&&(z=0,w=x),z==A-1&&b+1<n&&m[b+1][k]===x){for(c in f)f[c]||(f[c]=[]),f[c][b]=m[b][c];this.otherIncluded=!0,f[i][b]=u,f[j][b]=u,++z,f.cvdonutorder[b]=b}else if(z>=A)f[h][b-1]+=m[b][h],m.splice(b,1),n=m.length,--b,++z;else{++z;for(c in f)f[c][b]=m[b][c];if(B.indexOf(y)===-1){var C=r.indexOf(y);s.push(t[C]?t[C]:t[B.length%t.length]),B.push(y)}else{var D=B.indexOf(y);s.push(t[D]?t[D]:t[D%t.length])}f.cvdonutorder[b]=b}e.yAxisTitle=a.yAxisTitle||p,e.data=f,e.colors=s,this._processedOptions=e},d.processLabelData=function(a){var b=this.data(),c=this.mappings(),d=this._labelData=Object.create(b),e={},f={},g=d[c.series],h=d[c.y],i=d[c.totals],j=d[c.x];g.forEach(function(b,d){void 0===e[b]&&(e[b]=0),void 0===f[b]&&(f[b]=0),c.totals&&(!isNaN(parseFloat(i[d]))||i[d]>0)?(e[b]=e[b]||i[d],a.isSeriesEnabled&&!a.isSeriesEnabled(j[d])||(f[b]=f[b]||i[d])):(e[b]+=h[d],a.isSeriesEnabled&&!a.isSeriesEnabled(j[d])||(f[b]+=h[d]))});var k,l,m,n,o=d.cvtextvalue=[],p=d.cvtextperclabel=[],q=d.cvtextvallabel=[],r={};h.forEach(function(b,c){k=g[c],l=parseFloat(b)/e[k]*100,q[c]=b,p[c]=(l%1!=0?l.toFixed(1):l)+"%",n=!a.isSeriesEnabled||a.isSeriesEnabled(j[c]),m=parseFloat(b)/f[k]*100,void 0===r[k]&&(r[k]=0),o[c]=n?r[k]+m/2:0,r[k]+=n?m:0})},d.data=function(){return this._processedOptions.data},d.labelData=function(){return this._labelData},d.yAxisTitle=function(a){var b=this._processedOptions.yAxisTitle;return b instanceof Array&&b.length>a&&(b=b[a]),b},d.showOtherCategory=function(){return this.otherIncluded},d.numberOfFacets=function(){return this.numFacets},c.donutObj=d,c.donut=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.standard"),d=Object.create(c.baseObj);d._processOptions=function(a,b){var c=this._processedOptions=Object.create(a),e=this.data(),f=this.mappings();this._forceZero=a.forceZero,this._uniqueStrokeValues=this._processUniqueStrokeValues(e,f),this._uniqueStrokeExtents=this._processUniqueStrokeExtents(e,f),null==c.isOvertime&&(c.isOvertime=this._determineOvertime(e),c.isOvertime&&(c.dateGranularity=c.dateGranularity||this._calculateDateGranularity(e))),Object.getPrototypeOf(d)._processOptions.call(this,c,b)},d.isOvertime=function(){return this._processedOptions.isOvertime},d.uniqueStrokeValues=function(){return this._uniqueStrokeValues||[]},d.uniqueStrokeExtents=function(){return this._uniqueStrokeExtents},d.getUniqueStrokeExtent=function(a){var b=this._uniqueStrokeValues[a];return b?this._uniqueStrokeExtents[b]:null},d.getUniqueStrokeExtentByStroke=function(a){return this._uniqueStrokeExtents[a]},d._processUniqueStrokeValues=function(a,b){var c=a[b.series];return c?dv.util.uniq(c):[]},d._processUniqueStrokeExtents=function(a,b){var c=a[b.series],d=a[b.y],e={};return d.map(function(a,b){var d=c[b];isFinite(a)&&null!==a&&(e[d]||(e[d]=[a,a]),e[d][0]=Math.min(a,e[d][0]),e[d][1]=Math.max(a,e[d][1]))}),e},c.lineObj=d,c.line=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.standard"),d=Object.create(c.baseObj);d.sizeMetricName=function(){return this._options&&this._options.sizeTitle||null},d.isBubble=function(){var a=this.mappings().size;return a&&a.length},c.pointObj=d,c.point=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.standard"),d=Object.create(c.baseObj);d._processOptions=function(a,b){
var c=this._processedOptions=Object.create(a),e=JSON.parse(JSON.stringify(a.data));e.nodesById=[],e.nodes.map(function(a,b){return a._pid=b,e.nodesById[b]=a,a}),e.links=[],e.linksById=[];var f,g,h,i,j,k=this;e.paths=e.paths.filter(function(a){return a.values instanceof Array||(a.values=Array.apply(null,new Array(a.nodes.length-1)).map(function(){return a.values})),!a.values.some(function(a){return a<=0})&&(a.nodes.map(function(a){return null!==a?e.nodes[a]._pid:null}),!0)}),e.paths.forEach(function(a,b){a.nodes.forEach(function(c,d){if(!d)return void(null!==(f=a.nodes[d])&&(e.nodesById[f].isPathStart=!0,e.nodesById[f].isPathEnd&&(e.nodesById[f].isPivot=!0)));f=a.nodes[d-1],g=c,d===a.nodes.length-1&&null!==g&&(e.nodesById[g].isPathEnd=!0,e.nodesById[g].isPathStart&&(e.nodesById[g].isPivot=!0)),h=a.values[d-1],i=k._generateLinkId(f,g),(j=e.linksById[i])?(j.value+=h,j.paths.push(b)):(j={source:f,target:g,value:h,paths:[b]},e.linksById[i]=j,e.links.push(j))})}),c.data=e,Object.getPrototypeOf(d)._processOptions.apply(this,arguments)},d.data=function(){return this._processedOptions.data},d.nodeKey=function(){return function(a,b){return a.column+":"+a.row}},d.linkKey=function(){return function(a,b){var c=a.target,d=a.source,e=c?c.column+":"+c.row:"null";return(d?d.column+":"+d.row:"null")+"-"+e}},d.pathingTitle=function(){return""},d.getPathEnd=function(a){return null},d.getPathDirection=function(a){return 0},d.activePathsTitle=function(a){return a&&a.length?this.l10n.labels.pathing["path2+"]:""},d.isValidPathingData=function(){var a=this.data();return!!a&&(!(!a.nodes||!a.paths)&&!!a.nodes.length)},d._generateLinkId=function(a,b){return a+"-"+b},d._sortPaths=function(a,b){var c=this.data();return function(d,e){function f(a,b,g){var h=a+g,i=b+g,j=h<d.nodes.length&&h>=0?d.nodes[h]:-1,k=i<e.nodes.length&&i>=0?e.nodes[i]:-1;if(j!==-1&&null!==j&&(j=c.nodes.indexOf(c.nodesById[j])),k!==-1&&null!==k&&(k=c.nodes.indexOf(c.nodesById[k])),null===j&&null===k)return 0;if(null===j)return g>0?1:-1;if(null===k)return g>0?-1:1;if(-1===j&&-1===k)return 0;if(-1===j)return 1;if(-1===k)return-1;var l=j-k;return 0!==l?l:f(h,i,g)}var g=d.nodes.indexOf(a._pid),h=e.nodes.indexOf(a._pid),i=f(g,h,b);return 0===i&&(i=f(g,h,-b)),0!==i?i:e.nodes.length-d.nodes.length}},d._generatePathLinks=function(a,b,c){var d,e,f,g,h,i,j,k,l=this.data(),m=this,n=[];return a&&a.nodes?(a.nodes.forEach(function(c,o,p){o&&(d=a.nodes[o-1],e=c,f=l.nodesById[d]||null,g=l.nodesById[e]||null,h=a.values[o-1],i=null,o>1&&(i=l.linksById[m._generateLinkId(a.nodes[o-2],d)]),j=l.linksById[m._generateLinkId(d,e)],k=h/j.value*j.dy,f&&n.push({dy:k,sy:i?i.ty+i.offset-k:j.sy+j.offset,ty:g?j.sy+j.offset:f.dy-k,source:{x:f.x,y:f.y,dx:0},target:{x:f.x+f.dx,y:f.y},value:h,path:b,pivotStart:f.isPivot}),n.push({dy:k,sy:j.sy+j.offset,ty:j.ty+j.offset,source:f,target:g,value:h,path:b}),o+1===p.length&&g&&n.push({dy:k,sy:j.ty+j.offset,ty:j.ty+j.offset,source:{x:g.x,y:g.y,dx:0},target:{x:g.x+g.dx,y:g.y},value:h,path:b,pivotEnd:g.isPivot}),j.offset+=k)}),n):n},d.nodePaths=function(a){return this.data().paths.filter(function(b){return b.nodes.indexOf(a._pid)!==-1})},d.nodePathData=function(a,b){var c=this.data(),d=this,e=[];return c.links.forEach(function(a){a.offset=0}),a.sort(d._sortPaths(b,-1)),a.forEach(function(a,c){e=e.concat(d._generatePathLinks(a,c,b))}),e},d.linkSortActivePaths=function(a){var b,c=this.data(),d=c.paths,e=a.source?a.source:a.target;return c.links.forEach(function(a){a.offset=0}),b=a.paths.map(function(a){return d[a]}),b.sort(this._sortPaths(e,-1)),b},d.linkPathData=function(a){var b=[],c=this;return a.forEach(function(a,d){b=b.concat(c._generatePathLinks(a,d))}),b},d.canExpandNode=function(a){return!0},d.canCollapseNode=function(a){return!0},d.canPivotNode=function(a){return!0},c.pathingObj=d,c.pathing=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.standard"),d=Object.create(c.baseObj);a.d3;d._processOptions=function(a,b,c){function e(a){return a.metrics&&a.metrics.length&&a.metrics[0]&&void 0!==a.metrics[0].value?a.metrics[0].value:a.children&&a.children.length?a.children.reduce(function(a,b){return a+e(b)},0):0}function f(a,b){return e(b)-e(a)}function g(a,b){if(a.size=void 0===a.size?e(a):a.size,a.children&&a.children.length){if(b<k.categories.length){var c=k.categories[b],d=a.children.length;c.top=void 0!==c.top?Math.max(c.top,d):d}if(void 0!==a.size&&"percent"!==l.format){var h=a.children.reduce(function(a,b){return a+e(b)},0);a.size>h&&a.children.push({id:"cv-sb-other",name:m,size:a.size-h})}a.children.sort(f),a.children.forEach(function(a){g(a,b+1)})}}function h(a,b,c){var d,e,f=n[b]||(n[b]=[]),g=a.length;for(d=0;d<g;++d)e=a[d],e._sid=c+"s"+d,m!==e.name&&(e.name&&(f[f.length]=e.name),e.children&&e.children.length&&h(e.children,b+1,e._sid))}var i=c||this._processedOptions||{},j=this._processedOptions=Object.create(a),k=JSON.parse(JSON.stringify(j.data)),l=k.metrics[0]||{name:"",format:"int"},m=this.l10n.labels.core.other;g(k,0);var n=[];h([k],0,""),k.name=l.name,n.push([l.name]),k.categories.forEach(function(a,b){a.index=b}),j.uniques=n.reduce(function(a,b){var c=b.reduce(function(a,b){return a.indexOf(b)<0?a.push(b)&&a:a},[]);return a.concat(c)},[]),j.data=k,j.categories=k.categories,j.dataByPathKey=this._getDataByPathKey(),j.colorMetricIndex=i.colorMetricIndex,j.stackedMetricIndex=i.stackedMetricIndex,j.secondaryMetricIndex=i.secondaryMetricIndex,j.secondaryMetricType=i.secondaryMetricType,j.seqColors=j.seqColors,Object.getPrototypeOf(d)._processOptions.apply(this,arguments)},d.data=function(){return this._processedOptions.data},d.categories=function(){return this._processedOptions.categories},d.uniques=function(){return this._processedOptions.uniques},d.colors=function(){return this._processedOptions.colors},d.seqColors=function(){return this._processedOptions.seqColors},d.metricColor=function(a){return this._processedOptions.metricColor},d.otherColor=function(a){return this._processedOptions.otherColor},d.otherGrayColor=function(a){return this._processedOptions.otherGrayColor},d.outRangeColor=function(a){return this._processedOptions.outRangeColor},d.isOther=function(a){return a.name===this.l10n.labels.core.other},d.isRoot=function(a){return!a.parent},d.isDataEmpty=function(){var a=this.data();return!(a&&a.children&&a.children.length)},d.isSizeEmpty=function(){return!this.data().size},d._validateData=function(a){return!!(a&&a.children&&a.children.length)},d.getPathKey=function(a,b){return a&&a._sid||b},d.getCategoryName=function(a){return a&&a.name||null},d.getCategoryByName=function(a){var b=null;return this.categories().some(function(c){return a===c.name&&(b=c,!0)}),b},d._getDataByPathKey=function(){function a(c){c&&(b=d.getPathKey(c,null),b&&(e[b]=c),c.children&&c.children.forEach(a))}var b,c=this.data(),d=this,e={};return a(c),e},d.getDataByPathKey=function(){return this._processedOptions.dataByPathKey},d.getColorMetric=function(){var a=this._processedOptions.colorMetricIndex;return a?this.data().metrics[a]:null},d.getColorMetricIndex=function(){return this._processedOptions.colorMetricIndex},d.setColorMetricIndex=function(a){this._processedOptions.colorMetricIndex===a&&(a=null),this._processedOptions.secondaryMetricIndex=a,this.setSecondaryMetricType("color")},d.getStackedMetric=function(){var a=this._processedOptions.stackedMetricIndex;return a?this.data().metrics[a]:null},d.getStackedMetricIndex=function(){return this._processedOptions.stackedMetricIndex},d.setStackedMetricIndex=function(a){this._processedOptions.stackedMetricIndex===a&&(a=null),this._processedOptions.secondaryMetricIndex=a,this.setSecondaryMetricType("height")},d.getSecondaryMetricType=function(){return this._processedOptions.secondaryMetricType},d.setSecondaryMetricType=function(a){var b=this.getSecondaryMetricIndex()||1,c=this._processedOptions;switch(c.secondaryMetricIndex=b,c.secondaryMetricType=a,a){case"color":c.colorMetricIndex=b,c.stackedMetricIndex=null;break;case"height":c.colorMetricIndex=null,c.stackedMetricIndex=b;break;case"both":c.colorMetricIndex=b,c.stackedMetricIndex=b;break;default:c.colorMetricIndex=null,c.stackedMetricIndex=null,c.secondaryMetricIndex=null,c.secondaryMetricType=null}},d.getSecondaryMetric=function(){var a=this._processedOptions.secondaryMetricIndex;return a?this.data().metrics[a]:null},d.getSecondaryMetricIndex=function(){return this._processedOptions.secondaryMetricIndex},d.setSecondaryMetricIndex=function(a,b){this._processedOptions.secondaryMetricIndex===a&&b&&(a=null),this._processedOptions.secondaryMetricIndex=a,this.setSecondaryMetricType(a?this.getSecondaryMetricType()||"height":null)},c.sunburstObj=d,c.sunburst=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.standard"),d=Object.create(c.baseObj);a.d3;d._processOptions=function(a,b){var c=this._processedOptions=Object.create(a),e=a.data;a.isEmotionChart&&(e=this._getEmotionData(a.data)),c.data=e,Object.getPrototypeOf(d)._processOptions.call(this,c,b)},d._getEmotionData=function(a){var b=this.l10n.labels.flower,c=[{index:"joy",label:b.joy,color:"#e6b43c"},{index:"admiration",label:b.admiration,color:"#7daf4b"},{index:"fear",label:b.fear,color:"#50965a"},{index:"surprise",label:b.surprise,color:"#00a0be"},{index:"sadness",label:b.sadness,color:"#286eaf"},{index:"disgust",label:b.disgust,color:"#964196"},{index:"anger",label:b.anger,color:"#f04641"},{index:"anticipation",label:b.anticipation,color:"#dc5f00"}],d={};return dv.util.each(a,function(a){d[a.index]=a}),dv.util.each(c,function(a){d[a.index]?a.value=d[a.index].value||0:a.value=0}),c},d._validateData=function(a,b){return!!a},d.data=function(){return this._processedOptions.data},c.flowerObj=d,c.flower=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.standard"),d=Object.create(c.barObj);d._processOptions=function(a,b){var c=this._processedOptions=Object.create(a);this._processStepData(c),Object.getPrototypeOf(d)._processOptions.call(this,c,b)},d.data=function(){return this._processedOptions.data},d.mappings=function(){return this._processedOptions.mappings},d.seriesLabelKey=function(){return"cv:fnl:seriesLabel"},d.averageStepData=function(){return this._processedOptions.avgStepData},d.averageDataLabel=function(){return this._processedOptions.avgStepLabel},d.averageSeries=function(){return this._processedOptions.averageSeries},d.previousStepData=function(){return this._processedOptions.prevStepData},d.currentStepData=function(){return this._processedOptions.curStepData},d.textStepData=function(){return this._processedOptions.txtStepData},d.getNumSteps=function(){return this._processedOptions.numSteps},d.getNumBarsPerStep=function(){return this._processedOptions.numBarsPerStep},d.useAvgMaxValue=function(){if(!this.averageStepData())return!1;var a=this.uniqueFillExtents();return!Object.keys(a).some(function(b,c,d){return 0!==a[b][0]||0!==a[b][1]})||!this._processedOptions.normalized},d._stepDelimiter=":::",d.getStepName=function(a){return a&&a.slice(0,a.indexOf(this._stepDelimiter))||""},d.isSingleSeries=function(){return 1===this.getNumBarsPerStep()},d.isAvgCalculated=function(){return this._processedOptions.avgStepDataCalc},d.getSingleSeriesStepValue=function(a,b){if(this.isSingleSeries())return this.currentStepData()[this.mappings().y][b]},d._processStepData=function(a){var b=this.mappings(),c=this,d=a.data,e=b.series,f=b.seriesLabel,g=this.seriesLabelKey(),h=b.x,i=b.y,j=a.averageSeries,k=j&&d[e].indexOf(j)>=0,l=a.avgStepDataCalc=!k,m=a.avgStepData=a.disableAverage||!k&&!l?null:{cv_tt_val:[],cv_tt_pval:[]},n=a.prevStepData={cv_tt_val:[],cv_tt_pval:[]},o=a.data=a.curStepData={cv_tt_val:[],cv_tt_pval:[]},p=a.txtStepData={cv_label:[]},q={},r={};m&&(m[i]=[],m[h]=[],m[e]=[],m[g]=[]),n[i]=[],n[h]=[],n[e]=[],n[g]=[],o[i]=[],o[h]=[],o[e]=[],o[g]=[],p[i]=[],p[h]=[],p[e]=[],p[g]=[],a.numBarsPerStep=d[e].reduce(function(b,c,d){return b.indexOf(c)<0&&(a.disableAverage||c!==j)&&b.push(c),b},[]).length,d[i].forEach(function(b,l){var s,t=d[e][l],u=q[t];void 0===u?(q[t]=u=[],s=b):s=u[u.length-1];var v=d[h][l]+c._stepDelimiter+u.length;if(r[v]=r[v]?r[v]+b:b,k&&m&&t===j)return m[i].push(b),m[h].push(v),m[e].push(d[e][l]),m[g].push(a.avgStepLabel=a.averageSeriesLabel?a.averageSeriesLabel:d[f][l]),m.cv_tt_val.push(b),m.cv_tt_pval.push(s),void u.push(b);var w=o[i].length;n[i].push(s),o[i].push(b),p[i].push(b),p.cv_label.push(s?b/s:0),o.cv_tt_val[w]=n.cv_tt_val[w]=b,o.cv_tt_pval[w]=n.cv_tt_pval[w]=s,n[h][w]=o[h][w]=p[h][w]=v,n[e][w]=o[e][w]=p[e][w]=d[e][l],n[g][w]=o[g][w]=p[g][w]=d[f][l],u.push(b)});var s=null;m&&l&&(a.averageSeries="cv:fnl:avg"),a.numSteps=o[h].reduce(function(b,d,f){if(b.indexOf(d)<0&&(b.push(d),m&&l)){var j=r[d]/a.numBarsPerStep;null===s&&(s=j),m[i].push(j),m[h].push(d),m[e].push(a.averageSeries),m[g].push(a.avgStepLabel=a.averageSeriesLabel?a.averageSeriesLabel:c.l10n.labels.funnel.average),m.cv_tt_val.push(j),m.cv_tt_pval.push(s),s=j}return b},[]).length;var t=Object.create(a.mappings);t.seriesLabel=g,a.mappings=t},c.funnelObj=d,c.funnel=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.standard"),d=Object.create(c.baseObj);a.d3;d._processOptions=function(a,b){Object.getPrototypeOf(d)._processOptions.apply(this,arguments)},d._validateData=function(a,b){return!!a},d.data=function(){return this._options.data},c.wordcloudObj=d,c.wordcloud=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.rs"),d=Object.create(b.dataAdapter.standard.baseObj);d._getYFormats=function(a,b,c){var d=[];if(!(a&&a.metric&&b&&b.series&&c))return d;for(var e=a.metric.length,f=0;f<e;f++){var g=a.metric[f],h=a[b.series];d[c.indexOf(h[f])]=g.type}return d},d.mappings=function(){return this._processedOptions.mappings},d.formats=function(){return this._processedOptions.formats},c.baseObj=d,c.base=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.rs"),d=Object.create(b.dataAdapter.standard.barObj);d._processOptions=function(a,b){var c=this._processedOptions=Object.create(a);c.isOvertime=this._determineOvertime(c.data),c.yAxisTitle=a.yAxisTitle||this._getYAxisTitle(c.data),c.dateGranularity=this._getTimeGranularity(c.data),this._processData(c),this._updateMappings(c),Object.getPrototypeOf(d)._processOptions.call(this,c,b),c.formats={x:a.formats.x,y:this._getYFormats(c.data,c.mappings,this.uniqueFillValues())}},d.isOvertime=function(){return this._processedOptions.isOvertime},d.xAxisTitle=function(){return null},d.yAxisTitle=function(){return this._processedOptions.yAxisTitle},d.dateGranularity=function(){return this._processedOptions.dateGranularity},d.data=function(){return this._processedOptions.data},d.mappings=function(){return this._processedOptions.mappings},d.formats=function(){return this._processedOptions.formats},d._determineOvertime=function(a){var b=a.date,c=a.metric&&a.metric.some(function(a){return a&&a.date_range&&"*"!==a.date_range.gran});return b&&b.length&&c},d._getYAxisTitle=function(a){return this._getYTitleFromLabels(a.label)},d._processData=function(a){if(!a.isOvertime){var b,c=Object.create(a.data),d=c.cell.length,e=null,f=null;for(c.group=[],b=0;b<d;++b)f=e,e=c.cell[b],c.group[b]=c.series[b],f&&"incomplete"===e.status&&"incomplete"!==f.status&&(c.group[b]+="::incomplete::");a.data=c}},d._updateMappings=function(a){var b=Object.create(a.mappings);a.isOvertime?(b.x="date",b.y="value",b.group="group",b.series="series",b.seriesLabel="series_name"):(b.x="category",b.y="value",b.series="metric_series",b.seriesLabel="metric_series_name"),a.mappings=b},d._getTimeGranularity=function(a){return a.metric[0].date_range.gran};var e=c.baseObj;d._getYFormats=e._getYFormats,c.bar=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.rs"),d=Object.create(b.dataAdapter.standard.choroplethObj);a.d3;d._processOptions=function(a,b){var c=this._processedOptions=Object.create(a);this._processData(c,a),Object.getPrototypeOf(d)._processOptions.call(this,c,b)},d._processData=function(a,b){for(var c,d,e,f,g=b.data,h=g.data,i=g.metrics,j=g.filters,k=(g.dates,{values:{}}),l=0,m=i.length;l<m;++l){e=i[l],c=e.filter_ref,d=e.date_ref;for(var n=0,o=c.length;n<o;++n){f=j[c[n]];for(var p=0,q=d.length;p<q;++p)k.values[(f.info||{}).geo_id]=h[c[n]][d[p]][l].val}}a.data=k,a.metric=e.name,a.format=e.type},d.data=function(){return this._processedOptions.data},d.metric=function(){return this._processedOptions.metric},d.format=function(){return this._processedOptions.format},d._validateData=function(a,b){return!!a},d.data=function(){return this._processedOptions.data},c.choropleth=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.rs"),d=Object.create(b.dataAdapter.standard.donutObj);d._processOptions=function(a,b){var c=this._processedOptions=Object.create(a);this._updateMappings(c),Object.getPrototypeOf(d)._processOptions.call(this,c,b),c.formats={x:a.formats.x,y:this._getYFormats(c.data,c.mappings,this.uniqueFillValues())}},d.mappings=function(){return this._processedOptions.mappings},d.formats=function(){return this._processedOptions.formats},d._updateMappings=function(a){var b=Object.create(a.mappings);b.x="category",b.y="value",b.series="metric_series",b.seriesLabel="metric_series_name",a.mappings=b};var e=c.baseObj;d._getYFormats=e._getYFormats,c.donut=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.rs"),d=Object.create(b.dataAdapter.standard.lineObj);d._processOptions=function(a,b){var c=this._processedOptions=Object.create(a);c.isOvertime=this._determineOvertime(c.data),c.yAxisTitle=a.yAxisTitle||this._getYAxisTitle(c.data),c.dateGranularity=this._getTimeGranularity(c.data),this._updateMappings(c),this._processMultiMetric(c),this._processIncompleteData(c),Object.getPrototypeOf(d)._processOptions.call(this,c,b),c.formats={x:a.formats.x,y:c.isOvertime?this._getYFormats(c.data,c.mappings,this.uniqueStrokeValues()):a.formats.y}},d.data=function(){return this._processedOptions.data},d.mappings=function(){return this._processedOptions.mappings},d.formats=function(){return this._processedOptions.formats},d.xAxisTitle=function(){return this._processedOptions.xAxisTitle},d.yAxisTitle=function(){return this._processedOptions.yAxisTitle},d.isOvertime=function(){return this._processedOptions.isOvertime},d.dateGranularity=function(){return this._processedOptions.dateGranularity},d._determineOvertime=function(a){var b=a.date,c=a.metric&&a.metric.some(function(a){return a&&a.date_range&&"*"!==a.date_range.gran});return b&&b.length&&c},d._getYAxisTitle=function(a){return this._getYTitleFromLabels(a.label)},d._getTimeGranularity=function(a){return this.isOvertime()?a.metric[0].date_range.gran:"*"},d._processMultiMetric=function(a){if(!a.isOvertime){var b,c,d,e=a.data,f={series:[]},g=[],h=[];for(b=0,c=e.label.length;b<c;++b)d=e.label[b],f[d]||(g.push(d),e.metric&&e.metric.length?h.push(e.metric[b].type):h.push(null),f[d]=[]),f[d].push(e.value[b]),f.series[f[d].length-1]=e.category[b];var i={x:g[0],y:g[1]},j={x:h[0],y:{0:h[1]}};if(e.groups&&e.groups.length&&e.groups[0].length){var k,l,m=e.groups.length,n=[];for(k=0;k<m;++k)l=e.groups[k],n[k]=l.join("-");f.facet_group=n,i.series="facet_group"}g.length>2&&(i.size=g[2],j.size=h[2],a.sizeMetricName=a.sizeTitle||g[2]),a.data=f,a.mappings=i,a.formats=j,a.xAxisTitle=a.xAxisTitle||g[0],a.yAxisTitle=a.yAxisTitle||g[1]}},d._updateMappings=function(a){var b=Object.create(a.mappings);b.x="date",b.y="value",b.group="series",b.series="series",b.seriesLabel="series_name",a.mappings=b},d._processIncompleteData=function(a){if(a.isOvertime&&a.data.cell&&"stack"!==a.position&&"fill"!==a.position){var b,c,d=a.data,e=a.mappings,f=d.cell.length,g=null,h=null;for(d.cv_rs_group=d.cv_rs_group||[],b=0;b<f;++b)if(h=g,g=d.cell[b],d.cv_rs_group[b]=d.cv_rs_group[b]||d.series[b],!(d.cv_rs_group[b].indexOf("::incomplete::")>=0)){if(h&&"incomplete"===g.status&&"incomplete"!==h.status){for(c in d)d[c].splice(b,0,d[c][b-1]);d.cv_rs_group[b]+="::incomplete::",++f,++b}d.cv_rs_group[b]+="incomplete"===g.status?"::incomplete::":""}e.group="cv_rs_group"}};var e=c.baseObj;d._getYFormats=e._getYFormats,c.line=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.rs"),d=Object.create(b.dataAdapter.standard.pointObj);d._processOptions=function(a,b){var c,e,f,g=this._processedOptions=Object.create(a),h=a.data,i={series:[]},j=[],k=[];for(c=0,e=h.label.length;c<e;++c)f=h.label[c],i[f]||(j.push(f),h.metric&&h.metric.length?k.push(h.metric[c].type):k.push(null),i[f]=[]),i[f].push(h.value[c]),i.series[i[f].length-1]=h.category[c];var l={x:j[0],y:j[1]},m={x:k[0],y:k[1]};if(h.groups&&h.groups.length&&h.groups[0].length){var n,o,p=h.groups.length,q=[];for(n=0;n<p;++n)o=h.groups[n],q[n]=o.join("-");i.group=q,l.series="group"}else l.series="series";j.length>2&&(l.size=j[2],m.size=k[2],g.sizeMetricName=a.sizeTitle||j[2]),g.data=i,g.mappings=l,g.formats=m,g.xAxisTitle=a.xAxisTitle||j[0],g.yAxisTitle=a.yAxisTitle||j[1],Object.getPrototypeOf(d)._processOptions.apply(this,arguments)},d.data=function(){return this._processedOptions.data},d.mappings=function(){return this._processedOptions.mappings},d.formats=function(){return this._processedOptions.formats},d.xAxisTitle=function(){return this._processedOptions.xAxisTitle},d.yAxisTitle=function(){return this._processedOptions.yAxisTitle},d.sizeMetricName=function(){return this._processedOptions.sizeMetricName},c.point=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.rs"),d=Object.create(b.dataAdapter.standard.pathingObj);d._processOptions=function(a,b){function c(a){return"E"===a}function e(a){return"X"===a}var f,g,h,i,j,k,l,m,n,o,p=Object.create(a),q=p.data,r={},s=r.nodes=[],t=r.paths=[],u={},v=this.l10n.labels.pathing,w=0;for(g in q.filters)if(f=q.filters[g],h=this._getFilterId(f)){if(i=f.info&&f.info.name||"",j=this._getFilterChild(f),k=j&&j.op||null,k&&"previous"!==k&&"next"!==k&&(j=k=null),l=j&&j.val?[].concat(j.val):[],o=0,"previous"===k){if(l.some(c)){var x="E_0";u[x]||(m={label:v.entry,id:x,column:o,index:s.length,filters:[]},s[s.length]=m,u[x]=m)}o=l.length}if("next"===k){if(l.some(e)){var y="X_0";u[y]||(m={label:v.exit,id:y,column:o,index:s.length,filters:[]},s[s.length]=m,u[y]=m)}o=0-l.length}if(n=h+"_"+o,u[n]){u[n].filters.push(f);continue}if("0"===String(h)&&(v.exit===String(i)||v.entry===String(i)))continue;if("0"===String(h))continue;m={label:i,id:n,column:o,index:s.length,filters:[f]},s[s.length]=m,w=Math.min(w,o),u[n]=m}if(0!==w)for(var z in s)m=s[z],m.column-=w;var A,B,C,D,E,F,G,H,I,J,K,L;for(E=0,F=q.metrics.length;E<F;++E)for(A=q.metrics[E],B=A.filter_ref,C=A.date_ref,G=0,H=B.length;G<H;++G)for(g=B[G],f=q.filters[g],I=0,J=C.length;I<J;++I)D=C[I],q.dates[D],K=q.data[g][D][E],"invalid"!==K.status&&((m=this._getSingleNode(f,u))?m.total=+K.val:(L=this._createPath(f,u))&&L.length&&(t[t.length]={nodes:L,values:+K.val||0}));t.sort(function(a,b){return b.nodes.length-a.nodes.length});var M,N,O,P,Q,R;for(M=0,N=t.length;M<N;++M)for(Q=t[M],O=0,P=t.length;O<P;++O)M!==O&&(R=t[O],R.nodes.length!==Q.nodes.length&&-1!==this._getPathString(Q.nodes).indexOf(this._getPathString(R.nodes))&&(R.values-=Q.values));r.paths=t=t.filter(function(a){return a.values}),p.data=r;var S=a.data.metrics;p.pathingTitle=S&&S.length&&S[0].name,Object.getPrototypeOf(d)._processOptions.call(this,p,b)},d.nodeKey=function(){return function(a,b){return a.id}},d.linkKey=function(){return function(a,b){return(a.source?a.source.id:"null")+"-"+(a.target?a.target.id:"null")}},d.pathingTitle=function(){return this._processedOptions.pathingTitle},d.getPathEnd=function(a){function b(a){return a&&(a.isPivot||"E_0"===a.id||"X_0"===a.id)}if(!a||!a.nodes||!a.nodes.length)return null;if(1===a.nodes.length)return a.nodes[0];var c=a.nodes,d=this._processedOptions.data,e=d.nodesById,f=e[c[0]],g=e[c[c.length-1]];return b(f)?f:b(g)?g:null},d.getPathDirection=function(a){var b=this.getPathEnd(a);return b?b._pid===a.nodes[0]?1:-1:0},d.activePathsTitle=function(a){if(!a||!a.length)return"";var b=this.getPathEnd(a[0]),c=this.l10n.labels.pathing;return b?(1===this.getPathDirection(a[0])?c.pathFromNode:c.pathToNode).replace(/\{path\}/i,a.length>1?c["path2+"]:c.path).replace(/\{label\}/i,b.label):c["path2+"]},d._getSingleNode=function(a,b){var c=this._getFilterId(a),d=a.filter_def&&a.filter_def.length&&a.filter_def[0]||null,e=d&&d.op||null,f=this._getFilterChild(a),g=f&&f.op||null;return("select"===e||"equals"===e||"id"===e)&&"previous"!==g&&"next"!==g&&b[c+"_0"]},d._getPathString=function(a){return a.map(function(a){return null===a?"null":a}).toString()},d._createPath=function(a,b){var c=this._getFilterId(a),d=this._getFilterChild(a),e=d&&d.op||null;if(e&&"previous"!==e&&"next"!==e)return[];var f=d&&d.val?[].concat(d.val):[];if(!f.length)return f;var g="previous"===d.op,h="0"===c,i=g?0:h?0-f.length+1:0-f.length;return g?f.push(c):f.unshift(c),this._mapNodeIds(i,f,b)},d._mapNodeIds=function(a,b,c){if(!isFinite(a)||!c)return[];a=+a;var d,e=!1,f=!1,g=b&&b.map&&b.map(function(b){return"0"===b?null:(d=b+"_"+a,c[d]?(++a,e=!0,+c[d].index):(f=!0,null))});return e&&!f?g:[]},d._getFilterId=function(a){return a.info&&(a.info.id||0===a.info.id)?a.info.id+"":null},d._getFilterChild=function(a){var b=a.filter_def&&a.filter_def.length&&a.filter_def[0]||null;return b&&b.child&&b.child.length&&b.child[0]||null},d.canExpandNode=function(a){var b=a.entryLinks.length+a.targetLinks.length,c=a.exitLinks.length+a.sourceLinks.length;return!(Math.abs(parseInt(a.id.split("_")[1],10))>=4||c&&"E_0"===a.id||b&&"X_0"===a.id||b&&c)},d.canCollapseNode=function(a){var b=a.entryLinks.length+a.targetLinks.length,c=a.exitLinks.length+a.sourceLinks.length,d=parseInt(a.id.split("_")[1],10);return"E_0"!==a.id&&"X_0"!==a.id&&(0===d&&(c||b)||d>0&&c||d<0&&b)},d.canPivotNode=function(a){if(a.entryLinks.length,a.targetLinks.length,a.exitLinks.length,a.sourceLinks.length,0!==Math.abs(parseInt(a.id.split("_")[1],10)))return!0;var b=this.data(),c=b.nodes.map(function(a){return parseInt(a.id.split("_")[1],10)}),d=0;return!!c.some(function(a){return 0===a&&d++,d>1})},c.pathingObj=d,c.pathing=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.rs"),d=Object.create(b.dataAdapter.standard.sunburstObj);d._processOptions=function(a,b){function c(a){var b=a&&"id"===a.op?[a.val]:[];return a&&a.child&&a.child[0]?c(a.child[0]).concat(b):b}function e(a){return a&&a.child&&a.child[0]?e(a.child[0])+1:0}function f(a){return e(a&&a.filter_def&&a.filter_def[0]||null)}function g(a,b){var c=f(a.filter),d=f(b.filter);return c===d?b.cell[0].val-a.cell[0].val:c-d}var h,i,j,k,l,m,n,o,p,q,r,s,t=this._processedOptions,u=this._processedOptions=Object.create(a),v=a.data,w={children:[],categories:[],metrics:v.metrics.map(function(a,b){return{id:a.id,icon:a.icon,name:a.name||a.id,format:a.type,categories:[]}})};if(h=v.metrics[0]){for(p=[],i=h.filter_ref,j=h.date_ref,l=0,m=i.length;l<m;++l)for(s=i[l],r=v.filters[s],n=0,o=j.length;n<o;++n)k=j[n],v.dates[k],q=v.data[s][k],q[0]&&"invalid"!==q[0].status&&(r.info&&0===r.info.id||p.push({filter:r,cell:q}));p.sort(g);var x,y,z,A,B,C={};p.forEach(function(a){if(r=a.filter,q=a.cell,z=r&&r.filter_def&&r.filter_def[0]||null,A=c(z),B=A.length,x=A.join("-"),!x.length&&!r.info)return void q.forEach(function(a,b){w.metrics[b].value=+a.val});if(a={id:r.info.id,pid:x?x+"-"+r.info.id:r.info.id,name:r.info.name,metrics:q.map(function(a){return{value:+a.val}}),category:r.info.category||z&&z.var||void 0,filtervar:z&&z.var||void 0,children:[]},r.info.orig_name&&(a.orig_name=r.info.orig_name),q.forEach(function(a,b){var c=w.metrics[b];c.min=void 0!==c.min?Math.min(c.min,+a.val):+a.val,c.max=void 0!==c.max?Math.max(c.max,+a.val):+a.val;var d;(d=c.categories[B])?(d.min=Math.min(d.min,+a.val),d.max=Math.max(d.max,+a.val)):c.categories[B]={min:+a.val,max:+a.val}}),x&&(y=C[x]))y.children.push(a);else{if(A.length)return;w.children.push(a)}C[a.pid]=a,w.categories[B]={name:r.info.category||z&&z.var||w.categories[B]}})}u.data=w,Object.getPrototypeOf(d)._processOptions.call(this,u,b,t)},d._validateData=function(a){if(!a)return!1;for(var b in a)if(a[b].length)return!0;return!1},d.getPathKey=function(a,b){return a&&a._sid?a.pid?a.pid:a._sid:0},c.sunburst=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.rs"),d=Object.create(b.dataAdapter.standard.flowerObj);d._processOptions=function(a,b){var c=this._processedOptions=Object.create(a);c.data=this._parseData(a.data),Object.getPrototypeOf(d)._processOptions.call(this,c,b)},d._parseData=function(a){if(!a.metric.length)return[];var b=[],c=a.metric[0].id;return dv.util.each(a.metric,function(d,e){if(d.id==c){var f=a.filter[e].info.name,g=a.value[e];b.push({index:f.toLowerCase(),label:f,value:g})}}),b},d.formats=function(){return this._processedOptions.formats},c.flower=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.rs"),d=Object.create(b.dataAdapter.standard.funnelObj);d._processOptions=function(a,b){var c=this._processedOptions=Object.create(a);this._processData(c),this._updateMappings(c),Object.getPrototypeOf(d)._processOptions.call(this,c,b),c.formats={x:a.formats.x,y:this._getYFormats(c.data,c.mappings,this.uniqueFillValues())}},d.data=function(){return this._processedOptions.data},d.mappings=function(){return this._processedOptions.mappings},d.formats=function(){return this._processedOptions.formats},d._processData=function(a){a.data=Object.create(a.data)},d._updateMappings=function(a){var b=Object.create(a.mappings);b.x="category",b.y="value",b.series="metric_series",b.seriesLabel="metric_series_name",a.mappings=b};var e=c.baseObj;d._getYFormats=e._getYFormats,c.funnel=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.rs"),d=Object.create(b.dataAdapter.standard.wordcloudObj);a.d3;d._processOptions=function(a,b){var c=this._processedOptions=Object.create(a);this._processData(c,a),Object.getPrototypeOf(d)._processOptions.call(this,c,b)},d._processData=function(a,b){a.data=b.data},d.data=function(){return this._processedOptions.data},d._validateData=function(a,b){return!!a},d.data=function(){return this._processedOptions.data},c.wordcloud=b.util.createConstructor(d)}(this),function(a){"use strict";a.cloudViz.localeDefinition("de-DE",{monthAbbreviations:["Jan","Feb","Mrz","Apr","Mai","Juni","Juli","Aug","Sep","Okt","Nov","Dez"],months:["Januar","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],weekdayAbbreviations:["So","Mo","Di","Mi","Do","Fr","Sa"],weekdays:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],ampm:["AM","PM"]},"calendar"),a.cloudViz.localeDefinition("de-DE",{core:{nodata:"Das Diagramm enthlt keine Daten.",erroronrender:"Hoppla! Ein Fehler ist aufgetreten und das Diagramm konnte nicht gerendert werden.",other:"Sonstige",normalized:"Normalisiert"},dvcore:{target:"Zielgruppe",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} (in {time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:"Gre"},pathing:{entry:"Einstieg",exit:"Ausstieg","entry2+":"Einstiege","exit2+":"Ausstiege",path:"Pfad","path2+":"Pfade",expand:"Erweitern",focus:"Fokus",collapse:"Reduzieren",title:"Pfaderstellungs-diagramm",nodeEntries:"Einstiege fr {label}",nodeExits:"Ausstiege fr {label}",
nodeToNode:"{source}  {target}",percOfNode:"{perc} von {label}",pathToNode:"{path} zu {label}",pathFromNode:"{path} aus {label}",help1:"Dieses Diagramm stellt Pfade dar, die von einem Status in einen anderen bernommen wurden.",help2:"Jeder Knoten in Form eines Feldes reprsentiert einen Status im Pfad.",help3:"Durch Tippen oder Klicken auf einen Knoten werden zustzliche Optionen zum ndern des Diagramms angezeigt:",focusHelp:"Zeigt Pfade an, die am Knoten ein- oder ausgehen.",expandHelp:"Zeigt zustzliche Pfade an, die am Knoten ein- oder ausgehen.",collapseHelp:"Entfernt Pfade, die am Knoten ein- oder ausgehen."},sunburst:{audience:"Zielgruppe","audience2+":"Zielgruppen",category:"Kategorie","category2+":"Kategorien",metric:"Metrik","metric2+":"Metriken",primarymetric:"Primre Metrik",secondarymetric:"Sekundre Metrik","secondarymetric2+":"Sekundre Metriken",secondarymetrichelp:"Klicken Sie auf die Metrik, um die Hhe zu ndern.","secondarymetrichelp2+":"Klicken Sie auf die Metriken, um die Hhe zu ndern.",emptyFirstMetric:"Die erste Metrik enthlt keine Werte. Whlen Sie eine andere Metrik.",total:"Gesamt",zoomAction:"Doppelklicken, um zu vergrern.",moreAction:"Klicken Sie hier fr weitere Optionen.",zoomin:"Nahansicht",zoomout:"Weitansicht",hide:"Ausblenden",hideall:"Alles ausblenden",hideother:"Sonstige ausblenden",hidden:"{value} verborgenes Element","hidden2+":"{value} verborgene Elemente",topresults:"Top {value}",color:"Farbe",height:"Hhe",both:"Beide",none:"Keine",mapmetric:"{metric} anzeigen als:",percmetric:"{percent} der {metric}",mobilescroll:"&#x25BC  scrollen Sie, um Details anzuzeigen."},flower:{joy:"Freude",admiration:"Bewunderung",fear:"Angst",surprise:"berraschung",sadness:"Traurigkeit",disgust:"Emprung",anger:"Wut",anticipation:"Vorausschtzung"},venn:{definedAudience:"Definierte Zielgruppe"},donut:{precalculated:"Im Voraus berechnet"},bar:{max:"Max.",min:"Min.",mean:"Arithmetisches Mittel",median:"Median"},funnel:{step:"Schritt",segment:"Segment",conversion:"Konversion",fallout:"Trichteranalyse",average:"Durchschnitt"}},"labels"),a.cloudViz.localeDefinition("de-DE",{shortFormat:{second:":%S",minute:"%H:%M",hour:"%H",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{second:"%M:%S",minute:"%H:%M",hour:"%H",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{second:"%M:%S",minute:"%H:%M",hour:"%H Uhr %a %e",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%H Uhr %a %e"},fullFormat:{second:"%H:%M:%S",minute:"%H:%M Uhr %a %e",hour:"%H Uhr %a %e",day:"%A, %e. %B",week:"%A, %e. %B",month:"%B %Y",quarter:"%B %Y",year:"%Y",fallback:"%e %b, %Y",condensed:"%d/%m/%Y",timestamp:"%d %m.%Y %H:%M:%S"}},"dateFormat"),a.cloudViz.localeDefinition("de-DE",{decimalSeparator:",",groupSeparator:" ",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"},currency:{symbol:"",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"}},"numberFormat"),a.cloudViz.localeDefinition("de-DE",{singular:{second:"Sekunde",minute:"Minute",hour:"Stunde",day:"Tag",week:"Woche",month:"Monat",year:"Jahr"},plural:{second:"Sekunden",minute:"Minuten",hour:"Stunden",day:"Tagen",week:"Wochen",month:"Monate",year:"Jahre"},abbreviation:{second:"s",minute:"min",hour:"h",day:"d",week:"w",month:"mon",year:"y"}},"time")}(this),function(a){"use strict";a.cloudViz.localeDefinition("it-IT",{monthAbbreviations:["gen","feb","mar","apr","mag","giu","lug","ago","set","ott","nov","dic"],months:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],weekdayAbbreviations:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"],weekdays:["Domenica","Luned","Marted","Mercoled","Gioved","Venerd","Sabato"],ampm:["AM","PM"]},"calendar"),a.cloudViz.localeDefinition("it-IT",{core:{nodata:"Il grafico non contiene dati",erroronrender:"Si  verificato un errore, impossibile effettuare il rendering del grafico.",other:"Altro",normalized:"Normalizzato"},dvcore:{target:"Target",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} (in {time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:"Dimensione"},pathing:{entry:"Entrata",exit:"Uscita","entry2+":"Voci","exit2+":"Uscite",path:"Percorso","path2+":"Percorsi",expand:"Espandi",focus:"Focalizzazione",collapse:"Comprimi",title:"Grafico percorsi",nodeEntries:"{label} voci",nodeExits:"{label} uscite",nodeToNode:"{source}  {target}",percOfNode:"{perc} di {label}",pathToNode:"{path} a {label}",pathFromNode:"{path} da {label}",help1:"Questo grafico rappresenta i percorsi da uno stato a un altro.",help2:"Ogni nodo, a forma di casella, rappresenta uno stato all'interno del percorso.",help3:"Con un tocco o un clic su un nodo vengono visualizzate ulteriori opzioni per la modifica del grafico:",focusHelp:"Mostra i percorsi che entrano ed escono dal nodo",expandHelp:"Mostra ulteriori percorsi che arrivano al nodo o partono da esso",collapseHelp:"Rimuove i percorsi che arrivano al nodo o partono da esso"},sunburst:{audience:"Pubblico","audience2+":"Pubblico",category:"Categoria","category2+":"Categorie",metric:"Metrica","metric2+":"Metriche",primarymetric:"Metrica principale",secondarymetric:"Metrica secondaria","secondarymetric2+":"Metriche secondarie",secondarymetrichelp:"Fai clic sulla metrica per alternare l'altezza","secondarymetrichelp2+":"Fai clic sulla metrica per alternare l'altezza",emptyFirstMetric:"La prima metrica  priva di valori. Scegli una metrica diversa.",total:"Totale",zoomAction:"Fai doppio clic per ingrandire.",moreAction:"Fai clic per visualizzare altre opzioni.",zoomin:"Zoom avanti",zoomout:"Zoom indietro",hide:"Nascondi",hideall:"Nascondi tutto",hideother:"Nascondi altro",hidden:"{value} elemento nascosto","hidden2+":"{value} elementi nascosti",topresults:"primi {value}",color:"Colore",height:"Altezza",both:"Entrambi",none:"Nessuno",mapmetric:"Mostra {metric} come:",percmetric:"{percent} di {metric}",mobilescroll:"Scorri &#x25BC per visualizzare i dettagli"},flower:{joy:"Gioia",admiration:"Ammirazione",fear:"Timore",surprise:"Sorpresa",sadness:"Tristezza",disgust:"Disgusto",anger:"Rabbia",anticipation:"Attesa"},venn:{definedAudience:"Pubblico definito"},donut:{precalculated:"Precalcolato"},bar:{max:"Max.",min:"Min.",mean:"Media",median:"Mediana"},funnel:{step:"Incremento",segment:"Segmento",conversion:"Conversione",fallout:"Abbandono",average:"Media"}},"labels"),a.cloudViz.localeDefinition("it-IT",{shortFormat:{second:":%S",minute:"%I:%M",hour:"%I %p",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{second:"%M:%S",minute:"%I:%M %p",hour:"%I %p",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{second:"%M:%S",minute:"%I:%M %p",hour:"%I %p %a %e",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%I %p %a %e"},fullFormat:{second:"%I:%M:%S %p",minute:"%I:%M %p %a %e",hour:"%I %p %a %e",day:"%A %e %B",week:"%A %e %B",month:"%B %Y",quarter:"%B %Y",year:"%Y",fallback:"%e %b %Y",condensed:"%d/%m/%Y",timestamp:"%d/%m/%Y %I:%M:%S %p"}},"dateFormat"),a.cloudViz.localeDefinition("it-IT",{decimalSeparator:".",groupSeparator:",",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number}{symbol}",negativePattern:"-{number}{symbol}"},currency:{symbol:"$",positivePattern:"{number}{symbol}",negativePattern:"-{number}{symbol}"}},"numberFormat"),a.cloudViz.localeDefinition("it-IT",{singular:{second:"secondo",minute:"minuto",hour:"ora",day:"giorno",week:"settimana",month:"mese",year:"anno"},plural:{second:"secondi",minute:"minuti",hour:"ore",day:"giorni",week:"settimane",month:"mesi",year:"anni"},abbreviation:{second:"s",minute:"min",hour:"h",day:"d",week:"s",month:"mese",year:"y"}},"time")}(this),function(a){"use strict";a.cloudViz.localeDefinition("en-US",{monthAbbreviations:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdayAbbreviations:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ampm:["AM","PM"]},"calendar"),a.cloudViz.localeDefinition("en-US",{core:{nodata:"The chart has no data",erroronrender:"Oops! There was an error and the chart could not be rendered.",other:"Other",normalized:"Normalized"},dvcore:{target:"Target",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} (in {time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:"Size"},pathing:{entry:"Entry",exit:"Exit","entry2+":"Entries","exit2+":"Exits",path:"Path","path2+":"Paths",expand:"Expand",focus:"Focus",collapse:"Collapse",title:"Pathing Chart",nodeEntries:"{label} Entries",nodeExits:"{label} Exits",nodeToNode:"{source}  {target}",percOfNode:"{perc} of {label}",pathToNode:"{path} to {label}",pathFromNode:"{path} from {label}",help1:"This chart represents paths taken from one state to another.",help2:"Each node, shaped as a box, represents a state in the path.",help3:"Tapping or clicking a node will provide additional options to modify the chart:",focusHelp:"Shows paths coming into and going out of node",expandHelp:"Shows additional paths coming or going from the node",collapseHelp:"Removes paths coming or going from the node"},sunburst:{audience:"Audience","audience2+":"Audiences",category:"Category","category2+":"Categories",metric:"Metric","metric2+":"Metrics",primarymetric:"Primary Metric",secondarymetric:"Secondary Metric","secondarymetric2+":"Secondary Metrics",secondarymetrichelp:"Click metric to toggle height","secondarymetrichelp2+":"Click metrics to toggle height",emptyFirstMetric:"The first metric has no values. Please pick a different metric.",total:"Total",zoomAction:"Double-click to Zoom in.",moreAction:"Click for more options.",zoomin:"Zoom In",zoomout:"Zoom Out",hide:"Hide",hideall:"Hide All",hideother:"Hide Other",hidden:"{value} Hidden Item","hidden2+":"{value} Hidden Items",topresults:"top {value}",color:"Color",height:"Height",both:"Both",none:"None",mapmetric:"Show {metric} as:",percmetric:"{percent} of {metric}",mobilescroll:"&#x25BC scroll for details"},flower:{joy:"Joy",admiration:"Admiration",fear:"Fear",surprise:"Surprise",sadness:"Sadness",disgust:"Disgust",anger:"Anger",anticipation:"Anticipation"},venn:{definedAudience:"Defined Audience"},donut:{precalculated:"Precalculated"},bar:{max:"Max",min:"Min",mean:"Mean",median:"Median"},funnel:{step:"Step",segment:"Segment",conversion:"Conversion",fallout:"Fallout",average:"Average"}},"labels"),a.cloudViz.localeDefinition("en-US",{shortFormat:{second:":%S",minute:"%I:%M",hour:"%I %p",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{second:"%M:%S",minute:"%I:%M %p",hour:"%I %p",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{second:"%M:%S",minute:"%I:%M %p",hour:"%I %p %a %e",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%I %p %a %e"},fullFormat:{second:"%I:%M:%S %p",minute:"%I:%M %p %a %e",hour:"%I %p %a %e",day:"%A %e %B",week:"%A %e %B",month:"%B %Y",quarter:"%B %Y",year:"%Y",fallback:"%b %e, %Y",condensed:"%m/%d/%Y",timestamp:"%m/%d/%Y %I:%M:%S %p"}},"dateFormat"),a.cloudViz.localeDefinition("en-US",{decimalSeparator:".",groupSeparator:",",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number}{symbol}",negativePattern:"-{number}{symbol}"},currency:{symbol:"$",positivePattern:"{symbol}{number}",negativePattern:"-{symbol}{number}"}},"numberFormat"),a.cloudViz.localeDefinition("en-US",{singular:{second:"second",minute:"minute",hour:"hour",day:"day",week:"week",month:"month",year:"year"},plural:{second:"seconds",minute:"minutes",hour:"hours",day:"days",week:"weeks",month:"months",year:"years"},abbreviation:{second:"s",minute:"min",hour:"h",day:"d",week:"w",month:"mon",year:"y"}},"time")}(this),function(a){"use strict";a.cloudViz.localeDefinition("es-ES",{monthAbbreviations:["en.","febr.","mzo.","abr.","my.","jun.","jul.","ag.","sept.","oct.","nov.","dic."],months:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],weekdayAbbreviations:["dom.","lun.","mart.","mirc.","juev.","vier.","sb."],weekdays:["domingo","lunes","martes","mircoles","jueves","viernes","sbado"],ampm:["a. m.","p. m."]},"calendar"),a.cloudViz.localeDefinition("es-ES",{core:{nodata:"El grfico no contiene datos",erroronrender:"Se ha producido un error y no se ha podido procesar el grfico.",other:"Otro",normalized:"Normalizado"},dvcore:{target:"Destino",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} (en {time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:"Tamao"},pathing:{entry:"Entrada",exit:"Salida","entry2+":"Entradas","exit2+":"Salidas",path:"Ruta","path2+":"Rutas",expand:"Expandir",focus:"Enfoque",collapse:"Contraer",title:"Grfico de ruta",nodeEntries:"Entradas de {label}",nodeExits:"Salidas de {label}",nodeToNode:"{source}  {target}",percOfNode:"{perc} de {label}",pathToNode:"{path} a {label}",pathFromNode:"{path} de {label}",help1:"Este grfico representa las rutas que se pueden tomar para ir de un estado a otro.",help2:"Los nodos, con forma de caja, representan un estado en la ruta.",help3:"Al hacer clic o tocar un nodo, se mostrarn opciones adicionales para modificar el grfico:",focusHelp:"Muestra las rutas de ida al nodo o de vuelta",expandHelp:"Muestra rutas adicionales de ida al nodo o de vuelta",collapseHelp:"Suprime las rutas de ida al nodo o de vuelta"},sunburst:{audience:"Audiencia","audience2+":"Audiencias",category:"Categora","category2+":"Categoras",metric:"Mtrica","metric2+":"Mtrica",primarymetric:"Mtrica principal",secondarymetric:"Mtrica secundaria","secondarymetric2+":"Mtricas secundarias",secondarymetrichelp:"Haga clic en la mtrica para alternar la altura","secondarymetrichelp2+":"Haga clic en las mtricas para alternar la altura",emptyFirstMetric:"La primera mtrica no contiene ningn valor. Elija otra mtrica.",total:"Total",zoomAction:"Doble clic para aumentar.",moreAction:"Haga clic para ver ms opciones.",zoomin:"Acercar",zoomout:"Alejar",hide:"Ocultar",hideall:"Ocultar todo",hideother:"Ocultar otro",hidden:"{value} elemento oculto","hidden2+":"{value} elementos ocultos",topresults:"{value} principales",color:"Color",height:"Altura",both:"Ambos",none:"Ninguno",mapmetric:"Mostrar {metric} como:",percmetric:"{percent} de {metric}",mobilescroll:"&#x25BC desplcese para ms detalles"},flower:{joy:"Alegra",admiration:"Admiracin",fear:"Miedo",surprise:"Sorpresa",sadness:"Tristeza",disgust:"Desagrado",anger:"Enfado",anticipation:"Expectacin"},venn:{definedAudience:"Audiencia definida"},donut:{precalculated:"Calculado previamente"},bar:{max:"Mx.",min:"Mn.",mean:"Promedio",median:"Mediana"},funnel:{step:"Paso",segment:"Segmento",conversion:"Conversin",fallout:"Visita en el orden previsto",average:"Promedio"}},"labels"),a.cloudViz.localeDefinition("es-ES",{shortFormat:{second:":%S",minute:"%H:%M",hour:"%H",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{second:"%M:%S",minute:"%H:%M",hour:"%H",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{second:"%M:%S",minute:"%H:%M",hour:"%Hh %a %e",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%Hh %a %e"},fullFormat:{second:"%H:%M:%S",minute:"%H:%M %a %e",hour:"%Hh %I %p",day:"%A %e de %B",week:"%A %e de %B",month:"%B %Y",quarter:"%B %Y",year:"%Y",fallback:"%e %b, %Y",condensed:"%d/%m/%Y",timestamp:"%d/%m/%Y %H:%M:%S"}},"dateFormat"),a.cloudViz.localeDefinition("es-ES",{decimalSeparator:",",groupSeparator:" ",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"},currency:{symbol:"",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"}},"numberFormat"),a.cloudViz.localeDefinition("es-ES",{singular:{second:"segundo",minute:"minuto",hour:"hora",day:"da",week:"semana",month:"mes",year:"ao"},plural:{second:"segundos",minute:"minutos",hour:"horas",day:"das",week:"semanas",month:"meses",year:"aos"},abbreviation:{second:"s",minute:"min",hour:"h",day:"d",week:"w",month:"mon",year:"y"}},"time")}(this),function(a){"use strict";a.cloudViz.localeDefinition("fr-FR",{monthAbbreviations:["Janv.","Fvr.","Mars","Avr.","Mai","Juin","Juill.","Aot","Sept.","Oct.","Nov.","Dc."],months:["janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"],weekdayAbbreviations:["Dim.","Lun.","Mar.","Mer.","Jeu.","Ven.","Sam."],weekdays:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],ampm:["AM","PM"]},"calendar"),a.cloudViz.localeDefinition("fr-FR",{core:{nodata:"Le graphique ne contient aucune donne",erroronrender:"Une erreur sest produite, impossible de restituer le graphique.",other:"Autre",normalized:"Normalis"},dvcore:{target:"Cible",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} (en {time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:"Taille"},pathing:{entry:"Entre",exit:"Sortie","entry2+":"Entres de","exit2+":"Sorties de",path:"Chemin daccs","path2+":"Chemins daccs",expand:"Dvelopper",focus:"Mise au point",collapse:"Rduire",title:"Graphique du cheminement",nodeEntries:"Entres {label}",nodeExits:"Sorties {label}",nodeToNode:"{source}  {target}",percOfNode:"{perc} de {label}",pathToNode:"{path}  {label}",pathFromNode:"{path} de {label}",help1:"Ce graphique reprsente les chemins daccs rcuprs dun tat  un autre.",help2:"Chaque nud, en forme de cadre, reprsente un tat dans le chemin daccs.",help3:"Le fait dappuyer ou de cliquer sur un nud fournit dautres options pour modifier le graphique:",focusHelp:"Prsente les chemins daccs issus du nud ou y parvenant",expandHelp:"Prsente des chemins daccs supplmentaires issus du nud ou y parvenant.",collapseHelp:"Supprime les chemins daccs supplmentaires issus du nud ou y parvenant."},sunburst:{audience:"Audience","audience2+":"Audiences",category:"Catgorie","category2+":"Catgories",metric:"Mesure","metric2+":"Mesures",primarymetric:"Mesure principale",secondarymetric:"Mesure secondaire","secondarymetric2+":"Mesures secondaires",secondarymetrichelp:"Cliquer sur une mesure pour activer/dsactiver la hauteur","secondarymetrichelp2+":"Cliquer sur des mesures pour activer/dsactiver la hauteur",emptyFirstMetric:"La premire mesure na aucune valeur. Slectionnez une autre mesure.",total:"Total",zoomAction:"Double-cliquez pour effectuer un zoom avant.",moreAction:"Cliquez pour plus doptions.",zoomin:"Zoom avant",zoomout:"Zoom arrire",hide:"Masquer",hideall:"Tout masquer",hideother:"Masquer autres",hidden:"{value} lment masqu","hidden2+":"{value} lments masqus",topresults:"{value} premiers",color:"Couleur",height:"Hauteur",both:"Les deux",none:"Nant",mapmetric:"Afficher {metric} comme:",percmetric:"{percent} des {metric}",mobilescroll:"Dfilement &#x25BC pour plus de dtails"},flower:{joy:"Joie",admiration:"Admiration",fear:"Peur",surprise:"Surprise",sadness:"Tristesse",disgust:"Dgot",anger:"Colre",anticipation:"Anticipation"},venn:{definedAudience:"Audience dfinie"},donut:{precalculated:"Prcalculs"},bar:{max:"Max.",min:"Min.",mean:"Moyenne",median:"Mdiane"},funnel:{step:"Etape",segment:"Segment",conversion:"Conversion",fallout:"Abandons",average:"Moyenne"}},"labels"),a.cloudViz.localeDefinition("fr-FR",{shortFormat:{second:":%S",minute:"%H:%M",hour:"%H",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{second:"%M:%S",minute:"%H:%M",hour:"%H",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{second:"%M:%S",minute:"%H:%M",hour:"%H h %a %e",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%H h %a %e"},fullFormat:{second:"%H:%M:%S",minute:"%H:%M %a %e",hour:"%H h %a %e",day:"%A %e %B",week:"%A %e %B",month:"%B %Y",quarter:"%B %Y",year:"%Y",fallback:"%e %b %Y",condensed:"%d/%m/%Y",timestamp:"%d/%m/%Y %H:%M:%S"}},"dateFormat"),a.cloudViz.localeDefinition("fr-FR",{decimalSeparator:",",groupSeparator:" ",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"},currency:{symbol:"",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"}},"numberFormat"),a.cloudViz.localeDefinition("fr-FR",{singular:{second:"seconde",minute:"minute",hour:"heure",day:"jour",week:"semaine",month:"mois",year:"anne"},plural:{second:"secondes",minute:"minutes",hour:"heures",day:"jours",week:"semaines",month:"mois",year:"annes"},abbreviation:{second:"s",minute:"min",hour:"h",day:"d",week:"w",month:"mon",year:"y"}},"time")}(this),function(a){"use strict";a.cloudViz.localeDefinition("ja-JP",{monthAbbreviations:["1","2","3","4","5","6","7","8","9","10","11","12"],months:["1","2","3","4","5","6","7","8","9","10","11","12"],weekdayAbbreviations:["","","","","","",""],weekdays:["","","","","","",""],ampm:["",""]},"calendar"),a.cloudViz.localeDefinition("ja-JP",{core:{nodata:"",erroronrender:"",other:"",normalized:""},dvcore:{target:"Target",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} ({time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:"Size"},pathing:{entry:"",exit:"","entry2+":"","exit2+":"",path:"","path2+":"",expand:"",focus:"",collapse:"",title:"",nodeEntries:"{label} ",nodeExits:"{label} ",nodeToNode:"{source}  {target}",percOfNode:"{label}{perc}",pathToNode:"{label}{path}",pathFromNode:"{label}{path}",help1:"",help2:"",help3:"",focusHelp:"",expandHelp:"",collapseHelp:""},sunburst:{audience:"","audience2+":"",category:"","category2+":"",metric:"","metric2+":"",primarymetric:"",secondarymetric:"","secondarymetric2+":"",secondarymetrichelp:"","secondarymetrichelp2+":"",emptyFirstMetric:"",total:"",zoomAction:"",moreAction:"",zoomin:"",zoomout:"",hide:"",hideall:"",hideother:"",hidden:"{value} ","hidden2+":"{value} ",topresults:"{value}",color:"",height:"",both:"",none:"",mapmetric:"{metric}:",percmetric:"{metric}{percent}",mobilescroll:"&#x25BC "},flower:{joy:"",admiration:"",fear:"",surprise:"",sadness:"",disgust:"",anger:"",anticipation:""},venn:{definedAudience:""},donut:{precalculated:""},bar:{max:"",min:"",mean:"",median:""},funnel:{step:"",segment:"",conversion:"",fallout:"",average:""}},"labels"),a.cloudViz.localeDefinition("ja-JP",{shortFormat:{second:":%S",minute:"%I  %M ",hour:"%p %I ",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{second:"%M:%S",minute:"%p %I  %M ",hour:"%p %I ",day:"%e  (%a)",week:"%e  (%a)",month:"%b",quarter:"%b",year:"%Y",fallback:"%e  (%a)"},longFormat:{second:"%M:%S",minute:"%p %I  %M ",hour:"%e  (%a) %p %I ",day:"%e  (%a)",week:"%e  (%a)",month:"%B",quarter:"%B",year:"%Y",fallback:"%e  (%a) %p %I "},fullFormat:{second:"%p %I  %M  %S ",minute:"%e  (%a) %p %I  %M ",hour:"%e  (%a) %p %I ",day:"%B %e%A",week:"%B %e%A",month:"%Y  %B",quarter:"%Y  %B",year:"%Y",fallback:"%Y  %b %e ",condensed:"%Y/%m/%d",timestamp:"%Y  %m  %d %p %I  %M  %S "}},"dateFormat"),a.cloudViz.localeDefinition("ja-JP",{decimalSeparator:".",groupSeparator:",",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number}{symbol}",negativePattern:"-{number}{symbol}"},currency:{symbol:"",positivePattern:"{symbol}{number}",negativePattern:"-{symbol}{number}"}},"numberFormat"),a.cloudViz.localeDefinition("ja-JP",{singular:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""},plural:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""},abbreviation:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""}},"time")}(this),function(a){"use strict";a.cloudViz.localeDefinition("ko-KR",{monthAbbreviations:["1","2","3","4","5","6","7","8","9","10","11","12"],months:["1","2","3","4","5","6","7","8","9","10","11","12"],weekdayAbbreviations:["","","","","","",""],weekdays:["","","","","","",""],ampm:["",""]},"calendar"),a.cloudViz.localeDefinition("ko-KR",{core:{nodata:"  .",erroronrender:"     .",other:"",normalized:""},dvcore:{target:"",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title}({time})",legendTime:"{value}{time}"},point:{xScale:"X",yScale:"Y",sizeScale:""},pathing:{entry:"",exit:"","entry2+":"","exit2+":"",path:"","path2+":"",expand:"",focus:"",collapse:"",title:"  ",nodeEntries:"{label} ",nodeExits:"{label} ",nodeToNode:"{source}  {target}",percOfNode:"{label} {perc}",pathToNode:"{label}  {path}",pathFromNode:"{label}  {path}",help1:"        .",help2:"       .",help3:"         .",focusHelp:"    ",expandHelp:"     ",collapseHelp:"    "},sunburst:{audience:"","audience2+":"",category:"","category2+":"",metric:"","metric2+":"",primarymetric:" ",secondarymetric:" ","secondarymetric2+":" ",secondarymetrichelp:"   ","secondarymetrichelp2+":"   ",emptyFirstMetric:"    .   .",total:"",zoomAction:"   .",moreAction:"   .",zoomin:"",zoomout:"",hide:"",hideall:" ",hideother:" ",hidden:"{value}  ","hidden2+":"{value}  ",topresults:" {value}",color:"",height:"",both:" ",none:"",mapmetric:"{metric}  :",percmetric:"{metric}  {percent} ",mobilescroll:"&#x25BC    ."},flower:{joy:"",admiration:"",fear:"",surprise:"",sadness:"",disgust:"",anger:"",anticipation:""},venn:{definedAudience:" "},donut:{precalculated:" "},bar:{max:"",min:"",mean:"",median:""},funnel:{step:"",segment:"",conversion:"",fallout:"",average:""}},"labels"),a.cloudViz.localeDefinition("ko-KR",{shortFormat:{second:":%S",minute:"%I:%M",hour:"%p %I",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{second:"%M:%S",minute:"%p %I:%M",hour:"%p %I",day:"%e %a",week:"%e %a",month:"%b",quarter:"%b",year:"%Y",fallback:"%e %a"},longFormat:{second:"%M:%S",minute:"%p %I:%M",hour:"%e %a %p %I",day:"%e %A",week:"%e %A",month:"%B",quarter:"%B",year:"%Y",fallback:"%e %a %p %I"},fullFormat:{second:"%p %I:%M:%S",minute:"%e %a %p %I:%M",hour:"%e %a %p %I",day:"%B %e, %A",week:"%B %e, %A",month:"%Y  %B",quarter:"%Y %B",year:"%Y",fallback:"%Y %b %e",condensed:"%Y/%m/%d",timestamp:"%Y/%m/%d %p %I:%M:%S"}},"dateFormat"),a.cloudViz.localeDefinition("ko-KR",{decimalSeparator:".",groupSeparator:",",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number}{symbol}",negativePattern:"-{number}{symbol}"},currency:{symbol:"",positivePattern:"{symbol}{number}",negativePattern:"-{symbol}{number}"}},"numberFormat"),a.cloudViz.localeDefinition("ko-KR",{singular:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""},plural:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""},abbreviation:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""}},"time")}(this),function(a){"use strict";a.cloudViz.localeDefinition("pt-BR",{monthAbbreviations:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],months:["janeiro","fevereiro","maro","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],weekdayAbbreviations:["Dom","Seg","Ter","Qua","Qui","Sex","Sb"],weekdays:["Domingo","Segunda-feira","Tera-feira","Quarta-feira","Quinta-feira","Sexta-feira","Sbado"],ampm:["AM","PM"]},"calendar"),a.cloudViz.localeDefinition("pt-BR",{core:{nodata:"O grfico no possui dados",erroronrender:"Ops! Houve um erro e o grfico no pde ser processado.",other:"Outro",normalized:"Normalizado"},dvcore:{target:"Meta",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} (em {time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:"Tamanho"},pathing:{entry:"Entrada",exit:"Sair","entry2+":"Entradas","exit2+":"Sadas",path:"Caminho","path2+":"Caminhos",expand:"Expandir",focus:"Foco",collapse:"Recolher",title:"Grfico de criao de caminho",nodeEntries:"{label} Entradas",nodeExits:"{label} Sadas",nodeToNode:"{source}  {target}",percOfNode:"{perc} de {label}",pathToNode:"{path} para {label}",pathFromNode:"{path} de {label}",help1:"Esse grfico representa os caminhos tomados de um estado para outro.",help2:"Cada n, formado como uma caixa representa um estado no caminho.",help3:"Tocar ou clicar em um n fornecer opes adicionais para modificar o grfico:",focusHelp:"Mostra os caminhos entrando ou saindo do n",expandHelp:"Mostra caminhos adicionais entrando ou saindo do n",collapseHelp:"Remove os caminhos saindo ou entrando no n"},sunburst:{audience:"Pblico-alvo","audience2+":"Pblicos-alvos",category:"Categoria","category2+":"Categorias",metric:"Mtrica","metric2+":"Mtricas",primarymetric:"Mtrica principal",secondarymetric:"Mtrica secundria","secondarymetric2+":"Mtricas secundrias",secondarymetrichelp:"Clique na mtrica para alternar a altura","secondarymetrichelp2+":"Clique nas mtricas para alternar a altura",emptyFirstMetric:"A primeira mtrica no tem valores. Esolha uma mtrica diferente.",total:"Total",zoomAction:"Clique duas vezes para aumentar o zoom.",moreAction:"Clique para ver mais opes.",zoomin:"Ampliar",zoomout:"Reduzir",hide:"Ocultar",hideall:"Ocultar tudo",hideother:"Ocultar outro",hidden:"{value} Item oculto","hidden2+":"{value} itens ocultos",topresults:"principais {value}",color:"Cor",height:"Altura",both:"Ambos",none:"Nenhum",mapmetric:"Mostrar {metric} como:",percmetric:"{percent} de {metric}",mobilescroll:"&#x25BC role para ver os detalhes"},flower:{joy:"Alegria",admiration:"Admirao",fear:"Medo",surprise:"Problemas",sadness:"Tristeza",disgust:"Repulsa",anger:"Raiva",anticipation:"Antecipao"},venn:{definedAudience:"Pblico-alvo definido"},donut:{precalculated:"Pr-calculado"},bar:{max:"Mx",min:"Mn",mean:"Mdia",median:"Mediana"},funnel:{step:"Etapa",segment:"Segmento",conversion:"Converso",fallout:"Fallout",average:"Mdia"}},"labels"),a.cloudViz.localeDefinition("pt-BR",{shortFormat:{second:":%S",minute:"%H:%M",hour:"%H",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{second:"%M:%S",minute:"%H:%M",hour:"%H",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{second:"%M:%S",minute:"%H:%M",hour:"%Hh %a %e",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%Hh %a %e"},fullFormat:{second:"%H:%M:%S",minute:"%H:%M %a %e",hour:"%Hh %a %e",day:"%A, %e de %B",week:"%A, %e de %B",month:"%B %Y",quarter:"%B %Y",year:"%Y",fallback:"%e %b, %Y",condensed:"%Y/%m/%d",timestamp:"%m/%d/%Y %H:%M:%S"}},"dateFormat"),a.cloudViz.localeDefinition("pt-BR",{decimalSeparator:",",groupSeparator:" ",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"},currency:{symbol:"R$",positivePattern:"{number} {symbol}",
negativePattern:"-{number} {symbol}"}},"numberFormat"),a.cloudViz.localeDefinition("pt-BR",{singular:{second:"segundo",minute:"minuto",hour:"hora",day:"da",week:"semana",month:"ms",year:"ano"},plural:{second:"segundos",minute:"minutos",hour:"horas",day:"dias",week:"semanas",month:"meses",year:"anos"},abbreviation:{second:"s",minute:"min",hour:"h",day:"d",week:"w",month:"mon",year:"y"}},"time")}(this),function(a){"use strict";a.cloudViz.localeDefinition("zh-CN",{monthAbbreviations:["1 ","2 ","3 ","4 ","5 ","6 ","7 ","8 ","9 ","10 ","11 ","12 "],months:["1 ","2 ","3 ","4 ","5 ","6 ","7 ","8 ","9 ","10 ","11 ","12 "],weekdayAbbreviations:["","","","","","",""],weekdays:["","","","","","",""],ampm:["",""]},"calendar"),a.cloudViz.localeDefinition("zh-CN",{core:{nodata:"",erroronrender:"",other:"",normalized:""},dvcore:{target:"",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title}{time}",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:""},pathing:{entry:"",exit:"","entry2+":"","exit2+":"",path:"","path2+":"",expand:"",focus:"",collapse:"",title:"",nodeEntries:"{label} ",nodeExits:"{label} ",nodeToNode:"{source}  {target}",percOfNode:"{perc}  {label}",pathToNode:" {label}  {path}",pathFromNode:" {label}  {path}",help1:"",help2:"",help3:"",focusHelp:"",expandHelp:"",collapseHelp:""},sunburst:{audience:"","audience2+":"",category:"","category2+":"",metric:"","metric2+":"",primarymetric:"",secondarymetric:"","secondarymetric2+":"",secondarymetrichelp:"","secondarymetrichelp2+":"",emptyFirstMetric:"",total:"",zoomAction:"",moreAction:"",zoomin:"",zoomout:"",hide:"",hideall:"",hideother:"",hidden:"{value} ","hidden2+":"{value} ",topresults:" {value}",color:"",height:"",both:"",none:"",mapmetric:"{metric} :",percmetric:"{percent}  {metric}",mobilescroll:"&#x25BC "},flower:{joy:"",admiration:"",fear:"",surprise:"",sadness:"",disgust:"",anger:"",anticipation:""},venn:{definedAudience:""},donut:{precalculated:""},bar:{max:"",min:"",mean:"",median:""},funnel:{step:"",segment:"",conversion:"",fallout:"",average:""}},"labels"),a.cloudViz.localeDefinition("zh-CN",{shortFormat:{second:":%S",minute:"%I:%M",hour:"%p %I",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{second:"%M:%S",minute:"%p %I:%M",hour:"%p %I",day:"%e  %a",week:"%e  %a",month:"%b",quarter:"%b",year:"%Y",fallback:"%e  %a"},longFormat:{second:"%M:%S",minute:"%p %I:%M",hour:"%e  %a %p %I",day:"%e  %A",week:"%e  %A",month:"%B",quarter:"%B",year:"%Y",fallback:"%e  %a %p %I"},fullFormat:{second:"%p %I:%M:%S",minute:"%e  (%a) %p %I:%M",hour:"%e  %a %p %I",day:"%B %e %A",week:"%B %e %A",month:"%Y %B",quarter:"%Y %B",year:"%Y",fallback:"%Y %b %e ",condensed:"%Y/%m/%d",timestamp:"%Y/%m/%d %p %I:%M:%S"}},"dateFormat"),a.cloudViz.localeDefinition("zh-CN",{decimalSeparator:".",groupSeparator:",",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number}{symbol}",negativePattern:"-{number}{symbol}"},currency:{symbol:"",positivePattern:"{symbol}{number}",negativePattern:"-{symbol}{number}"}},"numberFormat"),a.cloudViz.localeDefinition("zh-CN",{singular:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""},plural:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""},abbreviation:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""}},"time")}(this),function(a){"use strict";a.cloudViz.localeDefinition("zh-TW",{monthAbbreviations:["1 ","2 ","3 ","4 ","5 ","6 ","7 ","8 ","9 ","10 ","11 ","12 "],months:["1 ","2 ","3 ","4 ","5 ","6 ","7 ","8 ","9 ","10 ","11 ","12 "],weekdayAbbreviations:["","","","","","",""],weekdays:["","","","","","",""],ampm:["",""]},"calendar"),a.cloudViz.localeDefinition("zh-TW",{core:{nodata:"",erroronrender:"",other:"",normalized:""},dvcore:{target:"",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} ({time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:""},pathing:{entry:"",exit:"","entry2+":"","exit2+":"",path:"","path2+":"",expand:"",focus:"",collapse:"",title:"",nodeEntries:"{label} ",nodeExits:"{label} ",nodeToNode:"{source}  {target}",percOfNode:"{perc}  {label}",pathToNode:" {label}  {path}",pathFromNode:" {label}  {path}",help1:"",help2:"",help3:":",focusHelp:"",expandHelp:"",collapseHelp:""},sunburst:{audience:"","audience2+":"",category:"","category2+":"",metric:"","metric2+":"",primarymetric:"",secondarymetric:"","secondarymetric2+":"",secondarymetrichelp:"","secondarymetrichelp2+":"",emptyFirstMetric:"",total:"",zoomAction:"",moreAction:"",zoomin:"",zoomout:"",hide:"",hideall:"",hideother:"",hidden:"{value} ","hidden2+":"{value} ",topresults:" {value} ",color:"",height:"",both:"",none:"",mapmetric:" {metric} :",percmetric:"{percent}  {metric}",mobilescroll:"&#x25BC "},flower:{joy:"",admiration:"",fear:"",surprise:"",sadness:"",disgust:"",anger:"",anticipation:""},venn:{definedAudience:""},donut:{precalculated:""},bar:{max:"",min:"",mean:"",median:""},funnel:{step:"",segment:"",conversion:"",fallout:"",average:""}},"labels"),a.cloudViz.localeDefinition("zh-TW",{shortFormat:{second:":%S",minute:"%I:%M",hour:"%p %I",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{second:"%M:%S",minute:"%p %I:%M",hour:"%p %I",day:"%e  %a",week:"%e  %a",month:"%b",quarter:"%b",year:"%Y",fallback:"%e  %a"},longFormat:{second:"%M:%S",minute:"%p %I:%M",hour:"%e  %a %p %I",day:"%e  %A",week:"%e  %A",month:"%B",quarter:"%B",year:"%Y",fallback:"%e  %a %p %I"},fullFormat:{second:"%p %I:%M:%S",minute:"%e  %a %p %I:%M",hour:"%e  %a %p %I",day:"%B %e %A",week:"%B %e %A",month:"%Y  %B",quarter:"%Y %B",year:"%Y",fallback:"%Y %b %e ",condensed:"%Y/%m/%d",timestamp:"%Y/%m/%d %p %I:%M:%S"}},"dateFormat"),a.cloudViz.localeDefinition("zh-TW",{decimalSeparator:".",groupSeparator:",",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number}{symbol}",negativePattern:"-{number}{symbol}"},currency:{symbol:"NT$",positivePattern:"{symbol}{number}",negativePattern:"-{symbol}{number}"}},"numberFormat"),a.cloudViz.localeDefinition("zh-TW",{singular:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""},plural:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""},abbreviation:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""}},"time")}(this),function(a){"use strict";a.cloudViz.localeDefinition("zz-ZZ",{monthAbbreviations:["_[g] Jan_","_[q] Feb_","_[r] Mar_","_[n] Apr_","_[p] May_","_[k] Jun_","_[l] Jul_","_[i] Aug_","_[j] Sep_","_[h] Oct_","_[o] Nov_","_[m] Dec_"],months:["_[1] January_","_[2] February_","_[3] March_","_[x] April_","_[y] May_","_[z] June_","_[0] July_","_[s] August_","_[t] September_","_[u] October_","_[v] November_","_[w] December_"],weekdayAbbreviations:["_[+] Sun_","_[4] Mon_","_[5] Tue_","_[6] Wed_","_[7] Thu_","_[8] Fri_","_[9] Sat_"],weekdays:["_[BB] Sunday_","_[BA] Monday_","_[/] Tuesday_","_[BC] Wednesday_","_[BD] Thursday_","_[BE] Friday_","_[BF] Saturday_"],ampm:["_[e] AM_","_[f] PM_"]},"calendar"),a.cloudViz.localeDefinition("zz-ZZ",{core:{nodata:"_[BH] The chart has no data_",erroronrender:"_[BG] Oops! There was an error and the chart could not be rendered._",other:"_[BJ] Other_",normalized:"_[BI] Normalized_"},dvcore:{target:"_[BL] Target_",yAxisTimeNoTitle:"_[BK] {time}_",yAxisTimeWithTitle:"_[BN] {title} (in {time})_",legendTime:"_[BM] {value} {time}_"},point:{xScale:"_[Bp] X_",yScale:"_[Br] Y_",sizeScale:"_[Bq] Size_"},pathing:{entry:"_[Be] Entry_",exit:"_[Bg] Exit_","entry2+":"_[Bn] Entries_","exit2+":"_[Bb] Exits_",path:"_[BZ] Path_","path2+":"_[Bf] Paths_",expand:"_[BX] Expand_",focus:"_[BW] Focus_",collapse:"_[Bj] Collapse_",title:"_[Bc] Pathing Chart_",nodeEntries:"_[Cz] {label} Entries_",nodeExits:"_[C0] {label} Exits_",nodeToNode:"_[Cy] {source}  {target}_",percOfNode:"_[Ba] {perc} of {label}_",pathToNode:"_[Bo] {path} to {label}_",pathFromNode:"_[Bd] {path} from {label}_",help1:"_[BY] This chart represents paths taken from one state to another._",help2:"_[Bh] Each node, shaped as a box, represents a state in the path._",help3:"_[Bk] Tapping or clicking a node will provide additional options to modify the chart:_",focusHelp:"_[Bm] Shows paths coming into and going out of node_",expandHelp:"_[Bi] Shows additional paths coming or going from the node_",collapseHelp:"_[Bl] Removes paths coming or going from the node_"},sunburst:{audience:"_[Ci] Audience_","audience2+":"_[Ce] Audiences_",category:"_[Ch] Category_","category2+":"_[Cf] Categories_",metric:"_[Cd] Metric_","metric2+":"_[Cg] Metrics_",primarymetric:"_[Cj] Primary Metric_",secondarymetric:"_[Cl] Secondary Metric_","secondarymetric2+":"_[Ck] Secondary Metrics_",secondarymetrichelp:"_[Cm] Click metric to toggle height_","secondarymetrichelp2+":"_[Cn] Click metrics to toggle height_",emptyFirstMetric:"_[B2] The first metric has no values. Please pick a different metric._",total:"_[B7] Total_",zoomAction:"_[By] Double-click to Zoom in._",moreAction:"_[B5] Click for more options._",zoomin:"_[Bz] Zoom In_",zoomout:"_[Bs] Zoom Out_",hide:"_[Bt] Hide_",hideall:"_[Bw] Hide All_",hideother:"_[Bu] Hide Other_",hidden:"_[B4] {value} Hidden Item_","hidden2+":"_[B0] {value} Hidden Items_",topresults:"_[B8] top {value}_",color:"_[Bx] Color_",height:"_[Bv] Height_",both:"_[B6] Both_",none:"_[B3] None_",mapmetric:"_[B9] Show {metric} as:_",percmetric:"_[B1] {percent} of {metric}_",mobilescroll:"_[Co] &#x25BC scroll for details_"},flower:{joy:"_[BU] Joy_",admiration:"_[BT] Admiration_",fear:"_[BQ] Fear_",surprise:"_[BR] Surprise_",sadness:"_[BO] Sadness_",disgust:"_[BP] Disgust_",anger:"_[BV] Anger_",anticipation:"_[BS] Anticipation_"},venn:{definedAudience:"_[B+] Defined Audience_"},donut:{precalculated:"_[DD] Precalculated_"},bar:{max:"_[DH] Max_",min:"_[DG] Min_",mean:"_[DE] Mean_",median:"_[DF] Median_"},funnel:{step:"_[C3] Step_",segment:"_[C4] Segment_",conversion:"_[C1] Conversion_",fallout:"_[C5] Fallout_",average:"_[C2] Average_"}},"labels"),a.cloudViz.localeDefinition("zz-ZZ",{shortFormat:{second:"_[DB] :%S_",minute:"_[DC] %I:%M_",hour:"_[Z] %I %p_",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"_[d] %Y_",fallback:"%e"},mediumFormat:{second:"_[DA] %M:%S_",minute:"_[C/] %I:%M %p_",hour:"_[S] %I %p_",day:"_[Q] %a %e_",week:"_[T] %a %e_",month:"%b",quarter:"%b",year:"_[U] %Y_",fallback:"_[V] %a %e_"},longFormat:{second:"_[C+] %M:%S_",minute:"_[C9] %I:%M %p_",hour:"_[P] %I %p %a %e_",day:"_[M] %A %e_",week:"_[O] %A %e_",month:"_[L] %B_",quarter:"_[K] %B_",year:"_[J] %Y_",fallback:"_[N] %I %p %a %e_"},fullFormat:{second:"_[C6] %I:%M:%S %p_",minute:"_[C8] %I:%M %p %a %e_",hour:"_[D] %I %p %a %e_",day:"_[C] %A %e %B_",week:"_[B] %A %e %B_",month:"_[G] %B %Y_",quarter:"_[E] %B %Y_",year:"_[I] %Y_",fallback:"_[F] %b %e, %Y_",condensed:"_[H] %m/%d/%Y_",timestamp:"_[C7] %m/%d/%Y %I:%M:%S %p_"}},"dateFormat"),a.cloudViz.localeDefinition("zz-ZZ",{decimalSeparator:"_[CC] ._",groupSeparator:"_[CD] ,_",negativePattern:"_[CE] -{number}_",percent:{symbol:"_[CF] %_",positivePattern:"_[CG] {number}{symbol}_",negativePattern:"_[CH] -{number}{symbol}_"},currency:{symbol:"_[B/] $_",positivePattern:"_[CA] {symbol}{number}_",negativePattern:"_[CB] -{symbol}{number}_"}},"numberFormat"),a.cloudViz.localeDefinition("zz-ZZ",{singular:{second:"_[CX] second_",minute:"_[CY] minute_",hour:"_[CZ] hour_",day:"_[CV] day_",week:"_[Ca] week_",month:"_[Cb] month_",year:"_[CW] year_"},plural:{second:"_[CS] seconds_",minute:"_[CP] minutes_",hour:"_[Cc] hours_",day:"_[CR] days_",week:"_[CQ] weeks_",month:"_[CT] months_",year:"_[CU] years_"},abbreviation:{second:"_[CJ] s_",minute:"_[CO] min_",hour:"_[CK] h_",day:"_[CI] d_",week:"_[CL] w_",month:"_[CM] mon_",year:"_[CN] y_"}},"time")}(this);